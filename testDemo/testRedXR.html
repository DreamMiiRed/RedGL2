<html>

<head>
    <meta charset="UTF-8">
    <title>다중뷰</title>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, target-densitydpi=device-dpi"
    />
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>
    <script src='https://immersive-web.github.io/webxr-samples/js/webxr-polyfill.js'></script>

    <!--This script patches up around implementation differences in past browser versions
        so that the samples can always be written against the most recent spec changes.
        It won't be necessary after the API has been officially shipped for a bit.-->
    <script src='https://immersive-web.github.io/webxr-samples/js/webxr-version-shim.js'></script>

    <script src='https://immersive-web.github.io/webxr-samples/js/cottontail/build/cottontail.js'></script>

    <script src='https://immersive-web.github.io/webxr-samples/js/webxr-button.js'></script>


    <script src="../example/dat.gui.min.js"></script>
    <script src="../src/gl-matrix-min.js"></script>
    <script src="../src/RedGLUtil.js"></script>
    <script src="../src/detect/RedGLDetect.js"></script>
    <script src="../src/base/RedDefinePropertyInfo.js"></script>
    <script src="../src/RedGL.js"></script>
    <script src="../src/RedXR.js"></script>
    <!--//-->

    <script src="../src/base/RedBaseObject3D.js"></script>
    <script src="../src/base/RedBaseContainer.js"></script>
    <script src="../src/base/RedBaseController.js"></script>
    <script src="../src/base/RedBaseLight.js"></script>
    <script src="../src/loader/RedImageLoader.js"></script>
    <script src="../src/base/RedBaseTexture.js"></script>
    <script src="../src/base/RedBaseMaterial.js"></script>


    <!--//-->
    <script src="../src/frameBuffer/RedFrameBuffer.js"></script>
    <!--//-->
    <script src="../src/geometry/RedBuffer.js"></script>
    <script src="../src/geometry/RedGeometry.js"></script>
    <script src="../src/geometry/RedInterleaveInfo.js"></script>
    <!--//-->

    <!--//-->
    <script src="../rnd/resources/RedAtlas.js"></script>
    <script src="../rnd/resources/system/RedAtlasUV.js"></script>
    <script src="../src/resources/system/RedTextureOptionChecker.js"></script>
    <script src="../src/resources/RedBitmapTexture.js"></script>
    <script src="../src/resources/RedDDSTexture.js"></script>
    <script src="../src/resources/RedVideoTexture.js"></script>
    <script src="../rnd/resources/RedAtlasTexture.js"></script>
    <script src="../src/resources/RedBitmapCubeTexture.js"></script>
    <!--재질-->
    <script src="../src/material/RedColorMaterial.js"></script>
    <script src="../src/material/RedColorPhongMaterial.js"></script>
    <script src="../src/material/RedColorPhongTextureMaterial.js"></script>
    <script src="../src/material/RedEnvironmentMaterial.js"></script>
    <script src="../src/material/RedBitmapMaterial.js"></script>
    <script src="../src/material/RedParticleColorMaterial.js"></script>
    <script src="../src/material/RedParticleBitmapMaterial.js"></script>
    <script src="../src/material/RedPointColorMaterial.js"></script>
    <script src="../src/material/RedPointBitmapMaterial.js"></script>
    <script src="../src/material/RedSheetMaterial.js"></script>
    <script src="../src/material/RedStandardMaterial.js"></script>
    <script src="../src/material/RedVideoMaterial.js"></script>
    <script src="../src/material/RedPBRMaterial.js"></script>
    <!--//-->
    <script src="../src/light/RedAmbientLight.js"></script>
    <script src="../src/light/RedDirectionalLight.js"></script>
    <script src="../src/light/RedPointLight.js"></script>
    <!--//-->
    <script src="../src/loader/JsonModelLoader.js"></script>
    <script src="../src/loader/obj/RedMTLLoader.js"></script>
    <script src="../src/loader/obj/RedOBJLoader.js"></script>
    <script src="../src/loader/gltf/RedGLTFLoader.js"></script>
    <script src="../src/loader/3ds/Red3DSLoader.js"></script>
    <script src="../src/loader/dae/RedDAELoader.js"></script>
    <!--//-->
    <script src="../src/object3D/RedAxis.js"></script>
    <script src="../src/object3D/RedGrid.js"></script>
    <script src="../src/object3D/RedMesh.js"></script>
    <script src="../src/object3D/RedLine.js"></script>
    <script src="../src/object3D/RedSkyBox.js"></script>
    <script src="../src/object3D/RedSprite3D.js"></script>
    <!--//-->
    <script src="../src/particle/RedPointUnit.js"></script>
    <script src="../src/particle/RedParticleUnit.js"></script>
    <script src="../src/particle/RedParticleEmitter.js"></script>
    <!--//-->
    <script src="../src/primitives/RedBox.js"></script>
    <script src="../src/primitives/RedPlane.js"></script>
    <script src="../src/primitives/RedSphere.js"></script>
    <!--//-->
    <script src="../src/program/RedProgram.js"></script>
    <script src="../src/program/RedSystemShaderCode.js"></script>
    <script src="../src/program/RedShader.js"></script>
    <!--//-->
    <script src="../src/renderer/RedRenderer.js"></script>
    <script src="../src/renderer/system/RedRenderDebuger.js"></script>
    <script src="../src/renderer/system/RedSystemUniformUpdater.js"></script>
    <!--//-->
    <script src="../src/RedView.js"></script>
    <script src="../src/RedWorld.js"></script>
    <script src="../src/RedScene.js"></script>
    <!--//-->
    <script src="../src/camera/RedCamera.js"></script>
    <script src="../src/camera/RedBasicController.js"></script>
    <script src="../src/camera/RedObitController.js"></script>
    <!--시스템 재질-->
    <script src="../src/material/system/RedGridMaterial.js"></script>
    <script src="../src/material/system/RedDirectionalShadowMaterial.js"></script>
    <script src="../src/material/system/RedSkyBoxMaterial.js"></script>
    <script src="../src/material/system/RedPostEffectMaterial.js"></script>
    <!--쉐도우-->
    <script src="../src/shadow/RedDirectionalShadow.js"></script>
    <script src="../src/shadow/RedShadowManager.js"></script>
    <!--마우스이벤트-->
    <script src="../src/renderer/system/RedMouseEventManager.js"></script>
    <script src="../src/material/system/RedMouseEventMaterial.js"></script><!--이펙트-->
    <script src="../src/postEffect/RedPostEffectManager.js"></script>
    <script src="../src/base/RedBasePostEffect.js"></script>
    <script src="../src/postEffect/bloom/RedPostEffect_Bloom.js"></script>
    <script src="../src/postEffect/bloom/RedPostEffect_BloomThreshold.js"></script>
    <script src="../src/postEffect/blur/RedPostEffect_Blur.js"></script>
    <script src="../src/postEffect/blur/RedPostEffect_BlurX.js"></script>
    <script src="../src/postEffect/blur/RedPostEffect_BlurY.js"></script>
    <script src="../src/postEffect/blur/RedPostEffect_GaussianBlur.js"></script>
    <script src="../src/postEffect/blur/RedPostEffect_ZoomBlur.js"></script>
    <script src="../src/postEffect/adjustments/RedPostEffect_BrightnessContrast.js"></script>
    <script src="../src/postEffect/adjustments/RedPostEffect_Threshold.js"></script>
    <script src="../src/postEffect/adjustments/RedPostEffect_Invert.js"></script>
    <script src="../src/postEffect/adjustments/RedPostEffect_Gray.js"></script>
    <script src="../src/postEffect/adjustments/RedPostEffect_HueSaturation.js"></script>
    <script src="../src/postEffect/pixelate/RedPostEffect_HalfTone.js"></script>
    <script src="../src/postEffect/pixelate/RedPostEffect_Pixelize.js"></script>
    <script src="../src/postEffect/RedPostEffect_Convolution.js"></script>
    <script src="../src/postEffect/dof/RedPostEffect_DoF.js"></script>
    <script src="../src/postEffect/dof/RedPostEffect_DoF_DepthMaterial.js"></script>
    <script src="../src/postEffect/RedPostEffect_Film.js"></script>
    <script src="../src/postEffect/RedPostEffect_Vignetting.js"></script>
    <script src="../rnd/postEffect/RedPostEffect_SSAO.js"></script>
    <script src="../rnd/postEffect/RedPostEffect_SSAO_DepthMaterial.js"></script>

    <script src="../rnd/postEffect/RedPostEffect_SSAO_PointMaker.js"></script>
    <script src="../src/postEffect/antialiasing/RedPostEffect_FXAA.js"></script>
</head>

<body>
<canvas id="test" style="border: none;width:0 ;height:0"></canvas>
<script>
    var t = document.getElementById('test')
    document.body.appendChild(t)
    var testMesh, testMesh2
    var testParticle;
    RedXR(t,
        function (v) {
            console.log(this)
            console.log(v)
            testMesh = RedMesh(this, RedSphere(this, 2, 16, 16, 16), RedColorPhongMaterial(this))
            testMesh.z = -10
            testMesh.drawMode = this.gl.POINTS
            testMesh.pointSize = 7
            v['scene'].addChild(testMesh)

            var testDLight;
            testDLight = RedDirectionalLight(this)
            testDLight.x = 0
            testDLight.y = 300
            testDLight.z = 300
            console.log('~~~', v)
            // var c = RedPostEffect_Bloom(this)
            // c.blur = 30
            // c.threshold = 0.5
            // RedView('left55')['postEffectManager'].addEffect(c)
            // RedView('right55')['postEffectManager'].addEffect(c)

            v['scene'].addLight(testDLight)
            v['scene'].skyBox =
                RedSkyBox(
                    this,
                    [
                        '../asset/cubemap/SwedishRoyalCastle/px.jpg',
                        '../asset/cubemap/SwedishRoyalCastle/nx.jpg',
                        '../asset/cubemap/SwedishRoyalCastle/py.jpg',
                        '../asset/cubemap/SwedishRoyalCastle/ny.jpg',
                        '../asset/cubemap/SwedishRoyalCastle/pz.jpg',
                        '../asset/cubemap/SwedishRoyalCastle/nz.jpg'
                    ]
                );
            var self = this;

            (function () {
                var testMaterial
                testMaterial = RedPointBitmapMaterial(self, RedBitmapTexture(self, '../asset/particle.png'))
                var interleaveData
                interleaveData = []
                var i = 20000
                while (i--) {
                    var t = Math.random() * 1000 - 500
                    interleaveData.push(Math.random() * 1000 - 500, Math.random() * 1000 - 500, Math.random() * 1000 - 500)
                    interleaveData.push(Math.random() * 2)
                }
                interleaveData = interleaveData
                testParticle = RedPointUnit(
                    self,
                    interleaveData,
                    [
                        RedInterleaveInfo('aVertexPosition', 3),
                        RedInterleaveInfo('aPointSize', 1)
                    ],
                    testMaterial
                )
//			testParticle['useDepthTest'] = false
                testParticle['blendSrc'] = self.gl.SRC_ALPHA
                testParticle['blendDst'] = self.gl.ONE
                v['scene'].addChildAt(testParticle, 0)
            })();
            var testMaterial = RedEnvironmentMaterial(
                this,
                RedBitmapTexture(this, '../asset/crate.png'),
                RedBitmapCubeTexture(this, [
                    '../asset/cubemap/SwedishRoyalCastle/px.jpg',
                    '../asset/cubemap/SwedishRoyalCastle/nx.jpg',
                    '../asset/cubemap/SwedishRoyalCastle/py.jpg',
                    '../asset/cubemap/SwedishRoyalCastle/ny.jpg',
                    '../asset/cubemap/SwedishRoyalCastle/pz.jpg',
                    '../asset/cubemap/SwedishRoyalCastle/nz.jpg'
                ]),
                RedBitmapTexture(this, '../asset/normalTest.jpg'),
                RedBitmapTexture(this, '../asset/specular.png'),
                RedBitmapTexture(this, '../asset/displacementTest.jpg')
            )
            testMaterial.reflectionPower = 0.5
            JsonModelLoader(this, 'testJsonModel', '../asset/teapot.json', function (interleaveBuffer, indexBuffer) {
                console.log('호잇!', interleaveBuffer, indexBuffer)

                var i = 10
                while (i--) {
                    // var testMesh = RedMesh(self, RedGeometry(interleaveBuffer, indexBuffer),
                    //     testMaterial)
                    var testMesh = RedMesh(self, RedSphere(self), testMaterial)
                    testMesh.x = Math.sin(Math.PI * 2 / 10 * i) * 25
                    testMesh.z = Math.cos(Math.PI * 2 / 10 * i) * 25
                    testMesh.scaleX = testMesh.scaleY = testMesh.scaleZ = 1
                    v['scene'].addChild(testMesh)
                }
                v['scene']['grid'] = RedGrid(self)
            });
            RedGLTFLoader(this, '../asset/glTF/basic/', 'DamagedHelmet.gltf', function (v2) {
                console.log('호잇!', v2)
                // v2['resultMesh'].scaleX = v2['resultMesh'].scaleY = v2['resultMesh'].scaleZ = 0.1
                v2['resultMesh'].z = -10
                v['scene'].addChild(testMesh2 = v2['resultMesh'])
            })
        },
        function (time) {
//			console.log(time)

            testParticle.rotationY += 0.1
            //
            testMesh.rotationX += 0.5
            testMesh.rotationY += 0.5
            testMesh.rotationZ += 0.5
            if (testMesh2) testMesh2.rotationY += 0.1
        }
    )
</script>
</body>

</html>