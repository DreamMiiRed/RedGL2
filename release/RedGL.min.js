var RedGLUtil,RedGL;let RedXR;var RedDefinePropertyInfo,RedFrameBuffer,RedBuffer,RedGeometry,RedInterleaveInfo,RedBaseMaterial,RedAtlas,RedAtlasUV,RedTextureOptionChecker,RedBitmapTexture,RedVideoTexture,RedAtlasTexture,RedBitmapCubeTexture,RedColorMaterial,RedColorPhongMaterial,RedColorPhongTextureMaterial,RedEnvironmentMaterial,RedBitmapMaterial,RedParticleColorMaterial,RedParticleBitmapMaterial,RedPointColorMaterial,RedPointBitmapMaterial,RedSheetMaterial,RedStandardMaterial,RedVideoMaterial,RedBaseObject3D,RedBaseContainer,RedBaseLight,RedAmbientLight,RedDirectionalLight,RedPointLight,JsonModelLoader,RedMTLLoader,RedOBJLoader,RedAxis,RedGrid,RedMesh,RedLine,RedSkyBox,RedSprite3D,RedPointUnit,RedParticleUnit,RedParticleEmitter,RedBox,RedPlane,RedSphere,RedProgram,RedSystemShaderCode,RedShader,RedRenderer,RedRenderDebuger,RedView,RedWorld,RedScene,RedCamera,RedBasicController,RedObitController,RedGridMaterial,RedSkyBoxMaterial,RedDirectionalShadowMaterial,RedPostEffectMaterial,RedDirectionalShadow,RedShadowManager,RedPostEffectManager,RedPostEffect_Bloom,RedPostEffect_BloomThreshold,RedPostEffect_Blur,RedPostEffect_BlurX,RedPostEffect_BlurY,RedPostEffect_GaussianBlur,RedPostEffect_ZoomBlur,RedPostEffect_BrightnessContrast,RedPostEffect_Threshold,RedPostEffect_Invert,RedPostEffect_Gray,RedPostEffect_HueSaturation,RedPostEffect_HalfTone,RedPostEffect_Pixelize,RedPostEffect_Convolution,RedPostEffect_DoF,RedPostEffect_DoF_DepthMaterial,RedPostEffect_Film,RedPostEffect_Vignetting,RedPostEffect_FXAA;!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=function(e){t.ARRAY_TYPE=e},t.toRadian=function(e){return e*i},t.equals=function(e,t){return Math.abs(e-t)<=n*Math.max(1,Math.abs(e),Math.abs(t))};var n=t.EPSILON=1e-6,i=(t.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,t.RANDOM=Math.random,Math.PI/180)},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],h=r[0],l=r[1],R=r[2],m=r[3],p=r[4],E=r[5],_=r[6],g=r[7],P=r[8];return e[0]=h*n+l*o+R*f,e[1]=h*i+l*s+R*c,e[2]=h*a+l*d+R*u,e[3]=m*n+p*o+E*f,e[4]=m*i+p*s+E*c,e[5]=m*a+p*d+E*u,e[6]=_*n+g*o+P*f,e[7]=_*i+g*s+P*c,e[8]=_*a+g*d+P*u,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},t.clone=function(e){var t=new a.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromValues=function(e,t,r,n,i,o,s,d,f){var c=new a.ARRAY_TYPE(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c[4]=i,c[5]=o,c[6]=s,c[7]=d,c[8]=f,c},t.set=function(e,t,r,n,i,a,o,s,d,f){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=d,e[8]=f,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=c*o-s*f,h=-c*a+s*d,l=f*a-o*d,R=r*u+n*h+i*l;return R?(R=1/R,e[0]=u*R,e[1]=(-c*n+i*f)*R,e[2]=(s*n-i*o)*R,e[3]=h*R,e[4]=(c*r-i*d)*R,e[5]=(-s*r+i*a)*R,e[6]=l*R,e[7]=(-f*r+n*d)*R,e[8]=(o*r-n*a)*R,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8];return e[0]=o*c-s*f,e[1]=i*f-n*c,e[2]=n*s-i*o,e[3]=s*d-a*c,e[4]=r*c-i*d,e[5]=i*a-r*s,e[6]=a*f-o*d,e[7]=n*d-r*f,e[8]=r*o-n*a,e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],d=e[7],f=e[8];return t*(f*a-o*d)+r*(-f*i+o*s)+n*(d*i-a*s)},t.multiply=n,t.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],h=r[0],l=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=d,e[6]=h*n+l*o+f,e[7]=h*i+l*s+c,e[8]=h*a+l*d+u,e},t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],h=Math.sin(r),l=Math.cos(r);return e[0]=l*n+h*o,e[1]=l*i+h*s,e[2]=l*a+h*d,e[3]=l*o-h*n,e[4]=l*s-h*i,e[5]=l*d-h*a,e[6]=f,e[7]=c,e[8]=u,e},t.scale=function(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,d=i+i,f=r*o,c=n*o,u=n*s,h=i*o,l=i*s,R=i*d,m=a*o,p=a*s,E=a*d;return e[0]=1-u-R,e[3]=c-E,e[6]=h+p,e[1]=c+E,e[4]=1-f-R,e[7]=l-m,e[2]=h-p,e[5]=l+m,e[8]=1-f-u,e},t.normalFromMat4=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=t[9],h=t[10],l=t[11],R=t[12],m=t[13],p=t[14],E=t[15],_=r*s-n*o,g=r*d-i*o,P=r*f-a*o,M=n*d-i*s,y=n*f-a*s,v=i*f-a*d,b=c*m-u*R,U=c*p-h*R,L=c*E-l*R,T=u*p-h*m,w=u*E-l*m,I=h*E-l*p,x=_*I-g*w+P*T+M*L-y*U+v*b;return x?(x=1/x,e[0]=(s*I-d*w+f*T)*x,e[1]=(d*L-o*I-f*U)*x,e[2]=(o*w-s*L+f*b)*x,e[3]=(i*w-n*I-a*T)*x,e[4]=(r*I-i*L+a*U)*x,e[5]=(n*L-r*w-a*b)*x,e[6]=(m*v-p*y+E*M)*x,e[7]=(p*P-R*v-E*g)*x,e[8]=(R*y-m*P+E*_)*x,e):null},t.projection=function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},t.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],d=e[5],f=e[6],c=e[7],u=e[8],h=t[0],l=t[1],R=t[2],m=t[3],p=t[4],E=t[5],_=t[6],g=t[7],P=t[8];return Math.abs(r-h)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-l)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-R)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(R))&&Math.abs(o-m)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-p)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(d-E)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(f-_)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(_))&&Math.abs(c-g)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(u-P)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(P))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(){var e=new R.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e}function i(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function a(e,t,r){var n=new R.ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=r,n}function o(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function s(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function d(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function f(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function c(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function u(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function h(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function l(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=function(e){var t=new R.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.length=i,t.fromValues=a,t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},t.subtract=o,t.multiply=s,t.divide=d,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},t.distance=f,t.squaredDistance=c,t.squaredLength=u,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=h,t.dot=l,t.cross=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],d=r[2];return e[0]=i*d-a*s,e[1]=a*o-n*d,e[2]=n*s-i*o,e},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e},t.hermite=function(e,t,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,d=o*(a-2)+a,f=o*(a-1),c=o*(3-2*a);return e[0]=t[0]*s+r[0]*d+n[0]*f+i[0]*c,e[1]=t[1]*s+r[1]*d+n[1]*f+i[1]*c,e[2]=t[2]*s+r[2]*d+n[2]*f+i[2]*c,e},t.bezier=function(e,t,r,n,i,a){var o=1-a,s=o*o,d=a*a,f=s*o,c=3*a*s,u=3*d*o,h=d*a;return e[0]=t[0]*f+r[0]*c+n[0]*u+i[0]*h,e[1]=t[1]*f+r[1]*c+n[1]*u+i[1]*h,e[2]=t[2]*f+r[2]*c+n[2]*u+i[2]*h,e},t.random=function(e,t){t=t||1;var r=2*R.RANDOM()*Math.PI,n=2*R.RANDOM()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e},t.transformMat3=function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],d=r[2],f=r[3],c=f*n+s*a-d*i,u=f*i+d*n-o*a,h=f*a+o*i-s*n,l=-o*n-s*i-d*a;return e[0]=c*f+l*-o+u*-d-h*-s,e[1]=u*f+l*-s+h*-o-c*-d,e[2]=h*f+l*-d+c*-s-u*-o,e},t.rotateX=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateY=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateZ=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.angle=function(e,t){var r=a(e[0],e[1],e[2]),n=a(t[0],t[1],t[2]);h(r,r),h(n,n);var i=l(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(r-a)<=R.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=R.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=R.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))};var R=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=o,t.mul=s,t.div=d,t.dist=f,t.sqrDist=c,t.len=i,t.sqrLen=u,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,d=void 0;for(r||(r=3),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,d=n;d<s;d+=r)e[0]=t[d],e[1]=t[d+1],e[2]=t[d+2],a(e,e,o),t[d]=e[0],t[d+1]=e[1],t[d+2]=e[2];return t}}()},function(e,t,r){"use strict";function n(){var e=new l.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function s(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function d(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+a*a)}function f(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a}function c(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function u(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function h(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o),e}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=function(e){var t=new l.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,r,n){var i=new l.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=i,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=s,t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},t.distance=d,t.squaredDistance=f,t.length=c,t.squaredLength=u,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=h,t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e},t.random=function(e,t){return t=t||1,e[0]=l.RANDOM(),e[1]=l.RANDOM(),e[2]=l.RANDOM(),e[3]=l.RANDOM(),h(e,e),s(e,e,t),e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],d=r[2],f=r[3],c=f*n+s*a-d*i,u=f*i+d*n-o*a,h=f*a+o*i-s*n,l=-o*n-s*i-d*a;return e[0]=c*f+l*-o+u*-d-h*-s,e[1]=u*f+l*-s+h*-o-c*-d,e[2]=h*f+l*-d+c*-s-u*-o,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=t[0],s=t[1],d=t[2],f=t[3];return Math.abs(r-o)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-d)<=l.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-f)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))};var l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=i,t.mul=a,t.div=o,t.dist=d,t.sqrDist=f,t.len=c,t.sqrLen=u,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,d=void 0;for(r||(r=4),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,d=n;d<s;d+=r)e[0]=t[d],e[1]=t[d+1],e[2]=t[d+2],e[3]=t[d+3],a(e,e,o),t[d]=e[0],t[d+1]=e[1],t[d+2]=e[2],t[d+3]=e[3];return t}}()},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=t.vec3=t.vec2=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.glMatrix=void 0;var i=n(r(0)),a=n(r(5)),o=n(r(6)),s=n(r(1)),d=n(r(7)),f=n(r(8)),c=n(r(9)),u=n(r(2)),h=n(r(3));t.glMatrix=i,t.mat2=a,t.mat2d=o,t.mat3=s,t.mat4=d,t.quat=f,t.vec2=c,t.vec3=u,t.vec4=h},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],d=r[1],f=r[2],c=r[3];return e[0]=n*s+a*d,e[1]=i*s+o*d,e[2]=n*f+a*c,e[3]=i*f+o*c,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.fromValues=function(e,t,r,n){var i=new a.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},t.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},t.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*a-i*n;return o?(o=1/o,e[0]=a*o,e[1]=-n*o,e[2]=-i*o,e[3]=r*o,e):null},t.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},t.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},t.multiply=n,t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=n*d+a*s,e[1]=i*d+o*s,e[2]=n*-s+a*d,e[3]=i*-s+o*d,e},t.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],d=r[1];return e[0]=n*s,e[1]=i*s,e[2]=a*d,e[3]=o*d,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},t.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},t.LDU=function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=i,t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=t[0],d=t[1],f=t[2],c=t[3];return Math.abs(r-s)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-d)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(i-f)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-c)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=r[0],c=r[1],u=r[2],h=r[3],l=r[4],R=r[5];return e[0]=n*f+a*c,e[1]=i*f+o*c,e[2]=n*u+a*h,e[3]=i*u+o*h,e[4]=n*l+a*R+s,e[5]=i*l+o*R+d,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.clone=function(e){var t=new a.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.fromValues=function(e,t,r,n,i,o){var s=new a.ARRAY_TYPE(6);return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s},t.set=function(e,t,r,n,i,a,o){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=r*a-n*i;return d?(d=1/d,e[0]=a*d,e[1]=-n*d,e[2]=-i*d,e[3]=r*d,e[4]=(i*s-a*o)*d,e[5]=(n*o-r*s)*d,e):null},t.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},t.multiply=n,t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=Math.sin(r),c=Math.cos(r);return e[0]=n*c+a*f,e[1]=i*c+o*f,e[2]=n*-f+a*c,e[3]=i*-f+o*c,e[4]=s,e[5]=d,e},t.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=r[0],c=r[1];return e[0]=n*f,e[1]=i*f,e[2]=a*c,e[3]=o*c,e[4]=s,e[5]=d,e},t.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=r[0],c=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=n*f+a*c+s,e[5]=i*f+o*c+d,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},t.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],d=e[5],f=t[0],c=t[1],u=t[2],h=t[3],l=t[4],R=t[5];return Math.abs(r-f)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-c)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-u)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-h)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-l)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(d-R)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],h=t[9],l=t[10],R=t[11],m=t[12],p=t[13],E=t[14],_=t[15],g=r[0],P=r[1],M=r[2],y=r[3];return e[0]=g*n+P*s+M*u+y*m,e[1]=g*i+P*d+M*h+y*p,e[2]=g*a+P*f+M*l+y*E,e[3]=g*o+P*c+M*R+y*_,g=r[4],P=r[5],M=r[6],y=r[7],e[4]=g*n+P*s+M*u+y*m,e[5]=g*i+P*d+M*h+y*p,e[6]=g*a+P*f+M*l+y*E,e[7]=g*o+P*c+M*R+y*_,g=r[8],P=r[9],M=r[10],y=r[11],e[8]=g*n+P*s+M*u+y*m,e[9]=g*i+P*d+M*h+y*p,e[10]=g*a+P*f+M*l+y*E,e[11]=g*o+P*c+M*R+y*_,g=r[12],P=r[13],M=r[14],y=r[15],e[12]=g*n+P*s+M*u+y*m,e[13]=g*i+P*d+M*h+y*p,e[14]=g*a+P*f+M*l+y*E,e[15]=g*o+P*c+M*R+y*_,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.fromValues=function(e,t,r,n,i,o,s,d,f,c,u,h,l,R,m,p){var E=new a.ARRAY_TYPE(16);return E[0]=e,E[1]=t,E[2]=r,E[3]=n,E[4]=i,E[5]=o,E[6]=s,E[7]=d,E[8]=f,E[9]=c,E[10]=u,E[11]=h,E[12]=l,E[13]=R,E[14]=m,E[15]=p,E},t.set=function(e,t,r,n,i,a,o,s,d,f,c,u,h,l,R,m,p){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=d,e[8]=f,e[9]=c,e[10]=u,e[11]=h,e[12]=l,e[13]=R,e[14]=m,e[15]=p,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=t[9],h=t[10],l=t[11],R=t[12],m=t[13],p=t[14],E=t[15],_=r*s-n*o,g=r*d-i*o,P=r*f-a*o,M=n*d-i*s,y=n*f-a*s,v=i*f-a*d,b=c*m-u*R,U=c*p-h*R,L=c*E-l*R,T=u*p-h*m,w=u*E-l*m,I=h*E-l*p,x=_*I-g*w+P*T+M*L-y*U+v*b;return x?(x=1/x,e[0]=(s*I-d*w+f*T)*x,e[1]=(i*w-n*I-a*T)*x,e[2]=(m*v-p*y+E*M)*x,e[3]=(h*y-u*v-l*M)*x,e[4]=(d*L-o*I-f*U)*x,e[5]=(r*I-i*L+a*U)*x,e[6]=(p*P-R*v-E*g)*x,e[7]=(c*v-h*P+l*g)*x,e[8]=(o*w-s*L+f*b)*x,e[9]=(n*L-r*w-a*b)*x,e[10]=(R*y-m*P+E*_)*x,e[11]=(u*P-c*y-l*_)*x,e[12]=(s*U-o*T-d*b)*x,e[13]=(r*T-n*U+i*b)*x,e[14]=(m*g-R*M-p*_)*x,e[15]=(c*M-u*g+h*_)*x,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=t[9],h=t[10],l=t[11],R=t[12],m=t[13],p=t[14],E=t[15];return e[0]=s*(h*E-l*p)-u*(d*E-f*p)+m*(d*l-f*h),e[1]=-(n*(h*E-l*p)-u*(i*E-a*p)+m*(i*l-a*h)),e[2]=n*(d*E-f*p)-s*(i*E-a*p)+m*(i*f-a*d),e[3]=-(n*(d*l-f*h)-s*(i*l-a*h)+u*(i*f-a*d)),e[4]=-(o*(h*E-l*p)-c*(d*E-f*p)+R*(d*l-f*h)),e[5]=r*(h*E-l*p)-c*(i*E-a*p)+R*(i*l-a*h),e[6]=-(r*(d*E-f*p)-o*(i*E-a*p)+R*(i*f-a*d)),e[7]=r*(d*l-f*h)-o*(i*l-a*h)+c*(i*f-a*d),e[8]=o*(u*E-l*m)-c*(s*E-f*m)+R*(s*l-f*u),e[9]=-(r*(u*E-l*m)-c*(n*E-a*m)+R*(n*l-a*u)),e[10]=r*(s*E-f*m)-o*(n*E-a*m)+R*(n*f-a*s),e[11]=-(r*(s*l-f*u)-o*(n*l-a*u)+c*(n*f-a*s)),e[12]=-(o*(u*p-h*m)-c*(s*p-d*m)+R*(s*h-d*u)),e[13]=r*(u*p-h*m)-c*(n*p-i*m)+R*(n*h-i*u),e[14]=-(r*(s*p-d*m)-o*(n*p-i*m)+R*(n*d-i*s)),e[15]=r*(s*h-d*u)-o*(n*h-i*u)+c*(n*d-i*s),e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],d=e[7],f=e[8],c=e[9],u=e[10],h=e[11],l=e[12],R=e[13],m=e[14],p=e[15];return(t*o-r*a)*(u*p-h*m)-(t*s-n*a)*(c*p-h*R)+(t*d-i*a)*(c*m-u*R)+(r*s-n*o)*(f*p-h*l)-(r*d-i*o)*(f*m-u*l)+(n*d-i*s)*(f*R-c*l)},t.multiply=n,t.translate=function(e,t,r){var n=r[0],i=r[1],a=r[2],o=void 0,s=void 0,d=void 0,f=void 0,c=void 0,u=void 0,h=void 0,l=void 0,R=void 0,m=void 0,p=void 0,E=void 0;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],d=t[2],f=t[3],c=t[4],u=t[5],h=t[6],l=t[7],R=t[8],m=t[9],p=t[10],E=t[11],e[0]=o,e[1]=s,e[2]=d,e[3]=f,e[4]=c,e[5]=u,e[6]=h,e[7]=l,e[8]=R,e[9]=m,e[10]=p,e[11]=E,e[12]=o*n+c*i+R*a+t[12],e[13]=s*n+u*i+m*a+t[13],e[14]=d*n+h*i+p*a+t[14],e[15]=f*n+l*i+E*a+t[15]),e},t.scale=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,r,n){var i=n[0],o=n[1],s=n[2],d=Math.sqrt(i*i+o*o+s*s),f=void 0,c=void 0,u=void 0,h=void 0,l=void 0,R=void 0,m=void 0,p=void 0,E=void 0,_=void 0,g=void 0,P=void 0,M=void 0,y=void 0,v=void 0,b=void 0,U=void 0,L=void 0,T=void 0,w=void 0,I=void 0,x=void 0,A=void 0,D=void 0;return Math.abs(d)<a.EPSILON?null:(i*=d=1/d,o*=d,s*=d,f=Math.sin(r),u=1-(c=Math.cos(r)),h=t[0],l=t[1],R=t[2],m=t[3],p=t[4],E=t[5],_=t[6],g=t[7],P=t[8],M=t[9],y=t[10],v=t[11],b=i*i*u+c,U=o*i*u+s*f,L=s*i*u-o*f,T=i*o*u-s*f,w=o*o*u+c,I=s*o*u+i*f,x=i*s*u+o*f,A=o*s*u-i*f,D=s*s*u+c,e[0]=h*b+p*U+P*L,e[1]=l*b+E*U+M*L,e[2]=R*b+_*U+y*L,e[3]=m*b+g*U+v*L,e[4]=h*T+p*w+P*I,e[5]=l*T+E*w+M*I,e[6]=R*T+_*w+y*I,e[7]=m*T+g*w+v*I,e[8]=h*x+p*A+P*D,e[9]=l*x+E*A+M*D,e[10]=R*x+_*A+y*D,e[11]=m*x+g*A+v*D,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],d=t[7],f=t[8],c=t[9],u=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+f*n,e[5]=o*i+c*n,e[6]=s*i+u*n,e[7]=d*i+h*n,e[8]=f*i-a*n,e[9]=c*i-o*n,e[10]=u*i-s*n,e[11]=h*i-d*n,e},t.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],d=t[3],f=t[8],c=t[9],u=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-f*n,e[1]=o*i-c*n,e[2]=s*i-u*n,e[3]=d*i-h*n,e[8]=a*n+f*i,e[9]=o*n+c*i,e[10]=s*n+u*i,e[11]=d*n+h*i,e},t.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],d=t[3],f=t[4],c=t[5],u=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+f*n,e[1]=o*i+c*n,e[2]=s*i+u*n,e[3]=d*i+h*n,e[4]=f*i-a*n,e[5]=c*i-o*n,e[6]=u*i-s*n,e[7]=h*i-d*n,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,r){var n=r[0],i=r[1],o=r[2],s=Math.sqrt(n*n+i*i+o*o),d=void 0,f=void 0,c=void 0;return Math.abs(s)<a.EPSILON?null:(n*=s=1/s,i*=s,o*=s,d=Math.sin(t),c=1-(f=Math.cos(t)),e[0]=n*n*c+f,e[1]=i*n*c+o*d,e[2]=o*n*c-i*d,e[3]=0,e[4]=n*i*c-o*d,e[5]=i*i*c+f,e[6]=o*i*c+n*d,e[7]=0,e[8]=n*o*c+i*d,e[9]=i*o*c-n*d,e[10]=o*o*c+f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,d=i+i,f=a+a,c=n*s,u=n*d,h=n*f,l=i*d,R=i*f,m=a*f,p=o*s,E=o*d,_=o*f;return e[0]=1-(l+m),e[1]=u+_,e[2]=h-E,e[3]=0,e[4]=u-_,e[5]=1-(c+m),e[6]=R+p,e[7]=0,e[8]=h+E,e[9]=R-p,e[10]=1-(c+l),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],d=t[8],f=t[9],c=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(d*d+f*f+c*c),e},t.getRotation=function(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},t.fromRotationTranslationScale=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],d=i+i,f=a+a,c=o+o,u=i*d,h=i*f,l=i*c,R=a*f,m=a*c,p=o*c,E=s*d,_=s*f,g=s*c,P=n[0],M=n[1],y=n[2];return e[0]=(1-(R+p))*P,e[1]=(h+g)*P,e[2]=(l-_)*P,e[3]=0,e[4]=(h-g)*M,e[5]=(1-(u+p))*M,e[6]=(m+E)*M,e[7]=0,e[8]=(l+_)*y,e[9]=(m-E)*y,e[10]=(1-(u+R))*y,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,r,n,i){var a=t[0],o=t[1],s=t[2],d=t[3],f=a+a,c=o+o,u=s+s,h=a*f,l=a*c,R=a*u,m=o*c,p=o*u,E=s*u,_=d*f,g=d*c,P=d*u,M=n[0],y=n[1],v=n[2],b=i[0],U=i[1],L=i[2];return e[0]=(1-(m+E))*M,e[1]=(l+P)*M,e[2]=(R-g)*M,e[3]=0,e[4]=(l-P)*y,e[5]=(1-(h+E))*y,e[6]=(p+_)*y,e[7]=0,e[8]=(R+g)*v,e[9]=(p-_)*v,e[10]=(1-(h+m))*v,e[11]=0,e[12]=r[0]+b-(e[0]*b+e[4]*U+e[8]*L),e[13]=r[1]+U-(e[1]*b+e[5]*U+e[9]*L),e[14]=r[2]+L-(e[2]*b+e[6]*U+e[10]*L),e[15]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,d=i+i,f=r*o,c=n*o,u=n*s,h=i*o,l=i*s,R=i*d,m=a*o,p=a*s,E=a*d;return e[0]=1-u-R,e[1]=c+E,e[2]=h-p,e[3]=0,e[4]=c-E,e[5]=1-f-R,e[6]=l+m,e[7]=0,e[8]=h+p,e[9]=l-m,e[10]=1-f-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,r,n,i,a,o){var s=1/(r-t),d=1/(i-n),f=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*d,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*d,e[10]=(o+a)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*f,e[15]=0,e},t.perspective=function(e,t,r,n,i){var a=1/Math.tan(t/2),o=1/(n-i);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*o,e[15]=0,e},t.perspectiveFromFieldOfView=function(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),d=2/(o+s),f=2/(i+a);return e[0]=d,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=-(o-s)*d*.5,e[9]=(i-a)*f*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},t.ortho=function(e,t,r,n,i,a,o){var s=1/(t-r),d=1/(n-i),f=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*d,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*d,e[14]=(o+a)*f,e[15]=1,e},t.lookAt=function(e,t,r,n){var i=void 0,o=void 0,s=void 0,d=void 0,f=void 0,c=void 0,u=void 0,h=void 0,l=void 0,R=void 0,m=t[0],p=t[1],E=t[2],_=n[0],g=n[1],P=n[2],M=r[0],y=r[1],v=r[2];return Math.abs(m-M)<a.EPSILON&&Math.abs(p-y)<a.EPSILON&&Math.abs(E-v)<a.EPSILON?mat4.identity(e):(u=m-M,h=p-y,l=E-v,i=g*(l*=R=1/Math.sqrt(u*u+h*h+l*l))-P*(h*=R),o=P*(u*=R)-_*l,s=_*h-g*u,(R=Math.sqrt(i*i+o*o+s*s))?(i*=R=1/R,o*=R,s*=R):(i=0,o=0,s=0),d=h*s-l*o,f=l*i-u*s,c=u*o-h*i,(R=Math.sqrt(d*d+f*f+c*c))?(d*=R=1/R,f*=R,c*=R):(d=0,f=0,c=0),e[0]=i,e[1]=d,e[2]=u,e[3]=0,e[4]=o,e[5]=f,e[6]=h,e[7]=0,e[8]=s,e[9]=c,e[10]=l,e[11]=0,e[12]=-(i*m+o*p+s*E),e[13]=-(d*m+f*p+c*E),e[14]=-(u*m+h*p+l*E),e[15]=1,e)},t.targetTo=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=n[0],d=n[1],f=n[2],c=i-r[0],u=a-r[1],h=o-r[2],l=c*c+u*u+h*h;l>0&&(c*=l=1/Math.sqrt(l),u*=l,h*=l);var R=d*h-f*u,m=f*c-s*h,p=s*u-d*c;return e[0]=R,e[1]=m,e[2]=p,e[3]=0,e[4]=u*p-h*m,e[5]=h*R-c*p,e[6]=c*m-u*R,e[7]=0,e[8]=c,e[9]=u,e[10]=h,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],d=e[5],f=e[6],c=e[7],u=e[8],h=e[9],l=e[10],R=e[11],m=e[12],p=e[13],E=e[14],_=e[15],g=t[0],P=t[1],M=t[2],y=t[3],v=t[4],b=t[5],U=t[6],L=t[7],T=t[8],w=t[9],I=t[10],x=t[11],A=t[12],D=t[13],B=t[14],G=t[15];return Math.abs(r-g)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-P)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(P))&&Math.abs(i-M)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(o-y)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(s-v)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(d-b)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(b))&&Math.abs(f-U)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(U))&&Math.abs(c-L)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(L))&&Math.abs(u-T)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(h-w)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(l-I)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(R-x)<=a.EPSILON*Math.max(1,Math.abs(R),Math.abs(x))&&Math.abs(m-A)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(p-D)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(E-B)<=a.EPSILON*Math.max(1,Math.abs(E),Math.abs(B))&&Math.abs(_-G)<=a.EPSILON*Math.max(1,Math.abs(_),Math.abs(G))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(){var e=new f.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function a(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function o(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],d=r[1],f=r[2],c=r[3];return e[0]=n*c+o*s+i*f-a*d,e[1]=i*c+o*d+a*s-n*f,e[2]=a*c+o*f+n*d-i*s,e[3]=o*c-n*s-i*d-a*f,e}function s(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],d=r[0],f=r[1],c=r[2],u=r[3],h=void 0,l=void 0,R=void 0,m=void 0,p=void 0;return(l=i*d+a*f+o*c+s*u)<0&&(l=-l,d=-d,f=-f,c=-c,u=-u),1-l>1e-6?(h=Math.acos(l),R=Math.sin(h),m=Math.sin((1-n)*h)/R,p=Math.sin(n*h)/R):(m=1-n,p=n),e[0]=m*i+p*d,e[1]=m*a+p*f,e[2]=m*o+p*c,e[3]=m*s+p*u,e}function d(e,t){var r=t[0]+t[4]+t[8],n=void 0;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=i,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},t.setAxisAngle=a,t.getAxisAngle=function(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return 0!=n?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r},t.multiply=o,t.rotateX=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=n*d+o*s,e[1]=i*d+a*s,e[2]=a*d-i*s,e[3]=o*d-n*s,e},t.rotateY=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=n*d-a*s,e[1]=i*d+o*s,e[2]=a*d+n*s,e[3]=o*d-i*s,e},t.rotateZ=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=n*d+i*s,e[1]=i*d-n*s,e[2]=a*d+o*s,e[3]=o*d-a*s,e},t.calculateW=function(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e},t.slerp=s,t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=a*s,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},t.fromMat3=d,t.fromEuler=function(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(r),d=Math.cos(r),f=Math.sin(n),c=Math.cos(n);return e[0]=a*d*c-o*s*f,e[1]=o*s*c+a*d*f,e[2]=o*d*f-a*s*c,e[3]=o*d*c+a*s*f,e},t.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"};var f=n(r(0)),c=n(r(1)),u=n(r(2)),h=n(r(3)),l=(t.clone=h.clone,t.fromValues=h.fromValues,t.copy=h.copy,t.set=h.set,t.add=h.add,t.mul=o,t.scale=h.scale,t.dot=h.dot,t.lerp=h.lerp,t.length=h.length),R=(t.len=l,t.squaredLength=h.squaredLength),m=(t.sqrLen=R,t.normalize=h.normalize);t.exactEquals=h.exactEquals,t.equals=h.equals,t.rotationTo=function(){var e=u.create(),t=u.fromValues(1,0,0),r=u.fromValues(0,1,0);return function(n,i,o){var s=u.dot(i,o);return s<-.999999?(u.cross(e,t,i),u.len(e)<1e-6&&u.cross(e,r,i),u.normalize(e,e),a(n,e,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(u.cross(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+s,m(n,n))}}(),t.sqlerp=function(){var e=i(),t=i();return function(r,n,i,a,o,d){return s(e,n,o,d),s(t,i,a,d),s(r,e,t,2*d*(1-d)),r}}(),t.setAxes=function(){var e=c.create();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],m(t,d(t,e))}}()},function(e,t,r){"use strict";function n(){var e=new u.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function s(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function d(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function f(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function c(e){var t=e[0],r=e[1];return t*t+r*r}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.sqrDist=t.dist=t.div=t.mul=t.sub=t.len=void 0,t.create=n,t.clone=function(e){var t=new u.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},t.fromValues=function(e,t){var r=new u.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},t.set=function(e,t,r){return e[0]=t,e[1]=r,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},t.subtract=i,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e},t.distance=s,t.squaredDistance=d,t.length=f,t.squaredLength=c,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},t.normalize=function(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},t.cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e},t.lerp=function(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e},t.random=function(e,t){t=t||1;var r=2*u.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},t.transformMat2=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e},t.transformMat2d=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e},t.transformMat3=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},t.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},t.equals=function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return Math.abs(r-i)<=u.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=u.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))};var u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.len=f,t.sub=i,t.mul=a,t.div=o,t.dist=s,t.sqrDist=d,t.sqrLen=c,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,d=void 0;for(r||(r=2),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,d=n;d<s;d+=r)e[0]=t[d],e[1]=t[d+1],a(e,e,o),t[d]=e[0],t[d+1]=e[1];return t}}()}])}),function(){var e,t;RedGLUtil={throwFunc:function(){throw Array.prototype.slice.call(arguments).join(" ")},copyProto:function(e,t){for(var r in t.prototype)e.prototype[r]=t.prototype[r]},hexToRGB:function(e){var t,r;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return r=[],3==(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),t="0x"+t.join(""),r[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,r;RedGLUtil.throwFunc("RedGLUtil.hexToRGB : 잘못된 hex값입니다.",e)},rgb2hex:function(e,t,r){return"#"+(16777216+(r|t<<8|e<<16)).toString(16).slice(1)},regHex:(t=/^#(?:[0-9a-fA-F]{3}){1,2}$/,function(e){return t.test(e)}),getStrFromComment:function(t){if("string"!=typeof t&&RedGLUtil.throwFunc("getStrFromComment : 해석할 값은 문자열만 가능",t),e=t.replace("@preserve","").toString().trim().match(/(\/\*)[\s\S]+(\*\/)/g))return e[0].replace(/\/\*|\*\//g,"").trim();RedGLUtil.throwFunc("getStrFromComment : 해석할 불가능한 값",t)}},Object.freeze(RedGLUtil)}(),function(){var e,t,r,n,i,a,o,s,d,f,c,u;t=function(e){if(!(this instanceof t))return new t(e);for(r="VENDOR,VERSION,SHADING_LANGUAGE_VERSION,RENDERER,MAX_VERTEX_ATTRIBS,MAX_VARYING_VECTORS,MAX_VERTEX_UNIFORM_VECTORS,MAX_VERTEX_TEXTURE_IMAGE_UNITS,MAX_FRAGMENT_UNIFORM_VECTORS,MAX_TEXTURE_SIZE,MAX_CUBE_MAP_TEXTURE_SIZE,MAX_COMBINED_TEXTURE_IMAGE_UNITS,MAX_TEXTURE_IMAGE_UNITS,MAX_RENDERBUFFER_SIZE,MAX_VIEWPORT_DIMS,RED_BITS,GREEN_BITS,BLUE_BITS,ALPHA_BITS,DEPTH_BITS,STENCIL_BITS".split(","),n=r.length;n--;)this[i=r[n]]=e.getParameter(e[i])},e=function(){var e,t,r,n,i,a,o;return t={alpha:!1,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!1,powerPreference:"default",failIfMajorPerformanceCaveat:!1},o=["OES_element_index_uint","OES_standard_derivatives","EXT_texture_filter_anisotropic"],e="webkit-3d,moz-webgl,3d,experimental-webgl,webgl".split(","),function(s,d){if(a=JSON.parse(JSON.stringify(t)),d)for(i in d)a[i]=d[i];for(i=e.length;i--;)if(r=s.getContext(n=e[i],a))return r.glExtension={},o.forEach(function(e){r.glExtension[e]=r.getExtension(e)}),r.version=n,r;return null}}(),(RedGL=function(r,n,i){var a,o,s,d;if(!(this instanceof RedGL))return new RedGL(r,n,i);r instanceof Element&&"CANVAS"==r.tagName||RedGLUtil.throwFunc("RedGL : Canvas Element만 허용"),o=this,s=!0,d=1,Object.defineProperty(this,"renderScale",{get:function(){return d},set:function(e){(d=e)<=0&&(d=.1),this.setSize(this._width,this._height,!0)}}),Object.defineProperty(this,"fullMode",{get:function(){return s},set:function(e){"boolean"!=typeof e&&RedGLUtil.throwFunc("RedGL : Boolean만 가능."),s=e,this.setSize(this._width,this._height)}}),this._canvas=r,this._width=500,this._height=500,this.gl=a=e(r,i),a&&(this._detect=t(a,i)),this._datas={},this._UUID=RedGL.makeUUID(),requestAnimationFrame(function(e){var t,r;window.addEventListener("resize",function(){o.setSize(o._width,o._height)}),o.setSize(o._width,o._height);var i=o._detect.MAX_COMBINED_TEXTURE_IMAGE_UNITS,s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC";for(t=RedBitmapTexture(o,s),r=RedBitmapCubeTexture(o,[s,s,s,s,s,s]),o._datas.emptyTexture={"2d":t,"3d":r};i--;)1==i?(a.activeTexture(a.TEXTURE0+1),a.bindTexture(a.TEXTURE_CUBE_MAP,r.webglTexture)):(a.activeTexture(a.TEXTURE0+i),a.bindTexture(a.TEXTURE_2D,t.webglTexture));n&&n.call(o,!!a)})}).makeUUID=(a=0,function(){return a++}),RedGL.prototype={setSize:(d=0,f=0,function(e,t,r){this.fullMode?(o=document.documentElement?document.documentElement.clientWidth:document.body.clientWidth,s=window.innerHeight):(void 0==e&&RedGLUtil.throwFunc("RedGL setSize : width가 입력되지 않았습니다."),void 0==t&&RedGLUtil.throwFunc("RedGL setSize : height가 입력되지 않았습니다."),"string"==typeof e&&-1!=e.indexOf("%")&&RedGLUtil.throwFunc("RedGL setSize : width는 %로 입력할수 없음."),"string"==typeof t&&-1!=t.indexOf("%")&&RedGLUtil.throwFunc("RedGL setSize: height는 %로 입력할수 없음."),this._width=o=e,this._height=s=t),c=window.devicePixelRatio||1,u=this._canvas,(d!=o||f!=s||r)&&(u.width=o*c*this.renderScale,u.height=s*c*this.renderScale,u.style.width=o,u.style.height=s,d=o,f=s)})},Object.freeze(RedGL)}(),(RedXR=function(e,t,r){(n=>{"use strict";new WebXRPolyfill,document.createElement("canvas");const i=new XRDeviceButton({onRequestSession:t=>t.requestSession({exclusive:!0}).then(t=>{i.setSession(t),t.addEventListener("end",t=>{i.setSession(null),e.style.display="none"}),a(t)}),onEndSession:e=>e.end()});[e,i.domElement].forEach(e=>document.body.appendChild(e)),navigator.xr&&navigator.xr.requestDevice().then(e=>e.supportsSession({exclusive:!0}).then(t=>i.setDevice(e)));const a=n=>{const i=RedGL(e,a=>{if(!a)return;e.style.display="block";const o=RedCamera(),s=RedCamera(),d=RedRenderer(i),f=RedWorld(),c=RedScene(i);i.world=f,d.world=i.world,o.autoUpdateMatrix=s.autoUpdateMatrix=!1;const u=+RedGL.makeUUID(),h="left"+u,l="right"+u;f.addView(RedView(h,c,o)),RedView(h).setSize("50%","100%"),RedView(h).setLocation("0%","0%"),f.addView(RedView("right"+u,c,s)),RedView(l).setSize("50%","100%"),RedView(l).setLocation("50%","0%");const R={world:f,scene:c};Object.freeze(R),t&&t.call(i,R),n.baseLayer=new XRWebGLLayer(n,i.gl),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,n.baseLayer.framebuffer),n.requestFrameOfReference("eyeLevel").then(e=>{const t=(n,a)=>{const f=a.session,c=a.getDevicePose(e);if(c){i.gl.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT);for(const e of a.views){const t=f.baseLayer.getViewport(e),r=0==t.x?o:s,n=0==t.x?h:l;RedView(n).setSize(t.width,t.height),RedView(n).setLocation(t.x,t.y),r.perspectiveMTX=e.projectionMatrix,r.matrix=c.getViewMatrix(e)}r(n),d.render(i,n)}f.requestAnimationFrame(t)};i.setSize(null,null,!0),n.requestAnimationFrame(t)})},{compatibleXRDevice:n.device})}})()}).makeUUID=function(){let e=0;return function(){return e++}}(),RedXR.prototype={},Object.freeze(RedGL),function(){var e;e=function(e,t,r,n,i){var a,o;switch(e.hasOwnProperty(r)&&RedGLUtil.throwFunc(t+" - "+r+" : 이미 정의된 속성"),n){case"boolean":i=i||!0,a={get:function(){return this["_"+r]},set:function(e){"boolean"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : boolean만 허용함."),this["_"+r]=e}};break;case"number":if(i){var s=i.min,d=i.max;i.hasOwnProperty("min")&&i.hasOwnProperty("max")?a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함."),e<s&&(e=s),e>d&&(e=d),this["_"+r]=e}}:i.hasOwnProperty("min")?a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함."),e<s&&(e=s),this["_"+r]=e}}:i.hasOwnProperty("max")&&(a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함."),e>d&&(e=d),this["_"+r]=e}})}else a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함."),this["_"+r]=e}};break;case"sampler2D":o="RedBitmapTexture";break;case"samplerCube":o="RedBitmapCubeTexture";break;case"samplerVideo":case"samplerVideo":o="RedVideoTexture";break;default:RedGLUtil.throwFunc(r+" - type : "+ +r+" : 정의할수없는 타입입니다.")}if(o){var f=window[o];a=i&&i.essential?{get:function(){return this["_"+r]},set:function(e){e instanceof f||RedGLUtil.throwFunc(t+" - "+r+" : "+o+" Instance만 허용.","입력값 : "+e),this["_"+r]=e}}:{get:function(){return this["_"+r]},set:function(e){!e||e instanceof f||RedGLUtil.throwFunc(t+" - "+r+" : "+o+" Instance만 허용.","입력값 : "+e),this["_"+r]=e}}}e["_"+r]=null,Object.defineProperty(e,r,a)},(RedDefinePropertyInfo={geometry:{get:function(){return this._geometry},set:function(e){this instanceof RedSkyBox?e instanceof RedBox||RedGLUtil.throwFunc("RedSkyBox : geometry - RedBox Instance만 허용됩니다.","입력값 : "+e):!e||e instanceof RedGeometry||RedGLUtil.throwFunc("geometry : RedGeometry Instance만 허용됩니다.","입력값 : "+e),this._geometry=e}},material:{get:function(){return this._material},set:function(e){this instanceof RedSprite3D?e instanceof RedColorMaterial||e instanceof RedBitmapMaterial||e instanceof RedSheetMaterial||RedGLUtil.throwFunc("RedSprite3D : RedColorMaterial or RedBitmapMaterial or RedSheetMaterial Instance만 허용됩니다.","입력값 : "+e):this instanceof RedSkyBox?e instanceof RedSkyBoxMaterial||RedGLUtil.throwFunc("RedSkyBox : RedSkyBoxMaterial Instance만 허용됩니다.","입력값 : "+e):this instanceof RedPointUnit?e instanceof RedPointColorMaterial||e instanceof RedPointBitmapMaterial||RedGLUtil.throwFunc("RedPointUnit : material - RedPointColorMaterial Instance or RedPointBitmapMaterial Instance만 허용됩니다."):this instanceof RedParticleEmitter?e instanceof RedParticleColorMaterial||e instanceof RedParticleBitmapMaterial||RedGLUtil.throwFunc("RedParticleEmitter : material - RedParticleColorMaterial Instance or RedParticleBitmapMaterial Instance만 허용됩니다."):!e||e instanceof RedBaseMaterial||RedGLUtil.throwFunc("material : RedBaseMaterial Instance만 허용됩니다.","입력값 : "+e),this._material=e}}}).definePrototype=function(t,r,n,i){e(window[t].prototype,t,r,n,i)},Object.defineProperty(RedDefinePropertyInfo,"color",{get:function(){var e,t="#ff2211";return{get:function(){return t},set:function(r){t=r||"#ff2211",e=RedGLUtil.hexToRGB.call(this,t),this._color[0]=e[0],this._color[1]=e[1],this._color[2]=e[2],this._color[3]=this.alpha}}}}),Object.defineProperty(RedDefinePropertyInfo,"alpha",{get:function(){var e=1;return{get:function(){return e},set:function(t){"number"!=typeof t&&RedGLUtil.throwFunc("alpha : 0~1 숫자만 허용함."),t<0&&(t=0),t>1&&(t=1),this._color[3]=e=t}}}}),Object.freeze(RedDefinePropertyInfo)}(),(RedFrameBuffer=function(e,t,r){if(!(this instanceof RedFrameBuffer))return new RedFrameBuffer(e,t,r);var n;e instanceof RedGL||RedGLUtil.throwFunc("RedFrameBuffer : RedGL Instance만 허용됩니다.",e),n=e.gl,t=t||1920,r=r||1080,t>2048&&(t=2048),r>2048&&(r=2048),this.redGL=e,this.width=t,this.height=r,this.webglFrameBuffer=n.createFramebuffer(),this.webglRenderBuffer=n.createRenderbuffer(),this.texture=RedBitmapTexture(e),this._UUID=RedGL.makeUUID(),n.bindFramebuffer(n.FRAMEBUFFER,this.webglFrameBuffer),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.texture.webglTexture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.bindRenderbuffer(n.RENDERBUFFER,this.webglRenderBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,this.width,this.height),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.texture.webglTexture,0),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.webglRenderBuffer),n.bindTexture(n.TEXTURE_2D,null),n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,null)}).prototype={bind:function(e){e.bindFramebuffer(e.FRAMEBUFFER,this.webglFrameBuffer),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture.webglTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindRenderbuffer(e.RENDERBUFFER,this.webglRenderBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this.width,this.height),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.webglTexture,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.webglRenderBuffer)},unbind:function(e){e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}},Object.freeze(RedFrameBuffer),function(){var e,t,r;e=function(e,t,r){switch(t){case RedBuffer.ARRAY_BUFFER:if(r instanceof Float32Array||r instanceof Float64Array){if(r instanceof Float32Array)return e.FLOAT;if(r instanceof Float64Array)return e.FLOAT}else RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ARRAY_BUFFER)형식을 사용해야합니다.","입력값 : "+r);break;case RedBuffer.ELEMENT_ARRAY_BUFFER:if(r instanceof Uint8Array||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array){if(r instanceof Int8Array)return e.BYTE;if(r instanceof Int16Array)return e.SHORT;if(r instanceof Int32Array)return e.INT;if(r instanceof Uint8Array)return e.UNSIGNED_BYTE;if(r instanceof Uint16Array)return e.UNSIGNED_SHORT;if(r instanceof Uint32Array)return e.UNSIGNED_INT}else RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ELEMENT_ARRAY_BUFFER)형식을 사용해야합니다.","입력값 : "+r);break;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ","입력값 : "+r)}},t=function(e,t){switch(t){case RedBuffer.ARRAY_BUFFER:return e.ARRAY_BUFFER;case RedBuffer.ELEMENT_ARRAY_BUFFER:return e.ELEMENT_ARRAY_BUFFER;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ")}},r=function(e,t,r,n){var i;switch(i=0,t){case RedBuffer.ARRAY_BUFFER:e.interleaveDefineInfoList=n,n?(0==n.length&&RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList의 정보는 1개이상의 RedInterleaveInfo Instance로 구성되어야함.",n),n.forEach(function(e){e instanceof RedInterleaveInfo||RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList의 정보는 RedInterleaveInfo Instance로만 구성되어야함.",n),e.offset=n.length<2?0:i,i+=e.size,e._UUID=RedGL.makeUUID(),n[e.attributeKey]=e}),n.length<2?(e.stride=0,e.pointNum=r.length/3):(e.stride=i,e.pointNum=r.length/i),e.pointNum!=parseInt(e.pointNum)&&RedGLUtil.throwFunc("RedBuffer : ARRAY_BUFFER의 pointNum이 정수로 떨어지지 않음. 데이터구성과 interleaveDefineInfoList 구성 확인 필요")):RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList는 반드시 정의 되어야합니다.");break;case RedBuffer.ELEMENT_ARRAY_BUFFER:e.pointNum=r.length}},(RedBuffer=function(n,i,a,o,s,d){if(!(this instanceof RedBuffer))return new RedBuffer(n,i,a,o,s,d);n instanceof RedGL||RedGLUtil.throwFunc("RedBuffer : RedGL Instance만 허용됩니다.",n),"string"!=typeof i&&RedGLUtil.throwFunc("RedBuffer : key - 문자열만 허용됩니다.","입력값 : "+i),a||RedGLUtil.throwFunc("RedBuffer : bufferType : 미입력"),a&&a!=RedBuffer.ARRAY_BUFFER&&a!=RedBuffer.ELEMENT_ARRAY_BUFFER&&RedGLUtil.throwFunc("RedBuffer : bufferType - RedBuffer.ARRAY_BUFFER or RedBuffer.ELEMENT_ARRAY_BUFFER 만 허용함.","입력값 : "+a);var f=n.gl;if(n._datas.RedBuffer||(n._datas.RedBuffer={},n._datas.RedBuffer[RedBuffer.ARRAY_BUFFER]={},n._datas.RedBuffer[RedBuffer.ELEMENT_ARRAY_BUFFER]={}),n._datas.RedBuffer[a][i])return n._datas.RedBuffer[a][i];n._datas.RedBuffer[a][i]=this,a&&a==RedBuffer.ARRAY_BUFFER&&!s&&RedGLUtil.throwFunc("RedBuffer : 신규생성시 interleaveDefineInfoList를 반드시 정의해야합니다.","입력값 : "+s),this.key=i,this.data=o,this.bufferType=a,this.glArrayType=e(f,this.bufferType,this.data),this.glBufferType=t(f,this.bufferType),this.drawMode=d||f.STATIC_DRAW,r(this,this.bufferType,this.data,s),this.webglBuffer=f.createBuffer(),this._binded=!1,this._UUID=RedGL.makeUUID(),this.upload=function(t){this.glArrayType==e(f,a,t)?(this.data=t,f.bindBuffer(this.glBufferType,this.webglBuffer),f.bufferData(this.glBufferType,this.data,this.drawMode),r(this,this.bufferType,this.data,this.interleaveDefineInfoList)):RedGLUtil.throwFunc("RedBuffer : upload - data형식이 기존 형식과 다름",t)},this.upload(this.data)}).ARRAY_BUFFER="arrayBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER="elementArrayBuffer",Object.freeze(RedBuffer)}(),RedGeometry=function(e,t){if(!(this instanceof RedGeometry))return new RedGeometry(e,t);e instanceof RedBuffer||RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer Instance만 허용.",e),e.bufferType!=RedBuffer.ARRAY_BUFFER&&RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer.ARRAY_BUFFER 타입만 허용.",e),t&&(e||RedGLUtil.throwFunc("RedGeometry : indexBuffer는 반드시 interleaveBuffer와 쌍으로 입력되어야함.",t),t instanceof RedBuffer||RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer Instance만 허용.",t),t.bufferType!=RedBuffer.ELEMENT_ARRAY_BUFFER&&RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer.ELEMENT_ARRAY_BUFFER 타입만 허용.",t)),this.interleaveBuffer=e,this.indexBuffer=t,this._UUID=RedGL.makeUUID()},Object.freeze(RedGeometry),RedInterleaveInfo=function(e,t,r){if(!(this instanceof RedInterleaveInfo))return new RedInterleaveInfo(e,t,r);"string"!=typeof e&&RedGLUtil.throwFunc("RedInterleaveInfo : attributeKey - 문자열만 허용",e),"a"!=e.charAt(0)&&RedGLUtil.throwFunc("RedShader : attribute의 첫글자는 a로 시작해야합니다.",e),e.charAt(1)!=e.charAt(1).toUpperCase()&&RedInterleaveInfo.throwFunc("RedShader : attribute의 두번째 글자는 대문자 시작해야합니다.",e),"number"!=typeof t&&RedGLUtil.throwFunc("RedInterleaveInfo : size - 숫자만 허용",t),this.attributeKey=e,this.size=t,this.normalize=void 0!=r,this.offset=null},Object.freeze(RedInterleaveInfo),(RedBaseMaterial=function(){}).prototype={checkUniformAndProperty:function(){var e,t,r;for(e=(t=this.program.uniformLocation).length;e--;)!(r=t[e]).location||r.materialPropertyName in this||RedGLUtil.throwFunc(this.program.key+"- ",r.materialPropertyName,"속성이 정의 되지않았습니다.")}},Object.freeze(RedBaseMaterial),function(){var e,t;function r(e,t,r,n){this.x=e,this.y=t,this.w=r,this.h=n}(RedAtlas=function(r,n,i){if(!(this instanceof RedAtlas))return new RedAtlas(r,n,i);r instanceof RedGL||RedGLUtil.throwFunc("RedBitmapMaterial : RedGL Instance만 허용됩니다.",r),r._datas.RedAtlas||(r._datas.RedAtlas={atlasInfoList:[new e],atlasMap:{}}),(t=r._detect.MAX_TEXTURE_SIZE)>2048&&(t=2048),this.redGL=r,this.loadList(n,i)}).prototype={getAtlasMap:function(){return this.redGL._datas.RedAtlas.atlasMap},getAtlasInfoList:function(){return this.redGL._datas.RedAtlas.atlasInfoList},loadList:function(e,t){var r,n,i,a;for(a=0,i=this,r=0,n=e.length,r=0;r<n;r++){var o=new Image;o.id=o.src=e[r],o.onload=function(){(i.atlasPack(i.redGL,this),++a==e.length)&&(i.redGL._datas.RedAtlas.atlasInfoList.forEach(function(e){e.texture=RedBitmapTexture(i.redGL,e.canvas)}),t&&t.call(i,i.redGL._datas.RedAtlas))}}},atlasPack:function(t,r){var n,i;if(n=t._datas.RedAtlas.atlasInfoList,!(i=t._datas.RedAtlas.atlasMap)[r.id]){var a,o,s,d;if(!1===(d=(s=n[0]).pack(r))){for(a=0,o=n.length;a<o&&!(d=(s=n[a]).pack(r));a++);!1===d&&(n.push(s=new e),d=s.pack(r))}i[r.id]={atlas:s,rect:s.uv()[r.id]},s.texture||(s.texture=RedBitmapTexture(t,s.canvas))}}},r.prototype.fitsIn=function(e){return e.w>=this.w&&e.h>=this.h},r.prototype.sameSizeAs=function(e){return this.w===e.w&&this.h===e.h},(e=function(e,n,i,a){if(void 0==e){var o=document.createElement("canvas");document.body.appendChild(o),o.style.display="none",o.width=t,o.height=t,this.canvas=o,e=n=0,i=this.canvas.width,a=this.canvas.height}2===arguments.length&&(i=e,a=n,e=n=0),this._UUID=RedGL.makeUUID(),this.left=this.right=null,this.rect=new r(e,n,i,a),this.filled=!1,this.tilepad=!1,this._cache=[],this._uvcache=Object.create(null)}).prototype.pack=function(t){return this._cache=[],this._uvcache=Object.create(null),t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),null!==this.left?this._ontoCanvas(this.left.pack(t)||this.right.pack(t)):!(this.filled||!t.fitsIn(this.rect))&&(t.sameSizeAs(this.rect)?(this.filled=!0,this._ontoCanvas(this)):(this.rect.w-t.w>this.rect.h-t.h?(this.left=new e(this.rect.x,this.rect.y,t.w,this.rect.h),this.right=new e(this.rect.x+t.w,this.rect.y,this.rect.w-t.w,this.rect.h)):(this.left=new e(this.rect.x,this.rect.y,this.rect.w,t.h),this.right=new e(this.rect.x,this.rect.y+t.h,this.rect.w,this.rect.h-t.h)),this._ontoCanvas(this.left.pack(t))))},e.prototype.expand=function(t){var r,n=this;if(t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),this.rect.w<this.rect.h?((r=new e(0,0,this.rect.w+t.w,this.rect.h)).right=new e(this.rect.w,0,t.w,this.rect.h),r.left=this):((r=new e(0,0,this.rect.w,this.rect.h+t.h)).right=new e(0,this.rect.h,this.rect.w,t.h),r.left=this),["canvas","context","img"].forEach(function(e){n[e]&&(r[e]=n[e],n[e]=null)}),r.canvas){r.context||(r.context=r.canvas.getContext("2d"));var i=r.context.getImageData(0,0,r.canvas.width,r.canvas.height);r.canvas.width=r.rect.w,r.canvas.height=r.rect.h,r.context.putImageData(i,0,0)}return!1===r.pack(t)?r.expand(t):r},e.prototype.index=function(){var e=this;return e._cache.length>0?e._cache:(function t(r){null!==r.left?(t(r.left),t(r.right)):r.rect.name&&e._cache.push(r.rect)}(e),e._cache)},e.prototype.uv=function(e,t){var r=this;e=e||r.rect.w,t=t||r.rect.h;var n=this.tilepad;return function i(a){if(null!==a.left)i(a.left),i(a.right);else if(void 0!==a.rect.name){var o=n?a.rect.w/4:0;r._uvcache[a.rect.name]=[[a.rect.x+o,a.rect.y+o],[a.rect.x+o+(a.rect.w-2*o),a.rect.y+o],[a.rect.x+o+(a.rect.w-2*o),a.rect.y+o+(a.rect.h-2*o)],[a.rect.x+o,a.rect.y+o+(a.rect.h-2*o)]].map(function(r){return 0!==r[0]&&(r[0]=r[0]/e),0!==r[1]&&(r[1]=r[1]/t),r})}}(r),r._uvcache},e.prototype.json=function(t){return t?("string"==typeof t&&(t=JSON.parse(t)),function t(r){if(r&&r.rect){var n=new e(r.rect.x,r.rect.y,r.rect.w,r.rect.h);return r.left&&(n.left=t(r.left)),r.right&&(n.right=t(r.right)),n}}(t)):JSON.stringify(function e(t){var r={left:null,right:null,rect:t.rect,filled:t.filled};return null!==t.left&&(r.left=e(t.left),r.right=e(t.right)),r}(this),null,2)},e.prototype._tilepad=function(e){var t=this.img;if(!t)return e;var n=t.width/2,i=document.createElement("canvas");i.name=t.name||t.src,i.id=t.id||"",i.width=t.width+t.width,i.height=t.height+t.height;var a=i.getContext("2d"),o=a.createPattern(t,"repeat");return a.fillStyle=o,a.translate(n,n),a.fillRect(-n,-n,i.width+n,i.height+n),a.translate(-n,-n),this.img=i,new r(e.x,e.y,this.img.width,this.img.height)},e.prototype._ontoCanvas=function(e){return e&&this.img&&this.canvas&&(this.context||(this.context=this.canvas.getContext("2d")),this.context.clearRect(e.rect.x,e.rect.y,e.rect.w,e.rect.h),this.context.drawImage(this.img,e.rect.x,e.rect.y,e.rect.w,e.rect.h),e.rect.name=this.img.id||this.img.name||this.img.src||null),e},e.prototype._toRect=function(e){return!e.nodeName||"IMG"!==e.nodeName&&"CANVAS"!==e.nodeName||(this.img=e,e=new r(e.x,e.y,e.width,e.height)),e instanceof r||(e=new r(e.x||0,e.y||0,e.w||e.width,e.h||e.height)),e},e.prototype._debug=function(){if(this.canvas){var e=this.canvas.getContext("2d");this.index().forEach(function(t){e.lineWidth=1,e.strokeStyle="red",e.strokeRect(t.x,t.y,t.w,t.h)})}}}(),function(){var e,t,r=new Float32Array([0,0,1,1]),n={};r._UUID=RedGL.makeUUID(),(RedAtlasUV=function(i,a){if(!(this instanceof RedAtlasUV))return new RedAtlasUV(i,a);i instanceof RedGL||RedGLUtil.throwFunc("RedAtlasUV : RedGL Instance만 허용됩니다.",i),a?(t=[a[0][0],1-a[2][1],a[1][0]-a[0][0],a[2][1]-a[0][1]],e=t.toString(),n[e]?this.data=n[e]:(this.data=n[e]=t,this.data._UUID=RedGL.makeUUID())):this.data=r}).prototype={},Object.freeze(RedAtlasUV)}(),RedTextureOptionChecker={check:function(e,t,r){t&&(t.min&&t.min!=r.LINEAR&&t.min!=r.NEAREST&&t.min!=r.NEAREST_MIPMAP_NEAREST&&t.min!=r.LINEAR_MIPMAP_NEAREST&&t.min!=r.NEAREST_MIPMAP_LINEAR&&t.min!=r.LINEAR_MIPMAP_LINEAR&&RedGLUtil.throwFunc(e+": min 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.min),t.mag&&t.mag!=r.LINEAR&&t.mag!=r.NEAREST&&RedGLUtil.throwFunc(e+" : mag 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.mag),t.wrap_s&&t.wrap_s!=r.REPEAT&&t.wrap_s!=r.CLAMP_TO_EDGE&&t.wrap_s!=r.MIRRORED_REPEAT&&RedGLUtil.throwFunc(e+" : wrap_s 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.wrap_s),t.wrap_t&&t.wrap_t!=r.REPEAT&&t.wrap_t!=r.CLAMP_TO_EDGE&&t.wrap_t!=r.MIRRORED_REPEAT&&RedGLUtil.throwFunc(e+" : wrap_t 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.wrap_t))}},Object.freeze(RedTextureOptionChecker),function(){var e,t,r,n,i=function(e){return 0==(e&e-1)},a=function(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1};e=function(e,t){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,2,2,0,e.LUMINANCE,e.UNSIGNED_BYTE,new Uint8Array([128,64,0,192])),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.generateMipmap(e.TEXTURE_2D),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.bindTexture(e.TEXTURE_2D,null),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0)},r=function(e,t,r,n){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n.min?n.min:e.LINEAR_MIPMAP_NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n.mag?n.mag:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,n.wrap_s?n.wrap_s:e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,n.wrap_t?n.wrap_t:e.REPEAT),e.glExtension.EXT_texture_filter_anisotropic&&n.anisotropic&&e.texParameterf(e.TEXTURE_2D,e.glExtension.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.anisotropic);try{e.generateMipmap(e.TEXTURE_2D)}catch(e){}e.bindTexture(e.TEXTURE_2D,null)},t=function(t,o,s,d,f,c){var u,h,l,R;f||(f={}),l=function(e){e.removeEventListener("error",u),e.removeEventListener("load",h)},u=function(){l(this),c&&c.call(o,!1)},h=function(){l(this);var e,o,d=this;if(d instanceof HTMLImageElement&&(!i(d.width)||!i(d.height))){var u=document.createElement("canvas"),h=u.getContext("2d");e=a(d.width),o=a(d.height),e>n&&(e=n),o>n&&(o=n),u.width=e,u.height=o,h.drawImage(d,0,0,e,o),d=u}r(t,s,d,f),c&&c.call(this,!0)},e(t,s),d instanceof HTMLCanvasElement?r(t,s,d,f):((R=new Image).crossOrigin="anonymous",R.src=d,R.addEventListener("error",u),R.addEventListener("load",h))},(RedBitmapTexture=function(e,r,i,a){var o;if(n=e._detect.MAX_TEXTURE_SIZE,!(this instanceof RedBitmapTexture))return new RedBitmapTexture(e,r,i,a);e instanceof RedGL||RedGLUtil.throwFunc("RedBitmapTexture : RedGL Instance만 허용됩니다.",e),!r||"string"==typeof r||r instanceof HTMLCanvasElement||RedGLUtil.throwFunc("RedBitmapTexture : src는 문자열 or Canvas Element만 허용.","입력값 : "+r),o=e.gl,RedTextureOptionChecker.check("RedBitmapTexture",i,o),this.webglTexture=o.createTexture(),this.atlascoord=RedAtlasUV(e),this._UUID=RedGL.makeUUID(),r&&t(o,this,this.webglTexture,r,i,a)}).prototype={},Object.freeze(RedBitmapTexture)}(),function(){var e,t,r;e=function(e,t){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,2,2,0,e.LUMINANCE,e.UNSIGNED_BYTE,new Uint8Array([128,64,0,192])),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.generateMipmap(e.TEXTURE_2D),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.bindTexture(e.TEXTURE_2D,null),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0)},r=function(e,t,r){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,null)},t=function(t,n,i,a,o){var s,d,f,c;f=function(e){e.removeEventListener("error",s),e.removeEventListener("canplaythrough",d)},s=function(){f(this),o&&o.call(n,!1);var e="couldn't load video: "+a;RedGLUtil.throwFunc(e)},d=function(){f(this),this.play(),n._videoDom.loaded=!0,r(t,i,this),o&&o.call(n,!0)},e(t,i),a instanceof HTMLVideoElement?((c=a).loop=1,c.muted=!0,c.setAttribute("autoplay",""),c.style="position:absolute;top:0px;left:0px;z-index:200",n._videoDom=c,n._videoDom.loaded=!1,c.addEventListener("error",s),c.addEventListener("canplaythrough",d)):((c=document.createElement("video")).src=a,c.loop=1,c.muted=!0,c.setAttribute("autoplay",""),c.style="position:absolute;top:0px;left:0px;z-index:200",n._videoDom=c,n._videoDom.loaded=!1,c.addEventListener("error",s),c.addEventListener("canplaythrough",d))},(RedVideoTexture=function(e,r,n){var i;if(!(this instanceof RedVideoTexture))return new RedVideoTexture(e,r,n);e instanceof RedGL||RedGLUtil.throwFunc("RedVideoTexture : RedGL Instance만 허용됩니다.",e),!r||"string"==typeof r||r instanceof HTMLVideoElement||RedGLUtil.throwFunc("RedBitmapTexture : src는 문자열 or HTMLVideoElement만 허용.","입력값 : "+r),i=e.gl,this.webglTexture=i.createTexture(),this.atlascoord=RedAtlasUV(e),this._UUID=RedGL.makeUUID(),r&&t(i,this,this.webglTexture,r,n)}).prototype={},Object.freeze(RedVideoTexture)}(),function(){var e;(RedAtlasTexture=function(t,r){if(!(this instanceof RedAtlasTexture))return new RedAtlasTexture(t,r);t instanceof RedGL||RedGLUtil.throwFunc("RedAtlasTexture : RedGL Instance만 허용됩니다.",t),e=t._datas.RedAtlas.atlasMap[r],this.webglTexture=e.atlas.texture.webglTexture,this.atlascoord=RedAtlasUV(t,e.rect),this._UUID=e.atlas._UUID}).prototype=RedBitmapTexture.prototype,Object.freeze(RedAtlasTexture)}(),function(){var e,t,r;(r=new Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC",e=function(e,t){e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,t),[r,r,r,r,r,r].forEach(function(t,n){e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},t=function(t,r,n,i,a,o){var s,d,f,c,u,h,l=[];for(a||(a={}),f=function(e){e.removeEventListener("error",s),e.removeEventListener("load",d)},s=function(){f(this),0==h&&o.call(r,!1),h++},d=function(){if(6==++u){f(this),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_CUBE_MAP,n);for(var e=l.length;e--;)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,l[e]);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,a.min?a.min:t.LINEAR_MIPMAP_NEAREST),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,a.mag?a.mag:t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,a.wrap_s?a.wrap_s:t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,a.wrap_t?a.wrap_t:t.CLAMP_TO_EDGE);try{t.generateMipmap(t.TEXTURE_CUBE_MAP)}catch(e){}t.bindTexture(t.TEXTURE_CUBE_MAP,null),0==h&&o&&o.call(r,!0)}else f(this)},c=6,u=0,h=0;c--;){var R;e(t,n),(R=new Image).crossOrigin="anonymous",R.src=i[c],R.addEventListener("error",s),R.addEventListener("load",d),l[c]=R}},(RedBitmapCubeTexture=function(e,r,n,i){var a;if(!(this instanceof RedBitmapCubeTexture))return new RedBitmapCubeTexture(e,r,n,i);e instanceof RedGL||RedGLUtil.throwFunc("RedBitmapCubeTexture : RedGL Instance만 허용됩니다.","입력값 : "+e),r instanceof Array||RedGLUtil.throwFunc("RedBitmapCubeTexture : srcList는 배열만 허용.","입력값 : "+r),6!=r.length&&RedGLUtil.throwFunc("RedBitmapCubeTexture : srcList 길이는 6이어야함","입력값 : "+r),a=e.gl,RedTextureOptionChecker.check("RedBitmapCubeTexture",n,a),this.webglTexture=a.createTexture(),this.atlascoord=RedAtlasUV(e),this._UUID=RedGL.makeUUID(),t(a,this,this.webglTexture,r,n,i)}).prototype={},Object.freeze(RedBitmapCubeTexture)}(),function(){var e,t;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
uniform vec4 u_color;
varying vec4 vColor;
void main(void) {
vColor = u_color;
gl_PointSize = uPointSize;
if(uSprite3DYn) {
gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
if(!uPerspectiveScale){
gl_Position /= gl_Position.w;
gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1]);
}
} else gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = vColor * vColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedColorMaterial=function(r,n,i){if(!(this instanceof RedColorMaterial))return new RedColorMaterial(r,n,i);r instanceof RedGL||RedGLUtil.throwFunc("RedColorMaterial : RedGL Instance만 허용됩니다.","입력값 : "+r),this._color=new Float32Array(4),Object.defineProperty(this,"color",RedDefinePropertyInfo.color),Object.defineProperty(this,"alpha",RedDefinePropertyInfo.alpha),this.alpha=void 0==i?1:i,this.color=n||"#ff0000",this.program=RedProgram.makeProgram(r,"colorProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,Object.freeze(RedColorMaterial)}(),function(){var e,t;e=function(){
/* @preserve
uniform vec4 u_color;
varying vec4 vColor;
varying vec4 vVertexPositionEye4;
void main(void) {
vColor = u_color;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform float u_shininess;
uniform float u_specularPower;
varying vec4 vVertexPositionEye4;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 la = uAmbientLightColor * uAmbientLightColor.a;
vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
vec4 texelColor = vColor;
// texelColor.rgb *= texelColor.a;
vec3 N = normalize(vVertexNormal);
vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
float specularTextureValue = 1.0;
float specular;
vec3 L;
vec3 R;
highp float lambertTerm;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPosition[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uDirectionalLightIntensity[i];
}
}
vec3 pointDirection;
highp float distanceLength;
highp float attenuation;
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
distanceLength = length(pointDirection);
if(uPointLightRadius[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(pointDirection);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensity[i] ;
}
}
}
vec4 finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedColorPhongMaterial=function(r,n,i){if(!(this instanceof RedColorPhongMaterial))return new RedColorPhongMaterial(r,n,i);r instanceof RedGL||RedGLUtil.throwFunc("RedColorPhongMaterial : RedGL Instance만 허용됩니다.","입력값 : "+r),this._color=new Float32Array(4),this.shininess=16,this.specularPower=1,Object.defineProperty(this,"color",RedDefinePropertyInfo.color),Object.defineProperty(this,"alpha",RedDefinePropertyInfo.alpha),this.alpha=void 0==i?1:i,this.color=n||"#ff0000",this.program=RedProgram.makeProgram(r,"colorPhongProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedColorPhongMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongMaterial","specularPower","number",{min:0}),Object.freeze(RedColorPhongMaterial)}(),function(){var e,t;e=function(){
/* @preserve
uniform vec4 u_color;
varying vec4 vColor;
uniform sampler2D u_displacementTexture;
uniform float u_displacementPower;
uniform float u_displacementFlowSpeedX;
uniform float u_displacementFlowSpeedY;
varying vec4 vVertexPositionEye4;
void main(void) {
vColor = u_color;
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(u_displacementTexture, vTexcoord + vec2(
u_displacementFlowSpeedX * (uTime/1000.0),
u_displacementFlowSpeedY * (uTime/1000.0)
)).x * u_displacementPower ;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_normalTexture;
uniform sampler2D u_specularTexture;
uniform float u_normalPower;
uniform float u_shininess;
uniform float u_specularPower;
varying vec4 vVertexPositionEye4;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 la = uAmbientLightColor * uAmbientLightColor.a;
vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
vec4 texelColor = vColor;
// texelColor.rgb *= texelColor.a;
vec3 N = normalize(vVertexNormal);
vec4 normalColor = texture2D(u_normalTexture, vTexcoord);
if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb * u_normalPower  - 0.5));
vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
float specularTextureValue = 1.0;
specularTextureValue = texture2D(u_specularTexture, vTexcoord).r;
float specular;
vec3 L;
vec3 R;
highp float lambertTerm;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPosition[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uDirectionalLightIntensity[i];
}
}
vec3 pointDirection;
highp float distanceLength;
highp float attenuation;
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
distanceLength = length(pointDirection);
if(uPointLightRadius[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(pointDirection);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensity[i] ;
}
}
}
vec4 finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedColorPhongTextureMaterial=function(r,n,i,a,o,s){if(!(this instanceof RedColorPhongTextureMaterial))return new RedColorPhongTextureMaterial(r,n,i,a,o,s);r instanceof RedGL||RedGLUtil.throwFunc("RedColorPhongTextureMaterial : RedGL Instance만 허용됩니다.","입력값 : "+r),this._color=new Float32Array(4),this.normalTexture=a,this.specularTexture=o,this.displacementTexture=s,this.normalPower=1,this.shininess=16,this.specularPower=1,this.displacementPower=0,this.displacementFlowSpeedX=0,this.displacementFlowSpeedY=0,Object.defineProperty(this,"color",RedDefinePropertyInfo.color),Object.defineProperty(this,"alpha",RedDefinePropertyInfo.alpha),this.alpha=void 0==i?1:i,this.color=n||"#ff0000",this.normalTexture=a,this.specularTexture=o,this.displacementTexture=s,this.program=RedProgram.makeProgram(r,"colorPhongTextureProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","normalTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","specularTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","normalPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","specularPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementFlowSpeedX","number"),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementFlowSpeedY","number"),Object.freeze(RedColorPhongTextureMaterial)}(),function(){var e,t;e=function(){
/* @preserve
varying vec4 vVertexPositionEye4;
varying vec3 vReflectionCubeCoord;
uniform sampler2D u_displacementTexture;
uniform float u_displacementPower;
uniform float u_displacementFlowSpeedX;
uniform float u_displacementFlowSpeedY;
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(u_displacementTexture, vTexcoord + vec2(
u_displacementFlowSpeedX * (uTime/1000.0),
u_displacementFlowSpeedY * (uTime/1000.0)
)).x * u_displacementPower ;
vReflectionCubeCoord = -vVertexPositionEye4.xyz;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform sampler2D u_normalTexture;
uniform sampler2D u_specularTexture;
uniform samplerCube u_environmentTexture;
uniform float u_normalPower;
uniform float u_shininess;
uniform float u_specularPower;
uniform float u_reflectionPower;
varying vec4 vVertexPositionEye4;
varying vec3 vReflectionCubeCoord;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 la = uAmbientLightColor * uAmbientLightColor.a;
vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
vec4 texelColor = texture2D(u_diffuseTexture, vTexcoord);
texelColor.rgb *= texelColor.a;
if(texelColor.a ==0.0) discard;
vec3 N = normalize(vVertexNormal);
vec4 normalColor = texture2D(u_normalTexture, vTexcoord);
if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb * u_normalPower  - 0.5));
vec4 reflectionColor = textureCube(u_environmentTexture, 2.0 * dot(vReflectionCubeCoord,vVertexNormal) * vVertexNormal - vReflectionCubeCoord);
texelColor = texelColor * (1.0 - u_reflectionPower) + reflectionColor * u_reflectionPower;
vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
float specularTextureValue = 1.0;
specularTextureValue = texture2D(u_specularTexture, vTexcoord).r;
float specular;
vec3 L;
vec3 R;
highp float lambertTerm;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPosition[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uDirectionalLightIntensity[i];
}
}
vec3 pointDirection;
highp float distanceLength;
highp float attenuation;
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
distanceLength = length(pointDirection);
if(uPointLightRadius[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(pointDirection);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensity[i] ;
}
}
}
vec4 finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedEnvironmentMaterial=function(r,n,i,a,o,s){if(!(this instanceof RedEnvironmentMaterial))return new RedEnvironmentMaterial(r,n,i,a,o,s);r instanceof RedGL||RedGLUtil.throwFunc("RedEnvironmentMaterial : RedGL Instance만 허용됩니다.",r),!i||i instanceof RedBitmapCubeTexture||RedGLUtil.throwFunc("RedEnvironmentMaterial : environmentTexture - RedBitmapCubeTexture Instance만 허용됩니다."),this.diffuseTexture=n,this.environmentTexture=i,this.normalTexture=a,this.specularTexture=o,this.displacementTexture=s,this.normalPower=1,this.shininess=8,this.specularPower=1,this.reflectionPower=1,this.displacementPower=0,this.displacementFlowSpeedX=0,this.displacementFlowSpeedY=0,this.program=RedProgram.makeProgram(r,"environmentProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","environmentTexture","samplerCube",{essential:!0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","normalTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","specularTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","normalPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","specularPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","reflectionPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementFlowSpeedX","number"),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementFlowSpeedY","number"),Object.freeze(RedEnvironmentMaterial)}(),function(){var e,t;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_PointSize = uPointSize;
if(uSprite3DYn) {
gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
if(!uPerspectiveScale){
gl_Position /= gl_Position.w;
gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1]);
}
} else gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
finalColor.rgb *= finalColor.a;
if(finalColor.a ==0.0) discard;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedBitmapMaterial=function(r,n){if(!(this instanceof RedBitmapMaterial))return new RedBitmapMaterial(r,n);r instanceof RedGL||RedGLUtil.throwFunc("RedBitmapMaterial : RedGL Instance만 허용됩니다.",r),this.diffuseTexture=n,this.program=RedProgram.makeProgram(r,"bitmapProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedBitmapMaterial","diffuseTexture","sampler2D",{essential:!0}),Object.freeze(RedBitmapMaterial)}(),function(){var e,t;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
vColor = aVertexColor;
gl_Position = uPMatrix * uCameraMatrix* vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize;
}
*/},t=function(){
/* @preserve
precision mediump float;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = vColor * vColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedParticleColorMaterial=function(r){if(!(this instanceof RedParticleColorMaterial))return new RedParticleColorMaterial(r);r instanceof RedGL||RedGLUtil.throwFunc("RedParticleColorMaterial : RedGL Instance만 허용됩니다.",r),this.program=RedProgram.makeProgram(r,"particleColorProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,Object.freeze(RedParticleColorMaterial)}(),function(){var e,t;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
gl_Position = uPMatrix * uCameraMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize;
vColor = aVertexColor;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float uAlphaTest;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vec2(gl_PointCoord.x, - gl_PointCoord.y));
finalColor.rgb *= finalColor.a;
finalColor.rgb += vColor.rgb;
finalColor.rgb *= vColor.a;
finalColor.a = finalColor.a;
if(finalColor.a < uAlphaTest) discard;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedParticleBitmapMaterial=function(r,n){if(!(this instanceof RedParticleBitmapMaterial))return new RedParticleBitmapMaterial(r,n);r instanceof RedGL||RedGLUtil.throwFunc("RedParticleBitmapMaterial : RedGL Instance만 허용됩니다.",r),this.diffuseTexture=n,this.program=RedProgram.makeProgram(r,"particleBitmapProgram",e,t),this.alphaTest=.01,this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedParticleBitmapMaterial","diffuseTexture","sampler2D",{essential:!0}),Object.freeze(RedParticleBitmapMaterial)}(),function(){var e,t;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
vColor = aVertexColor;
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize;
}
*/},t=function(){
/* @preserve
precision mediump float;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = vColor * vColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedPointColorMaterial=function(r){if(!(this instanceof RedPointColorMaterial))return new RedPointColorMaterial(r);r instanceof RedGL||RedGLUtil.throwFunc("RedPointColorMaterial : RedGL Instance만 허용됩니다.",r),this.program=RedProgram.makeProgram(r,"pointColorProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,Object.freeze(RedPointColorMaterial)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float uAlphaTest;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vec2(gl_PointCoord.x, - gl_PointCoord.y));
finalColor.rgb *= finalColor.a;
if(finalColor.a < uAlphaTest) discard;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedPointBitmapMaterial=function(r,n){if(!(this instanceof RedPointBitmapMaterial))return new RedPointBitmapMaterial(r,n);r instanceof RedGL||RedGLUtil.throwFunc("RedPointBitmapMaterial : RedGL Instance만 허용됩니다.",r),this.diffuseTexture=n,this.program=RedProgram.makeProgram(r,"pointBitmapProgram",e,t),this.alphaTest=.1,this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedPointBitmapMaterial","diffuseTexture","sampler2D",{essential:!0}),Object.freeze(RedPointBitmapMaterial)}(),function(){var e,t;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
uniform vec4 u_sheetRect;
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vTexcoord = vec2(
vTexcoord.s * u_sheetRect.x + u_sheetRect.z,
vTexcoord.t * u_sheetRect.y - u_sheetRect.w
);
gl_PointSize = uPointSize;
if(uSprite3DYn) {
gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
if(!uPerspectiveScale){
gl_Position /= gl_Position.w;
gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1]);
}
} else gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
finalColor.rgb *= finalColor.a;
if(finalColor.a ==0.0) discard;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedSheetMaterial=function(r,n,i,a,o,s){if(!(this instanceof RedSheetMaterial))return new RedSheetMaterial(r,n,i,a,o,s);r instanceof RedGL||RedGLUtil.throwFunc("RedSheetMaterial : RedGL Instance만 허용됩니다.",r),this.diffuseTexture=n,this._sheetRect=new Float32Array(4),this._perFrameTime=0,this._nextFrameTime=0,this._playYn=!0,this.segmentW=a||1,this.segmentH=o||1,this.totalFrame=s||1,this.frameRate=i||1e3,this.currentIndex=0,this.loop=!0,this._aniMap={},this.program=RedProgram.makeProgram(r,"bitmapProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedSheetMaterial.prototype.addAction=function(e,t){this._aniMap[e]=t},RedSheetMaterial.prototype.setAction=function(e){this.diffuseTexture=this._aniMap[e].texture,this.segmentW=this._aniMap[e].segmentW,this.segmentH=this._aniMap[e].segmentH,this.totalFrame=this._aniMap[e].totalFrame,this.frameRate=this._aniMap[e].frameRate,this.currentIndex=0,this._nextFrameTime=0},RedDefinePropertyInfo.definePrototype("RedSheetMaterial","diffuseTexture","sampler2D",{essential:!0}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","totalFrame","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","loop","boolean",!0),RedSheetMaterial.prototype.play=function(){this._playYn=!0},RedSheetMaterial.prototype.stop=function(){this._playYn=!1,this.currentIndex=0},RedSheetMaterial.prototype.pause=function(){this._playYn=!1},RedSheetMaterial.prototype.gotoAndStop=function(e){e>this.totalFrame-1&&(e=this.totalFrame-1),e<0&&(e=0),this._playYn=!1,this.currentIndex=e},RedSheetMaterial.prototype.gotoAndPlay=function(e){e>this.totalFrame-1&&(e=this.totalFrame-1),e<0&&(e=0),this._playYn=!0,this.currentIndex=e,this._nextFrameTime=0},Object.defineProperty(RedSheetMaterial.prototype,"frameRate",{get:function(){return this._frameRate},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc("RedSheetMaterial - frameRate  : 숫자만 허용함."),e<1&&(e=1),this._frameRate=e,this._perFrameTime=1e3/this.frameRate}}),Object.defineProperty(RedSheetMaterial.prototype,"segmentW",{get:function(){return this._segmentW},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc("RedSheetMaterial - segmentW  : 숫자만 허용함."),e<1&&(e=1),this._segmentW=e}}),Object.defineProperty(RedSheetMaterial.prototype,"segmentH",{get:function(){return this._segmentH},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc("RedSheetMaterial - segmentH  : 숫자만 허용함."),e<1&&(e=1),this._segmentH=e}}),Object.freeze(RedSheetMaterial)}(),function(){var e,t;e=function(){
/* @preserve
uniform sampler2D u_displacementTexture;
uniform float u_displacementPower;
uniform float u_displacementFlowSpeedX;
uniform float u_displacementFlowSpeedY;
varying vec4 vVertexPositionEye4;
varying highp vec4 vShadowPos;
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(u_displacementTexture, vTexcoord + vec2(
u_displacementFlowSpeedX * (uTime/1000.0),
u_displacementFlowSpeedY * (uTime/1000.0)
)).x * u_displacementPower ;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;
vResolution = uResolution;
mat4 texUnitConverter = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0);
vShadowPos = texUnitConverter  *  uDirectionalShadowLightMatrix * uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform sampler2D u_normalTexture;
uniform sampler2D u_specularTexture;
uniform float u_normalPower;
uniform float u_shininess;
uniform float u_specularPower;
varying vec4 vVertexPositionEye4;
varying highp vec4 vShadowPos;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
float decodeFloat (vec4 color) {
const vec4 cBitShift = vec4(
1.0 / (256.0 * 256.0 * 256.0),
1.0 / (256.0 * 256.0),
1.0 / 256.0,
1
);
return dot(color, cBitShift);
}
void main(void) {
vec4 la = uAmbientLightColor * uAmbientLightColor.a;
vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
vec4 texelColor = texture2D(u_diffuseTexture, vTexcoord);
texelColor.rgb *= texelColor.a;
if(texelColor.a ==0.0) discard;
///////////////////////////////////////////////////////////////////////////////////////
if(uUseDirectionalShadow){
vec3 fragmentDepth = vShadowPos.xyz;
float shadowAcneRemover = 0.0007;
fragmentDepth.z -= shadowAcneRemover;
float texelSizeX =  1.0/vResolution.x;
float texelSizeY =  1.0/vResolution.y;
float texelSize = 1.0 / 1024.0;
float amountInLight = 0.0;
for (int x = -1; x <= 1; x++) {
for (int y = -1; y <= 1; y++) {
vec2 tUV = fragmentDepth.xy + vec2(x, y) * vec2(texelSizeX,texelSizeY);
if(tUV.x<0.0) continue;
if(tUV.x>1.0) continue;
if(tUV.y<0.0) continue;
if(tUV.y>1.0) continue;
float texelDepth = decodeFloat(texture2D(uDirectionalShadowTexture,tUV));
if (fragmentDepth.z < texelDepth) {
amountInLight += 0.5;
}
// texelColor =  texture2D(uDirectionalShadowTexture,tUV);
}
}
amountInLight /= 9.0;
texelColor.rgb *= (1.0-amountInLight);
}
///////////////////////////////////////////////////////////////////////////////////////
vec3 N = normalize(vVertexNormal);
vec4 normalColor = texture2D(u_normalTexture, vTexcoord);
if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb * u_normalPower  - 0.5));
vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
float specularTextureValue = 1.0;
specularTextureValue = texture2D(u_specularTexture, vTexcoord).r;
float specular;
vec3 L;
vec3 R;
highp float lambertTerm;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPosition[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uDirectionalLightIntensity[i];
}
}
vec3 pointDirection;
highp float distanceLength;
highp float attenuation;
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
distanceLength = length(pointDirection);
if(uPointLightRadius[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(pointDirection);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensity[i] ;
}
}
}
vec4 finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedStandardMaterial=function(r,n,i,a,o){if(!(this instanceof RedStandardMaterial))return new RedStandardMaterial(r,n,i,a,o);r instanceof RedGL||RedGLUtil.throwFunc("RedStandardMaterial : RedGL Instance만 허용됩니다.",r),this.diffuseTexture=n,this.normalTexture=i,this.specularTexture=a,this.displacementTexture=o,this.normalPower=1,this.shininess=16,this.specularPower=1,this.displacementPower=0,this.displacementFlowSpeedX=0,this.displacementFlowSpeedY=0,this.program=RedProgram.makeProgram(r,"standardProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedStandardMaterial","diffuseTexture","sampler2D",{essential:!0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","normalTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","specularTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","normalPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","specularPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementFlowSpeedX","number"),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementFlowSpeedY","number"),Object.freeze(RedStandardMaterial)}(),function(){var e,t;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_PointSize = uPointSize;
if(uSprite3DYn) {
gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
if(!uPerspectiveScale){
gl_Position /= gl_Position.w;
gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1]);
}
} else gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_videoTexture;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_videoTexture, vTexcoord);
finalColor.rgb *= finalColor.a;
if(finalColor.a ==0.0) discard;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedVideoMaterial=function(r,n){if(!(this instanceof RedVideoMaterial))return new RedVideoMaterial(r,n);r instanceof RedGL||RedGLUtil.throwFunc("RedVideoMaterial : RedGL Instance만 허용됩니다.",r),this.videoTexture=n,this.program=RedProgram.makeProgram(r,"videoProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedVideoMaterial","videoTexture","samplerVideo",{essential:!0}),Object.freeze(RedVideoMaterial)}(),function(){var e,t,r,n,i,a;(RedBaseObject3D=function(){}).build=function(e){this.useCullFace=!0,this.cullFace=e.BACK,this.useDepthMask=!0,this.useDepthTest=!0,this.depthTestFunc=e.LEQUAL,this.useBlendMode=!0,this.blendSrc=e.SRC_ALPHA,this.blendDst=e.ONE_MINUS_SRC_ALPHA,this.drawMode=e.TRIANGLES,this.pointSize=1,this.x=this.y=this.z=0,this.rotationX=this.rotationY=this.rotationZ=0,this.scaleX=this.scaleY=this.scaleZ=1,this.matrix=mat4.create(),this.autoUpdateMatrix=!0,this.normalMatrix=mat4.create(),this.children=[],this.useLOD=!1,this._lodLevels={},this._geometry=null,Object.defineProperty(this,"geometry",RedDefinePropertyInfo.geometry),this._material=null,Object.defineProperty(this,"material",RedDefinePropertyInfo.material)},RedBaseObject3D.prototype={addLOD:function(e,t,r,n){r||n||RedGL.throwFunc("RedBaseObject3D - addLOD : geometry, material 둘중하나는 반드시 입력되어야함"),a={level:e,distance:t,geometry:r||this.geometry,material:n||this.material},this._lodLevels[e]=a},removeLOD:function(e){delete this._lodLevels[e]},localToWorld:(i=mat4.create(),function(e,t,r){return e=e||0,t=t||0,r=r||0,mat4.identity(i),mat4.translate(i,i,[e,t,r]),mat4.multiply(i,this.matrix,i),[i[12],i[13],i[14]]}),worldToLocal:function(){var e,t;return e=mat4.create(),t=mat4.create(),function(r,n,i){return r=r||0,n=n||0,i=i||0,mat4.translate(e,e,[r,n,i]),mat4.multiply(t,e,this.matrix),[t[0]*r+t[1]*n+t[2]*i+t[3],t[4]*r+t[5]*n+t[6]*i+t[7],t[8]*r+t[9]*n+t[10]*i+t[11]]}}(),getScreenPoint:(n=mat4.create(),r={x:0,y:0,z:0,w:0},function(i){return mat4.identity(n),e=i.camera,t=i._viewRect,e instanceof RedCamera||(e=e.camera),mat4.multiply(n,e.perspectiveMTX,e.matrix),mat4.multiply(n,n,this.matrix),r.x=n[12],r.y=n[13],r.z=n[14],r.w=n[15],r.x=.5*r.x/r.w+.5,r.y=.5*r.y/r.w+.5,[(t[0]+r.x*t[2])/window.devicePixelRatio,(t[1]+(1-r.y)*t[3])/window.devicePixelRatio]})},Object.freeze(RedBaseObject3D)}(),function(){RedBaseContainer=function(){};var e,t={addChild:function(t){t instanceof RedBaseObject3D||RedGLUtil.throwFunc("addChild","RedBaseObject3D Instance만 가능","입력값 : "+t),-1!=(e=this.children.indexOf(t))&&(t=this.children.splice(e,1)[0]),this.children.push(t)},addChildAt:function(e,t){"number"!=typeof t&&RedGLUtil.throwFunc("addChildAt","index는 숫자만 입력가능","입력값 : "+t),e instanceof RedBaseObject3D||RedGLUtil.throwFunc("addChildAt","RedBaseObject3D Instance만 가능","입력값 : "+e),this.children.length>=t?t?this.children.splice(t,0,e):this.children.push(e):RedGLUtil.throwFunc("addChildAt","해당인덱스가 현재 children 길이와 같거나 큽니다.","입력값 : "+t)},removeChild:function(){var e;return function(t){-1==(e=this.children.indexOf(t))?RedGLUtil.throwFunc("removeChild","존재하지 않는 RedMesh를 삭제하려고 함"):this.children.splice(e,1)}}(),removeChildAt:function(e){"number"!=typeof e&&RedGLUtil.throwFunc("removeChildAt","index가 Number형이 아님 ","입력값 : "+e),this.children[e]?this.children.splice(e,1):RedGLUtil.throwFunc("removeChildAt","index 해당인덱스에 위치한 자식이 없음.","입력값 : "+e)},removeChildAll:function(){this.children.length=0},getChildAt:function(e){return"number"!=typeof e&&RedGLUtil.throwFunc("getChildAt","index가 Number형이 아님 "),this.children[e]},getChildIndex:function(e){return this.children.indexOf(e)},numChildren:function(){return this.children.length}};for(var r in RedBaseContainer.prototype=new RedBaseObject3D,t)RedBaseContainer.prototype[r]=t[r];Object.freeze(RedBaseContainer)}(),(RedBaseLight=function(){}).prototype={},RedDefinePropertyInfo.definePrototype("RedBaseLight","intensity","number",{min:0}),Object.freeze(RedBaseLight),(RedAmbientLight=function(e,t,r){if(!(this instanceof RedAmbientLight))return new RedAmbientLight(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedAmbientLight : RedGL Instance만 허용됩니다.","입력값 : "+e),this._color=new Float32Array(4),this.intensity=1,Object.defineProperty(this,"alpha",RedDefinePropertyInfo.alpha),Object.defineProperty(this,"color",RedDefinePropertyInfo.color),this.alpha=void 0==r?.1:r,this.color=t||"#fff",this._UUID=RedGL.makeUUID()}).type="RedAmbientLight",RedAmbientLight.prototype=new RedBaseLight,Object.defineProperty(RedAmbientLight.prototype,"type",{configurable:!1,writable:!1,value:RedAmbientLight.type}),Object.freeze(RedAmbientLight),(RedDirectionalLight=function(e,t,r){if(!(this instanceof RedDirectionalLight))return new RedDirectionalLight(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedDirectionalLight : RedGL Instance만 허용됩니다.","입력값 : "+e),this._color=new Float32Array(4),this.intensity=1,Object.defineProperty(this,"alpha",RedDefinePropertyInfo.alpha),Object.defineProperty(this,"color",RedDefinePropertyInfo.color),this.alpha=void 0==r?1:r,this.color=t||"#fff",this.x=0,this.y=-1,this.z=0,this._UUID=RedGL.makeUUID(),this.debug=!1,this.debugObject=RedSprite3D(e,RedBitmapMaterial(e,RedBitmapTexture(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA25pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDozQjcyMEREMTUyMDYxMUU4OTRDNTgzQTBBMEY2MkFFNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDODA1NTI0RjUyMDYxMUU4QkVBQTg3NjZCN0M1OUI2OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDODA1NTI0RTUyMDYxMUU4QkVBQTg3NjZCN0M1OUI2OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowNmFjYmZjZi05YjBkLThlNGItODZiNy1kNWViYWNjZDg4OGMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6M0I3MjBERDE1MjA2MTFFODk0QzU4M0EwQTBGNjJBRTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4vVcpuAAAHNUlEQVR42uxbeWyURRT/tiw9OAJYUekfeBCFNmqlkAgRtURQaTywWIhGSfDAAzmkggcoKopKRQXFKKZqNGmkqGAkGEQFhaQenGrAI3iUpKilaiPSytKt74XfF6evM/vN7n67+xn6kl/Sb3bmvTdvZt68eTMNtbe3O8cyhboM0GWALgN0LKkJpUv2lYQFBFbgYcI7aZF6bcf+ZmXI8L0IlYShhBLCbELPTCiSKQOcTRimfA8nFP/fDTCEMJrQw2bpEVqV71ZLXXpARmHQDDCZ8DnhI8IrFkZoI0SVb/77iEXnX4WMzyAzEAbIJSwk9Mb3RMKMFMzWmYQK/N0bMnODYAB2q42i7B5CkY+dZ153i7JGyM64Af4hVIk13cdjFoQsy1yaAZ6qz6iC7ED4gJWEjaLsRkKpoX53MX1zUaajUvBSaSNkBmoXuI/QonyHCXMIeZq6PxJ+Vb5/I/ykqZcHHmGljGXcG8RtcCfhRVFWpjgulfahEzvQjn1GvaZeBXio9AJhV1ADoUcITaJsmKHuKvxWgr91NFx8N0FG2gOhbpb1WMGbxXRd6SE/lg61wrneRPjdT51tDkOTELe3YvrVWPC9CnH+h4SPlfKLCKMQChco/oEN1UD4krAF7Vy6EO14uay2kH0N4XZCDmFJpwEQhyEvAwxF1OV66MOEd8G4znIkuJNTCNcjhO3jUb+ZsIfwOqLKFks5IzFQlxOyURYhnAvjJXQa7Cu2J2Y8gbCBsJhwskf7SzCizxJGWHTejSFGoM0W8IhFA6HLBuiWLbbbvsn4gJ2GKd8T29NWeGodHx6NdXByWQn6pxLwqDT8XgEd5hiO0zXog5HCHkr8QbiO8AMOHwPF78fDUZWL9cmeep6B527CNsK3hAMKn8HYFYo0HX2S0I8wXyRUag0y6nFwWuBl5bDFSPCiuR/WvItwg6bO+YoB7jR0fjthBXxIg0FWAdbwVIy+SvOwyzytyNTRyzDYnlSlxEYh6hunePCLsV75t82aNrx7PCiiv1h0IurfajC2K+t9ZSd5j7AIv1mnxBLNCXJK61KMEiuxCdvOds0U5o48lGCcsgDt5RIqwUGoFMbfAQMcjDcn6GdSlPfe5aJsKWFWksHaM8gFqDSN8HxC3FKUFM3CulXpa2xPydJi8FJpql+6+2WACwiDNCPX4APvBvBSaRBkBsYAY+AXXOItbo2PZ5Y14Kn6oDF+MA7HyPMVI5I6IrI2XPY9Yb9SfpZoX6c5FSZDTeA5OIZM3jnOgL7t4lDUhiN0i40BLkNkVYjGUc0pqxGxQS1m0QBR5xvHf5I8B0A268eJWL5d6q/RNwSD7EYaba2XAZZrIj5J/bA9rYbFszUj5jdJntnoWHfoMtjCT50iDZCpm6HAkG4GTMMSKFKmjzRaI6wewfdhUSc/BbpKnoehXwS6LMQSaNPo24bQuMrGAGuRkChWHIi6nrjNd0pYGxUOkWlICgwgee5X1nstQvDTYZB20ccInGCr7S7A3vLTOJT7inCFSE7k++gL8sFTypQG2Z+pOOADEYezQxrv4+iPF07uIGQGJhD6hLBXlM3C8TZZKtCcJ/ZCZmAMEMVZX6UzCXN94D0XvFRaodnv02qAXkhHLXL+u/6qRrCh0kybrIzHcXim5jhcjb9LocPVIhS3pmM+IRLPDCiE5TcrnXegQDn+ZuGzNW25I5zcvMXDLxSgzjpD52crHSx3Ot47joNu1U4cL0hsZkAIcfbkGCFyKpOiLj3qdEyK8uXL24a65qRonBkhjvmf42YGQQeQCXpL45QqkcxI1tFG4QiXaPzXBJxd+hvaciL3DudodjuhJXCOofN/I6zky8tVBo/MCvPN7vYEPXYUbcs0nXd/XwUdqqBTp/FGHxLeBf5EGOkSJyLfJIzFqPzs0X49nNV0RJbNFh1vRt3paLveo349dBmLmaieSyLoQ1I+QL0c5UTkGxad4PVZgmjNj8vRMfAbNlkmvhy9DUmdpC9H1ZliO41V59SKkTFtTe4Vdpvh9/NgxFyFt22qrZuWb4LboG3n+dDykkitTfTgG4v3JKfjW6LqOI7abekMhV2ar1Fwq6FuBZzcNkf/jEbX9jixFSZNfl6McP6gTgQn6xCmymQkxxP80us05XDDT2D3iXp5cLpl4qg+0kn0nVAKX4s/Jjp/BNuT7oED5+ZOEKHvqYa8RJXTMTOdB1m+kF8GmIQRdMR63WSoH3E6P5aOGOpuUg4/Lo2GzEAYIAc5xFyxly+L0abdssylZSKGyIXMnCAYIKQJRZ/QHI2TIeb1uCjr74f+fhiApy9fkvyFbw5Plzr+E88C90UIy3rAsX9AZaSwT8q9RviCcJJz9FXZIQu5WWIgvN71Mc8pyC384li+AEmXARwoZKtU1On8WNrm6fshp/Oj7EDsAvHSLhHkbMM5IO0UzpAB+Oj6FPJ4IRxaDmZCka5/nOwyQJcBjm0D/CvAAF/S81D+EWScAAAAAElFTkSuQmCC")))}).type="RedDirectionalLight",RedDirectionalLight.prototype=new RedBaseLight,Object.defineProperty(RedDirectionalLight.prototype,"type",{configurable:!1,writable:!1,value:RedDirectionalLight.type}),Object.freeze(RedDirectionalLight),(RedPointLight=function(e,t,r){if(!(this instanceof RedPointLight))return new RedPointLight(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedPointLight : RedGL Instance만 허용됩니다.","입력값 : "+e),this._color=new Float32Array(4),this.intensity=1,Object.defineProperty(this,"alpha",RedDefinePropertyInfo.alpha),Object.defineProperty(this,"color",RedDefinePropertyInfo.color),this.alpha=void 0==r?1:r,this.color=t||"#fff",this.x=0,this.y=0,this.z=0,this.radius=1,this.debug=!1,this.debugObject=RedMesh(e,RedSphere(e,1,16,16,16),RedColorMaterial(e)),this.debugObject.drawMode=e.gl.LINE_STRIP,this._UUID=RedGL.makeUUID()}).type="RedPointLight",RedPointLight.prototype=new RedBaseLight,Object.defineProperty(RedPointLight.prototype,"type",{configurable:!1,writable:!1,value:RedPointLight.type}),RedDefinePropertyInfo.definePrototype("RedPointLight","radius","number",{min:0}),Object.freeze(RedPointLight),JsonModelLoader=function(e,t,r,n){if(!(this instanceof JsonModelLoader))return new JsonModelLoader(e,t,r,n);var i=new XMLHttpRequest;i.open("GET",r,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.onreadystatechange=function(){if(4==i.readyState){var r,a,o,s;for(a=[],o=0,s=(r=JSON.parse(i.responseText)).position.length/3;o<s;o++)a.push(r.position[3*o],r.position[3*o+1],r.position[3*o+2]),a.push(r.normal[3*o],r.normal[3*o+1],r.normal[3*o+2]),r.uvs?a.push(r.uvs[2*o],r.uvs[2*o+1]):a.push(0,0);n&&n(RedBuffer(e,t,RedBuffer.ARRAY_BUFFER,new Float32Array(a),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),RedBuffer(e,t,RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(r.index)))}},i.send()},Object.freeze(JsonModelLoader),function(){var e,t;t=function(){},RedMTLLoader=function(r,n,i,a){if(!(this instanceof RedMTLLoader))return new RedMTLLoader(r,n,i,a);var o=this,s=new XMLHttpRequest;s.open("GET",n+i,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.onreadystatechange=function(){if(4==s.readyState){var n;if(o.complete=!0,200==s.status)n=e(o,r,s.responseText),o.parseData=n;else o.parseData=new t;a&&a(o.parseData)}},s.addEventListener("error",function(e){}),s.send(),this.path=n,this.fileName=i,this.complete=!1,this.parseData=null},e=function(e,r,n){var i,a,o,s,d,f,c,u,h,l,R,m,p,E;for(var _ in i={},o=/^(newmtl )/,s=/^(Ns )/,d=/^(Ka )/,f=/^(Kd )/,c=/^(Ks )/,u=/^(Ni )/,h=/^(d )/,l=/^(illum )/,R=/^(map_Kd )/,/^(map_Ks )/,m=/^(map_Ns )/,p=/^(map_bump )/,(n=n.replace(/^\#[\s\S]+?\n/g,"")).split("\n").forEach(function(t){var r;o.test(t)?(r=t.replace("newmtl ","").trim(),E={name:r},i[r]=E):d.test(t)?E.Ka=t.replace("Ka ","").split(" "):f.test(t)?E.Kd=t.replace("Kd ","").split(" "):c.test(t)?E.Ks=t.replace("Ks ","").split(" "):s.test(t)?E.Ns=+t.replace("Ns ",""):u.test(t)?E.Ni=+t.replace("Ni ",""):h.test(t)?E.d=+t.replace("d ",""):l.test(t)?(E.illum=+t.replace("illum ",""),E.illum):R.test(t)?E.map_Kd=e.path+t.replace("map_Kd ",""):m.test(t)?E.map_Ns=e.path+t.replace("map_Ns ",""):p.test(t)&&(E.map_bump=e.path+t.replace("map_bump ","").split(" ")[2])}),a=new t,i)a[_]=i[_];return a},Object.freeze(RedMTLLoader)}(),function(){var e,t,r,n,i,a,o,s,d,f,c,u,h,l,R;RedOBJLoader=function(t,r,n,i){if(!(this instanceof RedOBJLoader))return new RedOBJLoader(t,r,n,i);var a=this,o=new XMLHttpRequest;o.open("GET",r+n,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.onreadystatechange=function(){4==o.readyState&&(a.result=e(a,t,o.responseText),a.modelParsingComplete=!0,a.resultMesh=void 0,i&&(a.mtlLoader?a.mtlLoader.complete&&i(a.result):i(a.result)))},o.send(),this.path=r,this.fileName=n,this.mtlLoader=null,this.modelParsingComplete=!1,this.callback=i,this.resultMesh=RedMesh(t),this.resultMesh.name="instanceOfRedOBJLoader_"+RedGL.makeUUID(),this.result=null},r=function(e,t,r){var n,i,a,o;for(n in o={},t){var s,d,f,c,u,h;if((a=t[n]).mesh,a.use&&a.resultInterleave.length)h=a.ableLight,(i=r.parseData[a.materialKey])&&(i.map_Kd?(o[i.map_Kd]?d=o[i.map_Kd]:(d=RedBitmapTexture(e,i.map_Kd),o[i.map_Kd]=d),s=h?RedStandardMaterial(e,d):RedBitmapMaterial(e,d)):i.Kd&&(f=255*i.Kd[0],c=255*i.Kd[1],u=255*i.Kd[2],s=h?RedColorPhongTextureMaterial(e,RedGLUtil.rgb2hex(f,c,u)):a.ableNormal?RedColorPhongMaterial(e,RedGLUtil.rgb2hex(f,c,u)):RedColorMaterial(e,RedGLUtil.rgb2hex(f,c,u))),s&&(i.map_Ns&&(o[i.map_Ns]?d=o[i.map_Ns]:(d=RedBitmapTexture(e,i.map_Ns),o[i.map_Ns]=d),s.specularTexture=d),i.map_bump&&(o[i.map_bump]?d=o[i.map_bump]:(d=RedBitmapTexture(e,i.map_bump),o[i.map_bump]=d),s.normalTexture=d),void 0!=i.Ns&&(s.shininess=i.Ns),a.mesh.material=s))}},t=function(e,r,n){for(var i in n){var a,o;if((a=n[i]).use){var s,d,f,c=[];a.resultPosition.length&&c.push(RedInterleaveInfo("aVertexPosition",3)),a.resultNormal.length&&c.push(RedInterleaveInfo("aVertexNormal",3)),a.resultUV.length&&c.push(RedInterleaveInfo("aTexcoord",2)),s=RedBuffer(e,i+"_interleave",RedBuffer.ARRAY_BUFFER,new Float32Array(a.resultInterleave.length?a.resultInterleave:a.resultPosition),c),a.index.length&&a.index.length&&(d=RedBuffer(e,i+"_index",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(a.index))),f=a.resultUV.length&&a.resultNormal.length?RedColorPhongTextureMaterial(e,"#00ff00"):a.resultNormal?RedColorPhongMaterial(e,"#00ff00"):RedColorMaterial(e,"#0000ff"),o=RedMesh(e,RedGeometry(s,d),f),a.ableUV=!!a.resultUV.length,a.ableNormal=!!a.resultNormal.length,a.ableLight=!!(a.ableUV&a.ableNormal)}else o=RedMesh(e);o.name=i,a.mesh=o,r.addChild(o),t(e,o,a.childrenInfo)}},l=/^(mtllib )/,R=/^(usemtl )/,i=/^o /,a=/^g /,o=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,s=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,d=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,f=/f\s+(([\d]{1,}[\s]?){3,})+/,c=/f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,u=/f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,h=/f\s+((([\d]{1,}\/\/[\d]{1,}[\s]?){3,})+)/,n=function(e,t,n){var m,p,E,_,g,P,M,y,v,b;for(E={position:[],normal:[],uv:[],points:[],normalPoints:[],uvPoints:[]},p={},m={},M=n.length;M--;)if(i.test(n[M])){y=!0;break}return y||(b={name:v="objModel"+RedGL.makeUUID(),groupName:v,index:[],position:[],resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},p[v]=_=b,m[v]=_,g=v),n.forEach(function(n){if(l.test(n))return P=RedMTLLoader(e,t.path,n.split(" ")[1],function(n){t.mtlLoader=n,t.modelParsingComplete&&t.callback&&(r(e,m,P),t.callback(t.result))}),void(t.mtlLoader=P);var M;if(R.test(n))y=n.split(" ").slice(1).join("").trim(),m[g].materialKey=y;else if(a.test(n))y=n.split(" ").slice(1).join("").trim(),p[g].use=!1,v={name:y,groupName:g,materialKey:y.replace(g+"_",""),index:[],position:_.position,resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},m[y]=_=v,p[g].childrenInfo[y]=_;else if(i.test(n)){var y,v;v={name:y=n.split(" ").slice(1).join("").trim(),groupName:y,materialKey:y,index:[],position:[],resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},p[y]=_=v,m[y]=_,g=y}if(o.test(n))M=n.split(" "),E.position.push(+M[1],+M[2],+M[3]),_.position.push(+M[1],+M[2],+M[3]),E.points[E.points.length]=[+M[1],+M[2],+M[3]];else if(s.test(n)){var b;b=n.split(" "),E.normal.push(+b[1],+b[2],+b[3]),E.normalPoints[E.normalPoints.length]=[+b[1],+b[2],+b[3]]}else if(d.test(n)){var U;U=n.split(" "),E.uv.push(+U[1],+U[2]),E.uvPoints[E.uvPoints.length]=[+U[1],+U[2]]}else if(h.test(n))(w=n.split(" ").slice(1,4)).forEach(function(e){var t,r,n;n=0,e=e.split("/"),x=+e[0]-1,L=+e[2]-1,t=E.points[x],r=E.normalPoints[L],E.position.length&&(n+=3),E.normal.length&&(n+=3),_.index.push(_.resultInterleave.length/n),E.position.length&&(_.resultPosition.push(t[0],t[1],t[2]),_.resultInterleave.push(t[0],t[1],t[2])),E.normal.length&&(_.resultNormal.push(r[0],r[1],r[2]),_.resultInterleave.push(r[0],r[1],r[2]))});else if(u.test(n)){var L;if(4==(w=n.split(" ").slice(1,5)).length){var T=w[3];w[3]=w[0],w[4]=w[2],w[5]=T}w.forEach(function(e){var t,r,n,i;i=0,e=e.split("/"),x=+e[0]-1,I=+e[1]-1,L=+e[2]-1,t=E.points[x],n=E.uvPoints[I],r=E.normalPoints[L],E.position.length&&(i+=3),E.normal.length&&(i+=3),E.uv.length&&(i+=2),_.index.push(_.resultInterleave.length/i),E.position.length&&(_.resultPosition.push(t[0],t[1],t[2]),_.resultInterleave.push(t[0],t[1],t[2])),E.normal.length&&(_.resultNormal.push(r[0],r[1],r[2]),_.resultInterleave.push(r[0],r[1],r[2])),E.uv.length&&(_.resultUV.push(n[0],n[1]),_.resultInterleave.push(n[0],n[1]))})}else if(c.test(n)){var w,I;(w=n.split(" ").slice(1,4)).forEach(function(e){var t,r,n;n=0,e=e.split("/"),x=+e[0]-1,I=+e[1]-1,t=E.points[x],r=E.uvPoints[I],E.position.length&&(n+=3),E.uv.length&&(n+=2),_.index.push(_.resultInterleave.length/n),E.position.length&&(_.resultPosition.push(t[0],t[1],t[2]),_.resultInterleave.push(t[0],t[1],t[2])),E.uv.length&&(_.resultUV.push(r[0],r[1]),_.resultInterleave.push(r[0],r[1]))})}else if(f.test(n)){var x;x=n.split(" "),_.resultInterleave=_.resultPosition=_.position,_.index.push(+x[1]-1,+x[2]-1,+x[3]-1),_.index.push(+x[1]-1,+x[3]-1,+x[4]-1)}}),{info:m,infoHierarchy:p}},e=function(e,r,i){i=i.replace(/^\#[\s\S]+?\n/g,"");var a=n(r,e,i.split("\n"));return t(r,e.resultMesh,a.infoHierarchy),new function(e){for(var t in e)this[t]=e[t]}({fileName:e.fileName,path:e.path,resultMesh:e.resultMesh,parseRawInfo:a.info,parseInfoHierarchy:a.infoHierarchy,parseInfoMaterial:e.mtlLoader})},Object.freeze(RedOBJLoader)}(),(RedAxis=function(e){if(!(this instanceof RedAxis))return new RedAxis(e);var t,r,n,i;e instanceof RedGL||RedGLUtil.throwFunc("RedAxis : RedGL Instance만 허용됩니다.",e),RedBaseObject3D.build.call(this,e.gl),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#ff0000")),(r=RedMesh(e,RedBox(e),RedColorMaterial(e,"#ff0000"))).scaleX=r.scaleY=r.scaleZ=.5,r.scaleX=10,t.x=5,r.x=-5,t.children.push(r),this.children.push(t),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#00ff00")),(n=RedMesh(e,RedBox(e),RedColorMaterial(e,"#00ff00"))).scaleX=n.scaleY=n.scaleZ=.5,n.scaleY=10,t.y=5,n.y=-5,t.children.push(n),this.children.push(t),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#0000ff")),(i=RedMesh(e,RedBox(e),RedColorMaterial(e,"#0000ff"))).scaleX=i.scaleY=i.scaleZ=.5,i.scaleZ=10,t.z=5,i.z=-5,t.children.push(i),this.children.push(t),this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,Object.freeze(RedAxis),(RedGrid=function(e,t,r,n,i){if(!(this instanceof RedGrid))return new RedGrid(e,t,r,n,i);var a;e instanceof RedGL||RedGLUtil.throwFunc("RedGrid : RedGL Instance만 허용됩니다.",e),a=e.gl,RedBaseObject3D.build.call(this,a);var o=[];t=t||100,n=[1,1,1,.7],i=[1,1,1,.5];for(var s,d=(r=r||100)/2,f=t/r,c=t/2,u=0,h=-c;u<=r;u++,h+=f){var l=u===d?n:i;o.push(-c,0,h),o.push(l[0],l[1],l[2],l[3]),o.push(c,0,h),o.push(l[0],l[1],l[2],l[3]),o.push(h,0,-c),o.push(l[0],l[1],l[2],l[3]),o.push(h,0,c),o.push(l[0],l[1],l[2],l[3])}s=RedBuffer(e,"gridInterleaveBuffer_"+r,RedBuffer.ARRAY_BUFFER,new Float32Array(o),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexColor",4)]),this.geometry=RedGeometry(s),this.material=RedGridMaterial(e),this.drawMode=a.LINES,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,Object.freeze(RedGrid),(RedMesh=function(e,t,r){if(!(this instanceof RedMesh))return new RedMesh(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedMesh : RedGL Instance만 허용됩니다.",e),RedBaseObject3D.build.call(this,e.gl),this.geometry=t,this.material=r,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,Object.freeze(RedMesh),(RedLine=function(e,t){if(!(this instanceof RedLine))return new RedLine(e,t);var r,n,i,a,o;e instanceof RedGL||RedGLUtil.throwFunc("RedLine : RedGL Instance만 허용됩니다.",e),t instanceof RedColorMaterial||RedGLUtil.throwFunc("RedLine : RedColorMaterial Instance만 허용됩니다."),n=[],i=[],this._UUID=RedGL.makeUUID(),a=RedBuffer(e,"RedLine_InterleaveBuffer_"+this._UUID,RedBuffer.ARRAY_BUFFER,new Float32Array(n),[RedInterleaveInfo("aVertexPosition",3)]),o=RedBuffer(e,"RedLine_indexBuffer_"+this._UUID,RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(i)),this.addPoint=function(e,t,r){var a=n.length/3;n.push(e,t,r),i.push(a),this.upload()},this.removeAllPoint=function(){n.length=0,i.length=0,this.upload()},this.upload=function(){a.upload(new Float32Array(n)),o.upload(new Uint16Array(i))},r=e.gl,RedBaseObject3D.build.call(this,r),this.geometry=RedGeometry(a,o),this.material=t,this.drawMode=r.LINE_STRIP}).prototype=new RedBaseContainer,Object.freeze(RedLine),(RedSkyBox=function(e,t){if(!(this instanceof RedSkyBox))return new RedSkyBox(e,t);e instanceof RedGL||RedGLUtil.throwFunc("RedSkyBox : RedGL Instance만 허용됩니다.",e),RedBaseObject3D.build.call(this,e.gl),this.geometry=RedBox(e),this.material=RedSkyBoxMaterial(e,RedBitmapCubeTexture(e,t)),this.cullFace=e.gl.FRONT,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseObject3D,Object.freeze(RedSkyBox),(RedSprite3D=function(e,t){if(!(this instanceof RedSprite3D))return new RedSprite3D(e,t);var r;e instanceof RedGL||RedGLUtil.throwFunc("RedSprite3D : RedGL Instance만 허용됩니다.",e),r=e.gl,RedBaseObject3D.build.call(this,r),this.geometry=RedPlane(e,1,1,0),this.material=t,this.perspectiveScale=!0,this._sprite3DYn=!0,this.useCullFace=!1,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,Object.freeze(RedSprite3D),(RedPointUnit=function(e,t,r,n){if(!(this instanceof RedPointUnit))return new RedPointUnit(e,t,r,n);var i,a;i=e.gl,RedBaseObject3D.build.call(this,i),this._UUID=RedGL.makeUUID(),a=RedBuffer(e,"RedPointUnit_"+this._UUID,RedBuffer.ARRAY_BUFFER,t,r),this.geometry=RedGeometry(a),this.material=n,this.drawMode=i.POINTS,this.useDepthMask=!1}).prototype=new RedBaseContainer,Object.freeze(RedPointUnit),RedParticleUnit=function(e){this.startTime=null,this.age=0,this.lifeTime=2==e.length?Math.random()*(e[1]-e[0])+e[0]:e[0],this.scaleUp=.5,this.movementX=.1*(Math.random()-.5),this.movementY=.1*(Math.random()-.5),this.movementZ=.1*(Math.random()-.5),this.gravityVelocity=0},Object.freeze(RedParticleUnit),function(){var e,t,r,n,i;(RedParticleEmitter=function(e,t,r){if(!(this instanceof RedParticleEmitter))return new RedPointUnit(e,r);RedBaseObject3D.build.call(this,e.gl),this.autoUpdateMatrix=!1,this.list=[],this._interleaveData=[],this.info=t,this.geometry=RedGeometry(RedBuffer(e,"RedParticleEmitter_Buffer"+RedGL.makeUUID(),RedBuffer.ARRAY_BUFFER,new Float32Array(this._interleaveData),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aPointSize",1),RedInterleaveInfo("aVertexColor",4)])),this.material=r,this.drawMode=e.gl.POINTS,this.blendSrc=e.gl.SRC_ALPHA,this.blendDst=e.gl.ONE,this.useDepthMask=!1,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,RedParticleEmitter.prototype.update=function(a){if((e=this.list.length)<this.info.max)for((t=this.info.emitCount)+e>this.info.max&&(t=this.info.max-e);t--;)this.list[e+t]=new RedParticleUnit(this.info.lifeTime),this._interleaveData.push(this.x,this.y,this.z),this._interleaveData.push(0),this._interleaveData.push(Math.random(),Math.random(),Math.random(),1);for(e=this.list.length;e--;)(r=this.list[e]).startTime||(r.startTime=a,r.age=0),r.age=a-r.startTime,n=r.age/r.lifeTime,i=8*e,n<1?(r.scaleVelocity+=-this.info.scaleVelocity*r.age/1e3,r.gravityVelocity+=-this.info.gravity*r.age/1e3,this._interleaveData[i+0]+=r.movementX,this._interleaveData[i+1]+=r.movementY+r.gravityVelocity,this._interleaveData[i+2]+=r.movementZ,this._interleaveData[i+3]+=r.scaleUp,this._interleaveData[i+7]=1-n):(this._interleaveData[i+0]=this.x,this._interleaveData[i+1]=this.y,this._interleaveData[i+2]=this.z,this._interleaveData[i+3]=0,this._interleaveData[i+7]=0,r.gravityVelocity=0,r.startTime=null,r.age=-1);this.geometry.interleaveBuffer.upload(new Float32Array(this._interleaveData))},Object.freeze(RedParticleEmitter)}(),function(){var e,t,r;r=function(e,r,n,i,a,o,s,d,f,c,u,h){var l,R,m=d/u,p=f/h,E=d/2,_=f/2,g=c/2,P=u+1,M=h+1,y=0,v=[];for(R=0;R<M;R++){var b=R*p-_;for(l=0;l<P;l++){var U=l*m-E;v[n]=U*o,v[i]=b*s,v[a]=g,e.push(v.x,v.y,v.z),v[n]=0,v[i]=0,v[a]=c>0?1:-1,e.push(v.x,v.y,v.z),e.push(l/u,1-R/h),y+=1}}for(R=0;R<h;R++)for(l=0;l<u;l++){var L=t+l+P*R,T=t+l+P*(R+1),w=t+(l+1)+P*(R+1),I=t+(l+1)+P*R;r.push(L,T,I,T,w,I),6}t+=y},e=function(e,n,i,a,o,s,d,f){var c=[],u=[];return t=0,r(c,u,"z","y","x",-1,-1,o,a,i,f,d),r(c,u,"z","y","x",1,-1,o,a,-i,f,d),r(c,u,"x","z","y",1,1,i,o,a,s,f),r(c,u,"x","z","y",1,-1,i,o,-a,s,f),r(c,u,"x","y","z",1,-1,i,a,o,s,d),r(c,u,"x","y","z",-1,-1,i,a,-o,s,d),{interleaveData:c,indexData:u,type:n,interleaveBuffer:RedBuffer(e,n+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(c),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,n+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(u))}},(RedBox=function(t,r,n,i,a,o,s){return this instanceof RedBox?(t instanceof RedGL||RedGLUtil.throwFunc("RedBox : RedGL Instance만 허용됩니다.",t),d="RedBox_"+(r=r||1)+"_"+(n=n||1)+"_"+(i=i||1)+"_"+(a=a||1)+"_"+(o=o||1)+"_"+(s=s||1),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[d]?t._datas.Primitives[d]:(t._datas.Primitives[d]=this,f=e(t,d,r,n,i,a,o,s),this.interleaveBuffer=f.interleaveBuffer,this.indexBuffer=f.indexBuffer,void(this._UUID=RedGL.makeUUID()))):new RedBox(t,r,n,i,a,o,s);var d,f}).prototype=RedGeometry.prototype,Object.freeze(RedBox)}(),function(){var e,t,r,n,i,a,o,s,d,f,c,u,h,l,R,m,p;e=function(e,E,_,g,P,M){t=_/2,r=g/2,n=Math.floor(P)||1,i=Math.floor(M)||1,a=n+1,o=i+1,s=_/n,d=g/i;var y=[],v=[];for(c=0;c<o;c++)for(h=c*d-r,f=0;f<a;f++)u=f*s-t,y.push(u,-h,0,0,0,1,f/n,1-c/i);for(c=0;c<i;c++)for(f=0;f<n;f++)l=f+a*c,R=f+a*(c+1),m=f+1+a*(c+1),p=f+1+a*c,v.push(l,R,p,R,m,p);return{interleaveData:y,indexData:v,type:E,interleaveBuffer:RedBuffer(e,E+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(y),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,E+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(v))}},(RedPlane=function(t,r,n,i,a){return this instanceof RedPlane?(t instanceof RedGL||RedGLUtil.throwFunc("RedPlane : RedGL Instance만 허용됩니다.",t),o="RedPlane_"+(r=r||1)+"_"+(n=n||1)+"_"+(i=i||1)+"_"+(a=a||1),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[o]?t._datas.Primitives[o]:(t._datas.Primitives[o]=this,s=e(t,o,r,n,i,a),this.interleaveBuffer=s.interleaveBuffer,this.indexBuffer=s.indexBuffer,void(this._UUID=RedGL.makeUUID()))):new RedPlane(t,r,n,i,a);var o,s}).prototype=RedGeometry.prototype,Object.freeze(RedPlane)}(),function(){var e,t,r,n,i,a,o,s,d,f,c,u;f=[],c=new Float32Array([0,0,0]),u=new Float32Array([0,0,0]),e=function(e,h,l,R,m,p,E,_,g){t=_+g,i=0,f.length=0,c[0]=0,c[1]=0,c[2]=0,u[0]=0,u[1]=0,u[2]=0;var P=[],M=[];for(n=0;n<=m;n++){var y=[],v=n/m;for(r=0;r<=R;r++){var b=r/R;c.x=-l*Math.cos(p+b*E)*Math.sin(_+v*g),c.y=l*Math.cos(_+v*g),c.z=l*Math.sin(p+b*E)*Math.sin(_+v*g),P.push(c.x,c.y,c.z),u[0]=c.x,u[1]=c.y,u[2]=c.z,vec3.normalize(u,u),P.push(u[0],u[1],u[2]),P.push(b,1-v),y.push(i++)}f.push(y)}for(n=0;n<m;n++)for(r=0;r<R;r++)a=f[n][r+1],o=f[n][r],s=f[n+1][r],d=f[n+1][r+1],(0!==n||_>0)&&M.push(a,o,d),(n!==m-1||t<Math.PI)&&M.push(o,s,d);return{interleaveData:P,indexData:M,type:h,interleaveBuffer:RedBuffer(e,h+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(P),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,h+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(M))}},(RedSphere=function(t,r,n,i,a,o,s,d){return this instanceof RedSphere?(t instanceof RedGL||RedGLUtil.throwFunc("RedPrimitive : RedGL Instance만 허용됩니다.",t),f="RedSphere_"+(r=r||1)+"_"+(n=Math.max(3,Math.floor(n)||8))+"_"+(i=Math.max(2,Math.floor(i)||6))+"_"+(a=void 0!==a?a:0)+"_"+(o=void 0!==o?o:2*Math.PI)+"_"+(s=void 0!==s?s:0)+"_"+(d=void 0!==d?d:Math.PI),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[f]?t._datas.Primitives[f]:(t._datas.Primitives[f]=this,c=e(t,f,r,n,i,a,o,s,d),this.interleaveBuffer=c.interleaveBuffer,this.indexBuffer=c.indexBuffer,void(this._UUID=RedGL.makeUUID()))):new RedSphere(t,r,n,i,a,o,s,d);var f,c}).prototype=RedGeometry.prototype,Object.freeze(RedSphere)}(),function(){var e,t,r,n,i,a,o,s,d,f;r=2,e=function(e,t,r,n){for(s in i=e.createProgram(),e.attachShader(i,r.webglShader),e.attachShader(i,n.webglShader),a=r.parseData.uniform.map,o=n.parseData.uniform.map,a)o[s]&&RedGLUtil.throwFunc("vertexShader와 fragmentShader에 중복된 유니폼 선언이 존재함.","중복선언 : "+s);return e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)||RedGLUtil.throwFunc("RedProgram : 프로그램을 초기화 할 수 없습니다.",e.getProgramInfoLog(i)),i.key=t,i.vShaderKey=r.key,i.fShaderKey=n.key,e.useProgram(i),i},d=function(){},f=function(){},t=function(e,t,i){i.parseData.attribute&&i.parseData.attribute.list.forEach(function(r){var n=new d;n._UUID=RedGL.makeUUID(),n.location=t.getAttribLocation(e.webglProgram,r.name),-1==n.location&&(n.msg="쉐이더 main 함수에서 사용되고 있지 않음"),n.attributeType=r.attributeType,n.name=r.name,n.enabled=!1,-1!=n.location&&e.attributeLocation.push(n),e.attributeLocation[r.name]=n}),i.parseData.uniform&&i.parseData.uniform.list.forEach(function(i){var a,o,s,d=new f;switch(d._UUID=RedGL.makeUUID(),d.location=t.getUniformLocation(e.webglProgram,i.name),d.uniformType=i.uniformType,a=i.arrayNum,i.uniformType){case"sampler2D":o="sampler2D",s="uniform1i",d.samplerIndex=r,++r==n&&(r=2);break;case"samplerCube":o="samplerCube",s="uniform1i",d.samplerIndex=r,++r==n&&(r=2);break;case"float":o="float",s=a?"uniform1fv":"uniform1f";break;case"int":o="int",s=a?"uniform1iv":"uniform1i";break;case"mat4":o="mat",s="uniformMatrix4fv";break;case"mat3":o="mat",s="uniformMatrix3fv";break;case"mat2":o="mat",s="uniformMatrix2fv";break;case"vec4":o="vec",s="uniform4fv";break;case"vec3":o="vec",s="uniform3fv";break;case"vec2":o="vec",s="uniform2fv";break;case"ivec4":o="vec",s="uniform4iv";break;case"ivec3":o="vec",s="uniform3iv";break;case"ivec2":o="vec",s="uniform2iv";break;case"bvec4":o="vec",s="uniform4iv";break;case"bvec3":o="vec",s="uniform3iv";break;case"bvec2":o="vec",s="uniform2iv";break;case"bool":o="bool",s=a?"uniform1iv":"uniform1i"}d.renderType=o,d.renderMethod=s,d.name=i.name,d.materialPropertyName=i.name.charAt(1).toLowerCase()+i.name.substr(2),d.arrayNum=i.arrayNum,d.location||(d.msg="쉐이더 main 함수에서 사용되고 있지 않음"),i.systemUniformYn?(d.location&&e.systemUniformLocation.push(d),e.systemUniformLocation[i.name]=d):(d.location&&e.uniformLocation.push(d),e.uniformLocation[i.name]=d)})},(RedProgram=function(r,i,a,o){var s,d,f;return this instanceof RedProgram?(r instanceof RedGL||RedGLUtil.throwFunc("RedProgram : RedGL Instance만 허용됩니다.","입력값 : "+r),"string"!=typeof i&&RedGLUtil.throwFunc("RedProgram : key - 문자열만 허용됩니다.","입력값 : "+i),s=r.gl,r._datas.RedProgram||(r._datas.RedProgram={}),RedProgram.hasKey(r,i)?r._datas.RedProgram[i]:(d=a?RedShader(r,i+"_VS",RedShader.VERTEX,a):null,f=o?RedShader(r,i+"_FS",RedShader.FRAGMENT,o):null,d&&f?r._datas.RedProgram[i]=this:RedGLUtil.throwFunc("RedProgram : 신규 생성시 vertexShader, fragmentShader 모두 입력해야함."),this.key=i,this.webglProgram=e(s,i,d,f),this.attributeLocation=[],this.uniformLocation=[],this.systemUniformLocation=[],s.useProgram(this.webglProgram),n=r._detect.MAX_COMBINED_TEXTURE_IMAGE_UNITS,t(this,s,d),t(this,s,f),void(this._UUID=RedGL.makeUUID()))):new RedProgram(r,i,a,o)}).prototype={},RedProgram.hasKey=function(e,t){return e instanceof RedGL||RedGLUtil.throwFunc("RedProgram : RedGL Instance만 허용됩니다.","입력값 : "+e),e._datas.RedProgram||(e._datas.RedProgram={}),!!e._datas.RedProgram[t]},RedProgram.makeProgram=function(e,t,r,n){return r=RedGLUtil.getStrFromComment(r.toString()),n=RedGLUtil.getStrFromComment(n.toString()),RedProgram(e,t,r,n)},Object.freeze(RedProgram)}(),[(RedSystemShaderCode={vShareSource:["attribute vec3 aVertexPosition","attribute vec3 aVertexNormal","attribute vec4 aVertexColor","varying vec3 vVertexNormal","attribute float aPointSize","uniform float uPointSize","attribute vec2 aTexcoord","varying vec2 vTexcoord","uniform vec4 uAtlascoord","uniform float uTime","varying float vTime","uniform vec2 uResolution","varying vec2 vResolution","uniform mat4 uMMatrix","uniform mat4 uNMatrix","uniform mat4 uPMatrix","uniform mat4 uCameraMatrix","uniform bool uSprite3DYn","uniform bool uPerspectiveScale","uniform mat4 uDirectionalShadowLightMatrix"],fShareSource:["varying vec3 vVertexNormal","varying vec2 vTexcoord","varying float vTime","varying vec2 vResolution","uniform bool uUseFog","uniform float uFogDistance","uniform float uFogDensity","uniform vec4 uFogColor","const int cDIRETIONAL_MAX = 3","uniform vec3 uDirectionalLightPosition[3]","uniform vec4 uDirectionalLightColor[3]","uniform float uDirectionalLightIntensity[3]","uniform int uDirectionalLightNum","const int cPOINT_MAX = 5","uniform vec3 uPointLightPosition[5]","uniform vec4 uPointLightColor[5]","uniform float uPointLightRadius[5]","uniform float uPointLightIntensity[5]","uniform int uPointLightNum","uniform vec4 uAmbientLightColor","uniform float uAmbientIntensity","uniform sampler2D uDirectionalShadowTexture","uniform bool uUseDirectionalShadow"],systemUniform:{}}).vShareSource,RedSystemShaderCode.fShareSource].forEach(function(e){e.forEach(function(e){"uniform"==(e=e.split(" "))[0]&&(RedSystemShaderCode.systemUniform[e[2]]=1)})}),Object.freeze(RedSystemShaderCode),function(){var e,t,r,n,i,a,o,s;e=function(e,t,r){switch(r){case RedShader.VERTEX:return(i=e.createShader(e.VERTEX_SHADER))||(e.isContextLost()?RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - WebGL 컨텍스트가 손실"):RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - GPU메모리가 부족일 가능성이 큼")),i.key=t,i.type=r,i;case RedShader.FRAGMENT:return(i=e.createShader(e.FRAGMENT_SHADER))||(e.isContextLost()?RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - WebGL 컨텍스트가 손실"):RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - GPU메모리가 부족일 가능성이 큼")),i.key=t,i.type=r,i;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요. RedShader.VERTEX or RedShader.FRAGMENT 만 허용됩니다")}},t=function(e,t,r,n){e.shaderSource(r,n.lastSource),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)||RedGLUtil.throwFunc("RedShader : 쉐이더 컴파일에 실패하였습니다.\n",e.getShaderInfoLog(r))},n=function(e,t){var r;switch(e){case RedShader.VERTEX:r=RedSystemShaderCode.vShareSource.concat();break;case RedShader.FRAGMENT:r=RedSystemShaderCode.fShareSource.concat();break;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요. RedShader.VERTEX or RedShader.FRAGMENT 만 허용됩니다")}return t.forEach(function(e){e=e.replace(";",""),-1==r.indexOf(e)?r.push(e):RedGLUtil.throwFunc("RedShader : ","\n1. 중복 선언 이거나","\n2. RedSystemShaderCode에 정의된 선언\n","입력값 : "+e)}),r},r=function(e,t){return t=(t=t.replace(/\s+$/,"")).replace(/  /g,"").trim(),a={etc:{list:[],map:{},source:""}},o=t.match(/attribute[\s\S]+?\;|uniform[\s\S]+?\;|varying[\s\S]+?\;|const[\s\S]+?\;|precision[\s\S]+?\;/g),(o=n(e,o=o||[])).sort(),o.forEach(function(e){var r,n,i,o,s,d,f,c,u;if(e=e.trim(),t=t.replace(e+";",""),("highp"==(r=e.split(" "))[1]||"mediump"==r[1]||"lowp"==r[1])&&(u=r[1],r.splice(1,1),r.push(u),c=u),r[2])switch(n=r[0],o=r[1],i=r[2].replace(";","").split("["),d=(d=e.split("="))[1]?d[1].trim().replace(";",""):null,s=i.length>1?+i[1].split("]")[0]:0,i=i[0],n){case"precision":break;case"attribute":"a"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : attribute의 첫글자는 a로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : attribute의 두번째 글자는 대문자 시작해야합니다.",i);break;case"uniform":"u"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : uniform의 첫글자는 u로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : uniform의 두번째 글자는 대문자 시작해야합니다.",i);break;case"varying":"v"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : varying의 첫글자는 v로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : varying의 두번째 글자는 대문자 시작해야합니다.",i);break;case"const":"c"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : const의 첫글자는 c로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : const의 두번째 글자는 대문자 시작해야합니다.",i)}else n="var",o=r[0],s=(i=r[1].replace(";","").split("[")).length>1?+i[1].split("]")[0]:0,i=i[0];a[n]||(a[n]={},a[n].list=[],a[n].map={},a[n].source=""),f={name:i,arrayNum:s,value:d,precision:c,systemUniformYn:!!RedSystemShaderCode.systemUniform[s?i+"["+s+"]":i]},"uniform"==n&&(f.uniformType=o),"attribute"==n&&(f.attributeType=o),"varying"==n&&(f.varyingType=o),a[n].list.push(f),a[n].map[i]=e,a[n].source+=e+";\n"}),[t+="\n"].forEach(function(e){var t=e.split(" "),r=t[1].replace(/\([\s\S]+/g,"").trim();a.etc.list.push({uniformType:t[0],name:r}),a.etc.map[r]=e,a.etc.source+=e+"\n"}),s="",a.precision&&(s+=a.precision.source+"\n//attribute\n"),a.const&&(s+=a.const.source+"\n//const\n"),a.attribute&&(s+=a.attribute.source+"\n//uniform\n"),a.uniform&&(s+=a.uniform.source+"\n//varying\n"),a.varying&&(s+=a.varying.source+"\n//var\n"),a.var&&(s+=a.var.source+"\n//etc\n"),a.etc&&(s+=a.etc.source),a.lastSource=s,e!=RedShader.FRAGMENT||a.precision||RedGLUtil.throwFunc("RedShader : FRAGMENT Shader는 precision를 반드시 선언해야함"),a},(RedShader=function(n,i,a,o){var s;if(!(this instanceof RedShader))return new RedShader(n,i,a,o);if(n instanceof RedGL||RedGLUtil.throwFunc("RedShader : RedGL Instance만 허용됩니다.","입력값 : "+n),"string"!=typeof i&&RedGLUtil.throwFunc("RedShader : key - 문자열만 허용됩니다.","입력값 : "+i),a!=RedShader.VERTEX&&a!=RedShader.FRAGMENT&&RedGLUtil.throwFunc("RedShader : type - RedShader.VERTEX or RedShader.FRAGMENT 만 허용됩니다.","입력값 : "+a),n._datas.RedShader||(n._datas.RedShader={},n._datas.RedShader[RedShader.VERTEX]={},n._datas.RedShader[RedShader.FRAGMENT]={}),o)"string"!=typeof o&&RedGLUtil.throwFunc("RedShader : source - 문자열만 허용됩니다."),RedShader.hasKey(n,i,a)?RedGLUtil.throwFunc("RedShader : key - 이미 정의된 키로 생성을 시도.","\n키 :",i,"\n타입 :"+a):n._datas.RedShader[a][i]=this;else{if(RedShader.hasKey(n,i,a))return n._datas.RedShader[a][i];RedGLUtil.throwFunc("RedShader : "+a+" 타입에 존재하지 않는 key를 검색하려고합니다.","입력값 : "+i)}s=n.gl,this.webglShader=e(s,i,a),this.parseData=r(a,o),t(s,0,this.webglShader,this.parseData),this.key=i,this.type=a,this._UUID=RedGL.makeUUID()}).hasKey=function(e,t,r){return!!e._datas.RedShader[r][t]},RedShader.FRAGMENT="fragmentShader",RedShader.VERTEX="vertexShader",Object.freeze(RedShader)}(),function(){var e,t,r,n,i,a,o,s,d,f;(RedRenderer=function(){if(!(this instanceof RedRenderer))return new RedRenderer;this.world=null,this._tickKey=null,this._callback=null,this._UUID=RedGL.makeUUID(),this.renderInfo={},this.cacheUniformInfo=[],this.cacheAttrInfo=[],this.cacheSamplerIndex=[],this.cacheTexture=[],this.cacheState=[],this.cacheSystemUniformInfo=[],this.renderDebuger=RedRenderDebuger(),this.worldRect=[],this._glInitialized=!1}).prototype={start:(e=function(n){t.worldRender(r,n),t._callback&&t._callback(n),t._tickKey=requestAnimationFrame(e)},function(n,i){n instanceof RedGL||RedGLUtil.throwFunc("RedGL Instance만 허용"),n.world instanceof RedWorld||RedGLUtil.throwFunc("RedWorld Instance만 허용"),(t=this).world=n.world,r=n,t._tickKey=requestAnimationFrame(e),t._callback=i}),render:function(e,t){e instanceof RedGL||RedGLUtil.throwFunc("RedGL Instance만 허용"),this.worldRender(e,t),this.world=e.world},stop:function(){cancelAnimationFrame(this._tickKey)}},RedRenderer.prototype.worldRender=function(){var e,t,r,o,s,d,f,c,u,h,l,R,m,p,E,_,g,P,M,y,v,b,U,L,T,w;return f=[],o=function(t){return t.forEach(function(r,n){"number"==typeof t[n]?t[n]=r:t[n]=n<2?e[n+2]*parseFloat(t[n])/100:e[n]*parseFloat(t[n])/100}),t},w={uTime:0,uResolution:[0,0],uUseFog:!1,uFogDensity:0,uFogColor:[0,0,0,0],uFogDistance:0,uCameraMatrix:null,uPMatrix:null,uAmbientLightColor:[0,0,0,0],uAmbientIntensity:1,uDirectionalLightPosition:[],uDirectionalLightColor:[],uDirectionalLightIntensity:[],uDirectionalLightNum:[],uPointLightPosition:[],uPointLightColor:[],uPointLightIntensity:[],uPointLightRadius:[],uPointLightNum:[],uDirectionalShadowTexture:!1},s=function(e,t,r,i,a){for(var o in h=e.gl,f.length=0,e._datas.RedProgram){var s,d,I,x,A;if(c=e._datas.RedProgram[o],h.useProgram(c.webglProgram),n=c._UUID,u=c.systemUniformLocation,l=u.uDirectionalShadowLightMatrix,R=l.location,m=l._UUID,R&&(s=mat4.create(),r.shadowManager._directionalShadow&&(d=r.shadowManager._directionalShadow.size,A=r.shadowManager._directionalShadow._light,I=mat4.ortho([],-d,d,-d,d,-d,d),x=vec3.create(),A&&(vec3.set(x,-A.x,-A.y,-A.z),vec3.normalize(x,x),mat4.lookAt(s,x,[0,0,0],[0,1,0]),mat4.multiply(s,I,s),h.uniformMatrix4fv(R,!1,s)))),(l=u.uDirectionalShadowTexture)&&(R=l.location)){m=l._UUID,T=r.shadowManager._directionalShadow?r.shadowManager.directionalShadow.frameBuffer.texture:e._datas.emptyTexture["2d"];var D=l.samplerIndex;h.activeTexture(h.TEXTURE0+D),h.bindTexture(h.TEXTURE_2D,T.webglTexture),h[l.renderMethod](R,D)}for(w.uUseDirectionalShadow=!!r.shadowManager._directionalShadow,w.uTime=t,w.uResolution[0]=a[2],w.uResolution[1]=a[3],w.uUseFog=!!r.useFog,w.uFogDensity=r.fogDensity,w.uFogColor[0]=r._fogR,w.uFogColor[1]=r._fogG,w.uFogColor[2]=r._fogB,w.uFogColor[3]=1,w.uFogDistance=r.fogDistance,w.uCameraMatrix=i.matrix,w.uPMatrix=i.perspectiveMTX,(U=r._lightInfo[RedAmbientLight.type])&&(w.uAmbientLightColor=U._color,w.uAmbientIntensity=U._intensity),y=vec3.create(),E=new Float32Array(9),_=new Float32Array(12),g=new Float32Array(3),b=r._lightInfo[RedDirectionalLight.type],v=b.length;v--;)U=b[v],vec3.set(y,U.x,U.y,U.z),U.debug&&((L=U.debugObject).x=y[0],L.y=y[1],L.z=y[2],L._material._color=U._color,f.push(L)),(l=u.uDirectionalLightPosition)&&(R=l.location)&&(vec3.normalize(y,y),E[0+3*v]=y[0],E[1+3*v]=y[1],E[2+3*v]=y[2]),(l=u.uDirectionalLightColor)&&(R=l.location)&&(_[0+4*v]=U._color[0],_[1+4*v]=U._color[1],_[2+4*v]=U._color[2],_[3+4*v]=U._color[3]),l&&(l=u.uDirectionalLightIntensity,(R=l.location)&&(g[v]=U._intensity));for(w.uDirectionalLightPosition=E,w.uDirectionalLightColor=_,w.uDirectionalLightIntensity=g,w.uDirectionalLightNum=b.length,y=vec3.create(),P=new Float32Array(15),_=new Float32Array(20),g=new Float32Array(5),M=new Float32Array(5),b=r._lightInfo[RedPointLight.type],v=b.length;v--;)U=b[v],vec3.set(y,U.x,U.y,U.z),U.debug&&((L=U.debugObject).x=y[0],L.y=y[1],L.z=y[2],L.scaleX=L.scaleY=L.scaleZ=U._radius,L._material._color=U._color,f.push(L)),l=u.uPointLightPosition,(R=l.location)&&(P[0+3*v]=y[0],P[1+3*v]=y[1],P[2+3*v]=y[2]),l=u.uPointLightColor,(R=l.location)&&(_[0+4*v]=U._color[0],_[1+4*v]=U._color[1],_[2+4*v]=U._color[2],_[3+4*v]=U._color[3]),l=u.uPointLightIntensity,(R=l.location)&&(g[v]=U._intensity),l=u.uPointLightRadius,(R=l.location)&&(M[v]=U._radius);for(var B in w.uPointLightPosition=P,w.uPointLightColor=_,w.uPointLightIntensity=g,w.uPointLightRadius=M,w.uPointLightNum=b.length,w)(l=u[B])&&(R=l.location,m=l._UUID,T=w[B],p=JSON.stringify(T),R&&this.cacheSystemUniformInfo[m]!=p&&("mat"==l.renderType?h[l.renderMethod](R,!1,T):h[l.renderMethod](R,T),this.cacheSystemUniformInfo[m]=p))}return f},d=function(e){e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.frontFace(e.CCW),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.enable(e.SCISSOR_TEST),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0)},function(n,c){var u,h,l;u=n.gl,e=(r=this).worldRect,r.worldRect[0]=0,r.worldRect[1]=0,r.worldRect[2]=u.drawingBufferWidth,r.worldRect[3]=u.drawingBufferHeight,u.viewport(0,0,u.drawingBufferWidth,u.drawingBufferHeight),u.scissor(0,0,u.drawingBufferWidth,u.drawingBufferHeight),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT),r._glInitialized||(d(u),r._glInitialized=!0),r.renderInfo={},r.cacheAttrInfo.length=0,r.world._viewList.forEach(function(d){(h=d._viewRect)[0]=d._x,h[1]=d._y,h[2]=d._width,h[3]=d._height,i=d.camera,a=d.scene,o(h),l=r.renderInfo[d.key]={orthographicYn:i.orthographicYn,x:d._x,y:d._y,width:d._width,height:d._height,viewRectX:h[0],viewRectY:h[1],viewRectWidth:h[2],viewRectHeight:h[3],key:d.key,call:0},u.viewport(h[0],e[3]-h[3]-h[1],h[2],h[3]),u.scissor(h[0],e[3]-h[3]-h[1],h[2],h[3]),a.useBackgroundColor?(u.clearColor(a._r,a._g,a._b,1),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT)):(u.clearColor(0,0,0,0),u.clear(u.DEPTH_BUFFER_BIT)),i instanceof RedCamera||(i.update(),i=i.camera),i.autoUpdateMatrix&&i.update(),t=i.perspectiveMTX,mat4.identity(t),i.orthographicYn?(mat4.ortho(t,-.5,.5,-.5,.5,-i.farClipping,i.farClipping),mat4.translate(t,t,[-.5,.5,0]),mat4.scale(t,t,[1/h[2],-1/h[3],1]),mat4.identity(i.matrix),u.disable(u.CULL_FACE),r.cacheState.useCullFace=!1):(mat4.perspective(t,i.fov*Math.PI/180,h[2]/h[3],i.nearClipping,i.farClipping),u.enable(u.CULL_FACE),r.cacheState.useCullFace=!0),u.depthMask(r.cacheState.useDepthMask=!0),a.shadowManager._directionalShadow&&(s.apply(r,[n,c,a,i,h]),u.enable(u.BLEND),u.blendFunc(u.ONE,u.ONE),r.cacheState.useBlendMode=!0,r.cacheState.blendSrc=u.ONE,r.cacheState.blendDst=u.ONE,a.shadowManager.render(n,r,d,c,l),u.enable(u.BLEND),u.blendFunc(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA),r.cacheState.useBlendMode=!0,r.cacheState.blendSrc=u.SRC_ALPHA,r.cacheState.blendDst=u.ONE_MINUS_SRC_ALPHA),a.postEffectManager.postEffectList.length&&(a.postEffectManager.bind(u),mat4.perspective(t,i.fov*Math.PI/180,a.postEffectManager.frameBuffer.width/a.postEffectManager.frameBuffer.height,i.nearClipping,i.farClipping),u.viewport(0,0,a.postEffectManager.frameBuffer.width,a.postEffectManager.frameBuffer.height),u.scissor(0,0,a.postEffectManager.frameBuffer.width,a.postEffectManager.frameBuffer.height)),s.apply(r,[n,c,a,i,h]),a.skyBox&&(a.skyBox.scaleX=a.skyBox.scaleY=a.skyBox.scaleZ=i.farClipping,r.sceneRender(n,u,i.orthographicYn,[a.skyBox],c,l),u.clear(u.DEPTH_BUFFER_BIT)),a.grid&&r.sceneRender(n,u,i.orthographicYn,[a.grid],c,l),r.sceneRender(n,u,i.orthographicYn,a.children,c,l),a.axis&&r.sceneRender(n,u,i.orthographicYn,a.axis.children,c,l),f.length&&r.sceneRender(n,u,i.orthographicYn,f,c,l),a.postEffectManager.postEffectList.length&&a.postEffectManager.render(n,u,r,d,c,l)}),this.renderDebuger.visible&&this.renderDebuger.update(n,r.renderInfo)}}(),RedRenderer.prototype.sceneRender=(o=function(e,t,r,a,c,u,h,l,R,m,p,E,_){var g,P,M,y,v,b,U,L,T,w,I,x,A,D,B,G,F,S,C,O,N,k,j,X,Y,z,V,Z,H,W,q,J,Q,K,$,ee,te,re,ne,ie,ae,oe,se,de,fe,ce,ue,he,le,Re,me,pe,Ee,_e,ge,Pe,Me,ye,ve,be,Ue,Le,Te,we,Ie,xe,Ae,De,Be,Ge,Fe,Se,Ce,Oe,Ne,ke,je,Xe,Ye,ze,Ve,Ze,He,We,qe,Je,Qe,Ke,$e,et,tt,rt,nt,it,at,ot,st,dt,ft,ct,ut,ht,lt,Rt,mt,pt,Et,_t=a?-1:1;for(M=Float32Array.BYTES_PER_ELEMENT,y=Math.PI/180,lt=3.141592653589793,Rt=6.283185307179586,mt=1.27323954,pt=.405284735,Et=1.5707963267948966,f=null,g=r.length,H=[i.x,i.y,i.z];g--;){if(u.call++,k=(v=r[g]).matrix,v.useLOD){var gt=H[0]-v.x,Pt=H[1]-v.y,Mt=H[2]-v.z,yt=Math.abs(Math.sqrt(gt*gt+Pt*Pt+Mt*Mt));for(var vt in L=v._lodLevels)(W=L[vt]).distance<yt&&(v._geometry=W.geometry,v._material=W.material)}if(j=v.normalMatrix,b=v._geometry,V=v._sprite3DYn,b){if(Z=(U=_||v._material)instanceof RedDirectionalShadowMaterial,U instanceof RedSheetMaterial){if(U._nextFrameTime||(U._nextFrameTime=U._perFrameTime+c),U._playYn&&U._nextFrameTime<c){var bt=parseInt((c-U._nextFrameTime)/U._perFrameTime);bt=bt||1,U._nextFrameTime=U._perFrameTime+c,U.currentIndex+=bt,U.currentIndex>=U.totalFrame&&(U._loop?(U._playYn=!0,U.currentIndex=0):(U._playYn=!1,U.currentIndex=U.totalFrame-1))}U._sheetRect[0]=1/U._segmentW,U._sheetRect[1]=1/U._segmentH,U._sheetRect[2]=U.currentIndex%U._segmentW/U._segmentW,U._sheetRect[3]=Math.floor(U.currentIndex/U._segmentH)/U._segmentH}for(n!=U.program._UUID&&t.useProgram(U.program.webglProgram),n=U.program._UUID,w=U.program.attributeLocation,I=U.program.uniformLocation,x=U.program.systemUniformLocation,S=b.interleaveBuffer,C=b.indexBuffer,T=S.interleaveDefineInfoList,X=S._UUID,P=w.length;P--;)A=T[(B=w[P]).name],d!=X&&t.bindBuffer(t.ARRAY_BUFFER,S.webglBuffer),d=X,B&&A&&h[F=B.location]!=A._UUID&&(!B.enabled&&(t.enableVertexAttribArray(F),B.enabled=!0),t.vertexAttribPointer(F,A.size,S.glArrayType,A.normalize,S.stride*M,A.offset*M),h[F]=A._UUID);for(P=I.length;P--;)G=(D=I[P]).location,X=D._UUID,N=D.renderType,O=U[D.materialPropertyName],Y=l[X]==O,"sampler2D"==N||"samplerCube"==N?(z=D.samplerIndex,O?(m[z]&&m[z]==O._UUID||(f!=z&&t.activeTexture(t.TEXTURE0+(f=z)),O._videoDom?(t.bindTexture(t.TEXTURE_2D,O.webglTexture),O._videoDom.loaded?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,O._videoDom):t.bindTexture(t.TEXTURE_2D,O.webglTexture)):t.bindTexture("sampler2D"==N?t.TEXTURE_2D:t.TEXTURE_CUBE_MAP,O.webglTexture),R[X]!=z&&t[D.renderMethod](G,R[X]=z),t[D.renderMethod](G,R[X]=z),m[z]=O._UUID),x.uAtlascoord.location&&l[X=x.uAtlascoord._UUID]!=O.atlascoord.data._UUID&&(t.uniform4fv(x.uAtlascoord.location,O.atlascoord.data),l[X]=O.atlascoord.data._UUID)):"sampler2D"==N?0==m[z]||(0!=f&&t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e._datas.emptyTexture["2d"].webglTexture),0!=R[X]&&t[D.renderMethod](G,R[X]=0),m[z]=0,f=0):1==m[z]||(1!=f&&t.activeTexture(t.TEXTURE0+1),t.bindTexture(t.TEXTURE_CUBE_MAP,e._datas.emptyTexture["3d"].webglTexture),1!=R[X]&&t[D.renderMethod](G,R[X]=1),m[z]=1,f=1)):(void 0==O&&RedGLUtil.throwFunc("RedRenderer : Material에 ",D.materialPropertyName,"이 정의 되지않았습니다."),"float"==N?!Y&&t[D.renderMethod](G,(l[X]=O.length?null:O,O)):"int"==N?!Y&&t[D.renderMethod](G,(l[X]=O.length?null:O,O)):"bool"==N?!Y&&t[D.renderMethod](G,(l[X]=O.length?null:O,O)):"vec"==N?t[D.renderMethod](G,O):"mat"==N?t[D.renderMethod](G,!1,O):RedGLUtil.throwFunc("RedRenderer : 처리할수없는 타입입니다.","tRenderType -",N))}v.autoUpdateMatrix&&(k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,q=k,Ge=v.x,Fe=v.y,Se=v.z,q[12]=q[0]*Ge+q[4]*Fe+q[8]*Se+q[12],q[13]=q[1]*Ge+q[5]*Fe+q[9]*Se+q[13],q[14]=q[2]*Ge+q[6]*Fe+q[10]*Se+q[14],q[15]=q[3]*Ge+q[7]*Fe+q[11]*Se+q[15],V?(re=0*y,ne=0*y,ie=0):(re=v.rotationX*y,ne=v.rotationY*y,ie=v.rotationZ*y),(ht=re%Rt)<-lt?ht+=Rt:ht>lt&&(ht-=Rt),J=(ht=ht<0?mt*ht+pt*ht*ht:mt*ht-pt*ht*ht)<0?.225*(ht*-ht-ht)+ht:.225*(ht*ht-ht)+ht,(ht=(re+Et)%Rt)<-lt?ht+=Rt:ht>lt&&(ht-=Rt),$=(ht=ht<0?mt*ht+pt*ht*ht:mt*ht-pt*ht*ht)<0?.225*(ht*-ht-ht)+ht:.225*(ht*ht-ht)+ht,(ht=ne%Rt)<-lt?ht+=Rt:ht>lt&&(ht-=Rt),Q=(ht=ht<0?mt*ht+pt*ht*ht:mt*ht-pt*ht*ht)<0?.225*(ht*-ht-ht)+ht:.225*(ht*ht-ht)+ht,(ht=(ne+Et)%Rt)<-lt?ht+=Rt:ht>lt&&(ht-=Rt),ee=(ht=ht<0?mt*ht+pt*ht*ht:mt*ht-pt*ht*ht)<0?.225*(ht*-ht-ht)+ht:.225*(ht*ht-ht)+ht,(ht=ie%Rt)<-lt?ht+=Rt:ht>lt&&(ht-=Rt),K=(ht=ht<0?mt*ht+pt*ht*ht:mt*ht-pt*ht*ht)<0?.225*(ht*-ht-ht)+ht:.225*(ht*ht-ht)+ht,(ht=(ie+Et)%Rt)<-lt?ht+=Rt:ht>lt&&(ht-=Rt),te=(ht=ht<0?mt*ht+pt*ht*ht:mt*ht-pt*ht*ht)<0?.225*(ht*-ht-ht)+ht:.225*(ht*ht-ht)+ht,ae=q[0],oe=q[1],se=q[2],fe=q[4],ce=q[5],ue=q[6],le=q[8],Re=q[9],me=q[10],Ue=ee*te,Le=J*Q*te-$*K,Te=$*Q*te+J*K,we=ee*K,Ie=J*Q*K+$*te,xe=$*Q*K-J*te,Ae=-Q,De=J*ee,Be=$*ee,q[0]=ae*Ue+fe*Le+le*Te,q[1]=oe*Ue+ce*Le+Re*Te,q[2]=se*Ue+ue*Le+me*Te,q[4]=ae*we+fe*Ie+le*xe,q[5]=oe*we+ce*Ie+Re*xe,q[6]=se*we+ue*Ie+me*xe,q[8]=ae*Ae+fe*De+le*Be,q[9]=oe*Ae+ce*De+Re*Be,q[10]=se*Ae+ue*De+me*Be,Ge=v.scaleX,Fe=v.scaleY*_t,Se=v.scaleZ,q[0]=q[0]*Ge,q[1]=q[1]*Ge,q[2]=q[2]*Ge,q[3]=q[3]*Ge,q[4]=q[4]*Fe,q[5]=q[5]*Fe,q[6]=q[6]*Fe,q[7]=q[7]*Fe,q[8]=q[8]*Se,q[9]=q[9]*Se,q[10]=q[10]*Se,q[11]=q[11]*Se,q[12]=q[12],q[13]=q[13],q[14]=q[14],q[15]=q[15],E&&(ae=E[0],oe=E[1],se=E[2],de=E[3],fe=E[4],ce=E[5],ue=E[6],he=E[7],le=E[8],Re=E[9],me=E[10],pe=E[11],Ee=E[12],_e=E[13],ge=E[14],Pe=E[15],Me=k[0],ye=k[1],ve=k[2],be=k[3],k[0]=Me*ae+ye*fe+ve*le+be*Ee,k[1]=Me*oe+ye*ce+ve*Re+be*_e,k[2]=Me*se+ye*ue+ve*me+be*ge,k[3]=Me*de+ye*he+ve*pe+be*Pe,Me=k[4],ye=k[5],ve=k[6],be=k[7],k[4]=Me*ae+ye*fe+ve*le+be*Ee,k[5]=Me*oe+ye*ce+ve*Re+be*_e,k[6]=Me*se+ye*ue+ve*me+be*ge,k[7]=Me*de+ye*he+ve*pe+be*Pe,Me=k[8],ye=k[9],ve=k[10],be=k[11],k[8]=Me*ae+ye*fe+ve*le+be*Ee,k[9]=Me*oe+ye*ce+ve*Re+be*_e,k[10]=Me*se+ye*ue+ve*me+be*ge,k[11]=Me*de+ye*he+ve*pe+be*Pe,Me=k[12],ye=k[13],ve=k[14],be=k[15],k[12]=Me*ae+ye*fe+ve*le+be*Ee,k[13]=Me*oe+ye*ce+ve*Re+be*_e,k[14]=Me*se+ye*ue+ve*me+be*ge,k[15]=Me*de+ye*he+ve*pe+be*Pe)),b&&t.uniformMatrix4fv(x.uMMatrix.location,!1,k),b&&v.autoUpdateMatrix&&x.uNMatrix.location&&(Ce=k[0],Oe=k[1],Ne=k[2],ke=k[3],je=k[4],Xe=k[5],Ye=k[6],ze=k[7],Ve=k[8],Ze=k[9],He=k[10],We=k[11],Je=k[12],Qe=k[13],Ke=k[14],ut=1/(ut=(qe=Ce*Xe-Oe*je)*(ct=He*($e=k[15])-We*Ke)-(et=Ce*Ye-Ne*je)*(ft=Ze*$e-We*Qe)+(tt=Ce*ze-ke*je)*(dt=Ze*Ke-He*Qe)+(rt=Oe*Ye-Ne*Xe)*(st=Ve*$e-We*Je)-(nt=Oe*ze-ke*Xe)*(ot=Ve*Ke-He*Je)+(it=Ne*ze-ke*Ye)*(at=Ve*Qe-Ze*Je)),j[0]=(Xe*ct-Ye*ft+ze*dt)*ut,j[1]=(-Oe*ct+Ne*ft-ke*dt)*ut,j[2]=(Qe*it-Ke*nt+$e*rt)*ut,j[3]=(-Ze*it+He*nt-We*rt)*ut,j[4]=(-je*ct+Ye*st-ze*ot)*ut,j[5]=(Ce*ct-Ne*st+ke*ot)*ut,j[6]=(-Je*it+Ke*tt-$e*et)*ut,j[7]=(Ve*it-He*tt+We*et)*ut,j[8]=(je*ft-Xe*st+ze*at)*ut,j[9]=(-Ce*ft+Oe*st-ke*at)*ut,j[10]=(Je*nt-Qe*tt+$e*qe)*ut,j[11]=(-Ve*nt+Ze*tt-We*qe)*ut,j[12]=(-je*dt+Xe*ot-Ye*at)*ut,j[13]=(Ce*dt-Oe*ot+Ne*at)*ut,j[14]=(-Je*rt+Qe*et-Ke*qe)*ut,j[15]=(Ve*rt-Ze*et+He*qe)*ut,oe=j[1],se=j[2],de=j[3],ue=j[6],he=j[7],pe=j[11],j[1]=j[4],j[2]=j[8],j[3]=j[12],j[4]=oe,j[6]=j[9],j[7]=j[13],j[8]=se,j[9]=ue,j[11]=j[14],j[12]=de,j[13]=he,j[14]=pe),x&&v.autoUpdateMatrix&&x.uNMatrix.location&&t.uniformMatrix4fv(x.uNMatrix.location,!1,j),b&&(x.uPointSize.location&&p.pointSize!=v.pointSize&&t.uniform1f(x.uPointSize.location,p.pointSize=v.pointSize),p.useCullFace!=v.useCullFace&&((p.useCullFace=v.useCullFace)?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE)),p.cullFace!=v.cullFace&&t.cullFace(p.cullFace=v.cullFace),p.useDepthMask!=v.useDepthMask&&t.depthMask(p.useDepthMask=v.useDepthMask),p.useDepthTest!=v.useDepthTest&&((p.useDepthTest=v.useDepthTest)?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)),p.depthTestFunc!=v.depthTestFunc&&t.depthFunc(p.depthTestFunc=v.depthTestFunc),Z||(p.useBlendMode!=v.useBlendMode&&((p.useBlendMode=v.useBlendMode)?t.enable(t.BLEND):t.disable(t.BLEND)),p.blendSrc==v.blendSrc&&p.blendDst==v.blendDst||(t.blendFunc(v.blendSrc,v.blendDst),p.blendSrc=v.blendSrc,p.blendDst=v.blendDst)),x.uSprite3DYn.location&&(O=V,l[X=x.uSprite3DYn._UUID]!=O&&(t[x.uSprite3DYn.renderMethod](x.uSprite3DYn.location,O),l[X]=O),X=x.uPerspectiveScale._UUID,O=v.perspectiveScale,l[X]!=O&&(t[x.uPerspectiveScale.renderMethod](x.uPerspectiveScale.location,O),l[X]=O)),C?(s!=C._UUID&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,C.webglBuffer),t.drawElements(v.drawMode,C.pointNum,C.glArrayType,0),s=C._UUID):t.drawArrays(v.drawMode,0,S.pointNum)),v.children.length&&o(e,t,v.children,a,c,u,h,l,R,m,p,k,_)}},function(e,t,r,n,i,a,s){this.cacheTexture.length=0,o(e,t,n,r,i,a,this.cacheAttrInfo,this.cacheUniformInfo,this.cacheSamplerIndex,this.cacheTexture,this.cacheState,void 0,s)}),Object.freeze(RedRenderer)}(),(RedRenderDebuger=function(){if(!(this instanceof RedRenderDebuger))return new RedRenderDebuger;this.renderResult||(this.renderResult=document.createElement("div"),this._contentBox=document.createElement("div"),this._etcBox=document.createElement("div"),this.renderResult.appendChild(this._contentBox),this.renderResult.appendChild(this._etcBox),this.renderResult.style.cssText="position:absolute;bottom:0px;left:0px;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;background:rgba(0,0,0,0.6);padding:3px;width:300px",this._etcBox.style.cssText="position:relative;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;background:rgba(0,0,0,0.6);padding:3px",this._etcBox.innerHTML='<a href="https://redcamel.github.io/RedGL2/redDoc/index.html" stlye="color:#fff;text-decoration:none">API document</a>'),this._visible=!1}).prototype={update:function(e,t){for(var r in this._contentBox.innerHTML="",t)this._contentBox.innerHTML+='<div style="padding:3px"><div><b>RedView : key - '+t[r].key+"</b></div> orthographicYn - "+t[r].orthographicYn+" <br>call - "+t[r].call+" <br> width - "+t[r].width+" / height - "+t[r].height+" <br> viewRectWidth - "+t[r].viewRectWidth+" / viewRectHeight - "+t[r].viewRectHeight+" <br> x - "+t[r].x+" / y - "+t[r].y+"</div><br>";this._contentBox.innerHTML+='<div style="padding:3px;background:#000">renderScale : '+e.renderScale+"</div>"}},Object.defineProperty(RedRenderDebuger.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible=e,this._visible?document.body.appendChild(this.renderResult):this.renderResult.parentNode&&document.body.removeChild(this.renderResult)}}),Object.freeze(RedRenderDebuger),function(){var e;e={},(RedView=function(t,r,n){if(e[t]){if(!r&&!n)return e[t];RedGLUtil.throwFunc("RedView : "+t,"는 이미 생성된 RedView key입니다.","입력값 : "+t)}if(!(this instanceof RedView))return new RedView(t,r,n);"string"!=typeof t&&RedGLUtil.throwFunc("RedView : key : 문자열만 허용","입력값 : "+t),r||n||RedGLUtil.throwFunc("RedView : 존재하지 않는 key입니다.","입력값 : "+t),!r||r instanceof RedScene||RedGLUtil.throwFunc("RedView : RedScene Instance만 허용","입력값 : "+r),n?n instanceof RedCamera||n instanceof RedBasicController||n instanceof RedObitController||RedGLUtil.throwFunc("RedView : RedCamera or XXController Instance만 허용"):RedGLUtil.throwFunc("RedView : RedCamera or XXController Instance만 허용","입력값 : "+n),this.key=t,this.scene=r,this.camera=n,this._width="100%",this._height="100%",this._x=0,this._y=0,this._viewRect=[0,0,0,0],e[t]=this}).prototype={setSize:function(e,t){this._width=void 0!=e?e:"100%",this._height=void 0!=t?t:"100%"},setLocation:function(e,t){this._x=void 0!=e?e:0,this._y=void 0!=t?t:0}},Object.freeze(RedView)}(),(RedWorld=function(){if(!(this instanceof RedWorld))return new RedWorld;this._viewList=[],this._viewMap={},this._UUID=RedGL.makeUUID()}).prototype={addView:function(e){e instanceof RedView||RedGLUtil.throwFunc("RedWorld :addView Instance만 허용함.","입력값 : "+e),this._viewMap[e.key]=e,this._viewList.push(e)},getView:function(e){return"string"!=typeof e&&RedGLUtil.throwFunc("RedWorld :getView 문자열만 허용함.","입력값 : "+e),this._viewMap[e]},delView:function(e){var t,r;"string"!=typeof e&&RedGLUtil.throwFunc("RedWorld :delView 문자열만 허용함.","입력값 : "+e),(t=this._viewMap[e])&&(r=this._viewList.indexOf(t),this._viewList.splice(r,1),delete this._viewMap[e])},hasView:function(e){return"string"!=typeof e&&RedGLUtil.throwFunc("RedWorld :hasView 문자열만 허용함.","입력값 : "+e),!!this._viewMap[e]},getViewList:function(){return this._viewList.concat()}},Object.freeze(RedWorld),function(){RedScene=function(e,t){if(e instanceof RedGL||RedGLUtil.throwFunc("RedScene : RedGL Instance만 허용됩니다.",e),!(this instanceof RedScene))return new RedScene(e,t);var r,n,i,a,o;Object.defineProperty(this,"backgroundColor",(o="#000000",{get:function(){return o},set:function(e){"string"!=typeof(o=e||"#000000")&&RedGLUtil.throwFunc("RedScene : backgroundColor hex 문자열만 허용함","입력값 : "+o),RedGLUtil.regHex(o)||RedGLUtil.throwFunc("RedScene : backgroundColor hex 형식을 사용해야함","입력값 : "+o),a=RedGLUtil.hexToRGB.call(this,o),this._r=a[0],this._g=a[1],this._b=a[2]}})),this.backgroundColor=t||"#000000",this.useBackgroundColor=!0,this.useFog=!1,this.fogDensity=.5,this.fogDistance=25,Object.defineProperty(this,"fogColor",function(){var e,t="#ffffff";return{get:function(){return t},set:function(r){"string"!=typeof(t=r||"#ffffff")&&RedGLUtil.throwFunc("RedScene : fogColor hex 문자열만 허용함","입력값 : "+t),RedGLUtil.regHex(t)||RedGLUtil.throwFunc("RedScene : fogColor hex 형식을 사용해야함","입력값 : "+t),e=RedGLUtil.hexToRGB.call(this,t),this._fogR=e[0],this._fogG=e[1],this._fogB=e[2]}}}()),this.fogColor="#ffffff",this.children=[],Object.defineProperty(this,"skyBox",{get:function(){return r},set:function(e){return e instanceof RedSkyBox||!e||RedGLUtil.throwFunc("RedScene : RedSkyBox Instance만 허용됩니다."),r=e}}),Object.defineProperty(this,"grid",{get:function(){return n},set:function(e){return e instanceof RedGrid||!e||RedGLUtil.throwFunc("RedScene : RedGrid Instance만 허용됩니다."),n=e}}),Object.defineProperty(this,"axis",{get:function(){return i},set:function(e){return e instanceof RedAxis||!e||RedGLUtil.throwFunc("RedScene : RedAxis Instance만 허용됩니다."),i=e}}),this.postEffectManager=RedPostEffectManager(e),this.shadowManager=RedShadowManager(e),this._lightInfo={RedAmbientLight:null,RedDirectionalLight:[],RedPointLight:[]},this._UUID=RedGL.makeUUID()};var e,t={_r:0,_g:0,_b:0,_fogR:1,_fogG:1,_fogB:1,addLight:function(e){switch(e.type){case RedAmbientLight.type:this._lightInfo[e.type]=e;break;case RedDirectionalLight.type:case RedPointLight.type:this._lightInfo[e.type].push(e);break;default:RedGLUtil.throwFunc("RedScene : RedAmbientLight,RedDirectionalLight,RedPointLight 인스턴스만 가능")}},removeLight:function(t){switch(t.type){case RedAmbientLight.type:this._lightInfo[t.type]==t&&(this._lightInfo[t.type]=null);break;case RedDirectionalLight.type:case RedPointLight.type:(e=this._lightInfo[t.type].indexOf(t))>-1&&this._lightInfo[t.type].splice(e,1);break;default:RedGLUtil.throwFunc("RedScene : RedAmbientLight,RedDirectionalLight,RedPointLight 인스턴스만 가능")}}};for(var r in RedScene.prototype=new RedBaseContainer,t)RedScene.prototype[r]=t[r];RedDefinePropertyInfo.definePrototype("RedScene","fogDensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedScene","fogDistance","number",{min:0}),Object.freeze(RedScene)}(),function(){var e,t;(RedCamera=function(){if(!(this instanceof RedCamera))return new RedCamera;this.x=this.y=this.z=0,this.targetX=this.targetY=this.targetZ=0,this.fov=45,this.nearClipping=.01,this.farClipping=1e4,this.orthographicYn=!1,this.matrix=mat4.create(),this.perspectiveMTX=mat4.create(),this.autoUpdateMatrix=!0,this._UUID=RedGL.makeUUID()}).prototype.update=function(){new Float32Array([0,1,0]);return function(){this.lookAt(this.targetX,this.targetY,this.targetZ)}}(),RedCamera.prototype.lookAt=(e=new Float32Array([0,1,0]),t=[],function(r,n,i){t[0]=this.targetX=r,t[1]=this.targetY=n,t[2]=this.targetZ=i,mat4.identity(this.matrix),mat4.lookAt(this.matrix,[this.x,this.y,this.z],t,e)}),Object.freeze(RedCamera)}(),(RedBasicController=function(e){if(!(this instanceof RedBasicController))return new RedBasicController(e);this.keyBuffer={},this.speed=1,this.delay=.1,this.speedRotation=1,this.delayRotation=.1,this.maxAcceleration=3,Object.defineProperty(this,"x",{get:function(){return this._targetObject.x},set:function(e){this._targetObject.x=e,this._desirePosition[0]=e}}),Object.defineProperty(this,"y",{get:function(){return this._targetObject.y},set:function(e){this._targetObject.y=e,this._desirePosition[1]=e}}),Object.defineProperty(this,"z",{get:function(){return this._targetObject.z},set:function(e){this._targetObject.z=e,this._desirePosition[2]=e}}),Object.defineProperty(this,"tilt",{get:function(){return this._desireTilt},set:function(e){this._targetObject.rotationX=e,this._desireTilt=e}}),Object.defineProperty(this,"pan",{get:function(){return this._desirePan},set:function(e){this._targetObject.rotationY=e,this._desirePan=e}}),this.camera=RedCamera(),this.keyNameMapper={moveForward:"w",moveBack:"s",moveLeft:"a",moveRight:"d",moveUp:"t",moveDown:"g",turnLeft:"q",turnRight:"e",turnUp:"r",turnDown:"f"},this._desirePosition=[0,0,0],this._targetObject=RedMesh(e),this._desirePan=0,this._desireTilt=0,function(t){var r,n,i,a,o,s,d,f,c;s=0,d=0,f=0,c=0,r=function(e){t.keyBuffer[e.key]=1},n=function(e){t.keyBuffer[e.key]=0},i=function(t){s=t.x,d=t.y,e._canvas.addEventListener("mousemove",a),window.addEventListener("mouseup",o)},a=function(e){f=e.x-s,c=e.y-d,s=e.x,d=e.y,t._desirePan-=f*t.speedRotation*.1,t._desireTilt-=c*t.speedRotation*.1},o=function(){e._canvas.removeEventListener("mousemove",a),window.removeEventListener("mouseup",o)},window.addEventListener("keydown",r),window.addEventListener("keyup",n),e._canvas.addEventListener("mousedown",i)}(this)}).prototype.update=function(){var e,t,r,n,i,a,o,s,d,f,c,u,h,l,R,m,p,E;return new Float32Array([0,1,0]),u=mat4.create(),f=mat4.create(),c=mat4.create(),h=vec3.create(),R=0,function(_){e=0,t=0,n=!1,i=!1,a=this.speed,o=this.speedRotation,s=this.delay,d=this.delayRotation,l=this.camera,E=this._desirePosition,m=this.keyBuffer,p=this.keyNameMapper,h[0]=0,h[1]=0,h[2]=0,m[p.turnLeft]&&(i=!0,e=o),m[p.turnRight]&&(i=!0,e=-o),m[p.turnUp]&&(i=!0,t=o),m[p.turnDown]&&(i=!0,t=-o),m[p.moveForward]&&(n=!0,h[2]=-R*a),m[p.moveBack]&&(n=!0,h[2]=R*a),m[p.moveLeft]&&(n=!0,h[0]=-R*a),m[p.moveRight]&&(n=!0,h[0]=R*a),m[p.moveUp]&&(n=!0,h[1]=R*a),m[p.moveDown]&&(n=!0,h[1]=-R*a),i||n?(R+=.1)>this.maxAcceleration&&(R=this.maxAcceleration):(R+=-.1)<0&&(R=0),r=this._targetObject,i&&(this._desirePan+=e,this._desireTilt+=t),r.rotationY+=(this._desirePan-r.rotationY)*d,r.rotationX+=(this._desireTilt-r.rotationX)*d,(n||i)&&(f=r.matrix,mat4.identity(u),mat4.rotateY(u,u,r.rotationY*Math.PI/180),mat4.rotateX(u,u,r.rotationX*Math.PI/180),mat4.translate(u,u,h),mat4.identity(f),mat4.translate(f,f,[r.x,r.y,r.z]),mat4.multiply(f,f,u),E[0]=f[12],E[1]=f[13],E[2]=f[14]),r.x+=(E[0]-r.x)*s,r.y+=(E[1]-r.y)*s,r.z+=(E[2]-r.z)*s,r.rotationY+=(this._desirePan-r.rotationY)*d,r.rotationX+=(this._desireTilt-r.rotationX)*d,f=r.matrix,mat4.identity(f),mat4.translate(f,f,[r.x,r.y,r.z]),mat4.rotateY(f,f,r.rotationY*Math.PI/180),mat4.rotateX(f,f,r.rotationX*Math.PI/180),c=mat4.clone(f),mat4.translate(c,c,[0,0,.01]),l.x=c[12],l.y=c[13],l.z=c[14],l.lookAt(r.x,r.y,r.z)}}(),Object.freeze(RedBasicController),(RedObitController=function(e){var t;if(!(this instanceof RedObitController))return new RedObitController(e);this.speedDistance=2,this.delayDistance=.1,this.speedRotation=3,this.delayRotation=.1,this.centerX=0,this.centerY=0,this.centerZ=0,this.distance=15,this.tilt=0,Object.defineProperty(this,"minTilt",(t=-90,{get:function(){return t},set:function(e){e<-90&&(e=-90),t=e}})),Object.defineProperty(this,"maxTilt",function(){var e=90;return{get:function(){return e},set:function(t){t>90&&(t=90),e=t}}}()),this.pan=0,this.camera=RedCamera(),this._currentPan=0,this._currentTilt=0,this._currentDistance=0,function(t){var r,n,i,a,o,s,d,f;o=0,s=0,d=0,f=0,r=function(t){o=t.x,s=t.y,e._canvas.addEventListener("mousemove",n),window.addEventListener("mouseup",i)},n=function(e){d=e.x-o,f=e.y-s,o=e.x,s=e.y,t.pan-=d*t.speedRotation*.1,t.tilt-=f*t.speedRotation*.1},i=function(){e._canvas.removeEventListener("mousemove",n),window.removeEventListener("mouseup",i)},a=function(e){t.distance+=e.deltaY/100*t.speedDistance},e._canvas.addEventListener("mousedown",r),e._canvas.addEventListener("wheel",a)}(this)}).prototype.update=function(){var e,t,r;return new Float32Array([0,1,0]),function(n){this.tilt<this.minTilt&&(this.tilt=this.minTilt+.01),this.tilt>this.maxTilt&&(this.tilt=this.maxTilt-.01),this.speedRotation,e=this.delayRotation,t=this.camera,r=t.matrix,this._currentPan+=(this.pan-this._currentPan)*e,this._currentTilt+=(this.tilt-this._currentTilt)*e,this._currentDistance+=(this.distance-this._currentDistance)*this.delayDistance,mat4.identity(r),mat4.rotateY(r,r,this._currentPan*Math.PI/180),mat4.rotateX(r,r,this._currentTilt*Math.PI/180),mat4.translate(r,r,[0,0,this._currentDistance]),t.x=r[12],t.y=r[13],t.z=r[14],t.lookAt(this.centerX,this.centerY,this.centerZ)}}(),Object.freeze(RedObitController),function(){var e,t;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
vColor = aVertexColor;
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
varying vec4 vColor;
void main(void) {
vec4 finalColor = vColor;
finalColor.rgb *= vColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedGridMaterial=function(r){if(!(this instanceof RedGridMaterial))return new RedGridMaterial(r);this.program=RedProgram.makeProgram(r,"gridMaterialProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,Object.freeze(RedGridMaterial)}(),function(){var e,t;e=function(){
/* @preserve
varying vec3 vReflectionCubeCoord;
void main(void) {
vReflectionCubeCoord = (uMMatrix *vec4(-aVertexPosition, 0.0)).xyz;
gl_Position = uPMatrix * uCameraMatrix * uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform samplerCube u_skyBoxTexture;
varying vec3 vReflectionCubeCoord;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = textureCube(u_skyBoxTexture, vReflectionCubeCoord);
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},(RedSkyBoxMaterial=function(r,n){if(!(this instanceof RedSkyBoxMaterial))return new RedSkyBoxMaterial(r,n);r instanceof RedGL||RedGLUtil.throwFunc("RedSkyBoxMaterial : RedGL Instance만 허용됩니다.",r),this.skyBoxTexture=n,this.program=RedProgram.makeProgram(r,"skyBoxProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedSkyBoxMaterial","skyBoxTexture","samplerCube",{essential:!0}),Object.freeze(RedSkyBoxMaterial)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
gl_Position =  uDirectionalShadowLightMatrix *  uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
vec4 encodeFloat (float depth) {
const vec4 cBitShift = vec4(
256 * 256 * 256,
256 * 256,
256,
1.0
);
const vec4 cBitMask = vec4(
0,
1.0 / 256.0,
1.0 / 256.0,
1.0 / 256.0
);
vec4 comp = fract(depth * cBitShift);
comp -= comp.xxyz * cBitMask;
return comp;
}
void main(void) {
gl_FragColor = encodeFloat(gl_FragCoord.z);
}
*/},(RedDirectionalShadowMaterial=function(r){if(!(this instanceof RedDirectionalShadowMaterial))return new RedDirectionalShadowMaterial(r);r instanceof RedGL||RedGLUtil.throwFunc("RedDirectionalShadowMaterial : RedGL Instance만 허용됩니다.",r),this.program=RedProgram.makeProgram(r,"RedDirectionalShadowMaterial_Program",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,Object.freeze(RedDirectionalShadowMaterial)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
gl_FragColor = finalColor;
}
*/},(RedPostEffectMaterial=function(r,n){if(!(this instanceof RedPostEffectMaterial))return new RedPostEffectMaterial(r,n);r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffectMaterial : RedGL Instance만 허용됩니다.",r),this.diffuseTexture=n,this.program=RedProgram.makeProgram(r,"RedPostEffectMaterial_Program",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedPostEffectMaterial","diffuseTexture","sampler2D",{essential:!0}),Object.freeze(RedPostEffectMaterial)}(),function(){var e;(RedDirectionalShadow=function(e,t){if(!(this instanceof RedDirectionalShadow))return new RedDirectionalShadow(e,t);e instanceof RedGL||RedGLUtil.throwFunc("RedDirectionalShadow : RedGL Instance만 허용됩니다.",e),this._directionalShadowMaterial=RedDirectionalShadowMaterial(e),this.frameBuffer=RedFrameBuffer(e),this.light=t,this.width=2048,this.height=2048,this.size=20,this._UUID=RedGL.makeUUID(),this._castingList=[]}).prototype.addCasting=function(e){e instanceof RedBaseObject3D||RedGLUtil.throwFunc("addCasting","RedBaseObject3D Instance만 가능","입력값 : "+e),this._castingList.push(e)},RedDirectionalShadow.prototype.removeCasting=function(t){-1==(e=this._castingList.indexOf(t))?RedGLUtil.throwFunc("removeChild","존재하지 않는 RedMesh를 삭제하려고 함"):this._castingList.splice(e,1)},Object.defineProperty(RedDirectionalShadow.prototype,"light",{get:function(){return this._light},set:function(e){e&&e instanceof RedDirectionalLight||RedGLUtil.throwFunc("RedDirectionalShadow - light : RedDirectionalLight Instance만 허용됩니다.",e),this._light=e}}),RedDefinePropertyInfo.definePrototype("RedDirectionalShadow","width","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedDirectionalShadow","height","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedDirectionalShadow","size","number",{min:1}),Object.freeze(RedDirectionalShadow)}(),function(){var e,t,r,n,i,a;(RedShadowManager=function(e){if(!(this instanceof RedShadowManager))return new RedShadowManager(e);e instanceof RedGL||RedGLUtil.throwFunc("RedShadowManager : RedGL Instance만 허용됩니다.",e),this._UUID=RedGL.makeUUID()}).prototype={render:function(o,s,d,f,c){(n=this._directionalShadow)&&(e=o.gl,r=s.worldRect,t=d._viewRect,i=n.width,a=n.height,n.frameBuffer.width=i,n.frameBuffer.height=a,n.frameBuffer.bind(o.gl),e.viewport(0,0,i,a),e.scissor(0,0,i,a),s.sceneRender(o,o.gl,d.camera.orthographicYn,n._castingList,f,c,n._directionalShadowMaterial),n.frameBuffer.unbind(o.gl),e.viewport(t[0],r[3]-t[3]-t[1],t[2],t[3]),e.scissor(t[0],r[3]-t[3]-t[1],t[2],t[3]))}},Object.defineProperty(RedShadowManager.prototype,"directionalShadow",{get:function(){return this._directionalShadow},set:function(e){e&&e instanceof RedDirectionalShadow||RedGLUtil.throwFunc("RedShadowManager - directionalShadow : RedDirectionalShadow Instance만 허용됩니다.",e),this._directionalShadow=e}}),Object.freeze(RedShadowManager)}(),function(){var e,t,r,n,i,a,o,s,d,f,c,u,h,l,R,m,p,E,_,g,P,M,y,v,b,U,L;(RedPostEffectManager=function(e){if(!(this instanceof RedPostEffectManager))return new RedPostEffectManager(e);var t,r;e instanceof RedGL||RedGLUtil.throwFunc("RedPostEffectManager : RedGL Instance만 허용됩니다.",e),this.frameBuffer=RedFrameBuffer(e),this._finalMaterial=RedPostEffectMaterial(e,this.frameBuffer.texture),this.postEffectList=[],Object.defineProperty(this,"antialiasing",(r=void 0,{get:function(){return r},set:function(e){e&&(e instanceof RedPostEffect_FXAA||RedGLUtil.throwFunc("RedPostEffectManager : antialiasing - RedPostEffect_FXAA Instance만 허용됩니다.","입력값 : "+e)),r=e}})),this.antialiasing=void 0,(t=RedMesh(e,RedPlane(e),this._finalMaterial)).useCullFace=!1,this.children=[t],this._UUID=RedGL.makeUUID()}).prototype={addEffect:function(e){e instanceof RedBaseMaterial||RedGLUtil.throwFunc("RedPostEffectManager : addEffect - RedBaseMaterial Instance만 허용.","입력값 : "+e),this.postEffectList.push(e)},removeEffect:function(e){-1!=(L=this.postEffectList.indexOf(e))&&this.postEffectList.splice(L,1)},removeAllEffect:function(){this.postEffectList.length=0},bind:function(e){this.frameBuffer.bind(e)},unbind:function(e){this.frameBuffer.unbind(e)},render:(g=mat4.create(),P=mat4.create(),_=new Float32Array(2),u=function(t,r,n,i,a,o){e._material=n,l=e._material.program,t.useProgram(l.webglProgram),m=l.systemUniformLocation,(R=m.uPMatrix)&&(p=R.location,E=R._UUID,p&&(mat4.ortho(g,-.5,.5,-.5,.5,-r.farClipping,r.farClipping),mat4.scale(g,g,[1,-1,1]),M=JSON.stringify(g),h[E]!=M&&(t.uniformMatrix4fv(p,!1,g),h[E]=M))),(R=m.uResolution)&&(p=R.location,E=R._UUID,p&&(_[0]=i,_[1]=a,M=JSON.stringify(_),h[E]!=M&&(t.uniform2fv(p,_),h[E]=M))),o&&(R=m.uCameraMatrix)&&(p=R.location,E=R._UUID,p&&(M=JSON.stringify(P),h[E]!=M&&(t.uniformMatrix4fv(p,!1,P),h[E]=M)))},n=function(e,t,r){y=r.frameBuffer.width,v=r.frameBuffer.height,i==y&&a==v||(e.viewport(0,0,y,v),e.scissor(0,0,y,v)),u(e,t,r,y,v),i=y,a=v},c=function(e,t,o,d,f,u,h){var l,R,m;m=e.gl,R=t.subFrameBufferInfo,t.process&&t.process.length&&(l=r,t.process.forEach(function(t){c(e,t,o,d,f,u,h)})),R&&(R.frameBuffer.bind(m),m.viewport(0,0,R.frameBuffer.width,R.frameBuffer.height),m.scissor(0,0,R.frameBuffer.width,R.frameBuffer.height),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT),f.sceneRender(e,m,s.orthographicYn,d.children,u,h,R.renderMaterial),R.frameBuffer.unbind(m),i=R.frameBuffer.width,a=R.frameBuffer.height),t.frameBuffer&&(n(m,s,t),t.bind(m),t.updateTexture(r,l),f.sceneRender(e,m,!0,o,u,h),t.unbind(m),r=t.frameBuffer.texture),R&&R.process&&R.process.forEach(function(t){c(e,t,o,d,f,u,h)})},function(n,l,R,m,p,E){b=this,i=null,a=null,o=m.scene,s=m.camera instanceof RedCamera?m.camera:m.camera.camera,d=m._viewRect,f=R.worldRect,h=R.cacheSystemUniformInfo,b.unbind(l),e=b.children[0],r=t=b.frameBuffer.texture,b.frameBuffer.width=l.drawingBufferWidth,b.frameBuffer.height=l.drawingBufferHeight,U=b.postEffectList.concat(),b.antialiasing&&U.push(b.antialiasing),U.forEach(function(e){c(n,e,b.children,o,R,p,E)}),r!=t&&(b._finalMaterial.diffuseTexture=r,l.viewport(d[0],f[3]-d[3]-d[1],d[2],d[3]),l.scissor(d[0],f[3]-d[3]-d[1],d[2],d[3]),u(l,s,b._finalMaterial,d[2],d[3],!0),R.sceneRender(n,l,!0,b.children,p,E)),b._finalMaterial.diffuseTexture=b.frameBuffer.texture})},Object.freeze(RedPostEffectManager)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform sampler2D uBlurTexture;
uniform float uExposure;
uniform float uBloomStrength;
void main() {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
vec4 thresholdColor = finalColor;
vec4 blurColor = texture2D(uBlurTexture, vTexcoord);
gl_FragColor = (finalColor  + blurColor * uBloomStrength) * uExposure ;
}
*/},(RedPostEffect_Bloom=function(r){if(!(this instanceof RedPostEffect_Bloom))return new RedPostEffect_Bloom(r);var n;r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Bloom : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.blurTexture=null,this.process=[RedPostEffect_BloomThreshold(r),RedPostEffect_BlurX(r),RedPostEffect_BlurY(r)],Object.defineProperty(this,"blur",(n=1,{get:function(){return n},set:function(e){n=e,this.process[1].size=n,this.process[2].size=n}})),this.blur=20,this.exposure=1,this.bloomStrength=1.2,Object.defineProperty(this,"threshold",function(){var e=100;return{get:function(){return e},set:function(t){this.process[0].threshold=e=t}}}()),this.threshold=75,this.program=RedProgram.makeProgram(r,"RedPostEffect_Bloom_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e,t){this.diffuseTexture=t,this.blurTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_Bloom.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_Bloom.prototype.unbind=RedPostEffectManager.prototype.unbind,RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","exposure","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","bloomStrength","number",{min:0}),Object.freeze(RedPostEffect_Bloom)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision highp float;
uniform sampler2D uDiffuseTexture;
uniform float u_threshold;
void main() {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
if(0.2126 * finalColor.r + 0.7152 * finalColor.g + 0.0722 * finalColor.b < u_threshold)  finalColor.r = finalColor.g = finalColor.b = 0.0;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_BloomThreshold=function(r){if(!(this instanceof RedPostEffect_BloomThreshold))return new RedPostEffect_BloomThreshold(r);var n;r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BloomThreshold : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this._threshold=null,Object.defineProperty(this,"threshold",(n=128,{get:function(){return n},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc("RedPostEffect_BloomThreshold : threshold 숫자만허용함","입력값 : "+e),(n=e)<1&&(n=1),n>255&&(n=255),this._threshold=n/255}})),this.threshold=128,this.program=RedProgram.makeProgram(r,"RedPostEffect_BloomThreshold_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_BloomThreshold.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_BloomThreshold.prototype.unbind=RedPostEffectManager.prototype.unbind,Object.freeze(RedPostEffect_BloomThreshold)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
void main(void) {
vec2 px = vec2(1.0/vResolution.x, 1.0/vResolution.y);
vec4 finalColor = vec4(0.0);
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-7.0*px.x, -7.0*px.y))*0.0044299121055113265;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-6.0*px.x, -6.0*px.y))*0.00895781211794;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-5.0*px.x, -5.0*px.y))*0.0215963866053;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-4.0*px.x, -4.0*px.y))*0.0443683338718;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-3.0*px.x, -3.0*px.y))*0.0776744219933;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-2.0*px.x, -2.0*px.y))*0.115876621105;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-1.0*px.x, -1.0*px.y))*0.147308056121;
finalColor += texture2D(uDiffuseTexture, vTexcoord                             )*0.159576912161;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 1.0*px.x,  1.0*px.y))*0.147308056121;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 2.0*px.x,  2.0*px.y))*0.115876621105;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 3.0*px.x,  3.0*px.y))*0.0776744219933;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 4.0*px.x,  4.0*px.y))*0.0443683338718;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 5.0*px.x,  5.0*px.y))*0.0215963866053;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 6.0*px.x,  6.0*px.y))*0.00895781211794;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 7.0*px.x,  7.0*px.y))*0.0044299121055113265;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Blur=function(r){if(!(this instanceof RedPostEffect_Blur))return new RedPostEffect_Blur(r);r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Blur : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.program=RedProgram.makeProgram(r,"RedPostEffect_Blur_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_Blur.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_Blur.prototype.unbind=RedPostEffectManager.prototype.unbind,Object.freeze(RedPostEffect_Blur)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float u_size;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main() {
vec4 finalColor = vec4(0.0);
vec2 delta;
float total = 0.0;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
delta = vec2(u_size/vResolution.x,0.0);
for (float t = -10.0; t <= 10.0; t++) {
float percent = (t + offset - 0.5) / 10.0;
float weight = 1.0 - abs(percent);
vec4 sample = texture2D(uDiffuseTexture, vTexcoord + delta * percent);
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
finalColor = finalColor / total;
finalColor.rgb /= finalColor.a + 0.00001;
gl_FragColor =  finalColor ;
}
*/},(RedPostEffect_BlurX=function(r){if(!(this instanceof RedPostEffect_BlurX))return new RedPostEffect_BlurX(r);r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BlurX : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.size=50,this.program=RedProgram.makeProgram(r,"RedPostEffect_BlurX_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_BlurX.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_BlurX.prototype.unbind=RedPostEffectManager.prototype.unbind,RedDefinePropertyInfo.definePrototype("RedPostEffect_BlurX","size","number",{min:0}),Object.freeze(RedPostEffect_BlurX)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float u_size;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main() {
vec4 finalColor = vec4(0.0);
vec2 delta;
float total = 0.0;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
delta = vec2(0.0, u_size/vResolution.y);
for (float t = -10.0; t <= 10.0; t++) {
float percent = (t + offset - 0.5) / 10.0;
float weight = 1.0 - abs(percent);
vec4 sample = texture2D(uDiffuseTexture, vTexcoord + delta * percent);
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
finalColor = finalColor / total;
finalColor.rgb /= finalColor.a + 0.00001;
gl_FragColor =   finalColor ;
}
*/},(RedPostEffect_BlurY=function(r){if(!(this instanceof RedPostEffect_BlurY))return new RedPostEffect_BlurY(r);r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BlurY : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.size=50,this.program=RedProgram.makeProgram(r,"RedPostEffect_BlurY_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_BlurY.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_BlurY.prototype.unbind=RedPostEffectManager.prototype.unbind,RedDefinePropertyInfo.definePrototype("RedPostEffect_BlurY","size","number",{min:0}),Object.freeze(RedPostEffect_BlurY)}(),(RedPostEffect_GaussianBlur=function(e){if(!(this instanceof RedPostEffect_GaussianBlur))return new RedPostEffect_GaussianBlur(e);var t;e instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_GaussianBlur : RedGL Instance만 허용됩니다.",e),this._UUID=RedGL.makeUUID(),this.process=[RedPostEffect_BlurX(e),RedPostEffect_BlurY(e)],Object.defineProperty(this,"radius",(t=1,{get:function(){return t},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc("RedPostEffect_GaussianBlur : radius 숫자만허용함","입력값 : "+e),(t=e)<.1&&(t=.1),t>255&&(t=255),this.process[0].size=t,this.process[1].size=t}})),this.radius=1}).prototype=new RedBaseMaterial,Object.freeze(RedPostEffect_GaussianBlur),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float uCenterX;
uniform float uCenterY;
uniform float u_amount;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main(void) {
vec4 finalColor = vec4(0.0);
vec2 center = vec2(uCenterX+0.5,-uCenterY+0.5);
vec2 toCenter = center - vTexcoord ;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
float total = 0.0;
for (float t = 0.0; t <= 30.0; t++) {
float percent = (t + offset) / 30.0;
float weight = 3.0 * (percent - percent * percent);
vec4 sample = texture2D(uDiffuseTexture, vTexcoord + toCenter * percent * u_amount );
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
gl_FragColor = finalColor / total;
gl_FragColor.rgb /= gl_FragColor.a + 0.00001;
}
*/},(RedPostEffect_ZoomBlur=function(r){if(!(this instanceof RedPostEffect_ZoomBlur))return new RedPostEffect_ZoomBlur(r);var n;r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_ZoomBlur : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.centerX=0,this.centerY=0,this._amount=null,Object.defineProperty(this,"amount",(n=0,{get:function(){return n},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc("RedPostEffect_ZoomBlur : amount 숫자만허용함","입력값 : "+e),(n=e)<1&&(n=1),n>100&&(n=100),this._amount=n/100}})),this.amount=38,this.program=RedProgram.makeProgram(r,"RedPostEffect_ZoomBlur_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_ZoomBlur.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_ZoomBlur.prototype.unbind=RedPostEffectManager.prototype.unbind,RedDefinePropertyInfo.definePrototype("RedPostEffect_ZoomBlur","centerX","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_ZoomBlur","centerY","number"),Object.freeze(RedPostEffect_ZoomBlur)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float u_brightness;
uniform float u_contrast;
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord );
if (u_contrast > 0.0) finalColor.rgb = (finalColor.rgb - 0.5) / (1.0 - u_contrast) + 0.5;
else finalColor.rgb = (finalColor.rgb - 0.5) * (1.0 + u_contrast) + 0.5;
finalColor.rgb += u_brightness;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_BrightnessContrast=function(r){if(!(this instanceof RedPostEffect_BrightnessContrast))return new RedPostEffect_BrightnessContrast(r);var n;r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BrightnessContrast : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this._brightness=0,Object.defineProperty(this,"brightness",(n=0,{get:function(){return n},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc("RedPostEffect_BrightnessContrast : brightness 숫자만허용함","입력값 : "+e),(n=e)<-150&&(n=-150),n>150&&(n=150),this._brightness=n/255}})),this._contrast=0,Object.defineProperty(this,"contrast",function(){var e=0;return{get:function(){return e},set:function(t){"number"!=typeof t&&RedGLUtil.throwFunc("RedPostEffect_BrightnessContrast : contrast 숫자만허용함","입력값 : "+t),(e=t)<-50&&(e=50),e>100&&(e=100),this._contrast=e/255}}}()),this.program=RedProgram.makeProgram(r,"RedPostEffect_BrightnessContrast_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_BrightnessContrast.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_BrightnessContrast.prototype.unbind=RedPostEffectManager.prototype.unbind,Object.freeze(RedPostEffect_BrightnessContrast)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision highp float;
uniform sampler2D uDiffuseTexture;
uniform float u_threshold;
void main() {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
float v;
if(0.2126 * finalColor.r + 0.7152 * finalColor.g + 0.0722 * finalColor.b >= u_threshold) v = 1.0;
else v = 0.0;
finalColor.r = finalColor.g = finalColor.b = v;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Threshold=function(r){if(!(this instanceof RedPostEffect_Threshold))return new RedPostEffect_Threshold(r);var n;r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Threshold : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.program=RedProgram.makeProgram(r,"RedPostEffect_Threshold_Program",e,t),this._UUID=RedGL.makeUUID(),this._threshold=null,Object.defineProperty(this,"threshold",(n=128,{get:function(){return n},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc("RedPostEffect_Threshold : threshold 숫자만허용함","입력값 : "+e),(n=e)<1&&(n=1),n>255&&(n=255),this._threshold=n/255}})),this.threshold=128,this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_Threshold.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_Threshold.prototype.unbind=RedPostEffectManager.prototype.unbind,Object.freeze(RedPostEffect_Threshold)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
finalColor.r = 1.0 - finalColor.r;
finalColor.g = 1.0 - finalColor.g;
finalColor.b = 1.0 - finalColor.b;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Invert=function(r){if(!(this instanceof RedPostEffect_Invert))return new RedPostEffect_Invert(r);r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Invert : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.program=RedProgram.makeProgram(r,"RedPostEffect_Invert_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_Invert.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_Invert.prototype.unbind=RedPostEffectManager.prototype.unbind,Object.freeze(RedPostEffect_Invert)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
highp float gray = (finalColor.r  + finalColor.g + finalColor.b)/3.0;
gl_FragColor = vec4( gray, gray, gray, 1.0);
}
*/},(RedPostEffect_Gray=function(r){if(!(this instanceof RedPostEffect_Gray))return new RedPostEffect_Gray(r);r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Gray : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.program=RedProgram.makeProgram(r,"RedPostEffect_Gray_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_Gray.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_Gray.prototype.unbind=RedPostEffectManager.prototype.unbind,Object.freeze(RedPostEffect_Gray)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float u_hue;
uniform float u_saturation;
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord );
float angle = u_hue * 3.1415926535897932384626433832795;
float s = sin(angle), c = cos(angle);
vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;
float len = length(finalColor.rgb);
finalColor.rgb = vec3(
dot(finalColor.rgb, weights.xyz),
dot(finalColor.rgb, weights.zxy),
dot(finalColor.rgb, weights.yzx)
);
float average = (finalColor.r + finalColor.g + finalColor.b) / 3.0;
if (u_saturation > 0.0) finalColor.rgb += (average - finalColor.rgb) * (1.0 - 1.0 / (1.001 - u_saturation));
else finalColor.rgb += (average - finalColor.rgb) * (-u_saturation);
gl_FragColor = finalColor;
}
*/},(RedPostEffect_HueSaturation=function(r){if(!(this instanceof RedPostEffect_HueSaturation))return new RedPostEffect_HueSaturation(r);var n;r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_HueSaturation : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this._hue=0,Object.defineProperty(this,"hue",(n=0,{get:function(){return n},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc("RedPostEffect_HueSaturation : hue 숫자만허용함","입력값 : "+e),(n=e)<-180&&(n=-180),n>180&&(n=180),this._hue=n/180}})),this._saturation=0,Object.defineProperty(this,"saturation",function(){var e=0;return{get:function(){return e},set:function(t){"number"!=typeof t&&RedGLUtil.throwFunc("RedPostEffect_HueSaturation : saturation 숫자만허용함","입력값 : "+t),(e=t)<-100&&(e=-100),e>100&&(e=100),this._saturation=e/100}}}()),this.program=RedProgram.makeProgram(r,"RedPostEffect_HueSaturation_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=RedBaseMaterial.prototype,RedPostEffect_HueSaturation.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_HueSaturation.prototype.unbind=RedPostEffectManager.prototype.unbind,Object.freeze(RedPostEffect_HueSaturation)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float u_centerX;
uniform float u_centerY;
uniform float u_angle;
uniform float u_radius;
uniform bool uGrayMode;
float pattern(float angle) {
angle = angle * 3.141592653589793/180.0;
float s = sin(angle), c = cos(angle);
vec2 tex = vTexcoord;
tex.x -= u_centerX + 0.5;
tex.y -= u_centerY + 0.5;
vec2 point = vec2(
c * tex.x - s * tex.y,
s * tex.x + c * tex.y
) * vResolution / u_radius;
return (sin(point.x) * sin(point.y)) * 4.0;
}
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
if(uGrayMode) {
float average = (finalColor.r + finalColor.g + finalColor.b) / 3.0;
gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern(u_angle)), finalColor.a);
}else{
vec3 cmy = 1.0 - finalColor.rgb;
float k = min(cmy.x, min(cmy.y, cmy.z));
cmy = (cmy - k) / (1.0 - k);
cmy = clamp(cmy * 10.0 - 3.0 + vec3(pattern(u_angle + 0.26179), pattern(u_angle + 1.30899), pattern(u_angle)), 0.0, 1.0);
k = clamp(k * 10.0 - 5.0 + pattern(u_angle + 0.78539), 0.0, 1.0);
gl_FragColor = vec4(1.0 - cmy - k, finalColor.a);
}
}
*/},(RedPostEffect_HalfTone=function(r){if(!(this instanceof RedPostEffect_HalfTone))return new RedPostEffect_HalfTone(r);r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_HalfTone : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.centerX=0,this.centerY=0,this.angle=0,this.radius=2,this.grayMode=!1,this.program=RedProgram.makeProgram(r,"RedPostEffect_HalfTone_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_HalfTone.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_HalfTone.prototype.unbind=RedPostEffectManager.prototype.unbind,RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","centerX","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","centerY","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","angle","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","radius","number",{min:0}),Object.freeze(RedPostEffect_HalfTone)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float u_width;
uniform float u_height;
void main(void) {
vec4 finalColor;
float dx = 1.0/vResolution.x * u_width;
float dy = 1.0/vResolution.y * u_height;
vec2 coord = vec2(
dx * (floor(vTexcoord.x / dx) + 0.5),
dy * (floor(vTexcoord.y / dy) + 0.5)
);
finalColor = texture2D(uDiffuseTexture, coord);
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Pixelize=function(r){if(!(this instanceof RedPostEffect_Pixelize))return new RedPostEffect_Pixelize(r);r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Pixelize : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.width=5,this.height=5,this.program=RedProgram.makeProgram(r,"RedPostEffect_Pixelize_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_Pixelize.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_Pixelize.prototype.unbind=RedPostEffectManager.prototype.unbind,RedDefinePropertyInfo.definePrototype("RedPostEffect_Pixelize","width","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Pixelize","height","number",{min:0}),Object.freeze(RedPostEffect_Pixelize)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform mat3 uKernel;
uniform float uKernelWeight;
void main(void) {
vec2 perPX = vec2(1.0/vResolution.x, 1.0/vResolution.y);
vec4 finalColor = vec4(0.0);
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2(-1.0, -1.0)) * uKernel[0][0] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 0.0, -1.0)) * uKernel[0][1] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 1.0, -1.0)) * uKernel[0][2] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2(-1.0,  0.0)) * uKernel[1][0] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 0.0,  0.0)) * uKernel[1][1] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 1.0,  0.0)) * uKernel[1][2] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2(-1.0,  1.0)) * uKernel[2][0] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 0.0,  1.0)) * uKernel[2][1] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 1.0,  1.0)) * uKernel[2][2] ;
highp float weight;
weight = uKernelWeight;
if (0.01 > weight) {
weight = 1.0;
}
gl_FragColor = vec4((finalColor / uKernelWeight).rgb, 1.0);
}
*/},(RedPostEffect_Convolution=function(r,n){if(!(this instanceof RedPostEffect_Convolution))return new RedPostEffect_Convolution(r,n);var i,a;r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Convolution : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.kernel=n,Object.defineProperty(this,"kernel",{get:function(){return i||(i=RedPostEffect_Convolution.NORMAL),i},set:function(e){i=e}}),Object.defineProperty(this,"kernelWeight",{get:function(){for(var e in a=0,this.kernel)a+=this.kernel[e];return a}}),this.program=RedProgram.makeProgram(r,"RedPostEffect_Convolution_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_Convolution.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_Convolution.prototype.unbind=RedPostEffectManager.prototype.unbind,RedPostEffect_Convolution.NORMAL=[0,0,0,0,1,0,0,0,0],RedPostEffect_Convolution.SHARPEN=[0,-1,0,-1,5,-1,0,-1,0],RedPostEffect_Convolution.BLUR=[1,1,1,1,1,1,1,1,1],RedPostEffect_Convolution.EDGE=[0,1,0,1,-4,1,0,1,0],RedPostEffect_Convolution.EMBOSS=[-2,-1,0,-1,1,1,0,1,2],Object.freeze(RedPostEffect_Convolution)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform sampler2D uBlurTexture;
uniform sampler2D uDepthTexture;
uniform float uDistance;
void main() {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
vec4 blurColor = texture2D(uBlurTexture, vTexcoord);
vec4 depthColor = texture2D(uDepthTexture, vTexcoord);
finalColor.rgb *= (depthColor.r);
blurColor.rgb *= (1.0-depthColor.r);
gl_FragColor =  (finalColor + blurColor) ;
}
*/},(RedPostEffect_DoF=function(r){if(!(this instanceof RedPostEffect_DoF))return new RedPostEffect_DoF(r);var n;r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_DoF : RedGL Instance만 허용됩니다.",r),this.subFrameBufferInfo={frameBuffer:RedFrameBuffer(r),renderMaterial:RedPostEffect_DoF_DepthMaterial(r),process:[]},this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.blurTexture=null,this.depthTexture=null,this.process=[RedPostEffect_BlurX(r),RedPostEffect_BlurY(r)],Object.defineProperty(this,"focusLength",{get:function(){return this.subFrameBufferInfo.renderMaterial.focusLength},set:function(e){this.subFrameBufferInfo.renderMaterial.focusLength=e}}),this.focusLength=15,Object.defineProperty(this,"blur",(n=1,{get:function(){return n},set:function(e){n=e,this.process[0].size=n,this.process[1].size=n}})),this.blur=10,this.updateTexture=function(e,t){this.diffuseTexture=t,this.blurTexture=e,this.depthTexture=this.subFrameBufferInfo.frameBuffer.texture},this.program=RedProgram.makeProgram(r,"RedPostEffect_DoF_Program",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_DoF.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_DoF.prototype.unbind=RedPostEffectManager.prototype.unbind,RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF","focusLength","number",{min:0}),Object.freeze(RedPostEffect_DoF)}(),function(){var e,t;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
gl_PointSize = uPointSize;
if(uSprite3DYn) {
gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
if(!uPerspectiveScale){
gl_Position /= gl_Position.w;
gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1]);
}
}
else gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform float uFocusLength;
void main(void) {
float depth = 1.0 - gl_FragCoord.z / gl_FragCoord.w / uFocusLength;
gl_FragColor = vec4(depth, depth, depth, 1.0);
}
*/},(RedPostEffect_DoF_DepthMaterial=function(r){if(!(this instanceof RedPostEffect_DoF_DepthMaterial))return new RedPostEffect_DoF_DepthMaterial(r);this.focusLength=15,this.program=RedProgram.makeProgram(r,"RedPostEffect_DoF_depthProgram",e,t),this._UUID=RedGL.makeUUID(),this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF_DepthMaterial","focusLength","number",{min:0}),Object.freeze(RedPostEffect_DoF_DepthMaterial)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vTime = uTime;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform bool uGrayMode;
uniform sampler2D uDiffuseTexture;
// noise effect intensity value (0 = no effect, 1 = full effect)
uniform float u_noiseIntensity;
// scanlines effect intensity value (0 = no effect, 1 = full effect)
uniform float u_scanlineIntensity;
// scanlines effect count value (0 = no effect, 4096 = full effect)
uniform float u_scanlineCount;
void main() {
// sample the source
vec4 diffuseColor = texture2D( uDiffuseTexture, vTexcoord );
// make some noise
float x = vTexcoord.x * vTexcoord.y * vTime;
x = mod( x, 13.0 ) * mod( x, 123.0 );
float dx = mod( x, 0.01 );
// add noise
vec3 finalColor = diffuseColor.rgb + diffuseColor.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );
// get us a sine and cosine
vec2 sc = vec2( sin( vTexcoord.y * u_scanlineCount ), cos( vTexcoord.y * u_scanlineCount ) );
// add scanlines
finalColor += diffuseColor.rgb * vec3( sc.x, sc.y, sc.x ) * u_scanlineIntensity;
// interpolate between source and result by intensity
finalColor = diffuseColor.rgb + clamp( u_noiseIntensity, 0.0, 1.0 ) * ( finalColor - diffuseColor.rgb );
// convert to grayscale if desired
if( uGrayMode ) finalColor = vec3( finalColor.r * 0.3 + finalColor.g * 0.59 + finalColor.b * 0.11 );
gl_FragColor =  vec4( finalColor, diffuseColor.a );
}
*/},(RedPostEffect_Film=function(r){if(!(this instanceof RedPostEffect_Film))return new RedPostEffect_Film(r);r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Film : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.grayMode=!1,this.scanlineIntensity=.5,this.noiseIntensity=.5,this.scanlineCount=2048,this.program=RedProgram.makeProgram(r,"RedPostEffect_Film_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_Film.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_Film.prototype.unbind=RedPostEffectManager.prototype.unbind,RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","scanlineIntensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","noiseIntensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","scanlineCount","number",{min:0}),Object.freeze(RedPostEffect_Film)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float u_size;
uniform float u_intensity;
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord );
float dist = distance(vTexcoord, vec2(0.5, 0.5));
finalColor.rgb *= smoothstep(0.8, u_size * 0.799, dist * (u_intensity + u_size));
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Vignetting=function(r){if(!(this instanceof RedPostEffect_Vignetting))return new RedPostEffect_Vignetting(r);r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Vignetting : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.size=.1,this.intensity=.85,this.program=RedProgram.makeProgram(r,"RedPostEffect_Vignetting_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_Vignetting.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_Vignetting.prototype.unbind=RedPostEffectManager.prototype.unbind,RedDefinePropertyInfo.definePrototype("RedPostEffect_Vignetting","intensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Vignetting","size","number",{min:0}),Object.freeze(RedPostEffect_Vignetting)}(),function(){var e,t;e=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
const float cFXAA_REDUCE_MIN = 1.0/ 128.0;
const float cFXAA_REDUCE_MUL = 1.0 / 8.0;
const float cFXAA_SPAN_MAX = 8.0;
void main() {
vec4 finalColor;
vec2 inverseVP = vec2(1.0 / vResolution.x, 1.0 / vResolution.y);
vec2 fragCoord = gl_FragCoord.xy;
vec3 rgbNW = texture2D(uDiffuseTexture, (fragCoord + vec2(-1.0, -1.0)) * inverseVP).xyz;
vec3 rgbNE = texture2D(uDiffuseTexture, (fragCoord + vec2(1.0, -1.0)) * inverseVP).xyz;
vec3 rgbSW = texture2D(uDiffuseTexture, (fragCoord + vec2(-1.0, 1.0)) * inverseVP).xyz;
vec3 rgbSE = texture2D(uDiffuseTexture, (fragCoord + vec2(1.0, 1.0)) * inverseVP).xyz;
vec3 rgbM  = texture2D(uDiffuseTexture, fragCoord  * inverseVP).xyz;
vec3 luma = vec3(0.299, 0.587, 0.114);
float lumaNW = dot(rgbNW, luma);
float lumaNE = dot(rgbNE, luma);
float lumaSW = dot(rgbSW, luma);
float lumaSE = dot(rgbSE, luma);
float lumaM  = dot(rgbM,  luma);
float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));
vec2 dir;
dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));
float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * cFXAA_REDUCE_MUL), cFXAA_REDUCE_MIN);
float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
dir = min(
vec2(cFXAA_SPAN_MAX, cFXAA_SPAN_MAX),
max( vec2(-cFXAA_SPAN_MAX, -cFXAA_SPAN_MAX), dir * rcpDirMin)
) * inverseVP;
vec3 rgbA = 0.5 * (
texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz
);
vec3 rgbB = rgbA * 0.5 + 0.25 * (
texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * -0.5).xyz +
texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * 0.5).xyz
);
float lumaB = dot(rgbB, luma);
if ((lumaB < lumaMin) || (lumaB > lumaMax)) finalColor = vec4(rgbA, 1.0);
else finalColor = vec4(rgbB, 1.0);
gl_FragColor = finalColor;
}
*/},(RedPostEffect_FXAA=function(r){if(!(this instanceof RedPostEffect_FXAA))return new RedPostEffect_FXAA(r);r instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_FXAA : RedGL Instance만 허용됩니다.",r),this.frameBuffer=RedFrameBuffer(r),this.diffuseTexture=null,this.program=RedProgram.makeProgram(r,"RedPostEffect_FXAA_Program",e,t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.checkUniformAndProperty()}).prototype=new RedBaseMaterial,RedPostEffect_FXAA.prototype.bind=RedPostEffectManager.prototype.bind,RedPostEffect_FXAA.prototype.unbind=RedPostEffectManager.prototype.unbind,Object.freeze(RedPostEffect_FXAA)}();console.log('RedGL Release. last update(2018-06-22 19:31:57)');