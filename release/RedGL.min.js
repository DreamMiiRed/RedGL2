var RedGLUtil,RedGL,RedBaseContainer,RedBaseLight,RedBaseMaterial,RedBaseObject3D,RedFrameBuffer,RedBuffer,RedGeometry,RedInterleaveInfo,RedAmbientLight,RedDirectionalLight,RedPointLight,JsonModelLoader,RedMTLLoader,RedOBJLoader,RedAxis,RedGrid,RedMesh,RedLine,RedSkyBox,RedSprite3D,RedPointUnit,RedBox,RedPlane,RedSphere,RedProgram,RedSystemShaderCode,RedShader,RedRenderer,RedRenderDebuger,RedAtlas,RedAtlasUV,RedBitmapTexture,RedAtlasTexture,RedBitmapCubeTexture,RedView,RedWorld,RedScene,RedCamera,RedBasicController,RedObitController;!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=function(e){t.ARRAY_TYPE=e},t.toRadian=function(e){return e*i},t.equals=function(e,t){return Math.abs(e-t)<=n*Math.max(1,Math.abs(e),Math.abs(t))};var n=t.EPSILON=1e-6,i=(t.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,t.RANDOM=Math.random,Math.PI/180)},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],d=t[7],h=t[8],l=r[0],f=r[1],R=r[2],m=r[3],p=r[4],v=r[5],M=r[6],E=r[7],g=r[8];return e[0]=l*n+f*o+R*c,e[1]=l*i+f*s+R*d,e[2]=l*a+f*u+R*h,e[3]=m*n+p*o+v*c,e[4]=m*i+p*s+v*d,e[5]=m*a+p*u+v*h,e[6]=M*n+E*o+g*c,e[7]=M*i+E*s+g*d,e[8]=M*a+E*u+g*h,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},t.clone=function(e){var t=new a.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromValues=function(e,t,r,n,i,o,s,u,c){var d=new a.ARRAY_TYPE(9);return d[0]=e,d[1]=t,d[2]=r,d[3]=n,d[4]=i,d[5]=o,d[6]=s,d[7]=u,d[8]=c,d},t.set=function(e,t,r,n,i,a,o,s,u,c){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=c,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],d=t[8],h=d*o-s*c,l=-d*a+s*u,f=c*a-o*u,R=r*h+n*l+i*f;return R?(R=1/R,e[0]=h*R,e[1]=(-d*n+i*c)*R,e[2]=(s*n-i*o)*R,e[3]=l*R,e[4]=(d*r-i*u)*R,e[5]=(-s*r+i*a)*R,e[6]=f*R,e[7]=(-c*r+n*u)*R,e[8]=(o*r-n*a)*R,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],d=t[8];return e[0]=o*d-s*c,e[1]=i*c-n*d,e[2]=n*s-i*o,e[3]=s*u-a*d,e[4]=r*d-i*u,e[5]=i*a-r*s,e[6]=a*c-o*u,e[7]=n*u-r*c,e[8]=r*o-n*a,e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],c=e[8];return t*(c*a-o*u)+r*(-c*i+o*s)+n*(u*i-a*s)},t.multiply=n,t.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],d=t[7],h=t[8],l=r[0],f=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=l*n+f*o+c,e[7]=l*i+f*s+d,e[8]=l*a+f*u+h,e},t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],d=t[7],h=t[8],l=Math.sin(r),f=Math.cos(r);return e[0]=f*n+l*o,e[1]=f*i+l*s,e[2]=f*a+l*u,e[3]=f*o-l*n,e[4]=f*s-l*i,e[5]=f*u-l*a,e[6]=c,e[7]=d,e[8]=h,e},t.scale=function(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,c=r*o,d=n*o,h=n*s,l=i*o,f=i*s,R=i*u,m=a*o,p=a*s,v=a*u;return e[0]=1-h-R,e[3]=d-v,e[6]=l+p,e[1]=d+v,e[4]=1-c-R,e[7]=f-m,e[2]=l-p,e[5]=f+m,e[8]=1-c-h,e},t.normalFromMat4=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],d=t[8],h=t[9],l=t[10],f=t[11],R=t[12],m=t[13],p=t[14],v=t[15],M=r*s-n*o,E=r*u-i*o,g=r*c-a*o,b=n*u-i*s,_=n*c-a*s,U=i*c-a*u,A=d*m-h*R,T=d*p-l*R,y=d*v-f*R,L=h*p-l*m,I=h*v-f*m,w=l*v-f*p,x=M*w-E*I+g*L+b*y-_*T+U*A;return x?(x=1/x,e[0]=(s*w-u*I+c*L)*x,e[1]=(u*y-o*w-c*T)*x,e[2]=(o*I-s*y+c*A)*x,e[3]=(i*I-n*w-a*L)*x,e[4]=(r*w-i*y+a*T)*x,e[5]=(n*y-r*I-a*A)*x,e[6]=(m*U-p*_+v*b)*x,e[7]=(p*g-R*U-v*E)*x,e[8]=(R*_-m*g+v*M)*x,e):null},t.projection=function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},t.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],d=e[7],h=e[8],l=t[0],f=t[1],R=t[2],m=t[3],p=t[4],v=t[5],M=t[6],E=t[7],g=t[8];return Math.abs(r-l)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-f)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-R)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(R))&&Math.abs(o-m)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-p)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(u-v)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-M)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(d-E)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(h-g)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(g))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(){var e=new R.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e}function i(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function a(e,t,r){var n=new R.ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=r,n}function o(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function s(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function u(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function c(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function d(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function h(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function l(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function f(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=function(e){var t=new R.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.length=i,t.fromValues=a,t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},t.subtract=o,t.multiply=s,t.divide=u,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},t.distance=c,t.squaredDistance=d,t.squaredLength=h,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=l,t.dot=f,t.cross=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2];return e[0]=i*u-a*s,e[1]=a*o-n*u,e[2]=n*s-i*o,e},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e},t.hermite=function(e,t,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,c=o*(a-1),d=o*(3-2*a);return e[0]=t[0]*s+r[0]*u+n[0]*c+i[0]*d,e[1]=t[1]*s+r[1]*u+n[1]*c+i[1]*d,e[2]=t[2]*s+r[2]*u+n[2]*c+i[2]*d,e},t.bezier=function(e,t,r,n,i,a){var o=1-a,s=o*o,u=a*a,c=s*o,d=3*a*s,h=3*u*o,l=u*a;return e[0]=t[0]*c+r[0]*d+n[0]*h+i[0]*l,e[1]=t[1]*c+r[1]*d+n[1]*h+i[1]*l,e[2]=t[2]*c+r[2]*d+n[2]*h+i[2]*l,e},t.random=function(e,t){t=t||1;var r=2*R.RANDOM()*Math.PI,n=2*R.RANDOM()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e},t.transformMat3=function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2],c=r[3],d=c*n+s*a-u*i,h=c*i+u*n-o*a,l=c*a+o*i-s*n,f=-o*n-s*i-u*a;return e[0]=d*c+f*-o+h*-u-l*-s,e[1]=h*c+f*-s+l*-o-d*-u,e[2]=l*c+f*-u+d*-s-h*-o,e},t.rotateX=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateY=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateZ=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.angle=function(e,t){var r=a(e[0],e[1],e[2]),n=a(t[0],t[1],t[2]);l(r,r),l(n,n);var i=f(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(r-a)<=R.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=R.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=R.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))};var R=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=o,t.mul=s,t.div=u,t.dist=c,t.sqrDist=d,t.len=i,t.sqrLen=h,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,u=void 0;for(r||(r=3),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],a(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2];return t}}()},function(e,t,r){"use strict";function n(){var e=new f.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function s(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function u(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+a*a)}function c(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a}function d(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function h(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function l(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o),e}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=function(e){var t=new f.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,r,n){var i=new f.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=i,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=s,t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},t.distance=u,t.squaredDistance=c,t.length=d,t.squaredLength=h,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=l,t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e},t.random=function(e,t){return t=t||1,e[0]=f.RANDOM(),e[1]=f.RANDOM(),e[2]=f.RANDOM(),e[3]=f.RANDOM(),l(e,e),s(e,e,t),e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2],c=r[3],d=c*n+s*a-u*i,h=c*i+u*n-o*a,l=c*a+o*i-s*n,f=-o*n-s*i-u*a;return e[0]=d*c+f*-o+h*-u-l*-s,e[1]=h*c+f*-s+l*-o-d*-u,e[2]=l*c+f*-u+d*-s-h*-o,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=t[0],s=t[1],u=t[2],c=t[3];return Math.abs(r-o)<=f.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=f.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=f.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=f.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))};var f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=i,t.mul=a,t.div=o,t.dist=u,t.sqrDist=c,t.len=d,t.sqrLen=h,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,u=void 0;for(r||(r=4),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],e[3]=t[u+3],a(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];return t}}()},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=t.vec3=t.vec2=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.glMatrix=void 0;var i=n(r(0)),a=n(r(5)),o=n(r(6)),s=n(r(1)),u=n(r(7)),c=n(r(8)),d=n(r(9)),h=n(r(2)),l=n(r(3));t.glMatrix=i,t.mat2=a,t.mat2d=o,t.mat3=s,t.mat4=u,t.quat=c,t.vec2=d,t.vec3=h,t.vec4=l},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],u=r[1],c=r[2],d=r[3];return e[0]=n*s+a*u,e[1]=i*s+o*u,e[2]=n*c+a*d,e[3]=i*c+o*d,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.fromValues=function(e,t,r,n){var i=new a.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},t.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},t.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*a-i*n;return o?(o=1/o,e[0]=a*o,e[1]=-n*o,e[2]=-i*o,e[3]=r*o,e):null},t.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},t.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},t.multiply=n,t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+a*s,e[1]=i*u+o*s,e[2]=n*-s+a*u,e[3]=i*-s+o*u,e},t.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],u=r[1];return e[0]=n*s,e[1]=i*s,e[2]=a*u,e[3]=o*u,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},t.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},t.LDU=function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=i,t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=t[0],u=t[1],c=t[2],d=t[3];return Math.abs(r-s)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-d)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))},t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=r[0],d=r[1],h=r[2],l=r[3],f=r[4],R=r[5];return e[0]=n*c+a*d,e[1]=i*c+o*d,e[2]=n*h+a*l,e[3]=i*h+o*l,e[4]=n*f+a*R+s,e[5]=i*f+o*R+u,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.clone=function(e){var t=new a.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.fromValues=function(e,t,r,n,i,o){var s=new a.ARRAY_TYPE(6);return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s},t.set=function(e,t,r,n,i,a,o){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=r*a-n*i;return u?(u=1/u,e[0]=a*u,e[1]=-n*u,e[2]=-i*u,e[3]=r*u,e[4]=(i*s-a*o)*u,e[5]=(n*o-r*s)*u,e):null},t.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},t.multiply=n,t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=Math.sin(r),d=Math.cos(r);return e[0]=n*d+a*c,e[1]=i*d+o*c,e[2]=n*-c+a*d,e[3]=i*-c+o*d,e[4]=s,e[5]=u,e},t.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=r[0],d=r[1];return e[0]=n*c,e[1]=i*c,e[2]=a*d,e[3]=o*d,e[4]=s,e[5]=u,e},t.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=r[0],d=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=n*c+a*d+s,e[5]=i*c+o*d+u,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},t.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=t[0],d=t[1],h=t[2],l=t[3],f=t[4],R=t[5];return Math.abs(r-c)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-d)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(i-h)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-l)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(s-f)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(u-R)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(R))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],d=t[7],h=t[8],l=t[9],f=t[10],R=t[11],m=t[12],p=t[13],v=t[14],M=t[15],E=r[0],g=r[1],b=r[2],_=r[3];return e[0]=E*n+g*s+b*h+_*m,e[1]=E*i+g*u+b*l+_*p,e[2]=E*a+g*c+b*f+_*v,e[3]=E*o+g*d+b*R+_*M,E=r[4],g=r[5],b=r[6],_=r[7],e[4]=E*n+g*s+b*h+_*m,e[5]=E*i+g*u+b*l+_*p,e[6]=E*a+g*c+b*f+_*v,e[7]=E*o+g*d+b*R+_*M,E=r[8],g=r[9],b=r[10],_=r[11],e[8]=E*n+g*s+b*h+_*m,e[9]=E*i+g*u+b*l+_*p,e[10]=E*a+g*c+b*f+_*v,e[11]=E*o+g*d+b*R+_*M,E=r[12],g=r[13],b=r[14],_=r[15],e[12]=E*n+g*s+b*h+_*m,e[13]=E*i+g*u+b*l+_*p,e[14]=E*a+g*c+b*f+_*v,e[15]=E*o+g*d+b*R+_*M,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.fromValues=function(e,t,r,n,i,o,s,u,c,d,h,l,f,R,m,p){var v=new a.ARRAY_TYPE(16);return v[0]=e,v[1]=t,v[2]=r,v[3]=n,v[4]=i,v[5]=o,v[6]=s,v[7]=u,v[8]=c,v[9]=d,v[10]=h,v[11]=l,v[12]=f,v[13]=R,v[14]=m,v[15]=p,v},t.set=function(e,t,r,n,i,a,o,s,u,c,d,h,l,f,R,m,p){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=c,e[9]=d,e[10]=h,e[11]=l,e[12]=f,e[13]=R,e[14]=m,e[15]=p,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],d=t[8],h=t[9],l=t[10],f=t[11],R=t[12],m=t[13],p=t[14],v=t[15],M=r*s-n*o,E=r*u-i*o,g=r*c-a*o,b=n*u-i*s,_=n*c-a*s,U=i*c-a*u,A=d*m-h*R,T=d*p-l*R,y=d*v-f*R,L=h*p-l*m,I=h*v-f*m,w=l*v-f*p,x=M*w-E*I+g*L+b*y-_*T+U*A;return x?(x=1/x,e[0]=(s*w-u*I+c*L)*x,e[1]=(i*I-n*w-a*L)*x,e[2]=(m*U-p*_+v*b)*x,e[3]=(l*_-h*U-f*b)*x,e[4]=(u*y-o*w-c*T)*x,e[5]=(r*w-i*y+a*T)*x,e[6]=(p*g-R*U-v*E)*x,e[7]=(d*U-l*g+f*E)*x,e[8]=(o*I-s*y+c*A)*x,e[9]=(n*y-r*I-a*A)*x,e[10]=(R*_-m*g+v*M)*x,e[11]=(h*g-d*_-f*M)*x,e[12]=(s*T-o*L-u*A)*x,e[13]=(r*L-n*T+i*A)*x,e[14]=(m*E-R*b-p*M)*x,e[15]=(d*b-h*E+l*M)*x,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],d=t[8],h=t[9],l=t[10],f=t[11],R=t[12],m=t[13],p=t[14],v=t[15];return e[0]=s*(l*v-f*p)-h*(u*v-c*p)+m*(u*f-c*l),e[1]=-(n*(l*v-f*p)-h*(i*v-a*p)+m*(i*f-a*l)),e[2]=n*(u*v-c*p)-s*(i*v-a*p)+m*(i*c-a*u),e[3]=-(n*(u*f-c*l)-s*(i*f-a*l)+h*(i*c-a*u)),e[4]=-(o*(l*v-f*p)-d*(u*v-c*p)+R*(u*f-c*l)),e[5]=r*(l*v-f*p)-d*(i*v-a*p)+R*(i*f-a*l),e[6]=-(r*(u*v-c*p)-o*(i*v-a*p)+R*(i*c-a*u)),e[7]=r*(u*f-c*l)-o*(i*f-a*l)+d*(i*c-a*u),e[8]=o*(h*v-f*m)-d*(s*v-c*m)+R*(s*f-c*h),e[9]=-(r*(h*v-f*m)-d*(n*v-a*m)+R*(n*f-a*h)),e[10]=r*(s*v-c*m)-o*(n*v-a*m)+R*(n*c-a*s),e[11]=-(r*(s*f-c*h)-o*(n*f-a*h)+d*(n*c-a*s)),e[12]=-(o*(h*p-l*m)-d*(s*p-u*m)+R*(s*l-u*h)),e[13]=r*(h*p-l*m)-d*(n*p-i*m)+R*(n*l-i*h),e[14]=-(r*(s*p-u*m)-o*(n*p-i*m)+R*(n*u-i*s)),e[15]=r*(s*l-u*h)-o*(n*l-i*h)+d*(n*u-i*s),e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],c=e[8],d=e[9],h=e[10],l=e[11],f=e[12],R=e[13],m=e[14],p=e[15];return(t*o-r*a)*(h*p-l*m)-(t*s-n*a)*(d*p-l*R)+(t*u-i*a)*(d*m-h*R)+(r*s-n*o)*(c*p-l*f)-(r*u-i*o)*(c*m-h*f)+(n*u-i*s)*(c*R-d*f)},t.multiply=n,t.translate=function(e,t,r){var n=r[0],i=r[1],a=r[2],o=void 0,s=void 0,u=void 0,c=void 0,d=void 0,h=void 0,l=void 0,f=void 0,R=void 0,m=void 0,p=void 0,v=void 0;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],u=t[2],c=t[3],d=t[4],h=t[5],l=t[6],f=t[7],R=t[8],m=t[9],p=t[10],v=t[11],e[0]=o,e[1]=s,e[2]=u,e[3]=c,e[4]=d,e[5]=h,e[6]=l,e[7]=f,e[8]=R,e[9]=m,e[10]=p,e[11]=v,e[12]=o*n+d*i+R*a+t[12],e[13]=s*n+h*i+m*a+t[13],e[14]=u*n+l*i+p*a+t[14],e[15]=c*n+f*i+v*a+t[15]),e},t.scale=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,r,n){var i=n[0],o=n[1],s=n[2],u=Math.sqrt(i*i+o*o+s*s),c=void 0,d=void 0,h=void 0,l=void 0,f=void 0,R=void 0,m=void 0,p=void 0,v=void 0,M=void 0,E=void 0,g=void 0,b=void 0,_=void 0,U=void 0,A=void 0,T=void 0,y=void 0,L=void 0,I=void 0,w=void 0,x=void 0,S=void 0,P=void 0;return Math.abs(u)<a.EPSILON?null:(i*=u=1/u,o*=u,s*=u,c=Math.sin(r),h=1-(d=Math.cos(r)),l=t[0],f=t[1],R=t[2],m=t[3],p=t[4],v=t[5],M=t[6],E=t[7],g=t[8],b=t[9],_=t[10],U=t[11],A=i*i*h+d,T=o*i*h+s*c,y=s*i*h-o*c,L=i*o*h-s*c,I=o*o*h+d,w=s*o*h+i*c,x=i*s*h+o*c,S=o*s*h-i*c,P=s*s*h+d,e[0]=l*A+p*T+g*y,e[1]=f*A+v*T+b*y,e[2]=R*A+M*T+_*y,e[3]=m*A+E*T+U*y,e[4]=l*L+p*I+g*w,e[5]=f*L+v*I+b*w,e[6]=R*L+M*I+_*w,e[7]=m*L+E*I+U*w,e[8]=l*x+p*S+g*P,e[9]=f*x+v*S+b*P,e[10]=R*x+M*S+_*P,e[11]=m*x+E*S+U*P,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],u=t[7],c=t[8],d=t[9],h=t[10],l=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+c*n,e[5]=o*i+d*n,e[6]=s*i+h*n,e[7]=u*i+l*n,e[8]=c*i-a*n,e[9]=d*i-o*n,e[10]=h*i-s*n,e[11]=l*i-u*n,e},t.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],c=t[8],d=t[9],h=t[10],l=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-c*n,e[1]=o*i-d*n,e[2]=s*i-h*n,e[3]=u*i-l*n,e[8]=a*n+c*i,e[9]=o*n+d*i,e[10]=s*n+h*i,e[11]=u*n+l*i,e},t.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],c=t[4],d=t[5],h=t[6],l=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+c*n,e[1]=o*i+d*n,e[2]=s*i+h*n,e[3]=u*i+l*n,e[4]=c*i-a*n,e[5]=d*i-o*n,e[6]=h*i-s*n,e[7]=l*i-u*n,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,r){var n=r[0],i=r[1],o=r[2],s=Math.sqrt(n*n+i*i+o*o),u=void 0,c=void 0,d=void 0;return Math.abs(s)<a.EPSILON?null:(n*=s=1/s,i*=s,o*=s,u=Math.sin(t),d=1-(c=Math.cos(t)),e[0]=n*n*d+c,e[1]=i*n*d+o*u,e[2]=o*n*d-i*u,e[3]=0,e[4]=n*i*d-o*u,e[5]=i*i*d+c,e[6]=o*i*d+n*u,e[7]=0,e[8]=n*o*d+i*u,e[9]=i*o*d-n*u,e[10]=o*o*d+c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,u=i+i,c=a+a,d=n*s,h=n*u,l=n*c,f=i*u,R=i*c,m=a*c,p=o*s,v=o*u,M=o*c;return e[0]=1-(f+m),e[1]=h+M,e[2]=l-v,e[3]=0,e[4]=h-M,e[5]=1-(d+m),e[6]=R+p,e[7]=0,e[8]=l+v,e[9]=R-p,e[10]=1-(d+f),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],u=t[8],c=t[9],d=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(u*u+c*c+d*d),e},t.getRotation=function(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},t.fromRotationTranslationScale=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],u=i+i,c=a+a,d=o+o,h=i*u,l=i*c,f=i*d,R=a*c,m=a*d,p=o*d,v=s*u,M=s*c,E=s*d,g=n[0],b=n[1],_=n[2];return e[0]=(1-(R+p))*g,e[1]=(l+E)*g,e[2]=(f-M)*g,e[3]=0,e[4]=(l-E)*b,e[5]=(1-(h+p))*b,e[6]=(m+v)*b,e[7]=0,e[8]=(f+M)*_,e[9]=(m-v)*_,e[10]=(1-(h+R))*_,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,r,n,i){var a=t[0],o=t[1],s=t[2],u=t[3],c=a+a,d=o+o,h=s+s,l=a*c,f=a*d,R=a*h,m=o*d,p=o*h,v=s*h,M=u*c,E=u*d,g=u*h,b=n[0],_=n[1],U=n[2],A=i[0],T=i[1],y=i[2];return e[0]=(1-(m+v))*b,e[1]=(f+g)*b,e[2]=(R-E)*b,e[3]=0,e[4]=(f-g)*_,e[5]=(1-(l+v))*_,e[6]=(p+M)*_,e[7]=0,e[8]=(R+E)*U,e[9]=(p-M)*U,e[10]=(1-(l+m))*U,e[11]=0,e[12]=r[0]+A-(e[0]*A+e[4]*T+e[8]*y),e[13]=r[1]+T-(e[1]*A+e[5]*T+e[9]*y),e[14]=r[2]+y-(e[2]*A+e[6]*T+e[10]*y),e[15]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,c=r*o,d=n*o,h=n*s,l=i*o,f=i*s,R=i*u,m=a*o,p=a*s,v=a*u;return e[0]=1-h-R,e[1]=d+v,e[2]=l-p,e[3]=0,e[4]=d-v,e[5]=1-c-R,e[6]=f+m,e[7]=0,e[8]=l+p,e[9]=f-m,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,r,n,i,a,o){var s=1/(r-t),u=1/(i-n),c=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*u,e[10]=(o+a)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*c,e[15]=0,e},t.perspective=function(e,t,r,n,i){var a=1/Math.tan(t/2),o=1/(n-i);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*o,e[15]=0,e},t.perspectiveFromFieldOfView=function(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(i+a);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(o-s)*u*.5,e[9]=(i-a)*c*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},t.ortho=function(e,t,r,n,i,a,o){var s=1/(t-r),u=1/(n-i),c=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(o+a)*c,e[15]=1,e},t.lookAt=function(e,t,r,n){var i=void 0,o=void 0,s=void 0,u=void 0,c=void 0,d=void 0,h=void 0,l=void 0,f=void 0,R=void 0,m=t[0],p=t[1],v=t[2],M=n[0],E=n[1],g=n[2],b=r[0],_=r[1],U=r[2];return Math.abs(m-b)<a.EPSILON&&Math.abs(p-_)<a.EPSILON&&Math.abs(v-U)<a.EPSILON?mat4.identity(e):(h=m-b,l=p-_,f=v-U,i=E*(f*=R=1/Math.sqrt(h*h+l*l+f*f))-g*(l*=R),o=g*(h*=R)-M*f,s=M*l-E*h,(R=Math.sqrt(i*i+o*o+s*s))?(i*=R=1/R,o*=R,s*=R):(i=0,o=0,s=0),u=l*s-f*o,c=f*i-h*s,d=h*o-l*i,(R=Math.sqrt(u*u+c*c+d*d))?(u*=R=1/R,c*=R,d*=R):(u=0,c=0,d=0),e[0]=i,e[1]=u,e[2]=h,e[3]=0,e[4]=o,e[5]=c,e[6]=l,e[7]=0,e[8]=s,e[9]=d,e[10]=f,e[11]=0,e[12]=-(i*m+o*p+s*v),e[13]=-(u*m+c*p+d*v),e[14]=-(h*m+l*p+f*v),e[15]=1,e)},t.targetTo=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=n[0],u=n[1],c=n[2],d=i-r[0],h=a-r[1],l=o-r[2],f=d*d+h*h+l*l;f>0&&(d*=f=1/Math.sqrt(f),h*=f,l*=f);var R=u*l-c*h,m=c*d-s*l,p=s*h-u*d;return e[0]=R,e[1]=m,e[2]=p,e[3]=0,e[4]=h*p-l*m,e[5]=l*R-d*p,e[6]=d*m-h*R,e[7]=0,e[8]=d,e[9]=h,e[10]=l,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],d=e[7],h=e[8],l=e[9],f=e[10],R=e[11],m=e[12],p=e[13],v=e[14],M=e[15],E=t[0],g=t[1],b=t[2],_=t[3],U=t[4],A=t[5],T=t[6],y=t[7],L=t[8],I=t[9],w=t[10],x=t[11],S=t[12],P=t[13],B=t[14],D=t[15];return Math.abs(r-E)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(E))&&Math.abs(n-g)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(i-b)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(o-_)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(s-U)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(U))&&Math.abs(u-A)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(c-T)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(d-y)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(y))&&Math.abs(h-L)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(l-I)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(f-w)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(R-x)<=a.EPSILON*Math.max(1,Math.abs(R),Math.abs(x))&&Math.abs(m-S)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(S))&&Math.abs(p-P)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(v-B)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs(B))&&Math.abs(M-D)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(D))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(){var e=new c.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function a(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function o(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],u=r[1],c=r[2],d=r[3];return e[0]=n*d+o*s+i*c-a*u,e[1]=i*d+o*u+a*s-n*c,e[2]=a*d+o*c+n*u-i*s,e[3]=o*d-n*s-i*u-a*c,e}function s(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],u=r[0],c=r[1],d=r[2],h=r[3],l=void 0,f=void 0,R=void 0,m=void 0,p=void 0;return(f=i*u+a*c+o*d+s*h)<0&&(f=-f,u=-u,c=-c,d=-d,h=-h),1-f>1e-6?(l=Math.acos(f),R=Math.sin(l),m=Math.sin((1-n)*l)/R,p=Math.sin(n*l)/R):(m=1-n,p=n),e[0]=m*i+p*u,e[1]=m*a+p*c,e[2]=m*o+p*d,e[3]=m*s+p*h,e}function u(e,t){var r=t[0]+t[4]+t[8],n=void 0;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=i,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},t.setAxisAngle=a,t.getAxisAngle=function(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return 0!=n?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r},t.multiply=o,t.rotateX=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+o*s,e[1]=i*u+a*s,e[2]=a*u-i*s,e[3]=o*u-n*s,e},t.rotateY=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u-a*s,e[1]=i*u+o*s,e[2]=a*u+n*s,e[3]=o*u-i*s,e},t.rotateZ=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+i*s,e[1]=i*u-n*s,e[2]=a*u+o*s,e[3]=o*u-a*s,e},t.calculateW=function(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e},t.slerp=s,t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=a*s,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},t.fromMat3=u,t.fromEuler=function(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(r),u=Math.cos(r),c=Math.sin(n),d=Math.cos(n);return e[0]=a*u*d-o*s*c,e[1]=o*s*d+a*u*c,e[2]=o*u*c-a*s*d,e[3]=o*u*d+a*s*c,e},t.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"};var c=n(r(0)),d=n(r(1)),h=n(r(2)),l=n(r(3)),f=(t.clone=l.clone,t.fromValues=l.fromValues,t.copy=l.copy,t.set=l.set,t.add=l.add,t.mul=o,t.scale=l.scale,t.dot=l.dot,t.lerp=l.lerp,t.length=l.length),R=(t.len=f,t.squaredLength=l.squaredLength),m=(t.sqrLen=R,t.normalize=l.normalize);t.exactEquals=l.exactEquals,t.equals=l.equals,t.rotationTo=function(){var e=h.create(),t=h.fromValues(1,0,0),r=h.fromValues(0,1,0);return function(n,i,o){var s=h.dot(i,o);return s<-.999999?(h.cross(e,t,i),h.len(e)<1e-6&&h.cross(e,r,i),h.normalize(e,e),a(n,e,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(h.cross(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+s,m(n,n))}}(),t.sqlerp=function(){var e=i(),t=i();return function(r,n,i,a,o,u){return s(e,n,o,u),s(t,i,a,u),s(r,e,t,2*u*(1-u)),r}}(),t.setAxes=function(){var e=d.create();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],m(t,u(t,e))}}()},function(e,t,r){"use strict";function n(){var e=new h.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function s(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function u(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function c(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function d(e){var t=e[0],r=e[1];return t*t+r*r}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.sqrDist=t.dist=t.div=t.mul=t.sub=t.len=void 0,t.create=n,t.clone=function(e){var t=new h.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},t.fromValues=function(e,t){var r=new h.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},t.set=function(e,t,r){return e[0]=t,e[1]=r,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},t.subtract=i,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e},t.distance=s,t.squaredDistance=u,t.length=c,t.squaredLength=d,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},t.normalize=function(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},t.cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e},t.lerp=function(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e},t.random=function(e,t){t=t||1;var r=2*h.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},t.transformMat2=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e},t.transformMat2d=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e},t.transformMat3=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},t.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},t.equals=function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return Math.abs(r-i)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))};var h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.len=c,t.sub=i,t.mul=a,t.div=o,t.dist=s,t.sqrDist=u,t.sqrLen=d,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,u=void 0;for(r||(r=2),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],a(e,e,o),t[u]=e[0],t[u+1]=e[1];return t}}()}])}),function(){var e;RedGLUtil={throwFunc:function(){throw Array.prototype.slice.call(arguments).join(" ")},copyProto:function(e,t){for(var r in t.prototype)e.prototype[r]=t.prototype[r]},hexToRGB:function(e){var t,r;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return r=[],3==(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),t="0x"+t.join(""),r[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,r;RedGLUtil.throwFunc("RedGLUtil.hexToRGB : 잘못된 hex값입니다.",e)},rgb2hex:(e,t,r)=>"#"+(16777216+(r|t<<8|e<<16)).toString(16).slice(1),getStrFromComment:function(t){if("string"!=typeof t&&RedGLUtil.throwFunc("getStrFromComment : 해석할 값은 문자열만 가능",t),e=t.toString().trim().match(/(\/\*)[\s\S]+(\*\/)/g))return e[0].replace(/\/\*|\*\//g,"").trim();RedGLUtil.throwFunc("getStrFromComment : 해석할 불가능한 값",t)}},Object.freeze(RedGLUtil)}(),function(){var e,t,r,n,i,a,o,s,u,c,d,h;t=function(e){if(!(this instanceof t))return new t(e);for(r="VENDOR,VERSION,SHADING_LANGUAGE_VERSION,RENDERER,MAX_VERTEX_ATTRIBS,MAX_VARYING_VECTORS,MAX_VERTEX_UNIFORM_VECTORS,MAX_VERTEX_TEXTURE_IMAGE_UNITS,MAX_FRAGMENT_UNIFORM_VECTORS,MAX_TEXTURE_SIZE,MAX_CUBE_MAP_TEXTURE_SIZE,MAX_COMBINED_TEXTURE_IMAGE_UNITS,MAX_TEXTURE_IMAGE_UNITS,MAX_RENDERBUFFER_SIZE,MAX_VIEWPORT_DIMS,RED_BITS,GREEN_BITS,BLUE_BITS,ALPHA_BITS,DEPTH_BITS,STENCIL_BITS".split(","),n=r.length;n--;)this[i=r[n]]=e.getParameter(e[i])},e=function(){var e,t,r,n,i,a;return t={alpha:!1,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!1,powerPreference:"default",failIfMajorPerformanceCaveat:!1},e="webkit-3d,moz-webgl,3d,experimental-webgl,webgl".split(","),function(o,s){if(a=JSON.parse(JSON.stringify(t)),i=e.length,s)for(i in s)a[i]=s[i];for(;i--;)if(r=o.getContext(n=e[i],a)){return r.OES_element_index_uint=r.getExtension("OES_element_index_uint"),r.EXT_texture_filter_anisotropic=r.getExtension("EXT_texture_filter_anisotropic"),r.version=n,r}return null}}(),(RedGL=function(r,n,i){var a,o,s,u;if(!(this instanceof RedGL))return new RedGL(r,n);r instanceof Element&&"CANVAS"==r.tagName||RedGLUtil.throwFunc("RedGL : Canvas Element만 허용"),o=this,s=!0,u=1,Object.defineProperty(this,"renderScale",{get:function(){return u},set:function(e){u=e,this.setSize(this._width,this._height,!0)}}),Object.defineProperty(this,"fullMode",{get:function(){return s},set:function(e){"boolean"!=typeof e&&RedGLUtil.throwFunc("RedGL : Boolean만 가능."),s=e,this.setSize(this._width,this._height)}}),this._canvas=r,this._width=500,this._height=500,this.gl=a=e(r),a&&(this._detect=t(a,i)),this._datas={},this._UUID=RedGL.makeUUID(),requestAnimationFrame(function(e){var t,r;window.addEventListener("resize",function(){o.setSize(o._width,o._height)}),o.setSize(o._width,o._height);var i=o._detect.MAX_COMBINED_TEXTURE_IMAGE_UNITS,s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC";for(t=RedBitmapTexture(o,s),r=RedBitmapCubeTexture(o,[s,s,s,s,s,s]),o._datas.emptyTexture={"2d":t,"3d":r},n&&n.call(o,!!a);i--;)1!=i?(a.activeTexture(a.TEXTURE0+i),a.bindTexture(a.TEXTURE_2D,t.webglTexture)):(a.activeTexture(a.TEXTURE0+1),a.bindTexture(a.TEXTURE_CUBE_MAP,r.webglTexture))})}).makeUUID=(a=0,function(){return a++}),RedGL.prototype={setSize:(u=0,c=0,function(e,t,r){this.fullMode?(o=document.documentElement?document.documentElement.clientWidth:document.body.clientWidth,s=window.innerHeight):(void 0==e&&RedGLUtil.throwFunc("RedGL setSize : width가 입력되지 않았습니다."),void 0==t&&RedGLUtil.throwFunc("RedGL setSize : height가 입력되지 않았습니다."),"string"==typeof e&&-1!=e.indexOf("%")&&RedGLUtil.throwFunc("RedGL setSize : width는 %로 입력할수 없음."),"string"==typeof t&&-1!=t.indexOf("%")&&RedGLUtil.throwFunc("RedGL setSize: height는 %로 입력할수 없음."),this._width=o=e,this._height=s=t),d=window.devicePixelRatio||1,h=this._canvas,(u!=o||c!=s||r)&&(h.width=o*d*this.renderScale,h.height=s*d*this.renderScale,h.style.width=o,h.style.height=s,u=o,c=s)})},Object.freeze(RedGL)}(),function(){var e;(RedBaseContainer=function(){RedGLUtil.throwFunc("RedBaseContainer : 생성자/직접실행으로 사용 할 수 없습니다.")}).prototype={addChild:function(t){t instanceof RedMesh||t instanceof RedSprite3D||t instanceof RedLine||t instanceof RedPointUnit||RedGLUtil.throwFunc("addChild","RedMesh,RedSprite3D,RedLine,RedPointUnit Instance만 가능"),-1!=(e=this.children.indexOf(t))&&(t=this.children.splice(e,1)),this.children.push(t)},addChildAt:function(){var e;return function(t,r){t instanceof RedMesh||t instanceof RedSprite3D||t instanceof RedLine||t instanceof RedPointUnit||RedGLUtil.throwFunc("addChildAt","RedMesh,RedSprite3D,RedLine,RedPointUnit Instance만 가능"),e=this.children.indexOf(t),this.children.splice(e,0,t)}}(),removeChild:function(){var e;return function(t){-1==(e=this.children.indexOf(t))?RedGLUtil.throwFunc("removeChild","존재하지 않는 RedMesh를 삭제하려고 함"):this.children.splice(e,1)}}(),removeChildAt:function(){return function(e){"number"!=typeof e&&RedGLUtil.throwFunc("removeChildAt","index가 Number형이 아님 "),this.children[e]&&this.children.splice(void 0,1)}},removeChildAll:function(){this.children.length=0},getChildAt:function(e){return"number"!=typeof e&&RedGLUtil.throwFunc("getChildAt","index가 Number형이 아님 "),this.children[e]},getChildIndex:function(e){return this.children.indexOf(e)},numChildren:function(e){return this.children.length}},Object.freeze(RedBaseContainer)}(),function(){var e;(RedBaseLight=function(){RedGLUtil.throwFunc("RedBaseLight : 생성자/직접실행으로 사용 할 수 없습니다.")}).prototype={addCasting:function(e){-1==this._castingList.indexOf(e)&&this._castingList.push(e)},removeCasting:function(e){this._castingList.indexOf(e)>-1&&this._castingList.splice},_castingList:[],setColor:function(t,r){t=t||"#fff",void 0==r&&(r=this.alpha),r>1&&(r=1),this.alpha=r,e=RedGLUtil.hexToRGB.call(this,t),this.color[0]=e[0],this.color[1]=e[1],this.color[2]=e[2],this.color[3]=this.alpha}},Object.freeze(RedBaseLight)}(),(RedBaseMaterial=function(){RedGLUtil.throwFunc("RedBaseMaterial : 생성자/직접실행으로 사용 할 수 없습니다.")}).prototype={checkProperty:function(){var e,t,r;for(e=(t=this.program.uniformLocation).length;e--;)(r=t[e]).location&&!this.hasOwnProperty(r.materialPropertyName)&&RedGLUtil.throwFunc("Material에 ",r.materialPropertyName,"이 정의 되지않았습니다.")},checkProgram:function(e,t,r,n){return RedProgram.hasKey(e,t)?RedProgram(e,t):RedProgram(e,t,RedShader(e,t+"_VS",RedShader.VERTEX,r),RedShader(e,t+"_FS",RedShader.FRAGMENT,n))}},Object.freeze(RedBaseMaterial),function(){var e;(RedBaseObject3D=function(){RedGLUtil.throwFunc("RedBaseObject3D : 생성자/직접실행으로 사용 할 수 없습니다.")}).build=function(e){this.useCullFace=!0,this.cullFace=e.BACK,this.useDepthTest=!0,this.depthTestFunc=e.LEQUAL,this.useBlendMode=!0,this.blendSrc=e.ONE,this.blendDst=e.ONE_MINUS_SRC_ALPHA,this.drawMode=e.TRIANGLES,this.pointSize=1,this.x=this.y=this.z=0,this.rotationX=this.rotationY=this.rotationZ=0,this.scaleX=this.scaleY=this.scaleZ=1,this.matrix=mat4.create(),this.normalMatrix=mat4.create(),this.children=[]},RedBaseObject3D.prototype={localToWorld:(e=mat4.create(),function(t,r,n){return t=t||0,r=r||0,n=n||0,mat4.identity(e),mat4.translate(e,e,[t,r,n]),mat4.multiply(e,this.matrix,e),[e[12],e[13],e[14]]}),worldToLocal:function(){var e,t;return e=mat4.create(),t=mat4.create(),function(r,n,i){return r=r||0,n=n||0,i=i||0,mat4.translate(e,e,[r,n,i]),mat4.multiply(t,e,this.matrix),[t[0]*r+t[1]*n+t[2]*i+t[3],t[4]*r+t[5]*n+t[6]*i+t[7],t[8]*r+t[9]*n+t[10]*i+t[11]]}}()},Object.freeze(RedBaseObject3D)}(),(RedFrameBuffer=function(e,t,r){if(!(this instanceof RedFrameBuffer))return new RedFrameBuffer(e,t,r);var n;e instanceof RedGL||RedGLUtil.throwFunc("RedFrameBuffer : RedGL Instance만 허용됩니다.",e),n=e.gl,t=t||1920,r=r||1080,t>2048&&(t=2048),r>2048&&(r=2048),this.redGL=e,this.width=t,this.height=r,this.webglFrameBuffer=n.createFramebuffer(),this.webglRenderBuffer=n.createRenderbuffer(),this.texture=RedBitmapTexture(e),this._UUID=RedGL.makeUUID(),n.bindFramebuffer(n.FRAMEBUFFER,this.webglFrameBuffer),n.bindTexture(n.TEXTURE_2D,this.texture.webglTexture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.bindRenderbuffer(n.RENDERBUFFER,this.webglRenderBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,this.width,this.height),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.texture.webglTexture,0),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.webglRenderBuffer),n.bindTexture(n.TEXTURE_2D,null),n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,null)}).prototype={bind:function(e){e.bindFramebuffer(e.FRAMEBUFFER,this.webglFrameBuffer),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture.webglTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindRenderbuffer(e.RENDERBUFFER,this.webglRenderBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this.width,this.height),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.webglTexture,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.webglRenderBuffer)},unbind:function(e){e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}},Object.freeze(RedFrameBuffer),function(){var e,t,r,n,i;e=function(e,t,r){switch(t){case RedBuffer.ARRAY_BUFFER:if(r instanceof Float32Array||r instanceof Float64Array){if(r instanceof Float32Array)return e.FLOAT;if(r instanceof Float64Array)return e.FLOAT}else RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ARRAY_BUFFER)형식을 사용해야합니다.");break;case RedBuffer.ELEMENT_ARRAY_BUFFER:if(r instanceof Uint8Array||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array){if(r instanceof Int8Array)return e.BYTE;if(r instanceof Uint8Array)return e.UNSIGNED_BYTE;if(r instanceof Uint16Array)return e.UNSIGNED_SHORT;if(r instanceof Uint32Array)return e.UNSIGNED_INT;if(r instanceof Int16Array)return e.SHORT;if(r instanceof Int32Array)return e.INT}else RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ELEMENT_ARRAY_BUFFER)형식을 사용해야합니다.");break;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ")}},t=function(e,t){switch(t){case RedBuffer.ARRAY_BUFFER:return e.ARRAY_BUFFER;case RedBuffer.ELEMENT_ARRAY_BUFFER:return e.ELEMENT_ARRAY_BUFFER;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ")}},r=function(e,t,r,a){switch(n=0,t){case RedBuffer.ARRAY_BUFFER:if(e.interleaveDefineInfo=a,a){for(i in a)a[i]instanceof RedInterleaveInfo||RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfo의 정보는 RedInterleaveInfo Instance로만 구성되어야합니다.",a),a[i].offset=a.length<2?0:n,n+=a[i].size,a[i]._UUID=RedGL.makeUUID();a.forEach(function(e){a[e.attributeKey]=e}),a.length<2?(e.stride=0,e.pointNum=r.length/3):(e.stride=n,e.pointNum=r.length/n)}else RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfo는 반드시 정의 되어야합니다.");break;case RedBuffer.ELEMENT_ARRAY_BUFFER:e.pointNum=r.length}},(RedBuffer=function(n,i,a,o,s,u){if(!(this instanceof RedBuffer))return new RedBuffer(n,i,a,o,s,u);n instanceof RedGL||RedGLUtil.throwFunc("RedBuffer : RedGL Instance만 허용됩니다.",n),"string"!=typeof o&&RedGLUtil.throwFunc("RedBuffer : bufferType - 문자열만 허용됩니다."),"string"!=typeof i&&RedGLUtil.throwFunc("RedBuffer : key - 문자열만 허용됩니다."),o!=RedBuffer.ARRAY_BUFFER||s||RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfo를 반드시 정의해야합니다.");var c=n.gl;if(n._datas[o]||(n._datas[o]={}),n._datas[o][i])return n._datas[o][i];n._datas[o][i]=this,this.key=i,this.data=a,this.bufferType=o,this.glArrayType=e(c,this.bufferType,this.data),this.glBufferType=t(c,this.bufferType),this.drawMode=u||c.STATIC_DRAW,r(this,this.bufferType,this.data,s),this.webglBuffer=c.createBuffer(),this._UUID=RedGL.makeUUID(),this.upload=function(t){this.glArrayType==e(c,o,t)?(this.data=t,c.bindBuffer(this.glBufferType,this.webglBuffer),c.bufferData(this.glBufferType,this.data,this.drawMode)):RedGLUtil.throwFunc("RedBuffer : upload - data형식이 기존 형식과 다름",t)},this.parseInterleaveDefineInfo=function(){r(this,this.bufferType,this.data,this.interleaveDefineInfo)},this.upload(this.data)}).ARRAY_BUFFER="arrayBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER="elementArrayBuffer",Object.freeze(RedBuffer)}(),RedGeometry=function(e,t){if(!(this instanceof RedGeometry))return new RedGeometry(e,t);e instanceof RedBuffer?e.bufferType!=RedBuffer.ARRAY_BUFFER&&RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer.ARRAY_BUFFER 타입만.",e):RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer Instance만 허용.",e),t&&(t instanceof RedBuffer?t.bufferType!=RedBuffer.ELEMENT_ARRAY_BUFFER&&RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer.ELEMENT_ARRAY_BUFFER 타입만.",t):RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer Instance만 허용.",t)),this.interleaveBuffer=e,this.indexBuffer=t,this._UUID=RedGL.makeUUID()},Object.freeze(RedGeometry),RedInterleaveInfo=function(e,t,r){if(!(this instanceof RedInterleaveInfo))return new RedInterleaveInfo(e,t,r);"string"!=typeof e&&RedGLUtil.throwFunc("RedInterleaveInfo : attributeKey - 문자열만 허용",e),"number"!=typeof t&&RedGLUtil.throwFunc("RedInterleaveInfo : size - 숫자만 허용",t),this.attributeKey=e,this.size=t,this.normalize=void 0!=r,this.offset=null},Object.freeze(RedInterleaveInfo),(RedAmbientLight=function(e,t,r){if(!(this instanceof RedAmbientLight))return new RedAmbientLight(e,t,r);this.color=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?.1:r,this.setColor(t||"#fff",this.alpha),this._UUID=RedGL.makeUUID(),Object.defineProperty(this,"type",{configurable:!1,writable:!1,value:RedAmbientLight.type})}).type="RedAmbientLight",RedGLUtil.copyProto(RedAmbientLight,RedBaseLight),Object.defineProperty(RedAmbientLight.prototype,"alpha",{get:function(){return this.color[3]},set:function(e){this.color[3]=e}}),Object.freeze(RedAmbientLight),(RedDirectionalLight=function(e,t,r){if(!(this instanceof RedDirectionalLight))return new RedDirectionalLight(e,t,r);this.color=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?1:r,this.setColor(t||"#fff",this.alpha),this.x=0,this.y=-1,this.z=0,this._UUID=RedGL.makeUUID(),Object.defineProperty(this,"type",{configurable:!1,writable:!1,value:RedDirectionalLight.type}),this.debug=!1,this.debugObject=RedSprite3D(e,RedBitmapMaterial(e,RedBitmapTexture(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA25pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDozQjcyMEREMTUyMDYxMUU4OTRDNTgzQTBBMEY2MkFFNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDODA1NTI0RjUyMDYxMUU4QkVBQTg3NjZCN0M1OUI2OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDODA1NTI0RTUyMDYxMUU4QkVBQTg3NjZCN0M1OUI2OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowNmFjYmZjZi05YjBkLThlNGItODZiNy1kNWViYWNjZDg4OGMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6M0I3MjBERDE1MjA2MTFFODk0QzU4M0EwQTBGNjJBRTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4vVcpuAAAHNUlEQVR42uxbeWyURRT/tiw9OAJYUekfeBCFNmqlkAgRtURQaTywWIhGSfDAAzmkggcoKopKRQXFKKZqNGmkqGAkGEQFhaQenGrAI3iUpKilaiPSytKt74XfF6evM/vN7n67+xn6kl/Sb3bmvTdvZt68eTMNtbe3O8cyhboM0GWALgN0LKkJpUv2lYQFBFbgYcI7aZF6bcf+ZmXI8L0IlYShhBLCbELPTCiSKQOcTRimfA8nFP/fDTCEMJrQw2bpEVqV71ZLXXpARmHQDDCZ8DnhI8IrFkZoI0SVb/77iEXnX4WMzyAzEAbIJSwk9Mb3RMKMFMzWmYQK/N0bMnODYAB2q42i7B5CkY+dZ153i7JGyM64Af4hVIk13cdjFoQsy1yaAZ6qz6iC7ED4gJWEjaLsRkKpoX53MX1zUaajUvBSaSNkBmoXuI/QonyHCXMIeZq6PxJ+Vb5/I/ykqZcHHmGljGXcG8RtcCfhRVFWpjgulfahEzvQjn1GvaZeBXio9AJhV1ADoUcITaJsmKHuKvxWgr91NFx8N0FG2gOhbpb1WMGbxXRd6SE/lg61wrneRPjdT51tDkOTELe3YvrVWPC9CnH+h4SPlfKLCKMQChco/oEN1UD4krAF7Vy6EO14uay2kH0N4XZCDmFJpwEQhyEvAwxF1OV66MOEd8G4znIkuJNTCNcjhO3jUb+ZsIfwOqLKFks5IzFQlxOyURYhnAvjJXQa7Cu2J2Y8gbCBsJhwskf7SzCizxJGWHTejSFGoM0W8IhFA6HLBuiWLbbbvsn4gJ2GKd8T29NWeGodHx6NdXByWQn6pxLwqDT8XgEd5hiO0zXog5HCHkr8QbiO8AMOHwPF78fDUZWL9cmeep6B527CNsK3hAMKn8HYFYo0HX2S0I8wXyRUag0y6nFwWuBl5bDFSPCiuR/WvItwg6bO+YoB7jR0fjthBXxIg0FWAdbwVIy+SvOwyzytyNTRyzDYnlSlxEYh6hunePCLsV75t82aNrx7PCiiv1h0IurfajC2K+t9ZSd5j7AIv1mnxBLNCXJK61KMEiuxCdvOds0U5o48lGCcsgDt5RIqwUGoFMbfAQMcjDcn6GdSlPfe5aJsKWFWksHaM8gFqDSN8HxC3FKUFM3CulXpa2xPydJi8FJpql+6+2WACwiDNCPX4APvBvBSaRBkBsYAY+AXXOItbo2PZ5Y14Kn6oDF+MA7HyPMVI5I6IrI2XPY9Yb9SfpZoX6c5FSZDTeA5OIZM3jnOgL7t4lDUhiN0i40BLkNkVYjGUc0pqxGxQS1m0QBR5xvHf5I8B0A268eJWL5d6q/RNwSD7EYaba2XAZZrIj5J/bA9rYbFszUj5jdJntnoWHfoMtjCT50iDZCpm6HAkG4GTMMSKFKmjzRaI6wewfdhUSc/BbpKnoehXwS6LMQSaNPo24bQuMrGAGuRkChWHIi6nrjNd0pYGxUOkWlICgwgee5X1nstQvDTYZB20ccInGCr7S7A3vLTOJT7inCFSE7k++gL8sFTypQG2Z+pOOADEYezQxrv4+iPF07uIGQGJhD6hLBXlM3C8TZZKtCcJ/ZCZmAMEMVZX6UzCXN94D0XvFRaodnv02qAXkhHLXL+u/6qRrCh0kybrIzHcXim5jhcjb9LocPVIhS3pmM+IRLPDCiE5TcrnXegQDn+ZuGzNW25I5zcvMXDLxSgzjpD52crHSx3Ot47joNu1U4cL0hsZkAIcfbkGCFyKpOiLj3qdEyK8uXL24a65qRonBkhjvmf42YGQQeQCXpL45QqkcxI1tFG4QiXaPzXBJxd+hvaciL3DudodjuhJXCOofN/I6zky8tVBo/MCvPN7vYEPXYUbcs0nXd/XwUdqqBTp/FGHxLeBf5EGOkSJyLfJIzFqPzs0X49nNV0RJbNFh1vRt3paLveo349dBmLmaieSyLoQ1I+QL0c5UTkGxad4PVZgmjNj8vRMfAbNlkmvhy9DUmdpC9H1ZliO41V59SKkTFtTe4Vdpvh9/NgxFyFt22qrZuWb4LboG3n+dDykkitTfTgG4v3JKfjW6LqOI7abekMhV2ar1Fwq6FuBZzcNkf/jEbX9jixFSZNfl6McP6gTgQn6xCmymQkxxP80us05XDDT2D3iXp5cLpl4qg+0kn0nVAKX4s/Jjp/BNuT7oED5+ZOEKHvqYa8RJXTMTOdB1m+kF8GmIQRdMR63WSoH3E6P5aOGOpuUg4/Lo2GzEAYIAc5xFyxly+L0abdssylZSKGyIXMnCAYIKQJRZ/QHI2TIeb1uCjr74f+fhiApy9fkvyFbw5Plzr+E88C90UIy3rAsX9AZaSwT8q9RviCcJJz9FXZIQu5WWIgvN71Mc8pyC384li+AEmXARwoZKtU1On8WNrm6fshp/Oj7EDsAvHSLhHkbMM5IO0UzpAB+Oj6FPJ4IRxaDmZCka5/nOwyQJcBjm0D/CvAAF/S81D+EWScAAAAAElFTkSuQmCC")))}).type="RedDirectionalLight",RedGLUtil.copyProto(RedDirectionalLight,RedBaseLight),Object.defineProperty(RedDirectionalLight.prototype,"alpha",{get:function(){return this.color[3]},set:function(e){this.color[3]=e}}),Object.freeze(RedDirectionalLight),(RedPointLight=function(e,t,r){if(!(this instanceof RedPointLight))return new RedPointLight(e,t,r);this.color=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?1:r,this.setColor(t||"#fff",this.alpha),this.x=0,this.y=0,this.z=0,this.radius=1,this._UUID=RedGL.makeUUID(),Object.defineProperty(this,"type",{configurable:!1,writable:!1,value:RedPointLight.type}),this.debug=!1,this.debugObject=RedMesh(e,RedSphere(e,1,16,16,16),RedColorMaterial(e)),this.debugObject.drawMode=e.gl.LINE_STRIP}).type="RedPointLight",RedGLUtil.copyProto(RedPointLight,RedBaseLight),Object.defineProperty(RedPointLight.prototype,"alpha",{get:function(){return this.color[3]},set:function(e){this.color[3]=e}}),Object.freeze(RedPointLight),JsonModelLoader=function(e,t,r,n){if(!(this instanceof JsonModelLoader))return new JsonModelLoader(e,t,r,n);var i=new XMLHttpRequest;i.open("GET",r,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.onreadystatechange=function(){if(4==i.readyState){var r,a,o,s;for(a=[],o=0,s=(r=JSON.parse(i.responseText)).position.length/3;o<s;o++)a.push(r.position[3*o],r.position[3*o+1],r.position[3*o+2]),a.push(r.normal[3*o],r.normal[3*o+1],r.normal[3*o+2]),r.uvs?a.push(r.uvs[2*o],r.uvs[2*o+1]):a.push(0,0);n&&n(RedBuffer(e,t,new Float32Array(a),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),RedBuffer(e,t,new Uint16Array(r.index),RedBuffer.ELEMENT_ARRAY_BUFFER))}},i.send()},Object.freeze(JsonModelLoader),function(){var e,t;t=function(){},RedMTLLoader=function(r,n,i,a){if(!(this instanceof RedMTLLoader))return new RedMTLLoader(r,n,i,a);var o=this,s=new XMLHttpRequest;s.open("GET",n+i,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.onreadystatechange=function(){if(4==s.readyState){var n;if(o.complete=!0,200==s.status)n=e(o,r,s.responseText),o.parseData=n;else o.parseData=new t;a&&a(o.parseData)}},s.addEventListener("error",function(e){}),s.send(),this.path=n,this.fileName=i,this.complete=!1,this.parseData=null},e=function(e,r,n){var i,a,o,s,u,c,d,h,l,f,R,m,p,v;for(var M in i={},o=/^(newmtl )/,s=/^(Ns )/,u=/^(Ka )/,c=/^(Kd )/,d=/^(Ks )/,h=/^(Ni )/,l=/^(d )/,f=/^(illum )/,R=/^(map_Kd )/,/^(map_Ks )/,m=/^(map_Ns )/,p=/^(map_bump )/,(n=n.replace(/^\#[\s\S]+?\n/g,"")).split("\n").forEach(function(t){var r;o.test(t)?(r=t.replace("newmtl ","").trim(),v={name:r},i[r]=v):u.test(t)?v.Ka=t.replace("Ka ","").split(" "):c.test(t)?v.Kd=t.replace("Kd ","").split(" "):d.test(t)?v.Ks=t.replace("Ks ","").split(" "):s.test(t)?v.Ns=+t.replace("Ns ",""):h.test(t)?v.Ni=+t.replace("Ni ",""):l.test(t)?v.d=+t.replace("d ",""):f.test(t)?(v.illum=+t.replace("illum ",""),v.illum):R.test(t)?v.map_Kd=e.path+t.replace("map_Kd ",""):m.test(t)?v.map_Ns=e.path+t.replace("map_Ns ",""):p.test(t)&&(v.map_bump=e.path+t.replace("map_bump ","").split(" ")[2])}),a=new t,i)a[M]=i[M];return a},Object.freeze(RedMTLLoader)}(),function(){var e,t,r,n,i,a,o,s,u,c,d,h,l,f,R;RedOBJLoader=function(t,r,n,i){if(!(this instanceof RedOBJLoader))return new RedOBJLoader(t,r,n,i);var a=this,o=new XMLHttpRequest;o.open("GET",r+n,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.onreadystatechange=function(){4==o.readyState&&(a.result=e(a,t,o.responseText),a.modelParsingComplete=!0,a.resultMesh=void 0,i&&(a.mtlLoader?a.mtlLoader.complete&&i(a.result):i(a.result)))},o.send(),this.path=r,this.fileName=n,this.mtlLoader=null,this.modelParsingComplete=!1,this.callback=i,this.resultMesh=RedMesh(t),this.resultMesh.name="instanceOfRedOBJLoader_"+RedGL.makeUUID(),this.result=null},r=function(e,t,r){var n,i,a,o;for(n in o={},t){var s,u,c,d,h,l;if((a=t[n]).mesh,a.use&&a.resultInterleave.length)l=a.ableLight,(i=r.parseData[a.materialKey])&&(i.map_Kd?(o[i.map_Kd]?u=o[i.map_Kd]:(u=RedBitmapTexture(e,i.map_Kd),o[i.map_Kd]=u),s=l?RedStandardMaterial(e,u):RedBitmapMaterial(e,u)):i.Kd&&(c=255*i.Kd[0],d=255*i.Kd[1],h=255*i.Kd[2],s=l?RedColorPhongTextureMaterial(e,RedGLUtil.rgb2hex(c,d,h)):a.ableNormal?RedColorPhongMaterial(e,RedGLUtil.rgb2hex(c,d,h)):RedColorMaterial(e,RedGLUtil.rgb2hex(c,d,h))),s&&(i.map_Ns&&(o[i.map_Ns]?u=o[i.map_Ns]:(u=RedBitmapTexture(e,i.map_Ns),o[i.map_Ns]=u),s.specularTexture=u),i.map_bump&&(o[i.map_bump]?u=o[i.map_bump]:(u=RedBitmapTexture(e,i.map_bump),o[i.map_bump]=u),s.normalTexture=u),void 0!=i.Ns&&(s.shininess=i.Ns),a.mesh.material=s))}},t=function(e,r,n){for(var i in n){var a,o;if((a=n[i]).use){var s,u,c,d=[];a.resultPosition.length&&d.push(RedInterleaveInfo("aVertexPosition",3)),a.resultNormal.length&&d.push(RedInterleaveInfo("aVertexNormal",3)),a.resultUV.length&&d.push(RedInterleaveInfo("aTexcoord",2)),s=RedBuffer(e,i+"_interleave",new Float32Array(a.resultInterleave.length?a.resultInterleave:a.resultPosition),RedBuffer.ARRAY_BUFFER,d),a.index.length&&a.index.length&&(u=RedBuffer(e,i+"_index",new Uint16Array(a.index),RedBuffer.ELEMENT_ARRAY_BUFFER)),c=a.resultUV.length&&a.resultNormal.length?RedColorPhongTextureMaterial(e,"#00ff00"):a.resultNormal?RedColorPhongMaterial(e,"#00ff00"):RedColorMaterial(e,"#0000ff"),o=RedMesh(e,RedGeometry(s,u),c),a.ableUV=!!a.resultUV.length,a.ableNormal=!!a.resultNormal.length,a.ableLight=!!(a.ableUV&a.ableNormal)}else o=RedMesh(e);o.name=i,a.mesh=o,r.addChild(o),t(e,o,a.childrenInfo)}},f=/^(mtllib )/,R=/^(usemtl )/,i=/^o /,a=/^g /,o=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,s=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,u=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,c=/f\s+(([\d]{1,}[\s]?){3,})+/,d=/f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,h=/f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,l=/f\s+((([\d]{1,}\/\/[\d]{1,}[\s]?){3,})+)/,n=function(e,t,n){var m,p,v,M,E,g,b,_,U,A;for(v={position:[],normal:[],uv:[],points:[],normalPoints:[],uvPoints:[]},p={},m={},b=n.length;b--;)if(i.test(n[b])){_=!0;break}return _||(A={name:U="objModel"+RedGL.makeUUID(),groupName:U,index:[],position:[],resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},p[U]=M=A,m[U]=M,E=U),n.forEach(function(n){if(f.test(n))return g=RedMTLLoader(e,t.path,n.split(" ")[1],function(n){t.mtlLoader=n,t.modelParsingComplete&&t.callback&&(r(e,m,g),t.callback(t.result))}),void(t.mtlLoader=g);var b;if(R.test(n))_=n.split(" ").slice(1).join("").trim(),m[E].materialKey=_;else if(a.test(n))_=n.split(" ").slice(1).join("").trim(),p[E].use=!1,U={name:_,groupName:E,materialKey:_.replace(E+"_",""),index:[],position:M.position,resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},m[_]=M=U,p[E].childrenInfo[_]=M;else if(i.test(n)){var _,U;U={name:_=n.split(" ").slice(1).join("").trim(),groupName:_,materialKey:_,index:[],position:[],resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},p[_]=M=U,m[_]=M,E=_}if(o.test(n))b=n.split(" "),v.position.push(+b[1],+b[2],+b[3]),M.position.push(+b[1],+b[2],+b[3]),v.points[v.points.length]=[+b[1],+b[2],+b[3]];else if(s.test(n)){var A;A=n.split(" "),v.normal.push(+A[1],+A[2],+A[3]),v.normalPoints[v.normalPoints.length]=[+A[1],+A[2],+A[3]]}else if(u.test(n)){var T;T=n.split(" "),v.uv.push(+T[1],+T[2]),v.uvPoints[v.uvPoints.length]=[+T[1],+T[2]]}else if(l.test(n))(I=n.split(" ").slice(1,4)).forEach(function(e){var t,r,n;n=0,e=e.split("/"),x=+e[0]-1,y=+e[2]-1,t=v.points[x],r=v.normalPoints[y],v.position.length&&(n+=3),v.normal.length&&(n+=3),M.index.push(M.resultInterleave.length/n),v.position.length&&(M.resultPosition.push(t[0],t[1],t[2]),M.resultInterleave.push(t[0],t[1],t[2])),v.normal.length&&(M.resultNormal.push(r[0],r[1],r[2]),M.resultInterleave.push(r[0],r[1],r[2]))});else if(h.test(n)){var y;if(4==(I=n.split(" ").slice(1,5)).length){var L=I[3];I[3]=I[0],I[4]=I[2],I[5]=L}I.forEach(function(e){var t,r,n,i;i=0,e=e.split("/"),x=+e[0]-1,w=+e[1]-1,y=+e[2]-1,t=v.points[x],n=v.uvPoints[w],r=v.normalPoints[y],v.position.length&&(i+=3),v.normal.length&&(i+=3),v.uv.length&&(i+=2),M.index.push(M.resultInterleave.length/i),v.position.length&&(M.resultPosition.push(t[0],t[1],t[2]),M.resultInterleave.push(t[0],t[1],t[2])),v.normal.length&&(M.resultNormal.push(r[0],r[1],r[2]),M.resultInterleave.push(r[0],r[1],r[2])),v.uv.length&&(M.resultUV.push(n[0],n[1]),M.resultInterleave.push(n[0],n[1]))})}else if(d.test(n)){var I,w;(I=n.split(" ").slice(1,4)).forEach(function(e){var t,r,n;n=0,e=e.split("/"),x=+e[0]-1,w=+e[1]-1,t=v.points[x],r=v.uvPoints[w],v.position.length&&(n+=3),v.uv.length&&(n+=2),M.index.push(M.resultInterleave.length/n),v.position.length&&(M.resultPosition.push(t[0],t[1],t[2]),M.resultInterleave.push(t[0],t[1],t[2])),v.uv.length&&(M.resultUV.push(r[0],r[1]),M.resultInterleave.push(r[0],r[1]))})}else if(c.test(n)){var x;x=n.split(" "),M.resultInterleave=M.resultPosition=M.position,M.index.push(+x[1]-1,+x[2]-1,+x[3]-1),M.index.push(+x[1]-1,+x[3]-1,+x[4]-1)}}),{info:m,infoHierarchy:p}},e=function(e,r,i){i=i.replace(/^\#[\s\S]+?\n/g,"");var a=n(r,e,i.split("\n"));return t(r,e.resultMesh,a.infoHierarchy),new function(e){for(var t in e)this[t]=e[t]}({fileName:e.fileName,path:e.path,resultMesh:e.resultMesh,parseRawInfo:a.info,parseInfoHierarchy:a.infoHierarchy,parseInfoMaterial:e.mtlLoader})},Object.freeze(RedOBJLoader)}(),RedAxis=function(e){if(!(this instanceof RedAxis))return new RedAxis(e);var t,r,n,i;e instanceof RedGL||RedGLUtil.throwFunc("RedAxis : RedGL Instance만 허용됩니다.",e),RedBaseObject3D.build.call(this,e.gl),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#ff0000")),(r=RedMesh(e,RedBox(e),RedColorMaterial(e,"#ff0000"))).scaleX=r.scaleY=r.scaleZ=.5,r.scaleX=10,t.x=5,r.x=-5,t.children.push(r),this.children.push(t),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#00ff00")),(n=RedMesh(e,RedBox(e),RedColorMaterial(e,"#00ff00"))).scaleX=n.scaleY=n.scaleZ=.5,n.scaleY=10,t.y=5,n.y=-5,t.children.push(n),this.children.push(t),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#0000ff")),(i=RedMesh(e,RedBox(e),RedColorMaterial(e,"#0000ff"))).scaleX=i.scaleY=i.scaleZ=.5,i.scaleZ=10,t.z=5,i.z=-5,t.children.push(i),this.children.push(t),this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedAxis,RedBaseContainer),RedGLUtil.copyProto(RedAxis,RedBaseObject3D),Object.freeze(RedAxis),RedGrid=function(e,t,r,n,i){if(!(this instanceof RedGrid))return new RedGrid(e,t,r,n,i);var a;e instanceof RedGL||RedGLUtil.throwFunc("RedGrid : RedGL Instance만 허용됩니다.",e),a=e.gl,RedBaseObject3D.build.call(this,a);var o=[];t=t||100,n=[1,1,1,.7],i=[1,1,1,.5];for(var s,u=(r=r||100)/2,c=t/r,d=t/2,h=0,l=-d;h<=r;h++,l+=c){var f=h===u?n:i;o.push(-d,0,l),o.push(f[0],f[1],f[2],f[3]),o.push(d,0,l),o.push(f[0],f[1],f[2],f[3]),o.push(l,0,-d),o.push(f[0],f[1],f[2],f[3]),o.push(l,0,d),o.push(f[0],f[1],f[2],f[3])}s=RedBuffer(e,"gridInterleaveBuffer_"+r,new Float32Array(o),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexColor",4)]),this.geometry=RedGeometry(s),this.material=RedGridMaterial(e),this.drawMode=a.LINES,this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedGrid,RedBaseContainer),RedGLUtil.copyProto(RedGrid,RedBaseObject3D),Object.freeze(RedGrid),RedMesh=function(e,t,r){if(!(this instanceof RedMesh))return new RedMesh(e,t,r);var n;e instanceof RedGL||RedGLUtil.throwFunc("RedMesh : RedGL Instance만 허용됩니다.",e),!t||t instanceof RedGeometry||RedGLUtil.throwFunc("RedMesh : RedGeometry Instance만 허용됩니다."),!r||r instanceof RedBaseMaterial||RedGLUtil.throwFunc("RedMesh : RedBaseMaterial 확장 Instance만 허용됩니다."),n=e.gl,RedBaseObject3D.build.call(this,n),this.geometry=t,this.material=r,this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedMesh,RedBaseContainer),RedGLUtil.copyProto(RedMesh,RedBaseObject3D),Object.freeze(RedMesh),RedLine=function(e,t){if(!(this instanceof RedLine))return new RedLine(e,t);var r,n,i,a,o;e instanceof RedGL||RedGLUtil.throwFunc("RedLine : RedGL Instance만 허용됩니다.",e),t instanceof RedColorMaterial||RedGLUtil.throwFunc("RedLine : RedColorMaterial Instance만 허용됩니다."),n=[],i=[],this._UUID=RedGL.makeUUID(),a=RedBuffer(e,"RedLine_InterleaveBuffer_"+this._UUID,new Float32Array(n),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3)]),o=RedBuffer(e,"RedLine_indexBuffer_"+this._UUID,new Uint16Array(i),RedBuffer.ELEMENT_ARRAY_BUFFER),this.addPoint=function(e,t,r){var a=n.length/3;n.push(e,t,r),i.push(a)},this.upload=function(){a.upload(new Float32Array(n)),o.upload(new Uint16Array(i)),a.parseInterleaveDefineInfo(),o.parseInterleaveDefineInfo()},r=e.gl,RedBaseObject3D.build.call(this,r),this.geometry=RedGeometry(a,o),this.material=t,this.drawMode=r.LINE_STRIP},RedGLUtil.copyProto(RedLine,RedBaseContainer),RedGLUtil.copyProto(RedLine,RedBaseObject3D),Object.freeze(RedLine),RedSkyBox=function(e,t){if(!(this instanceof RedSkyBox))return new RedSkyBox(e,t);var r;e instanceof RedGL||RedGLUtil.throwFunc("RedSkyBox : RedGL Instance만 허용됩니다.",e),r=e.gl,RedBaseObject3D.build.call(this,r),this.geometry=RedBox(e),this.material=RedSkyBoxMaterial(e,RedBitmapCubeTexture(e,t)),this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedSkyBox,RedBaseObject3D),Object.freeze(RedSkyBox),RedSprite3D=function(e,t){if(!(this instanceof RedSprite3D))return new RedSprite3D(e,t);var r;e instanceof RedGL||RedGLUtil.throwFunc("RedSprite3D : RedGL Instance만 허용됩니다.",e),t instanceof RedColorMaterial||t instanceof RedBitmapMaterial||RedGLUtil.throwFunc("RedSprite3D : RedColorMaterial or RedBitmapMaterial Instance만 허용됩니다."),r=e.gl,RedBaseObject3D.build.call(this,r),this.geometry=RedPlane(e,1,1,0),this.material=t,this.perspectiveScale=!0,this.useCullFace=!1,this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedSprite3D,RedBaseContainer),RedGLUtil.copyProto(RedSprite3D,RedBaseObject3D),Object.freeze(RedSprite3D),RedPointUnit=function(e,t,r,n){if(!(this instanceof RedPointUnit))return new RedPointUnit(e,t,r,n);var i,a;n instanceof RedPointColorMaterial||n instanceof RedPointBitmapMaterial||RedGLUtil.throwFunc("RedPointUnit : material - RedPointColorMaterial Instance or RedPointBitmapMaterial Instance만 허용됩니다."),i=e.gl,RedBaseObject3D.build.call(this,i),this._UUID=RedGL.makeUUID(),a=RedBuffer(e,"RedPointUnit_"+this._UUID,t,RedBuffer.ARRAY_BUFFER,r),this.geometry=RedGeometry(a),this.material=n,this.drawMode=i.POINTS},RedGLUtil.copyProto(RedPointUnit,RedBaseContainer),RedGLUtil.copyProto(RedPointUnit,RedBaseObject3D),RedPointUnit.prototype.update=function(){},Object.freeze(RedPointUnit),function(){var e,t,r,n;r=function(e,r,n,i,a,o,s,u,c,d,h,l){var f,R,m=u/h,p=c/l,v=u/2,M=c/2,E=d/2,g=h+1,b=l+1,_=0,U=[];for(R=0;R<b;R++){var A=R*p-M;for(f=0;f<g;f++){var T=f*m-v;U[n]=T*o,U[i]=A*s,U[a]=E,e.push(U.x,U.y,U.z),U[n]=0,U[i]=0,U[a]=d>0?1:-1,e.push(U.x,U.y,U.z),e.push(f/h,1-R/l),_+=1}}for(R=0;R<l;R++)for(f=0;f<h;f++){var y=t+f+g*R,L=t+f+g*(R+1),I=t+(f+1)+g*(R+1),w=t+(f+1)+g*R;r.push(y,L,w,L,I,w),6}t+=_},e=function(e,i,a,o,s,u,c){n="RedBox_"+(i=i||1)+"_"+(a=a||1)+"_"+(o=o||1)+"_"+(s=s||1)+"_"+(u=u||1)+"_"+(c=c||1);var d=[],h=[];return t=0,r(d,h,"z","y","x",-1,-1,o,a,i,c,u),r(d,h,"z","y","x",1,-1,o,a,-i,c,u),r(d,h,"x","z","y",1,1,i,o,a,s,c),r(d,h,"x","z","y",1,-1,i,o,-a,s,c),r(d,h,"x","y","z",1,-1,i,a,o,s,u),r(d,h,"x","y","z",-1,-1,i,a,-o,s,u),{interleaveData:d,indexData:h,type:n,interleaveBuffer:RedBuffer(e,n+"_interleaveBuffer",new Float32Array(d),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,n+"_indexBuffer",new Uint16Array(h),RedBuffer.ELEMENT_ARRAY_BUFFER)}},(RedBox=function(t,r,n,i,a,o,s){if(!(this instanceof RedBox))return new RedBox(t,r,n,i,a,o,s);if(!(t instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";var u;if(u=e(t,r,n,i,a,o,s),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[u.type])return t._datas.Primitives[u.type];t._datas.Primitives[u.type]=this,this.interleaveBuffer=u.interleaveBuffer,this.indexBuffer=u.indexBuffer,this._UUID=RedGL.makeUUID()}).prototype=RedGeometry.prototype,Object.freeze(RedBox)}(),function(){var e,t,r,n,i,a,o,s,u,c,d,h,l,f,R,m,p,v;e=function(e,M,E,g,b){M=M||1,E=E||1,g=g||1,b=b||1,t=M/2,r=E/2,n=Math.floor(g)||1,i=Math.floor(b)||1,a=n+1,o=i+1,s=M/n,u=E/i,v="RedPlane_"+M+"_"+E+"_"+g+"_"+b;var _=[],U=[];for(d=0;d<o;d++)for(l=d*u-r,c=0;c<a;c++)h=c*s-t,_.push(h,-l,0),_.push(0,0,1),_.push(c/n,1-d/i);for(d=0;d<i;d++)for(c=0;c<n;c++)f=c+a*d,R=c+a*(d+1),m=c+1+a*(d+1),p=c+1+a*d,U.push(f,R,p,R,m,p);return{interleaveData:_,indexData:U,type:v,interleaveBuffer:RedBuffer(e,v+"_interleaveBuffer",new Float32Array(_),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,v+"_indexBuffer",new Uint16Array(U),RedBuffer.ELEMENT_ARRAY_BUFFER)}},(RedPlane=function(t,r,n,i,a){if(!(this instanceof RedPlane))return new RedPlane(t,r,n,i,a);if(!(t instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";var o;if(o=e(t,r,n,i,a),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[o.type])return t._datas.Primitives[o.type];t._datas.Primitives[o.type]=this,this.interleaveBuffer=o.interleaveBuffer,this.indexBuffer=o.indexBuffer,this._UUID=RedGL.makeUUID()}).prototype=RedGeometry.prototype,Object.freeze(RedPlane)}(),function(){var e,t,r,n,i,a,o,s,u,c,d,h,l;d=[],h=new Float32Array([0,0,0]),l=new Float32Array([0,0,0]),e=function(e,f,R,m,p,v,M,E){f=f||1,R=Math.max(3,Math.floor(R)||8),m=Math.max(2,Math.floor(m)||6),p=void 0!==p?p:0,v=void 0!==v?v:2*Math.PI,M=void 0!==M?M:0,E=void 0!==E?E:Math.PI,t=M+E,i=0,d.length=0,h[0]=0,h[1]=0,h[2]=0,l[0]=0,l[1]=0,l[2]=0,c="RedSphere_"+f+"_"+R+"_"+m+"_"+p+"_"+v+"_"+M+"_"+E;var g=[],b=[];for(n=0;n<=m;n++){var _=[],U=n/m;for(r=0;r<=R;r++){var A=r/R;h.x=-f*Math.cos(p+A*v)*Math.sin(M+U*E),h.y=f*Math.cos(M+U*E),h.z=f*Math.sin(p+A*v)*Math.sin(M+U*E),g.push(h.x,h.y,h.z),l[0]=h.x,l[1]=h.y,l[2]=h.z,vec3.normalize(l,l),g.push(l[0],l[1],l[2]),g.push(A,1-U),_.push(i++)}d.push(_)}for(n=0;n<m;n++)for(r=0;r<R;r++)a=d[n][r+1],o=d[n][r],s=d[n+1][r],u=d[n+1][r+1],(0!==n||M>0)&&b.push(a,o,u),(n!==m-1||t<Math.PI)&&b.push(o,s,u);return{interleaveData:g,indexData:b,type:c,interleaveBuffer:RedBuffer(e,c+"_interleaveBuffer",new Float32Array(g),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,c+"_indexBuffer",new Uint16Array(b),RedBuffer.ELEMENT_ARRAY_BUFFER)}},(RedSphere=function(t,r,n,i,a,o,s,u){if(!(this instanceof RedSphere))return new RedSphere(t,r,n,i,a,o,s,u);if(!(t instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";var c;if(c=e(t,r,n,i,a,o,s,u),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[c.type])return t._datas.Primitives[c.type];t._datas.Primitives[c.type]=this,this.interleaveBuffer=c.interleaveBuffer,this.indexBuffer=c.indexBuffer,this._UUID=RedGL.makeUUID()}).prototype=RedGeometry.prototype,Object.freeze(RedSphere)}(),function(){var e,t,r,n,i,a;e=function(e,t,r,i){return n=e.createProgram(),e.attachShader(n,r.webglShader),e.attachShader(n,i.webglShader),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||RedGLUtil.throwFunc("프로그램을 초기화 할 수 없습니다."),n.key=t,n.vShaderKey=r.key,n.fShaderKey=r.key,e.useProgram(n),n},i=function(){},a=function(){},t=function(e,t,n){n.parseData.attribute&&n.parseData.attribute.list.forEach(function(r){var n=new i;n._UUID=RedGL.makeUUID(),n.location=t.getAttribLocation(e.webglProgram,r.name),-1==n.location?n.msg="쉐이더 main 함수에서 사용되고 있지 않음":(n.attributeType=r.attributeType,n.name=r.name,n.enabled=!1,e.attributeLocation.push(n),e.attributeLocation[r.name]=n)}),n.parseData.uniform&&n.parseData.uniform.list.forEach(function(n){var i,o,s=new a;switch(s._UUID=RedGL.makeUUID(),s.location=t.getUniformLocation(e.webglProgram,n.name),s.location||(s.msg="쉐이더 main 함수에서 사용되고 있지 않음"),s.uniformType=n.uniformType,n.arrayNum,n.uniformType){case"sampler2D":i="sampler2D",o="uniform1f",s.samplerIndex=r,8==++r&&(r=2);break;case"samplerCube":i="samplerCube",o="uniform1f",s.samplerIndex=r,8==++r&&(r=2);break;case"float":i="float",o="uniform1f";break;case"int":i="int",o="uniform1i";break;case"mat4":i="mat",o="uniformMatrix4fv";break;case"mat3":i="mat",o="uniformMatrix3fv";break;case"mat2":i="mat",o="uniformMatrix2fv";break;case"vec4":i="vec",o="uniform4fv";break;case"vec3":i="vec",o="uniform3fv";break;case"vec2":i="vec",o="uniform2fv";break;case"bool":i="bool",o="uniform1i"}s.renderType=i,s.renderMethod=o,s.name=n.name,s.materialPropertyName=n.name.charAt(1).toLowerCase()+n.name.substr(2),s.arrayNum=n.arrayNum,n.systemUniformYn?(e.systemUniformLocation.push(s),e.systemUniformLocation[n.name]=s):(e.uniformLocation.push(s),e.uniformLocation[n.name]=s)})},(RedProgram=function(n,i,a,o){var s;if(!(this instanceof RedProgram))return new RedProgram(n,i,a,o);if(n instanceof RedGL||RedGLUtil.throwFunc("RedProgram : RedGL Instance만 허용됩니다.",n),"string"!=typeof i&&RedGLUtil.throwFunc("RedProgram : key - 문자열만 허용됩니다."),!a instanceof RedShader&&RedGLUtil.throwFunc("RedProgram : vShaderInfo - RedShader만 허용됩니다."),!o instanceof RedShader&&RedGLUtil.throwFunc("RedProgram : fShaderInfo - RedShader만 허용됩니다."),a&&a.type!=RedShader.VERTEX&&RedGLUtil.throwFunc("RedProgram : vShaderInfo - VERTEX 타입만 허용됩니다."),o&&o.type!=RedShader.FRAGMENT&&RedGLUtil.throwFunc("RedProgram : fShaderInfo - FRAGMENT 타입만 허용됩니다."),s=n.gl,n._datas.RedProgram||(n._datas.RedProgram={}),a||o)a&&o||RedGLUtil.throwFunc("RedProgram : 신규 생성시 vertexShader, fragmentShader 모두 입력해야함."),RedProgram.hasKey(n,i)?RedGLUtil.throwFunc("RedProgram : key - 이미 정의된 키로 생성을 시도.","\n키 :",i):n._datas.RedProgram[i]=this;else{if(n._datas.RedProgram[i])return n._datas.RedProgram[i];RedGLUtil.throwFunc("RedShader : 존재하지않는 key를 검색하려고합니다.",i)}this.key=i,this.webglProgram=e(s,i,a,o),this.attributeLocation=[],this.uniformLocation=[],this.systemUniformLocation=[],s.useProgram(this.webglProgram),r=2,t(this,s,a),t(this,s,o),this._UUID=RedGL.makeUUID()}).prototype={},RedProgram.hasKey=function(e,t){return e._datas.RedProgram||(e._datas.RedProgram={}),!!e._datas.RedProgram[t]},Object.freeze(RedProgram)}(),[(RedSystemShaderCode={vShareSource:["attribute vec3 aVertexPosition","attribute vec3 aVertexNormal","attribute vec4 aVertexColor","varying vec3 vVertexNormal","attribute float aPointSize","uniform float uPointSize","attribute vec2 aTexcoord","varying vec2 vTexcoord","uniform vec4 uAtlascoord","uniform float uTime","varying float vTime","uniform vec2 uResolution","varying vec2 vResolution","uniform mat4 uMMatrix","uniform mat4 uNMatrix","uniform mat4 uPMatrix","uniform mat4 uCameraMatrix","uniform bool uSprite3DYn","uniform bool uPerspectiveScale"],fShareSource:["varying vec3 vVertexNormal","varying vec2 vTexcoord","varying float vTime","varying vec2 vResolution","uniform float uUseFog","uniform float uFogDistance","uniform float uFogDensity","uniform vec4 uFogColor","const int DIRETIONAL_MAX = 3","uniform vec3 uDirectionalLightPosition[3]","uniform vec4 uDirectionalLightColor[3]","uniform float uDirectionalLightIntensity[3]","uniform int uDirectionalLightNum","const int POINT_MAX = 5","uniform vec3 uPointLightPosition[5]","uniform vec4 uPointLightColor[5]","uniform float uPointLightRadius[5]","uniform float uPointLightIntensity[5]","uniform int uPointLightNum","uniform vec4 uAmbientLightColor","uniform float uAmbientIntensity"],systemUniform:{}}).vShareSource,RedSystemShaderCode.fShareSource].forEach(function(e){e.forEach(function(e){"uniform"==(e=e.split(" "))[0]&&(RedSystemShaderCode.systemUniform[e[2]]=1)})}),Object.freeze(RedSystemShaderCode),function(){var e,t,r,n,i,a,o,s;e=function(e,t,r){switch(r){case RedShader.VERTEX:return(i=e.createShader(e.VERTEX_SHADER)).key=t,i.type=r,i;case RedShader.FRAGMENT:return(i=e.createShader(e.FRAGMENT_SHADER)).key=t,i.type=r,i;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요!")}},t=function(e,t,r,n){e.shaderSource(r,n.lastSource),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)||RedGLUtil.throwFunc(e.getShaderInfoLog(r),"쉐이더 컴파일에 실패하였습니다.")},n=function(){var e;return function(t,r){switch(t){case RedShader.VERTEX:e=RedSystemShaderCode.vShareSource.concat();break;case RedShader.FRAGMENT:e=RedSystemShaderCode.fShareSource.concat();break;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요!")}return r.forEach(function(t){t=t.replace(";",""),-1==e.indexOf(t)?e.push(t):RedGLUtil.throwFunc("RedShader : ","\n1. 중복된 소스이거나","\n2. RedSystemShaderCode에 정의된 소스\n",t)}),e}}(),r=function(e,t){return t=(t=t.replace(/\s+$/,"")).replace(/  /g,"").trim(),a={etc:{list:[],map:{},source:""}},o=t.match(/attribute[\s\S]+?\;|uniform[\s\S]+?\;|varying[\s\S]+?\;|precision[\s\S]+?\;/g),(o=n(e,o=o||[])).sort(),o.forEach(function(e){var r,n,i,o,s,u,c;if(e=e.trim(),t=t.replace(e+";",""),(r=e.split(" "))[2])switch(n=r[0],o=r[1],i=r[2].replace(";","").split("["),u=(u=e.split("="))[1]?u[1].trim().replace(";",""):null,s=i.length>1?+i[1].split("]")[0]:0,i=i[0],n){case"attribute":"a"!=i.charAt(0)&&RedGLUtil.throwFunc("attribute의 첫글자는 a로 시작해야합니다.",i);break;case"uniform":"u"!=i.charAt(0)&&RedGLUtil.throwFunc("uniform의 첫글자는 u로 시작해야합니다.",i);break;case"varying":"v"!=i.charAt(0)&&RedGLUtil.throwFunc("varying의 첫글자는 v로 시작해야합니다.",i)}else n="var",o=r[0],s=(i=r[1].replace(";","").split("[")).length>1?+i[1].split("]")[0]:0,i=i[0];a[n]||(a[n]={},a[n].list=[],a[n].map={},a[n].source=""),c={name:i,arrayNum:s,value:u,systemUniformYn:!!RedSystemShaderCode.systemUniform[s?i+"["+s+"]":i]},"uniform"==n&&(c.uniformType=o),"attribute"==n&&(c.attributeType=o),a[n].list.push(c),a[n].map[i]=e,a[n].source+=e+";\n"}),[t+="\n"].forEach(function(e){var t=e.split(" "),r=t[1].replace(/\([\s\S]+/g,"").trim();a.etc.list.push({uniformType:t[0],name:r}),a.etc.map[r]=e,a.etc.source+=e+"\n"}),s="",a.precision&&(s+=a.precision.source+"\n//attribute\n"),a.const&&(s+=a.const.source+"\n//const\n"),a.attribute&&(s+=a.attribute.source+"\n//uniform\n"),a.uniform&&(s+=a.uniform.source+"\n//varying\n"),a.varying&&(s+=a.varying.source+"\n//var\n"),a.var&&(s+=a.var.source+"\n//etc\n"),a.etc&&(s+=a.etc.source),a.lastSource=s,a},(RedShader=function(n,i,a,o){var s;if(!(this instanceof RedShader))return new RedShader(n,i,a,o);if(n instanceof RedGL||RedGLUtil.throwFunc("RedShader : RedGL Instance만 허용됩니다.",n),"string"!=typeof i&&RedGLUtil.throwFunc("RedShader : key - 문자열만 허용됩니다.",i),a!=RedShader.VERTEX&&a!=RedShader.FRAGMENT&&RedGLUtil.throwFunc("RedShader : type - RedShader.VERTEX or RedShader.FRAGMENT 만 허용됩니다.",a),n._datas.RedShader||(n._datas.RedShader={},n._datas.RedShader[RedShader.VERTEX]={},n._datas.RedShader[RedShader.FRAGMENT]={}),o)"string"!=typeof o&&RedGLUtil.throwFunc("RedShader : source - 문자열만 허용됩니다."),RedShader.hasKey(n,i,a)?RedGLUtil.throwFunc("RedShader : key - 이미 정의된 키로 생성을 시도.","\n키 :",i,"\n타입 :",a):n._datas.RedShader[a][i]=this;else{if(RedShader.hasKey(n,i,a))return n._datas.RedShader[a][i];RedGLUtil.throwFunc("RedShader : 존재하지않는 key를 검색하려고합니다.",i)}s=n.gl,this.webglShader=e(s,i,a),this.parseData=r(a,o),t(s,0,this.webglShader,this.parseData),this.key=i,this.type=a,this._UUID=RedGL.makeUUID(),Object.freeze(this)}).hasKey=function(e,t,r){return e._datas.RedShader||(e._datas.RedShader={},e._datas.RedShader[RedShader.VERTEX]={},e._datas.RedShader[RedShader.FRAGMENT]={}),!!e._datas.RedShader[r][t]},RedShader.FRAGMENT="fragmentShader",RedShader.VERTEX="vertexShader",Object.freeze(RedShader)}(),function(){var e,t,r,n,i,a,o,s,u,c;(RedRenderer=function(){if(!(this instanceof RedRenderer))return new RedRenderer;this.world=null,this._tickKey=null,this._callback=null,this._UUID=RedGL.makeUUID(),this.renderInfo={},this.cacheUniformInfo=[],this.cacheAttrInfo=[],this.cacheBySamplerIndex=[],this.cacheState=[],this.renderDebuger=RedRenderDebuger()}).prototype={start:(e=function(n){t.worldRender(r,n),t._callback&&t._callback(n),t._tickKey=requestAnimationFrame(e)},function(n,i){n instanceof RedGL||RedGLUtil.throwFunc("RedGL Instance만 허용"),n.world instanceof RedWorld||RedGLUtil.throwFunc("RedWorld Instance만 허용"),(t=this).world=n.world,r=n,t._tickKey=requestAnimationFrame(e),t._callback=i}),stop:function(){cancelAnimationFrame(this._tickKey)}},RedRenderer.prototype.worldRender=function(){var e,t,r,o,s,u,c,d,h,l,f,R,m,p,v,M;return c=[],o=function(t){return t.forEach(function(r,n){"number"==typeof t[n]?t[n]=r:t[n]=n<2?e[n+2]*parseFloat(t[n])/100:e[n]*parseFloat(t[n])/100}),t},M=[],s=function(e,t,r,i,a){for(var o in f=e.gl,c.length=0,e._datas.RedProgram){var s,u,d,E,g,b,_,U,A,T,y;for(h=e._datas.RedProgram[o],n!=h._UUID&&f.useProgram(h.webglProgram),n=h._UUID,l=h.systemUniformLocation,R=l.uTime,m=R.location,p=R._UUID,m&&M[p]!=t&&(f.uniform1f(m,t),M[p]=t),R=l.uResolution,m=R.location,p=R._UUID,v=[a[2],a[3]],m&&M[p]!=v.toString()&&(f.uniform2fv(m,v),M[p]=v.toString()),R=l.uUseFog,m=R.location,g=r.useFog?1:0,p=R._UUID,m&&M[p]!=g&&(f.uniform1f(m,g),M[p]=g),R=l.uFogDensity,m=R.location,g=r.fogDensity,p=R._UUID,m&&M[p]!=g&&(f.uniform1f(m,g),M[p]=g),R=l.uFogColor,m=R.location,g=r.fogColor,p=R._UUID,m&&M[p]!=g.toString()&&(f.uniform4fv(m,g),M[p]=g.toString()),R=l.uFogDistance,m=R.location,g=r.fogDistance,p=R._UUID,m&&M[p]!=g&&(f.uniform1f(m,g),M[p]=g),R=l.uCameraMatrix,m=R.location,g=i.matrix,p=R._UUID,m&&M[p]!=g.toString()&&(f.uniformMatrix4fv(m,!1,g),M[p]=g.toString()),R=l.uPMatrix,m=R.location,g=i.perspectiveMTX,p=R._UUID,m&&M[p]!=g.toString()&&(f.uniformMatrix4fv(m,!1,g),M[p]=g.toString()),(d=r._lightInfo[RedAmbientLight.type])&&(R=l.uAmbientLightColor,m=R.location,p=R._UUID,g=d.color,m&&M[p]!=g.toString()&&(f.uniform4fv(m,g),M[p]=g.toString()),R=l.uAmbientIntensity,m=R.location,p=R._UUID,g=d.intensity,m&&M[p]!=g&&(f.uniform1f(m,g),M[p]=g)),y=vec3.create(),b=new Float32Array(9),U=new Float32Array(12),A=new Float32Array(3),s=(u=r._lightInfo[RedDirectionalLight.type]).length;s--;)d=u[s],vec3.set(y,d.x,d.y,d.z),d.debug&&((E=d.debugObject).x=y[0],E.y=y[1],E.z=y[2],E.material.color=d.color,c.push(E)),R=l.uDirectionalLightPosition,(m=R.location)&&(vec3.normalize(y,y),b[0+3*s]=y[0],b[1+3*s]=y[1],b[2+3*s]=y[2]),R=l.uDirectionalLightColor,(m=R.location)&&(U[0+4*s]=d.color[0],U[1+4*s]=d.color[1],U[2+4*s]=d.color[2],U[3+4*s]=d.color[3]),R=l.uDirectionalLightIntensity,(m=R.location)&&(A[s]=d.intensity);for(R=l.uDirectionalLightPosition,m=R.location,p=R._UUID,g=b,m&&M[p]!=g.toString()&&(f.uniform3fv(m,g),M[p]=g.toString()),R=l.uDirectionalLightColor,m=R.location,p=R._UUID,g=U,m&&M[p]!=g.toString()&&(f.uniform4fv(m,g),M[p]=g.toString()),R=l.uDirectionalLightIntensity,m=R.location,p=R._UUID,g=A,m&&M[p]!=g.toString()&&(f.uniform1fv(m,g),M[p]=g.toString()),R=l.uDirectionalLightNum,m=R.location,p=R._UUID,g=u.length,m&&M[p]!=g&&(f.uniform1i(m,g),M[p]=g),y=vec3.create(),_=new Float32Array(15),U=new Float32Array(20),A=new Float32Array(5),T=new Float32Array(5),s=(u=r._lightInfo[RedPointLight.type]).length;s--;)d=u[s],vec3.set(y,d.x,d.y,d.z),d.debug&&((E=d.debugObject).x=y[0],E.y=y[1],E.z=y[2],E.scaleX=E.scaleY=E.scaleZ=d.radius,E.material.color=d.color,c.push(E)),R=l.uPointLightPosition,(m=R.location)&&(_[0+3*s]=y[0],_[1+3*s]=y[1],_[2+3*s]=y[2]),R=l.uPointLightColor,(m=R.location)&&(U[0+4*s]=d.color[0],U[1+4*s]=d.color[1],U[2+4*s]=d.color[2],U[3+4*s]=d.color[3]),R=l.uPointLightIntensity,(m=R.location)&&(A[s]=d.intensity),R=l.uPointLightRadius,(m=R.location)&&(T[s]=d.radius);R=l.uPointLightPosition,m=R.location,p=R._UUID,g=_,m&&M[p]!=g.toString()&&(f.uniform3fv(m,g),M[p]=g.toString()),R=l.uPointLightColor,m=R.location,p=R._UUID,g=U,m&&M[p]!=g.toString()&&(f.uniform4fv(m,g),M[p]=g.toString()),R=l.uPointLightIntensity,m=R.location,p=R._UUID,g=A,m&&M[p]!=g.toString()&&(f.uniform1fv(m,g),M[p]=g.toString()),R=l.uPointLightRadius,m=R.location,p=R._UUID,g=T,m&&M[p]!=g.toString()&&(f.uniform1fv(m,g),M[p]=g.toString()),R=l.uPointLightNum,m=R.location,p=R._UUID,g=u.length,m&&M[p]!=g&&(f.uniform1i(m,g),M[p]=g)}return c},u=function(e){e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.frontFace(e.CCW),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.enable(e.SCISSOR_TEST),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0)},d=function(){var t,n,o,s,u,c,d,h,l,f,R,m,p,v,M,E;return l=mat4.create(),h=new Float32Array(2),n=function(e,r,n,a,f){o=t.material=r,s=o.program,e.useProgram(s.webglProgram),c=s.systemUniformLocation,u=c.uPMatrix,(d=u.location)&&(mat4.ortho(l,-.5,.5,-.5,.5,-i.farClipping,i.farClipping),e.uniformMatrix4fv(d,!1,l)),u=c.uResolution,(d=u.location)&&(h[0]=n,h[1]=a,e.uniform2fv(d,h)),f&&(u=c.uCameraMatrix,d=u.location,mat4.identity(l),e.uniformMatrix4fv(d,!1,l))},m=function(e,t,r){M=t.frameBuffer.width,E=t.frameBuffer.height,(p!=M||v!=E||r)&&(e.viewport(0,0,M,E),e.scissor(0,0,M,E)),n(e,t,M,E),p=M,v=E},function(o,s,u,c,d,h){p=null,v=null,u.unbind(s),t=u.children[0],R=f=u.frameBuffer.texture,u.frameBuffer.width=s.drawingBufferWidth,u.frameBuffer.height=s.drawingBufferHeight;var l=u.postEffectList.concat();u.antialiasing&&l.push(u.antialiasing),l.forEach(function(e){var t;e.process&&e.process.length&&(t=R,e.process.forEach(function(e){m(s,e),e.bind(s),e.diffuseTexture=R,r.sceneRender(o,s,!0,u.children,d,h),e.unbind(s),R=e.frameBuffer.texture})),e.subSceneFrameBuffer&&(e.subSceneFrameBuffer.bind(s),e.subSceneFrameBuffer.width=a.postEffectManager.frameBuffer.width,e.subSceneFrameBuffer.height=a.postEffectManager.frameBuffer.height,s.viewport(0,0,e.subSceneFrameBuffer.width,e.subSceneFrameBuffer.height),s.scissor(0,0,e.subSceneFrameBuffer.width,e.subSceneFrameBuffer.height),r.sceneRender(o,s,i.orthographicYn,a.children,d,h,e.subSceneMaterial),e.subSceneFrameBuffer.unbind(s),p=0,v=0),e.frameBuffer&&(m(s,e),e.bind(s),e.updateTexture(R,t,e.subSceneFrameBuffer?e.subSceneFrameBuffer.texture:null),r.sceneRender(o,s,!0,u.children,d,h),e.unbind(s),R=e.frameBuffer.texture)}),R!=f&&(u.finalMaterial.diffuseTexture=R,s.viewport(c[0],e[3]-c[3]-c[1],c[2],c[3]),s.scissor(c[0],e[3]-c[3]-c[1],c[2],c[3]),n(s,u.finalMaterial,c[2],c[3],!0),r.sceneRender(o,s,!0,u.children,d,h)),u.finalMaterial.diffuseTexture=u.frameBuffer.texture}}(),function(n,h){var l,f,R;l=n.gl,r=this,e=[0,0,l.drawingBufferWidth,l.drawingBufferHeight],l.viewport(0,0,l.drawingBufferWidth,l.drawingBufferHeight),l.scissor(0,0,l.drawingBufferWidth,l.drawingBufferHeight),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),u(l),r.renderInfo={},this.cacheAttrInfo.length=0,r.world._viewList.forEach(function(u){(f=u._viewRect)[0]=u._x,f[1]=u._y,f[2]=u._width,f[3]=u._height,i=u.camera,a=u.scene,o(f),R=r.renderInfo[u.key]={orthographicYn:i.orthographicYn,x:u._x,y:u._y,width:u._width,height:u._height,viewRectX:f[0],viewRectY:f[1],viewRectWidth:f[2],viewRectHeight:f[3],key:u.key,call:0},l.viewport(f[0],e[3]-f[3]-f[1],f[2],f[3]),l.scissor(f[0],e[3]-f[3]-f[1],f[2],f[3]),a.useBackgroundColor?(l.clearColor(a.r,a.g,a.b,1),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT)):(l.clearColor(0,0,0,0),l.clear(l.DEPTH_BUFFER_BIT)),i instanceof RedCamera||(i.update(),i=i.camera),i.update(),t=i.perspectiveMTX,mat4.identity(t),i.orthographicYn?(mat4.ortho(t,-.5,.5,-.5,.5,-i.farClipping,i.farClipping),mat4.translate(t,t,[-.5,.5,0]),mat4.scale(t,t,[1/f[2],-1/f[3],1]),mat4.identity(i.matrix),l.disable(l.CULL_FACE)):(mat4.perspective(t,i.fov*Math.PI/180,f[2]/f[3],i.nearClipping,i.farClipping),l.enable(l.CULL_FACE)),a.postEffectManager.postEffectList.length&&(a.postEffectManager.bind(l),mat4.perspective(t,i.fov*Math.PI/180,a.postEffectManager.frameBuffer.width/a.postEffectManager.frameBuffer.height,i.nearClipping,i.farClipping),l.viewport(0,0,a.postEffectManager.frameBuffer.width,a.postEffectManager.frameBuffer.height),l.scissor(0,0,a.postEffectManager.frameBuffer.width,a.postEffectManager.frameBuffer.height)),s(n,h,a,i,f),a.skyBox&&(l.cullFace(l.FRONT),a.skyBox.scaleX=a.skyBox.scaleY=a.skyBox.scaleZ=i.farClipping,r.sceneRender(n,l,i.orthographicYn,[a.skyBox],h,R),l.cullFace(l.BACK),l.clear(l.DEPTH_BUFFER_BIT)),r.sceneRender(n,l,i.orthographicYn,a.children,h,R),a.grid&&r.sceneRender(n,l,i.orthographicYn,[a.grid],h,R),a.axis&&r.sceneRender(n,l,i.orthographicYn,a.axis.children,h,R),c.length&&r.sceneRender(n,l,i.orthographicYn,c,h,R),a.postEffectManager.postEffectList.length&&d(n,l,a.postEffectManager,f,h,R)}),this.renderDebuger.visible&&this.renderDebuger.update(n,r.renderInfo)}}(),RedRenderer.prototype.sceneRender=(o=function(e,t,r,i,a,d,h,l,f,R,m,p){var v,M,E,g,b,_,U,A,T,y,L,I,w,x,S,P,B,D,F,G,N,O,C,Y,j,X,k,z,V,Z,W,H,q,J,Q,K,$,ee,te,re,ne,ie,ae,oe,se,ue,ce,de,he,le,fe,Re,me,pe,ve,Me,Ee,ge,be,_e,Ue,Ae,Te,ye,Le,Ie,we,xe,Se,Pe,Be,De,Fe,Ge,Ne,Oe,Ce,Ye,je,Xe,ke,ze,Ve,Ze,We,He,qe,Je,Qe,Ke,$e,et,tt,rt,nt,it,at,ot,st,ut,ct,dt,ht;for(E=Float32Array.BYTES_PER_ELEMENT,g=Math.PI/180,st=3.141592653589793,ut=6.283185307179586,ct=1.27323954,dt=.405284735,ht=1.5707963267948966,c=null,v=r.length;v--;){if(d.call++,N=(b=r[v]).matrix,O=b.normalMatrix,_=b.geometry,X=b instanceof RedSprite3D,_){for(U=p||b.material,n!=U.program._UUID&&t.useProgram(U.program.webglProgram),n=U.program._UUID,T=U.program.attributeLocation,y=U.program.uniformLocation,L=U.program.systemUniformLocation,B=_.interleaveBuffer,D=_.indexBuffer,A=B.interleaveDefineInfo,C=B._UUID,M=T.length;M--;)I=A[(x=T[M]).name],u!=C&&t.bindBuffer(t.ARRAY_BUFFER,B.webglBuffer),u=C,x&&I&&h[P=x.location]!=I._UUID&&(!x.enabled&&(t.enableVertexAttribArray(P),x.enabled=!0),t.vertexAttribPointer(P,I.size,B.glArrayType,I.normalize,B.stride*E,I.offset*E),h[P]=I._UUID);for(M=y.length;M--;)S=(w=y[M]).location,C=w._UUID,S&&(G=w.renderType,F=U[w.materialPropertyName],Y=l[C]==F,"sampler2D"==G||"samplerCube"==G?(j=w.samplerIndex,F?(f[j]==F._UUID||(c!=j&&t.activeTexture(t.TEXTURE0+(c=j)),t.bindTexture("sampler2D"==G?t.TEXTURE_2D:t.TEXTURE_CUBE_MAP,F.webglTexture),f[C]!=j&&t.uniform1i(S,f[C]=j),f[j]=F._UUID),L.uAtlascoord.location&&l[C=L.uAtlascoord._UUID]!=F.atlascoord.data._UUID&&(t.uniform4fv(L.uAtlascoord.location,F.atlascoord.data),l[C]=F.atlascoord.data._UUID)):"sampler2D"==G?0==f[j]||(0!=c&&t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e._datas.emptyTexture["2d"].webglTexture),0!=f[C]&&t.uniform1i(S,f[C]=0),f[j]=0,c=0):1==f[j]||(1!=c&&t.activeTexture(t.TEXTURE0+1),t.bindTexture(t.TEXTURE_CUBE_MAP,e._datas.emptyTexture["3d"].webglTexture),1!=f[C]&&t.uniform1i(S,f[C]=1),f[j]=1,c=1)):(void 0==F&&RedGLUtil.throwFunc("RedRenderer : Material에 ",w.materialPropertyName,"이 정의 되지않았습니다."),"float"==G?!Y&&t[w.renderMethod](S,l[C]=F):"int"==G?!Y&&t[w.renderMethod](S,l[C]=F):"bool"==G?!Y&&t[w.renderMethod](S,l[C]=F):"vec"==G?t[w.renderMethod](S,l[C]=F):"mat"==G?t[w.renderMethod](S,!1,F):RedGLUtil.throwFunc("RedRenderer : 처리할수없는 타입입니다.","tRenderType -",G)))}N[0]=1,N[1]=0,N[2]=0,N[3]=0,N[4]=0,N[5]=1,N[6]=0,N[7]=0,N[8]=0,N[9]=0,N[10]=1,N[11]=0,N[12]=0,N[13]=0,N[14]=0,N[15]=1,k=N,Ie=b.x,we=b.y,xe=b.z,k[12]=k[0]*Ie+k[4]*we+k[8]*xe+k[12],k[13]=k[1]*Ie+k[5]*we+k[9]*xe+k[13],k[14]=k[2]*Ie+k[6]*we+k[10]*xe+k[14],k[15]=k[3]*Ie+k[7]*we+k[11]*xe+k[15],X?(J=0*g,Q=0*g,K=0):(J=b.rotationX*g,Q=b.rotationY*g,K=b.rotationZ*g),(ot=J%ut)<-st?ot+=ut:ot>st&&(ot-=ut),z=(ot=ot<0?ct*ot+dt*ot*ot:ct*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,(ot=(J+ht)%ut)<-st?ot+=ut:ot>st&&(ot-=ut),W=(ot=ot<0?ct*ot+dt*ot*ot:ct*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,(ot=Q%ut)<-st?ot+=ut:ot>st&&(ot-=ut),V=(ot=ot<0?ct*ot+dt*ot*ot:ct*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,(ot=(Q+ht)%ut)<-st?ot+=ut:ot>st&&(ot-=ut),H=(ot=ot<0?ct*ot+dt*ot*ot:ct*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,(ot=K%ut)<-st?ot+=ut:ot>st&&(ot-=ut),Z=(ot=ot<0?ct*ot+dt*ot*ot:ct*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,(ot=(K+ht)%ut)<-st?ot+=ut:ot>st&&(ot-=ut),q=(ot=ot<0?ct*ot+dt*ot*ot:ct*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,$=k[0],ee=k[1],te=k[2],ne=k[4],ie=k[5],ae=k[6],se=k[8],ue=k[9],ce=k[10],Ee=H*q,ge=z*V*q-W*Z,be=W*V*q+z*Z,_e=H*Z,Ue=z*V*Z+W*q,Ae=W*V*Z-z*q,Te=-V,ye=z*H,Le=W*H,k[0]=$*Ee+ne*ge+se*be,k[1]=ee*Ee+ie*ge+ue*be,k[2]=te*Ee+ae*ge+ce*be,k[4]=$*_e+ne*Ue+se*Ae,k[5]=ee*_e+ie*Ue+ue*Ae,k[6]=te*_e+ae*Ue+ce*Ae,k[8]=$*Te+ne*ye+se*Le,k[9]=ee*Te+ie*ye+ue*Le,k[10]=te*Te+ae*ye+ce*Le,Ie=b.scaleX,we=1*b.scaleY,xe=b.scaleZ,k[0]=k[0]*Ie,k[1]=k[1]*Ie,k[2]=k[2]*Ie,k[3]=k[3]*Ie,k[4]=k[4]*we,k[5]=k[5]*we,k[6]=k[6]*we,k[7]=k[7]*we,k[8]=k[8]*xe,k[9]=k[9]*xe,k[10]=k[10]*xe,k[11]=k[11]*xe,k[12]=k[12],k[13]=k[13],k[14]=k[14],k[15]=k[15],m&&($=m[0],ee=m[1],te=m[2],re=m[3],ne=m[4],ie=m[5],ae=m[6],oe=m[7],se=m[8],ue=m[9],ce=m[10],de=m[11],he=m[12],le=m[13],fe=m[14],Re=m[15],me=N[0],pe=N[1],ve=N[2],Me=N[3],N[0]=me*$+pe*ne+ve*se+Me*he,N[1]=me*ee+pe*ie+ve*ue+Me*le,N[2]=me*te+pe*ae+ve*ce+Me*fe,N[3]=me*re+pe*oe+ve*de+Me*Re,me=N[4],pe=N[5],ve=N[6],Me=N[7],N[4]=me*$+pe*ne+ve*se+Me*he,N[5]=me*ee+pe*ie+ve*ue+Me*le,N[6]=me*te+pe*ae+ve*ce+Me*fe,N[7]=me*re+pe*oe+ve*de+Me*Re,me=N[8],pe=N[9],ve=N[10],Me=N[11],N[8]=me*$+pe*ne+ve*se+Me*he,N[9]=me*ee+pe*ie+ve*ue+Me*le,N[10]=me*te+pe*ae+ve*ce+Me*fe,N[11]=me*re+pe*oe+ve*de+Me*Re,me=N[12],pe=N[13],ve=N[14],Me=N[15],N[12]=me*$+pe*ne+ve*se+Me*he,N[13]=me*ee+pe*ie+ve*ue+Me*le,N[14]=me*te+pe*ae+ve*ce+Me*fe,N[15]=me*re+pe*oe+ve*de+Me*Re),_&&t.uniformMatrix4fv(L.uMMatrix.location,!1,N),_&&L.uNMatrix.location&&(Se=N[0],Pe=N[1],Be=N[2],De=N[3],Fe=N[4],Ge=N[5],Ne=N[6],Oe=N[7],Ce=N[8],Ye=N[9],je=N[10],Xe=N[11],ze=N[12],Ve=N[13],Ze=N[14],at=1/(at=(ke=Se*Ge-Pe*Fe)*(it=je*(We=N[15])-Xe*Ze)-(He=Se*Ne-Be*Fe)*(nt=Ye*We-Xe*Ve)+(qe=Se*Oe-De*Fe)*(rt=Ye*Ze-je*Ve)+(Je=Pe*Ne-Be*Ge)*(tt=Ce*We-Xe*ze)-(Qe=Pe*Oe-De*Ge)*(et=Ce*Ze-je*ze)+(Ke=Be*Oe-De*Ne)*($e=Ce*Ve-Ye*ze)),O[0]=(Ge*it-Ne*nt+Oe*rt)*at,O[1]=(-Pe*it+Be*nt-De*rt)*at,O[2]=(Ve*Ke-Ze*Qe+We*Je)*at,O[3]=(-Ye*Ke+je*Qe-Xe*Je)*at,O[4]=(-Fe*it+Ne*tt-Oe*et)*at,O[5]=(Se*it-Be*tt+De*et)*at,O[6]=(-ze*Ke+Ze*qe-We*He)*at,O[7]=(Ce*Ke-je*qe+Xe*He)*at,O[8]=(Fe*nt-Ge*tt+Oe*$e)*at,O[9]=(-Se*nt+Pe*tt-De*$e)*at,O[10]=(ze*Qe-Ve*qe+We*ke)*at,O[11]=(-Ce*Qe+Ye*qe-Xe*ke)*at,O[12]=(-Fe*rt+Ge*et-Ne*$e)*at,O[13]=(Se*rt-Pe*et+Be*$e)*at,O[14]=(-ze*Je+Ve*He-Ze*ke)*at,O[15]=(Ce*Je-Ye*He+je*ke)*at,ee=O[1],te=O[2],re=O[3],ae=O[6],oe=O[7],de=O[11],O[1]=O[4],O[2]=O[8],O[3]=O[12],O[4]=ee,O[6]=O[9],O[7]=O[13],O[8]=te,O[9]=ae,O[11]=O[14],O[12]=re,O[13]=oe,O[14]=de,t.uniformMatrix4fv(L.uNMatrix.location,!1,O)),_&&(L.uPointSize.location&&R.pointSize!=b.pointSize&&t.uniform1f(L.uPointSize.location,R.pointSize=b.pointSize),R.useCullFace!=b.useCullFace&&((R.useCullFace=b.useCullFace)?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE)),R.cullFace!=b.cullFace&&t.cullFace(R.cullFace=b.cullFace),R.useDepthTest!=b.useDepthTest&&((R.useDepthTest=b.useDepthTest)?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)),R.depthTestFunc!=b.depthTestFunc&&t.depthFunc(b.depthTestFunc),R.useBlendMode!=b.useBlendMode&&((R.useBlendMode=b.useBlendMode)?t.enable(t.BLEND):t.disable(t.BLEND)),R.blendSrc==b.blendSrc&&R.blendDst==b.blendDst||(t.blendFunc(b.blendSrc,b.blendDst),R.blendSrc=b.blendSrc,R.blendDst=b.blendDst),L.uSprite3DYn.location&&(F=X,l[C=L.uSprite3DYn._UUID]!=F&&(t.uniform1i(L.uSprite3DYn.location,F),l[C]=F),C=L.uPerspectiveScale._UUID,F=b.perspectiveScale,l[C]!=F&&(t.uniform1i(L.uPerspectiveScale.location,F),l[C]=F)),D?(s!=D._UUID&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,D.webglBuffer),t.drawElements(b.drawMode,D.pointNum,D.glArrayType,0),s=D._UUID):t.drawArrays(b.drawMode,0,B.pointNum)),b.children.length&&o(e,t,b.children,i,a,d,h,l,f,R,N,p)}},function(e,t,r,n,i,a,s){void 0==this.cacheState.pointSize&&(this.cacheState.pointSize=null),this.cacheState.useCullFace||(this.cacheState.useCullFace=null),this.cacheState.cullFace||(this.cacheState.cullFace=null),this.cacheState.useDepthTest||(this.cacheState.useDepthTest=null),this.cacheState.depthTestFunc||(this.cacheState.depthTestFunc=null),this.cacheState.useBlendMode||(this.cacheState.useBlendMode=null),this.cacheState.blendSrc||(this.cacheState.blendSrc=null),this.cacheState.blendDst||(this.cacheState.blendDst=null),this.cacheBySamplerIndex.length=0,o(e,t,n,r,i,a,this.cacheAttrInfo,this.cacheUniformInfo,this.cacheBySamplerIndex,this.cacheState,void 0,s)}),Object.freeze(RedRenderer)}(),(RedRenderDebuger=function(){if(!(this instanceof RedRenderDebuger))return new RedRenderDebuger;this.renderResult||(this.renderResult=document.createElement("div"),this._contentBox=document.createElement("div"),this._etcBox=document.createElement("div"),this.renderResult.appendChild(this._contentBox),this.renderResult.appendChild(this._etcBox),this.renderResult.style.cssText="position:absolute;bottom:0px;left:0px;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;background:rgba(0,0,0,0.6);padding:3px;width:300px",this._etcBox.style.cssText="position:relative;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;background:rgba(0,0,0,0.6);padding:3px",this._etcBox.innerHTML='<a href="https://redcamel.github.io/RedGL2/redDoc/index.html" stlye="color:#fff;text-decoration:none">API document</a>'),this._visible=!1}).prototype={update:function(e,t){for(var r in this._contentBox.innerHTML="",t)this._contentBox.innerHTML+='<div style="padding:3px"><div><b>RedView : key - '+t[r].key+"</b></div> orthographicYn - "+t[r].orthographicYn+" <br>call - "+t[r].call+" <br> width - "+t[r].width+" / height - "+t[r].height+" <br> viewRectWidth - "+t[r].viewRectWidth+" / viewRectHeight - "+t[r].viewRectHeight+" <br> x - "+t[r].x+" / y - "+t[r].y+"</div><br>";this._contentBox.innerHTML+='<div style="padding:3px;background:#000">renderScale : '+e.renderScale+"</div>"}},Object.defineProperty(RedRenderDebuger.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible=e,this._visible?document.body.appendChild(this.renderResult):this.renderResult.parentNode&&document.body.removeChild(this.renderResult)}}),Object.freeze(RedRenderDebuger),function(){var e,t;function r(e,t,r,n){this.x=e,this.y=t,this.w=r,this.h=n}(RedAtlas=function(r,n,i){if(!(this instanceof RedAtlas))return new RedAtlas(r,n,i);r instanceof RedGL||RedGLUtil.throwFunc("RedBitmapMaterial : RedGL Instance만 허용됩니다.",r),r._datas.RedAtlas||(r._datas.RedAtlas={atlasInfoList:[new e],atlasMap:{}}),(t=r._detect.MAX_TEXTURE_SIZE)>2048&&(t=2048),this.redGL=r,this.loadList(n,i)}).prototype={getAtlasMap:function(){return this.redGL._datas.RedAtlas.atlasMap},getAtlasInfoList:function(){return this.redGL._datas.RedAtlas.atlasInfoList},loadList:function(e,t){var r,n,i,a;for(a=0,i=this,r=0,n=e.length,r=0;r<n;r++){var o=new Image;o.id=o.src=e[r],o.onload=function(){(i.atlasPack(i.redGL,this),++a==e.length)&&(i.redGL._datas.RedAtlas.atlasInfoList.forEach(function(e){e.texture=RedBitmapTexture(i.redGL,e.canvas)}),t&&t.call(i,i.redGL._datas.RedAtlas))}}},atlasPack:function(t,r){var n,i;if(n=t._datas.RedAtlas.atlasInfoList,!(i=t._datas.RedAtlas.atlasMap)[r.id]){var a,o,s,u;if(!1===(u=(s=n[0]).pack(r))){for(a=0,o=n.length;a<o&&!(u=(s=n[a]).pack(r));a++);!1===u&&(n.push(s=new e),u=s.pack(r))}i[r.id]={atlas:s,rect:s.uv()[r.id]},s.texture||(s.texture=RedBitmapTexture(t,s.canvas))}}},r.prototype.fitsIn=function(e){return e.w>=this.w&&e.h>=this.h},r.prototype.sameSizeAs=function(e){return this.w===e.w&&this.h===e.h},(e=function(e,n,i,a){if(void 0==e){var o=document.createElement("canvas");document.body.appendChild(o),o.style.display="none",o.width=t,o.height=t,this.canvas=o,e=n=0,i=this.canvas.width,a=this.canvas.height}2===arguments.length&&(i=e,a=n,e=n=0),this._UUID=RedGL.makeUUID(),this.left=this.right=null,this.rect=new r(e,n,i,a),this.filled=!1,this.tilepad=!1,this._cache=[],this._uvcache=Object.create(null)}).prototype.pack=function(t){return this._cache=[],this._uvcache=Object.create(null),t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),null!==this.left?this._ontoCanvas(this.left.pack(t)||this.right.pack(t)):!(this.filled||!t.fitsIn(this.rect))&&(t.sameSizeAs(this.rect)?(this.filled=!0,this._ontoCanvas(this)):(this.rect.w-t.w>this.rect.h-t.h?(this.left=new e(this.rect.x,this.rect.y,t.w,this.rect.h),this.right=new e(this.rect.x+t.w,this.rect.y,this.rect.w-t.w,this.rect.h)):(this.left=new e(this.rect.x,this.rect.y,this.rect.w,t.h),this.right=new e(this.rect.x,this.rect.y+t.h,this.rect.w,this.rect.h-t.h)),this._ontoCanvas(this.left.pack(t))))},e.prototype.expand=function(t){var r,n=this;if(t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),this.rect.w<this.rect.h?((r=new e(0,0,this.rect.w+t.w,this.rect.h)).right=new e(this.rect.w,0,t.w,this.rect.h),r.left=this):((r=new e(0,0,this.rect.w,this.rect.h+t.h)).right=new e(0,this.rect.h,this.rect.w,t.h),r.left=this),["canvas","context","img"].forEach(function(e){n[e]&&(r[e]=n[e],n[e]=null)}),r.canvas){r.context||(r.context=r.canvas.getContext("2d"));var i=r.context.getImageData(0,0,r.canvas.width,r.canvas.height);r.canvas.width=r.rect.w,r.canvas.height=r.rect.h,r.context.putImageData(i,0,0)}return!1===r.pack(t)?r.expand(t):r},e.prototype.index=function(){var e=this;return e._cache.length>0?e._cache:(function t(r){null!==r.left?(t(r.left),t(r.right)):r.rect.name&&e._cache.push(r.rect)}(e),e._cache)},e.prototype.uv=function(e,t){var r=this;e=e||r.rect.w,t=t||r.rect.h;var n=this.tilepad;return function i(a){if(null!==a.left)i(a.left),i(a.right);else if(void 0!==a.rect.name){var o=n?a.rect.w/4:0;r._uvcache[a.rect.name]=[[a.rect.x+o,a.rect.y+o],[a.rect.x+o+(a.rect.w-2*o),a.rect.y+o],[a.rect.x+o+(a.rect.w-2*o),a.rect.y+o+(a.rect.h-2*o)],[a.rect.x+o,a.rect.y+o+(a.rect.h-2*o)]].map(function(r){return 0!==r[0]&&(r[0]=r[0]/e),0!==r[1]&&(r[1]=r[1]/t),r})}}(r),r._uvcache},e.prototype.json=function(t){return t?("string"==typeof t&&(t=JSON.parse(t)),function t(r){if(r&&r.rect){var n=new e(r.rect.x,r.rect.y,r.rect.w,r.rect.h);return r.left&&(n.left=t(r.left)),r.right&&(n.right=t(r.right)),n}}(t)):JSON.stringify(function e(t){var r={left:null,right:null,rect:t.rect,filled:t.filled};return null!==t.left&&(r.left=e(t.left),r.right=e(t.right)),r}(this),null,2)},e.prototype._tilepad=function(e){var t=this.img;if(!t)return e;var n=t.width/2,i=document.createElement("canvas");i.name=t.name||t.src,i.id=t.id||"",i.width=t.width+t.width,i.height=t.height+t.height;var a=i.getContext("2d"),o=a.createPattern(t,"repeat");return a.fillStyle=o,a.translate(n,n),a.fillRect(-n,-n,i.width+n,i.height+n),a.translate(-n,-n),this.img=i,new r(e.x,e.y,this.img.width,this.img.height)},e.prototype._ontoCanvas=function(e){return e&&this.img&&this.canvas&&(this.context||(this.context=this.canvas.getContext("2d")),this.context.clearRect(e.rect.x,e.rect.y,e.rect.w,e.rect.h),this.context.drawImage(this.img,e.rect.x,e.rect.y,e.rect.w,e.rect.h),e.rect.name=this.img.id||this.img.name||this.img.src||null),e},e.prototype._toRect=function(e){return!e.nodeName||"IMG"!==e.nodeName&&"CANVAS"!==e.nodeName||(this.img=e,e=new r(e.x,e.y,e.width,e.height)),e instanceof r||(e=new r(e.x||0,e.y||0,e.w||e.width,e.h||e.height)),e},e.prototype._debug=function(){if(this.canvas){var e=this.canvas.getContext("2d");this.index().forEach(function(t){e.lineWidth=1,e.strokeStyle="red",e.strokeRect(t.x,t.y,t.w,t.h)})}}}(),function(){var e,t,r=new Float32Array([0,0,1,1]),n={};r._UUID=RedGL.makeUUID(),(RedAtlasUV=function(i,a){if(!(this instanceof RedAtlasUV))return new RedAtlasUV(i,a);i instanceof RedGL||RedGLUtil.throwFunc("RedAtlasUV : RedGL Instance만 허용됩니다.",i),a?(t=[a[0][0],1-a[2][1],a[1][0]-a[0][0],a[2][1]-a[0][1]],e=t.toString(),n[e]?this.data=n[e]:(this.data=n[e]=t,this.data._UUID=RedGL.makeUUID())):this.data=r}).prototype={},Object.freeze(RedAtlasUV)}(),function(){var e,t,r;e=function(e,t){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,2,2,0,e.LUMINANCE,e.UNSIGNED_BYTE,new Uint8Array([128,64,0,192])),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.generateMipmap(e.TEXTURE_2D),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.bindTexture(e.TEXTURE_2D,null),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0)},r=function(e,t,r,n){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n.min?n.min:e.LINEAR_MIPMAP_NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n.max?n.max:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,n.wrap_s?n.wrap_s:e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,n.wrap_t?n.wrap_t:e.REPEAT),e.EXT_texture_filter_anisotropic&&n.anisotropic&&e.texParameterf(e.TEXTURE_2D,e.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.anisotropic);try{e.generateMipmap(e.TEXTURE_2D)}catch(e){}e.bindTexture(e.TEXTURE_2D,null)},t=function(t,n,i,a){var o,s,u,c;a||(a={}),u=function(e){e.removeEventListener("error",o),e.removeEventListener("load",s)},o=function(){var e="couldn't load image: "+i;RedGLUtil.throwFunc(e),u(this)},s=function(){u(this),r(t,n,this,a)},e(t,n),i instanceof HTMLCanvasElement?r(t,n,i,a):((c=new Image).crossOrigin="anonymous",c.src=i,c.addEventListener("error",o),c.addEventListener("load",s))},(RedBitmapTexture=function(e,r,n){var i;if(!(this instanceof RedBitmapTexture))return new RedBitmapTexture(e,r,n);e instanceof RedGL||RedGLUtil.throwFunc("RedBitmapTexture : RedGL Instance만 허용됩니다.",e),i=e.gl,this.webglTexture=i.createTexture(),this.atlascoord=RedAtlasUV(e),this._UUID=RedGL.makeUUID(),r&&t(i,this.webglTexture,r,n)}).prototype={},Object.freeze(RedBitmapTexture)}(),function(){var e;(RedAtlasTexture=function(t,r){if(!(this instanceof RedAtlasTexture))return new RedAtlasTexture(t,r);t instanceof RedGL||RedGLUtil.throwFunc("RedAtlasTexture : RedGL Instance만 허용됩니다.",t),e=t._datas.RedAtlas.atlasMap[r],this.webglTexture=e.atlas.texture.webglTexture,this.atlascoord=RedAtlasUV(t,e.rect),this._UUID=e.atlas._UUID}).prototype=RedBitmapTexture.prototype,Object.freeze(RedAtlasTexture)}(),function(){var e,t,r;(r=new Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC",e=function(e,t){e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,t),[r,r,r,r,r,r].forEach(function(t,n){e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},t=function(t,r,n,i){var a,o,s,u,c,d=[];for(i||(i={}),s=function(e){e.removeEventListener("error",a),e.removeEventListener("load",o)},a=function(){var e="couldn't load image: "+src;RedGLUtil.throwFunc(e),s(this)},o=function(){if(6==++c){s(this),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_CUBE_MAP,r);for(var e=d.length;e--;)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,d[e]);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,i.min?i.min:t.LINEAR_MIPMAP_NEAREST),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,i.max?i.max:t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,i.wrap_s?i.wrap_s:t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,i.wrap_t?i.wrap_t:t.CLAMP_TO_EDGE);try{t.generateMipmap(t.TEXTURE_CUBE_MAP)}catch(e){}t.bindTexture(t.TEXTURE_CUBE_MAP,null)}else s(this)},u=6,c=0;u--;){var h;e(t,r),(h=new Image).crossOrigin="anonymous",h.src=n[u],h.addEventListener("error",a),h.addEventListener("load",o),d[u]=h}},(RedBitmapCubeTexture=function(e,r,n){var i;if(!(this instanceof RedBitmapCubeTexture))return new RedBitmapCubeTexture(e,r,n);e instanceof RedGL||RedGLUtil.throwFunc("RedBitmapCubeTexture : RedGL Instance만 허용됩니다.",e),i=e.gl,this.webglTexture=i.createTexture(),this.atlascoord=RedAtlasUV(e),this._UUID=RedGL.makeUUID(),t(i,this.webglTexture,r,n)}).prototype={},Object.freeze(RedBitmapCubeTexture)}(),function(){var e;e={},(RedView=function(t,r,n){if(e[t]){if(!r&&!n)return e[t];RedGLUtil.throwFunc(t,"는 이미 생성된 RedView key입니다.")}if(!(this instanceof RedView))return new RedView(t,r,n);"string"!=typeof t&&RedGLUtil.throwFunc("RedView : key : 문자열만 허용"),r||n||RedGLUtil.throwFunc("RedView : 존재하지 않는 key입니다."),!r||r instanceof RedScene||RedGLUtil.throwFunc("RedView : RedScene Instance만 허용"),n&&(n instanceof RedCamera||n instanceof RedBasicController||n instanceof RedObitController)||RedGLUtil.throwFunc("RedView : RedCamera or XXController Instance만 허용"),this.key=t,this.scene=r,this.camera=n,this._width="100%",this._height="100%",this._x=0,this._y=0,this._viewRect=[0,0,0,0],e[t]=this,Object.seal(this)}).prototype={setSize:function(e,t){this._width=void 0!=e?e:"100%",this._height=void 0!=t?t:"100%"},setLocation:function(e,t){this._x=void 0!=e?e:0,this._y=void 0!=t?t:0}},Object.freeze(RedView)}(),(RedWorld=function(){if(!(this instanceof RedWorld))return new RedWorld;this._viewList=[],this._viewMap={},this._UUID=RedGL.makeUUID(),Object.seal(this)}).prototype={addView:function(e){e instanceof RedView||RedGLUtil.throwFunc("RedView Instance만 허용함."),this._viewMap[e.key]=e,this._viewList.push(e)},getView:function(e){return this._viewMap[e]},delView:function(e){var t,r;(t=this._viewMap[e])&&(r=this._viewList.indexOf(t),this._viewList.splice(r,1),delete this._viewMap[e])},hasView:function(e){return!!this._viewMap[e]},getViewList:function(){return this._viewList.concat()}},Object.freeze(RedWorld),function(){var e;(RedScene=function(e,t){if(!(this instanceof RedScene))return new RedScene(e,t);var r,n,i,a,o;this.r=0,this.g=0,this.b=0,this.setBackgroundColor(t||"#000"),this.useBackgroundColor=!0,this.useFog=!1,this.fogDensity=.5,this.fogDistance=25,Object.defineProperty(this,"fogColor",(o=[1,1,1,1],{get:function(){return o},set:function(e){e=e||"#fff",a=RedGLUtil.hexToRGB.call(this,e),o[0]=a[0],o[1]=a[1],o[2]=a[2]}})),this.fogColor="#fff",this.children=[],Object.defineProperty(this,"skyBox",{get:function(){return r},set:function(e){return e instanceof RedSkyBox||!e||RedGLUtil.throwFunc("RedScene : RedSkyBox Instance만 허용됩니다."),r=e}}),Object.defineProperty(this,"grid",{get:function(){return n},set:function(e){return e instanceof RedGrid||!e||RedGLUtil.throwFunc("RedScene : RedGrid Instance만 허용됩니다."),n=e}}),Object.defineProperty(this,"axis",{get:function(){return i},set:function(e){return e instanceof RedAxis||!e||RedGLUtil.throwFunc("RedScene : RedAxis Instance만 허용됩니다."),i=e}}),this.postEffectManager=RedPostEffectManager(e),this._lightInfo={RedAmbientLight:null,RedDirectionalLight:[],RedPointLight:[]},this._UUID=RedGL.makeUUID()}).prototype={addLight:function(e){switch(e.type){case RedAmbientLight.type:this._lightInfo[e.type]=e;break;case RedDirectionalLight.type:case RedPointLight.type:this._lightInfo[e.type].push(e);break;default:RedGLUtil.throwFunc("RedBaseLight 확장객체만 가능")}},removeLight:function(){}},RedScene.prototype.setBackgroundColor=function(t){t=t||"#000",e=RedGLUtil.hexToRGB.call(this,t),this.r=e[0],this.g=e[1],this.b=e[2]},RedGLUtil.copyProto(RedScene,RedBaseContainer),Object.freeze(RedScene)}(),function(){var e,t;(RedCamera=function(){if(!(this instanceof RedCamera))return new RedCamera;this.x=this.y=this.z=0,this.targetX=this.targetY=this.targetZ=0,this.fov=45,this.nearClipping=.01,this.farClipping=1e4,this.orthographicYn=!1,this.matrix=mat4.create(),this.perspectiveMTX=mat4.create(),this._UUID=RedGL.makeUUID()}).prototype.update=function(){new Float32Array([0,1,0]);return function(){this.lookAt(this.targetX,this.targetY,this.targetZ)}}(),RedCamera.prototype.lookAt=(e=new Float32Array([0,1,0]),t=[],function(r,n,i){t[0]=this.targetX=r,t[1]=this.targetY=n,t[2]=this.targetZ=i,mat4.identity(this.matrix),mat4.lookAt(this.matrix,[this.x,this.y,this.z],t,e)}),Object.freeze(RedCamera)}(),(RedBasicController=function(e){if(!(this instanceof RedBasicController))return new RedBasicController(e);this.keyBuffer={},this.speed=1,this.delay=.1,this.speedRotation=1,this.delayRotation=.1,this.maxAcceleration=3,Object.defineProperty(this,"x",{get:function(){return this._targetObject.x},set:function(e){this._targetObject.x=e,this._desirePosition[0]=e}}),Object.defineProperty(this,"y",{get:function(){return this._targetObject.y},set:function(e){this._targetObject.y=e,this._desirePosition[1]=e}}),Object.defineProperty(this,"z",{get:function(){return this._targetObject.z},set:function(e){this._targetObject.z=e,this._desirePosition[2]=e}}),Object.defineProperty(this,"tilt",{get:function(){return this._desireTilt},set:function(e){this._targetObject.rotationX=e,this._desireTilt=e}}),Object.defineProperty(this,"pan",{get:function(){return this._desirePan},set:function(e){this._targetObject.rotationY=e,this._desirePan=e}}),this.camera=RedCamera(),this.keyNameMapper={moveForward:"w",moveBack:"s",moveLeft:"a",moveRight:"d",moveUp:"t",moveDown:"g",turnLeft:"q",turnRight:"e",turnUp:"r",turnDown:"f"},this._desirePosition=[0,0,0],this._targetObject=RedMesh(e),this._desirePan=0,this._desireTilt=0,function(t){var r,n,i,a,o,s,u,c,d;s=0,u=0,c=0,d=0,r=function(e){t.keyBuffer[e.key]=1},n=function(e){t.keyBuffer[e.key]=0},i=function(t){s=t.x,u=t.y,e._canvas.addEventListener("mousemove",a),window.addEventListener("mouseup",o)},a=function(e){c=e.x-s,d=e.y-u,s=e.x,u=e.y,t._desirePan-=c*t.speedRotation*.1,t._desireTilt-=d*t.speedRotation*.1},o=function(){e._canvas.removeEventListener("mousemove",a),window.removeEventListener("mouseup",o)},window.addEventListener("keydown",r),window.addEventListener("keyup",n),e._canvas.addEventListener("mousedown",i)}(this)}).prototype.update=function(){var e,t,r,n,i,a,o,s,u,c,d,h,l,f,R,m,p,v;return new Float32Array([0,1,0]),h=mat4.create(),c=mat4.create(),d=mat4.create(),l=vec3.create(),R=0,function(M){e=0,t=0,n=!1,i=!1,a=this.speed,o=this.speedRotation,s=this.delay,u=this.delayRotation,f=this.camera,v=this._desirePosition,m=this.keyBuffer,p=this.keyNameMapper,l[0]=0,l[1]=0,l[2]=0,m[p.turnLeft]&&(i=!0,e=o),m[p.turnRight]&&(i=!0,e=-o),m[p.turnUp]&&(i=!0,t=o),m[p.turnDown]&&(i=!0,t=-o),m[p.moveForward]&&(n=!0,l[2]=-R*a),m[p.moveBack]&&(n=!0,l[2]=R*a),m[p.moveLeft]&&(n=!0,l[0]=-R*a),m[p.moveRight]&&(n=!0,l[0]=R*a),m[p.moveUp]&&(n=!0,l[1]=R*a),m[p.moveDown]&&(n=!0,l[1]=-R*a),i||n?(R+=.1)>this.maxAcceleration&&(R=this.maxAcceleration):(R+=-.1)<0&&(R=0),r=this._targetObject,i&&(this._desirePan+=e,this._desireTilt+=t),r.rotationY+=(this._desirePan-r.rotationY)*u,r.rotationX+=(this._desireTilt-r.rotationX)*u,(n||i)&&(c=r.matrix,mat4.identity(h),mat4.rotateY(h,h,r.rotationY*Math.PI/180),mat4.rotateX(h,h,r.rotationX*Math.PI/180),mat4.translate(h,h,l),mat4.identity(c),mat4.translate(c,c,[r.x,r.y,r.z]),mat4.multiply(c,c,h),v[0]=c[12],v[1]=c[13],v[2]=c[14]),r.x+=(v[0]-r.x)*s,r.y+=(v[1]-r.y)*s,r.z+=(v[2]-r.z)*s,r.rotationY+=(this._desirePan-r.rotationY)*u,r.rotationX+=(this._desireTilt-r.rotationX)*u,c=r.matrix,mat4.identity(c),mat4.translate(c,c,[r.x,r.y,r.z]),mat4.rotateY(c,c,r.rotationY*Math.PI/180),mat4.rotateX(c,c,r.rotationX*Math.PI/180),d=mat4.clone(c),mat4.translate(d,d,[0,0,10.1]),f.x=d[12],f.y=d[13],f.z=d[14],f.lookAt(r.x,r.y,r.z)}}(),Object.freeze(RedBasicController),(RedObitController=function(e){var t;if(!(this instanceof RedObitController))return new RedObitController(e);this.speedDistance=2,this.delayDistance=.1,this.speedRotation=3,this.delayRotation=.1,this.centerX=0,this.centerY=0,this.centerZ=0,this.distance=15,this.tilt=0,Object.defineProperty(this,"minTilt",(t=-90,{get:function(){return t},set:function(e){e<-90&&(e=-90),t=e}})),Object.defineProperty(this,"maxTilt",function(){var e=90;return{get:function(){return e},set:function(t){t>90&&(t=90),e=t}}}()),this.pan=0,this.camera=RedCamera(),this._currentPan=0,this._currentTilt=0,this._currentDistance=0,function(t){var r,n,i,a,o,s,u,c;o=0,s=0,u=0,c=0,r=function(t){o=t.x,s=t.y,e._canvas.addEventListener("mousemove",n),window.addEventListener("mouseup",i)},n=function(e){u=e.x-o,c=e.y-s,o=e.x,s=e.y,t.pan-=u*t.speedRotation*.1,t.tilt-=c*t.speedRotation*.1},i=function(){e._canvas.removeEventListener("mousemove",n),window.removeEventListener("mouseup",i)},a=function(e){t.distance+=e.deltaY/100*t.speedDistance},e._canvas.addEventListener("mousedown",r),e._canvas.addEventListener("wheel",a)}(this)}).prototype.update=function(){var e,t,r;return new Float32Array([0,1,0]),function(n){this.tilt<this.minTilt&&(this.tilt=this.minTilt+.01),this.tilt>this.maxTilt&&(this.tilt=this.maxTilt-.01),this.speedRotation,e=this.delayRotation,t=this.camera,r=t.matrix,this._currentPan+=(this.pan-this._currentPan)*e,this._currentTilt+=(this.tilt-this._currentTilt)*e,this._currentDistance+=(this.distance-this._currentDistance)*this.delayDistance,mat4.identity(r),mat4.rotateY(r,r,this._currentPan*Math.PI/180),mat4.rotateX(r,r,this._currentTilt*Math.PI/180),mat4.translate(r,r,[0,0,this._currentDistance]),t.x=r[12],t.y=r[13],t.z=r[14],t.lookAt(this.centerX,this.centerY,this.centerZ)}}(),Object.freeze(RedObitController);
"use strict";
var RedMaterial;
(function () {
    var makeProgram;
    RedMaterial = function (redGL) {
        if (!(this instanceof RedMaterial)) return new RedMaterial(redGL);
        this['program'] = makeProgram(this, redGL)
        // 유니폼 프로퍼티
        this['floatTest'] = 1
        this['floatTest2'] = [1, 2, 3, 4, 5]
        this['intTest'] = 1
        this['intTest2'] = [1, 2, 3, 4, 5]
        this['vec4Test'] = [0, 0, 0, 0]
        this['mat4Test'] = mat4.create()
        // 일반 프로퍼티
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        Object.seal(this)
        console.log(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*      
            varying vec4 vColor;
            uniform float uFloatTest;
            uniform float uFloatTest2[10];
            uniform int uIntTest;
            uniform int uIntTest2[10];
            uniform vec4 uVec4Test;
            uniform mat4 uMat4Test;
            void main(void) {
                vColor = aVertexColor;
                vColor.r= sin(uTime*0.01);
                uFloatTest;
                uFloatTest2;
                uIntTest;
                uIntTest2;
                uVec4Test;
                uMat4Test;
                uResolution;
                gl_PointSize = aPointSize;
                gl_Position = uPMatrix * uCameraMatrix * uMMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            varying vec4 vColor;
            void main(void) {
                gl_FragColor = vColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'testrProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })()

    RedMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedMaterial)
})();
"use strict";
var RedColorMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedColorMaterial`,
            description : `
                RedColorMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                hex : [
                    {type:'hex'}
                ],
                alpha : [
                    {type:'number'},
                    '알파값'
                ]
            },
            example : `
                RedColorMaterial(RedGL Instance, hex)
            `,
            return : 'RedColorMaterial Instance'
        }
    :DOC*/
    RedColorMaterial = function (redGL, hex, alpha) {
        if (!(this instanceof RedColorMaterial)) return new RedColorMaterial(redGL, hex, alpha);
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`color`,
                description : `
                    RedProgram Instance
                    직접설정하지 않도록 유의해야함!
                `,
                return : 'Float32Array'
            }
        :DOC*/
        this['color'] = new Float32Array(4);
        this.setColor(hex ? hex : '#ff0000', alpha == undefined ? 1 : alpha);
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this);
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
                mat4 cacheScale = mat4(
                    mvMatrix[0][0], 0.0, 0.0, 0.0, 
                    0.0, mvMatrix[1][1], 0.0, 0.0, 
                    0.0, 0.0, 1.0, mvMatrix[2][2], 
                    0.0, 0.0, 0.0, 1.0 
                );
                mat4 tMTX = cameraMTX * mvMatrix;
                tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
                tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
                tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
                return tMTX * cacheScale;
            }
            uniform vec4 uColor;
            varying vec4 vColor;
            void main(void) {
                vColor = uColor; 
                gl_PointSize = uPointSize;
                if(uSprite3DYn) {
                    gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
                    if(!uPerspectiveScale){
                        gl_Position /= gl_Position.w;
                        gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1]);
                    }
                }
                else gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            varying vec4 vColor;
            float fogFactor(float perspectiveFar, float density){
                float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
                float fog = flog_cord * density;
                if(1.0 - fog < 0.0) discard;
                return clamp(1.0 - fog, 0.0,  1.0);
            }
            vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
                return mix(fogColor, currentColor, fogFactor);
            }
            void main(void) {
                vec4 finalColor = vColor * vColor.a;
                if(uUseFog == 1.0) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
                else gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'colorProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })()
    RedColorMaterial.prototype = RedBaseMaterial.prototype
    /**DOC:
        {
            code : 'METHOD',
            title :`setColor`,
            description : `
                컬러설정
            `,
            params : {
                hex : [
                    {type: 'hex'},
                    'ex) #fff, #ffffff'
                ]
            },
            example : `// TODO:`,
            return : 'RedProgram Instance'
        }
    :DOC*/
    RedColorMaterial.prototype['setColor'] = (function () {
        var t0;
        return function (hex, alpha) {
            hex = hex ? hex : '#ff2211';
            if (alpha == undefined) alpha = 1;
            if (alpha > 1) alpha = 1
            t0 = RedGLUtil.hexToRGB.call(this, hex);
            this['color'][0] = t0[0];
            this['color'][1] = t0[1];
            this['color'][2] = t0[2];
            this['color'][3] = alpha;
        }
    })();
    Object.freeze(RedColorMaterial)
})();
"use strict";
var RedColorPhongMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedColorPhongMaterial`,
            description : `
                RedColorPhongMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                color : [
                    {type:'hex'}
                ],
                alpha : [
                    {type:'number'},
                    '알파값'
                ]
            },
            example: `
            RedColorPhongMaterial(RedGL Instance, hex, alpha)
            `,
            return : 'RedColorPhongMaterial Instance'
        }
    :DOC*/
    RedColorPhongMaterial = function (redGL, hex, alpha) {
        if (!(this instanceof RedColorPhongMaterial)) return new RedColorPhongMaterial(redGL, hex, alpha);
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`color`,
                description : `
                    RedProgram Instance
                    직접설정하지 않도록 유의해야함!
                `,
                return : 'RedProgram Instance'
            }
        :DOC*/
        this['color'] = new Float32Array(4);
        this['shininess'] = 16
        /**DOC:
            {
                title :`specularPower`,
                description : `기본값 : 1`,
                return : 'uint'
            }
        :DOC*/
        this['specularPower'] = 1
        this.setColor(hex ? hex : '#ff0000', alpha == undefined ? 1 : alpha);
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this);
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            
            uniform vec4 uColor;
            varying vec4 vColor;

            varying vec4 vVertexPositionEye4;
            void main(void) {
                vColor = uColor; 
                vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0)); 
                vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
                gl_PointSize = uPointSize;
                gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            
            uniform float uShininess;
            uniform float uSpecularPower;
            
            varying vec4 vVertexPositionEye4;
            varying vec4 vColor;
            float fogFactor(float perspectiveFar, float density){
                float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
                float fog = flog_cord * density;
                if(1.0 - fog < 0.0) discard;
                return clamp(1.0 - fog, 0.0,  1.0);
            }
            vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
                return mix(fogColor, currentColor, fogFactor);
            }
            void main(void) {
                vec4 la = uAmbientLightColor * uAmbientLightColor.a;
                vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
                vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);

                vec4 texelColor = vColor;
                // texelColor.rgb *= texelColor.a;

                vec3 N = normalize(vVertexNormal);

                vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
                float specularTextureValue = 1.0;
                float specular;             

                vec3 L;
                vec3 R;
                highp float lambertTerm;
                for(int i=0; i<DIRETIONAL_MAX; i++){
                    if(i == uDirectionalLightNum) break;
                    L = normalize(-uDirectionalLightPosition[i]);
                    lambertTerm = dot(N,-L);
                    if(lambertTerm > 0.0){
                        ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
                        R = reflect(L, N);
                        specular = pow( max(dot(R, -L), 0.0), uShininess);
                        ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
                    }
                }         
                vec3 pointDirection;  
                highp float distanceLength;
                highp float attenuation;
                for(int i=0;i<POINT_MAX;i++){
                    if(i== uPointLightNum) break;
                    pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
                    distanceLength = length(pointDirection);
                    if(uPointLightRadius[i]> distanceLength){
                        attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength); 
                        L = normalize(pointDirection);
                        lambertTerm = dot(N,-L);
                        if(lambertTerm > 0.0){
                            ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
                            R = reflect(L, N);
                            specular = pow( max(dot(R, -L), 0.0), uShininess);
                            ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
                        }
                    }                          
                }            
                
                vec4 finalColor = la * uAmbientIntensity + ld + ls; 
                finalColor.rgb *= texelColor.a;
                finalColor.a = texelColor.a;
                if(uUseFog == 1.0) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
                else gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'colorPhongProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedColorPhongMaterial.prototype = RedBaseMaterial.prototype
    /**DOC:
        {
            code : 'METHOD',
            title :`setColor`,
            description : `
                컬러설정
            `,
            params : {
                hex : [
                    {type: 'hex'},
                    'ex) #fff, #ffffff'
                ]
            },
            example : `// TODO:`,
            return : 'RedProgram Instance'
        }
    :DOC*/
    RedColorPhongMaterial.prototype['setColor'] = RedColorMaterial.prototype['setColor'];
    Object.freeze(RedColorPhongMaterial)
})();
"use strict";
var RedColorPhongTextureMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedColorPhongTextureMaterial`,
            description : `
                RedColorPhongTextureMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                color : [
                    {type:'hex'}
                ],
                alpha : [
                    {type:'number'},
                    '알파값'
                ],
                normalTexture : [
                    {type: 'RedBitmapTexture'}
                ],
                specularTexture : [
                    {type: 'RedBitmapTexture'}
                ],
                specularTexture : [
                    {type: 'RedBitmapTexture'}
                ],
                displacementTexture : [
                    {type: 'RedBitmapTexture'}
                ]
            },
            example: `
            RedColorPhongTextureMaterial(RedGL Instance, hex, alpha, normalTexture, specularTexture)
            `,
            return : 'RedColorPhongTextureMaterial Instance'
        }
    :DOC*/
    RedColorPhongTextureMaterial = function (redGL, hex, alpha, normalTexture, specularTexture, displacementTexture) {
        if (!(this instanceof RedColorPhongTextureMaterial)) return new RedColorPhongTextureMaterial(redGL, hex, alpha, normalTexture, specularTexture, displacementTexture);
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`color`,
                description : `
                    RedProgram Instance
                    직접설정하지 않도록 유의해야함!
                `,
                return : 'RedProgram Instance'
            }
        :DOC*/
        this['color'] = new Float32Array(4);
        /**DOC:
             {
                 title :`normalTexture`,
                 return : 'RedBitmapTexture'
             }
         :DOC*/
        this['normalTexture'] = normalTexture;
        /**DOC:
            {
                title :`specularTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['specularTexture'] = specularTexture;
        /**DOC:
            {
                title :`displacementTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['displacementTexture'] = displacementTexture;
        /**DOC:
            {
                title :`shininess`,
                description : `기본값 : 16`,
                return : 'uint'
            }
        :DOC*/
        this['shininess'] = 16
        /**DOC:
            {
                title :`specularPower`,
                description : `기본값 : 1`,
                return : 'uint'
            }
        :DOC*/
        this['specularPower'] = 1
        /**DOC:
           {
               title :`displacementPower`,
               description : `기본값 : 0`,                
               return : 'Number'
           }
       :DOC*/
        this['displacementPower'] = 0
        this.setColor(hex ? hex : '#ff0000', alpha == undefined ? 1 : alpha);
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this);
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            
            uniform vec4 uColor;
            varying vec4 vColor;
            uniform sampler2D uDisplacementTexture;
            uniform float uDisplacementPower;
            varying vec4 vVertexPositionEye4;
            void main(void) {
                vColor = uColor; 
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0)); 
                vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
                vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(uDisplacementTexture, vTexcoord).x * uDisplacementPower ;
                gl_PointSize = uPointSize;
                gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uNormalTexture;
            uniform sampler2D uSpecularTexture;

            uniform float uShininess;
            uniform float uSpecularPower;
            
            varying vec4 vVertexPositionEye4;
            varying vec4 vColor;
            
            float fogFactor(float perspectiveFar, float density){
                float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
                float fog = flog_cord * density;
                if(1.0 - fog < 0.0) discard;
                return clamp(1.0 - fog, 0.0,  1.0);
            }
            vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
                return mix(fogColor, currentColor, fogFactor);
            }
            void main(void) {
                vec4 la = uAmbientLightColor * uAmbientLightColor.a;
                vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
                vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);

                vec4 texelColor = vColor;
                // texelColor.rgb *= texelColor.a;

                vec3 N = normalize(vVertexNormal);
                vec4 normalColor = texture2D(uNormalTexture, vTexcoord);
                if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb  - 0.5));

                vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
                float specularTextureValue = 1.0;
                specularTextureValue = texture2D(uSpecularTexture, vTexcoord).r;
                float specular;             

                vec3 L;
                vec3 R;
                highp float lambertTerm;
                for(int i=0; i<DIRETIONAL_MAX; i++){
                    if(i == uDirectionalLightNum) break;
                    L = normalize(-uDirectionalLightPosition[i]);
                    lambertTerm = dot(N,-L);
                    if(lambertTerm > 0.0){
                        ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
                        R = reflect(L, N);
                        specular = pow( max(dot(R, -L), 0.0), uShininess);
                        ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
                    }
                }         
                vec3 pointDirection;  
                highp float distanceLength;
                highp float attenuation;
                for(int i=0;i<POINT_MAX;i++){
                    if(i== uPointLightNum) break;
                    pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
                    distanceLength = length(pointDirection);
                    if(uPointLightRadius[i]> distanceLength){
                        attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength); 
                        L = normalize(pointDirection);
                        lambertTerm = dot(N,-L);
                        if(lambertTerm > 0.0){
                            ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
                            R = reflect(L, N);
                            specular = pow( max(dot(R, -L), 0.0), uShininess);
                            ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
                        }
                    }                          
                }            
                
                vec4 finalColor = la * uAmbientIntensity + ld + ls; 
                finalColor.rgb *= texelColor.a;
                finalColor.a = texelColor.a;
                if(uUseFog == 1.0) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
                else gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'colorPhongTextureProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedColorPhongTextureMaterial.prototype = RedBaseMaterial.prototype
    /**DOC:
        {
            code : 'METHOD',
            title :`setColor`,
            description : `
                컬러설정
            `,
            params : {
                hex : [
                    {type: 'hex'},
                    'ex) #fff, #ffffff'
                ]
            },
            example : `// TODO:`,
            return : 'RedProgram Instance'
        }
    :DOC*/
    RedColorPhongTextureMaterial.prototype['setColor'] = RedColorMaterial.prototype['setColor'];
    Object.freeze(RedColorPhongTextureMaterial)
})();
"use strict";
var RedEnvironmentMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedEnvironmentMaterial`,
            description : `
                RedEnvironmentMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                diffuseTexture : [
                    {type:'RedBitmapTexture'}
                ],
                environmentTexture : [
                    {type:'RedBitmapCubeTexture'}
                ],
                normalTexture : [
                    {type:'RedBitmapTexture'}
                ],
                specularTexture : [
                    {type:'RedBitmapTexture'}
                ],
                displacementTexture : [
                    {type:'RedBitmapTexture'}
                ]
            },
            example : `
                RedEnvironmentMaterial(
                    RedGL Instance, 
                    RedBitmapTexture(RedGL Instance, src), // diffuseTexture
                    RedBitmapCubeTexture(RedGL Instance, srcList),
                    RedBitmapTexture(RedGL Instance, src), // normalTexture
                    RedBitmapTexture(RedGL Instance, src), // specularTexture
                    RedBitmapTexture(RedGL Instance, src)  // displacementTexture
                )
            `,
            return : 'RedEnvironmentMaterial Instance'
        }
    :DOC*/
    RedEnvironmentMaterial = function (
        redGL,
        diffuseTexture,
        environmentTexture,
        normalTexture,
        specularTexture,
        displacementTexture
    ) {
        if (!(this instanceof RedEnvironmentMaterial)) return new RedEnvironmentMaterial(
            redGL,
            diffuseTexture,
            environmentTexture,
            normalTexture,
            specularTexture,
            displacementTexture
        );
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedEnvironmentMaterial : RedGL Instance만 허용됩니다.', redGL)
        if (!(diffuseTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedEnvironmentMaterial : diffuseTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (environmentTexture && !(environmentTexture instanceof RedBitmapCubeTexture)) RedGLUtil.throwFunc('RedEnvironmentMaterial : environmentTexture - RedBitmapCubeTexture Instance만 허용됩니다.')
        if (normalTexture && !(normalTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedEnvironmentMaterial : normalTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (specularTexture && !(specularTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedEnvironmentMaterial : specularTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (displacementTexture && !(displacementTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedEnvironmentMaterial : displacementTexture - RedBitmapTexture Instance만 허용됩니다.')
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`diffuseTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['diffuseTexture'] = diffuseTexture;
        /**DOC:
            {
                title :`environmentTexture`,
                return : 'RedBitmapCubeTexture'
            }
        :DOC*/
        this['environmentTexture'] = environmentTexture;
        /**DOC:
            {
                title :`normalTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['normalTexture'] = normalTexture;
        /**DOC:
            {
                title :`specularTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['specularTexture'] = specularTexture;
        /**DOC:
            {
                title :`shininess`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['displacementTexture'] = displacementTexture;
        /**DOC:
            {
                title :`shininess`,
                description : `기본값 : 16`,                
                return : 'Number'
            }
        :DOC*/
        this['shininess'] = 8
        /**DOC:
            {
                title :`specularPower`,
                description : `기본값 : 1`,                
                return : 'Number'
            }
        :DOC*/
        this['specularPower'] = 1
        /**DOC:
            {
                title :`reflectionPower`,
                description : `기본값 : 1`,                
                return : 'Number'
            }
        :DOC*/
        this['reflectionPower'] = 1
        /**DOC:
            {
                title :`displacementPower`,
                description : `기본값 : 0`,                
                return : 'Number'
            }
        :DOC*/
        this['displacementPower'] = 0
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        console.log(this)
        // Object.seal(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            varying vec4 vVertexPositionEye4;
            varying vec3 vReflectionCubeCoord;
            uniform sampler2D uDisplacementTexture;
            uniform float uDisplacementPower;
 
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0)); 
                vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);     
                vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(uDisplacementTexture, vTexcoord).x * uDisplacementPower ;
                vReflectionCubeCoord = -vVertexPositionEye4.xyz;
                
                gl_PointSize = uPointSize;
                gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;     
                
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;
            uniform sampler2D uNormalTexture;
            uniform sampler2D uSpecularTexture;
            uniform samplerCube uEnvironmentTexture;
            
            uniform float uShininess;
            uniform float uSpecularPower;
            uniform float uReflectionPower;            
            
            varying vec4 vVertexPositionEye4;
            varying vec3 vReflectionCubeCoord;
            float fogFactor(float perspectiveFar, float density){
                float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
                float fog = flog_cord * density;
                if(1.0 - fog < 0.0) discard;
                return clamp(1.0 - fog, 0.0,  1.0);
            }
            vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
                return mix(fogColor, currentColor, fogFactor);
            }
            void main(void) {
                
                vec4 la = uAmbientLightColor * uAmbientLightColor.a;
                vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
                vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
 
                vec4 texelColor = texture2D(uDiffuseTexture, vTexcoord);
                texelColor.rgb *= texelColor.a;
                if(texelColor.a ==0.0) discard;
 
                vec3 N = normalize(vVertexNormal);
                vec4 normalColor = texture2D(uNormalTexture, vTexcoord);
                if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb  - 0.5));
 
                vec4 reflectionColor = textureCube(uEnvironmentTexture, 2.0 * dot(vReflectionCubeCoord,vVertexNormal) * vVertexNormal - vReflectionCubeCoord);
                texelColor = texelColor * (1.0 - uReflectionPower) + reflectionColor * uReflectionPower;
 
                vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
                float specularTextureValue = 1.0;
                specularTextureValue = texture2D(uSpecularTexture, vTexcoord).r;
                float specular;             
 
                vec3 L;
                vec3 R;
                highp float lambertTerm;
                for(int i=0; i<DIRETIONAL_MAX; i++){
                    if(i == uDirectionalLightNum) break;
                    L = normalize(-uDirectionalLightPosition[i]);
                    lambertTerm = dot(N,-L);
                    if(lambertTerm > 0.0){
                        ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
                        R = reflect(L, N);
                        specular = pow( max(dot(R, -L), 0.0), uShininess);
                        ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
                    }
                }         
                vec3 pointDirection;  
                highp float distanceLength;
                highp float attenuation;
                for(int i=0;i<POINT_MAX;i++){
                    if(i== uPointLightNum) break;
                    pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
                    distanceLength = length(pointDirection);
                    if(uPointLightRadius[i]> distanceLength){
                        attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength); 
                        L = normalize(pointDirection);
                        lambertTerm = dot(N,-L);
                        if(lambertTerm > 0.0){
                            ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
                            R = reflect(L, N);
                            specular = pow( max(dot(R, -L), 0.0), uShininess);
                            ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
                        }
                    }                          
                }         
                    
                vec4 finalColor = la * uAmbientIntensity + ld + ls; 
                finalColor.rgb *= texelColor.a;
                finalColor.a = texelColor.a;
                if(uUseFog == 1.0) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
                else gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'environmentProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedEnvironmentMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedEnvironmentMaterial)
})();
"use strict";
var RedBitmapMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedBitmapMaterial`,
            description : `
                RedBitmapMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                diffuseTexture : [
                    {type:'RedBitmapTexture'},
                    'RedBitmapTexture Instance'
                ]
            },
            example : `
                RedBitmapMaterial(RedGL Instance, RedBitmapTexture(RedGL Instance, src))
            `,
            return : 'RedBitmapMaterial Instance'
        }
    :DOC*/
    RedBitmapMaterial = function (redGL, diffuseTexture) {
        if (!(this instanceof RedBitmapMaterial)) return new RedBitmapMaterial(redGL, diffuseTexture);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedBitmapMaterial : RedGL Instance만 허용됩니다.', redGL)
        if (!(diffuseTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedBitmapMaterial : RedBitmapTexture Instance만 허용됩니다.')
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`diffuseTexture`,
                return : 'RedBitmapMaterial'
            }
        :DOC*/
        this['diffuseTexture'] = diffuseTexture;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this)
        console.log(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
                mat4 cacheScale = mat4(
                    mvMatrix[0][0], 0.0, 0.0, 0.0, 
                    0.0, mvMatrix[1][1], 0.0, 0.0, 
                    0.0, 0.0, 1.0, mvMatrix[2][2], 
                    0.0, 0.0, 0.0, 1.0 
                );
                mat4 tMTX = cameraMTX * mvMatrix;
                tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
                tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
                tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
                return tMTX * cacheScale;
            }
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                gl_PointSize = uPointSize;
                if(uSprite3DYn) {
                    gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
                    if(!uPerspectiveScale){
                        gl_Position /= gl_Position.w;
                        gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1]);
                    }
                }
                else gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;
            float fogFactor(float perspectiveFar, float density){
                float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
                float fog = flog_cord * density;
                if(1.0 - fog < 0.0) discard;
                return clamp(1.0 - fog, 0.0,  1.0);
            }
            vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
                return mix(fogColor, currentColor, fogFactor);
            }
            void main(void) {
                vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
                finalColor.rgb *= finalColor.a;
                if(finalColor.a ==0.0) discard;
                if(uUseFog == 1.0) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
                else gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'bitmapProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedBitmapMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedBitmapMaterial)
})();
"use strict";
var RedPointBitmapMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedPointBitmapMaterial`,
            description : `
                RedPointBitmapMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                diffuseTexture : [
                    {type:'RedBitmapTexture'}
                ]
            },
            return : 'RedPointBitmapMaterial Instance'
        }
    :DOC*/
    RedPointBitmapMaterial = function (redGL, diffuseTexture) {
        if (!(this instanceof RedPointBitmapMaterial)) return new RedPointBitmapMaterial(redGL, diffuseTexture);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPointBitmapMaterial : RedGL Instance만 허용됩니다.', redGL)
        if (!(diffuseTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedPointBitmapMaterial : RedBitmapTexture Instance만 허용됩니다.')
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`diffuseTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['diffuseTexture'] = diffuseTexture;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this,redGL);
        /**DOC:
            {
                title :`alphaTest`,
                description : `
                기본값 : 0.0001
                해당값보다 알파값이 작을경우 discard 처리됨.
                `,
                return : 'Number'
            }
        :DOC*/
        this['alphaTest'] = 0.00001
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this)
        console.log(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                gl_PointSize = aPointSize;
                gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;
            uniform float uAlphaTest;
            float fogFactor(float perspectiveFar, float density){
                float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
                float fog = flog_cord * density;
                if(1.0 - fog < 0.0) discard;
                return clamp(1.0 - fog, 0.0,  1.0);
            }
            vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
                return mix(fogColor, currentColor, fogFactor);
            }
            void main(void) {
                vec4 finalColor = texture2D(uDiffuseTexture, vec2(gl_PointCoord.x, - gl_PointCoord.y));
                finalColor.rgb *= finalColor.a;
                if(finalColor.a < uAlphaTest) discard;
                if(uUseFog == 1.0) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
                else gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'pointBitmapProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedPointBitmapMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedPointBitmapMaterial)
})();
"use strict";
var RedStandardMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedStandardMaterial`,
            description : `
                RedStandardMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                diffuseTexture : [
                    {type:'RedBitmapTexture'}
                ],
                normalTexture : [
                    {type:'RedBitmapTexture'}
                ],
                specularTexture : [
                    {type:'RedBitmapTexture'}
                ],
                displacementTexture : [
                    {type:'RedBitmapTexture'}
                ]
            },
            example : `
                RedStandardMaterial(
                    RedGL Instance, 
                    RedBitmapTexture(RedGL Instance, src), // diffuseTexture
                    RedBitmapTexture(RedGL Instance, src), // normalTexture
                    RedBitmapTexture(RedGL Instance, src), // specularTexture
                    RedBitmapTexture(RedGL Instance, src)  // displacementTexture
                )
            `,
            return : 'RedStandardMaterial Instance'
        }
    :DOC*/
    RedStandardMaterial = function (redGL, diffuseTexture, normalTexture, specularTexture, displacementTexture) {
        if (!(this instanceof RedStandardMaterial)) return new RedStandardMaterial(redGL, diffuseTexture, normalTexture, specularTexture, displacementTexture);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedStandardMaterial : RedGL Instance만 허용됩니다.', redGL)
        if (!(diffuseTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedStandardMaterial : diffuseTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (normalTexture && !(normalTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedStandardMaterial : normalTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (specularTexture && !(specularTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedStandardMaterial : specularTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (displacementTexture && !(displacementTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedStandardMaterial : displacementTexture - RedBitmapTexture Instance만 허용됩니다.')

        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`diffuseTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['diffuseTexture'] = diffuseTexture;
        /**DOC:
            {
                title :`normalTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['normalTexture'] = normalTexture;
        /**DOC:
            {
                title :`specularTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['specularTexture'] = specularTexture;
        /**DOC:
            {
                title :`shininess`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['displacementTexture'] = displacementTexture;
        /**DOC:
            {
                title :`shininess`,
                description : `기본값 : 16`,
                return : 'number'
            }
        :DOC*/
        this['shininess'] = 16
        /**DOC:
            {
                title :`specularPower`,
                description : `기본값 : 1`,                
                return : 'number'
            }
        :DOC*/
        this['specularPower'] = 1
        /**DOC:
            {
                title :`displacementPower`,
                description : `기본값 : 0`,                
                return : 'Number'
            }
        :DOC*/
        this['displacementPower'] = 0
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        console.log(this)
        // Object.seal(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            uniform sampler2D uDisplacementTexture;
            uniform float uDisplacementPower;
            
            varying vec4 vVertexPositionEye4;
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0)); 
                vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);         
                vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(uDisplacementTexture, vTexcoord).x * uDisplacementPower ;
                
                gl_PointSize = uPointSize;
                gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;
            uniform sampler2D uNormalTexture;
            uniform sampler2D uSpecularTexture;
 
            uniform float uShininess;
            uniform float uSpecularPower;
            
            varying vec4 vVertexPositionEye4;
            float fogFactor(float perspectiveFar, float density){
                float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
                float fog = flog_cord * density;
                if(1.0 - fog < 0.0) discard;
                return clamp(1.0 - fog, 0.0,  1.0);
            }
            vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
                return mix(fogColor, currentColor, fogFactor);
            }
            void main(void) {
                vec4 la = uAmbientLightColor * uAmbientLightColor.a;
                vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
                vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
 
                vec4 texelColor = texture2D(uDiffuseTexture, vTexcoord);
                texelColor.rgb *= texelColor.a;
                if(texelColor.a ==0.0) discard;
 
                vec3 N = normalize(vVertexNormal);
                vec4 normalColor = texture2D(uNormalTexture, vTexcoord);
                if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb  - 0.5));
 
                vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
                float specularTextureValue = 1.0;
                specularTextureValue = texture2D(uSpecularTexture, vTexcoord).r;
                float specular;             
 
                vec3 L;
                vec3 R;
                highp float lambertTerm;
                for(int i=0; i<DIRETIONAL_MAX; i++){
                    if(i == uDirectionalLightNum) break;
                    L = normalize(-uDirectionalLightPosition[i]);
                    lambertTerm = dot(N,-L);
                    if(lambertTerm > 0.0){
                        ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
                        R = reflect(L, N);
                        specular = pow( max(dot(R, -L), 0.0), uShininess);
                        ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
                    }
                }         
                vec3 pointDirection;  
                highp float distanceLength;
                highp float attenuation;
                for(int i=0;i<POINT_MAX;i++){
                    if(i== uPointLightNum) break;
                    pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
                    distanceLength = length(pointDirection);
                    if(uPointLightRadius[i]> distanceLength){
                        attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength); 
                        L = normalize(pointDirection);
                        lambertTerm = dot(N,-L);
                        if(lambertTerm > 0.0){
                            ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
                            R = reflect(L, N);
                            specular = pow( max(dot(R, -L), 0.0), uShininess);
                            ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
                        }
                    }                          
                }            
                
                vec4 finalColor = la * uAmbientIntensity + ld + ls; 
                finalColor.rgb *= texelColor.a;
                finalColor.a = texelColor.a;
                if(uUseFog == 1.0) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
                else gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'standardProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedStandardMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedStandardMaterial)
})();
"use strict";
var RedGridMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedGridMaterial`,
            description : `
                RedGridMaterial Instance 생성.
                RedGrid Instance 새성시 내부적으로 자동으로 생성됨.
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ]
            },
            example : `
                RedGridMaterial(RedGL Instance)
            `,
            return : 'RedGridMaterial Instance'
        }
    :DOC*/
    RedGridMaterial = function (redGL) {
        if (!(this instanceof RedGridMaterial)) return new RedGridMaterial(redGL);
        // 유니폼 프로퍼티
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL)
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        Object.seal(this)
        console.log(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            varying vec4 vColor;
            void main(void) {
                vColor = aVertexColor;
                gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            float fogFactor(float perspectiveFar, float density){
                float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
                float fog = flog_cord * density;
                if(1.0 - fog < 0.0) discard;
                return clamp(1.0 - fog, 0.0,  1.0);
            }
            vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
                return mix(fogColor, currentColor, fogFactor);
            }
            varying vec4 vColor;
            void main(void) {
                vec4 finalColor = vColor;
                finalColor.rgb *= vColor.a;
                if(uUseFog == 1.0) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
                else gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'gridMaterialProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();

    RedGridMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedGridMaterial)
})();
"use strict";
var RedPointColorMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedPointColorMaterial`,
            description : `
                RedPointColorMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ]
            },
            return : 'RedPointColorMaterial Instance'
        }
    :DOC*/
    RedPointColorMaterial = function (redGL) {
        if (!(this instanceof RedPointColorMaterial)) return new RedPointColorMaterial(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPointColorMaterial : RedGL Instance만 허용됩니다.', redGL)
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this)
        console.log(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            varying vec4 vColor;
            void main(void) {
                gl_PointSize = aPointSize;
                vColor = aVertexColor;
                gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            varying vec4 vColor;
            float fogFactor(float perspectiveFar, float density){
                float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
                float fog = flog_cord * density;
                if(1.0 - fog < 0.0) discard;
                return clamp(1.0 - fog, 0.0,  1.0);
            }
            vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
                return mix(fogColor, currentColor, fogFactor);
            }
            void main(void) {
                vec4 finalColor = vColor * vColor.a;
                if(uUseFog == 1.0) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
                else gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'pointColorProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedPointColorMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedPointColorMaterial)
})();
"use strict";
var RedSkyBoxMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedSkyBoxMaterial`,
            description : `
                RedSkyBoxMaterial Instance 생성.
                RedSkyBox Instance 생성시 내부적으로 자동으로 생성됨.
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                skyboxTexture : [
                    {type:'RedBitmapCubeTexture'}
                ]
            },
            example : `
                RedSkyBoxMaterial(
                    RedGL Instance,
                    RedBitmapCubeTexture Instance
                )
            `,
            return : 'RedSkyBoxMaterial Instance'
        }
    :DOC*/
    RedSkyBoxMaterial = function (redGL, skyboxTexture) {
        if (!(this instanceof RedSkyBoxMaterial)) return new RedSkyBoxMaterial(redGL, skyboxTexture);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedSkyBoxMaterial : RedGL Instance만 허용됩니다.', redGL)
        if (skyboxTexture && !(skyboxTexture instanceof RedBitmapCubeTexture)) RedGLUtil.throwFunc('RedSkyBoxMaterial : skyboxTexture - RedBitmapCubeTexture Instance만 허용됩니다.')
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`skyboxTexture`,
                return : 'RedBitmapCubeTexture'
            }
        :DOC*/
        this['skyboxTexture'] = skyboxTexture;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        console.log(this)
        // Object.seal(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            varying vec3 vReflectionCubeCoord;
            void main(void) {
                vReflectionCubeCoord = (uMMatrix *vec4(-aVertexPosition, 0.0)).xyz;
                gl_Position = uPMatrix * uCameraMatrix * uMMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform samplerCube uSkyboxTexture;
            
            float fogFactor(float perspectiveFar, float density){
                float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
                float fog = flog_cord * density;
                return clamp(1.0 - fog, 0.0,  1.0);
            }
            vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
                return mix(fogColor, currentColor, fogFactor);
            }

            varying vec3 vReflectionCubeCoord;
            void main(void) {
                vec4 finalColor = textureCube(uSkyboxTexture, vReflectionCubeCoord);
                if(uUseFog == 1.0) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
                else gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'skyboxProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedSkyBoxMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedSkyBoxMaterial)
})();
"use strict";
var RedPostEffect_Bloom;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_Bloom`,
           description : `
               RedPostEffect_Bloom Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_Bloom Instance'
       }
   :DOC*/
    RedPostEffect_Bloom = function (redGL) {
        if (!(this instanceof RedPostEffect_Bloom)) return new RedPostEffect_Bloom(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_Bloom : RedGL Instance만 허용됩니다.', redGL)
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        this['blurTexture'] = null;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this['process'] = [
            RedPostEffect_BloomThreshold(redGL),
            RedPostEffect_BlurX(redGL),
            RedPostEffect_BlurY(redGL)
        ]
        /**DOC:
           {
               title :`blur`,
               description : `
                   blur 정도.
                   기본값 : 20
               `,
               return : 'Number'
           }
       :DOC*/
        Object.defineProperty(this, 'blur', (function () {
            var _v = 1
            return {
                get: function () { return _v },
                set: function (v) {
                    _v = v;
                    this['process'][1]['size'] = _v;
                    this['process'][2]['size'] = _v;
                }
            }
        })());
        this['blur'] = 20;
        /**DOC:
           {
               title :`exposure`,
               description : `
                   확산 강도.
                   기본값 : 1
               `,
               return : 'Number'
           }
       :DOC*/
        this['exposure'] = 1;
        /**DOC:
           {
               title :`bloomStrength`,
               description : `
                   블룸 강도
                   기본값 : 1.2
               `,
               return : 'Number'
           }
       :DOC*/
        this['bloomStrength'] = 1.2;
        /**DOC:
           {
               title :`threshold`,
               description : `
                   최소 유효값
                   기본값 : 0.3
               `,
               return : 'Number'
           }
       :DOC*/
        Object.defineProperty(this, 'threshold', (function () {
            var _v = 0.3
            return {
                get: function () { return _v },
                set: function (v) { this['process'][0]['threshold'] = _v = v }
            }
        })())
        this['threshold'] = 0.3;
        this.updateTexture = function (lastFrameBufferTexture, parentFramBufferTexture) {
            this['diffuseTexture'] = parentFramBufferTexture;
            this['blurTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;     
            uniform sampler2D uBlurTexture;          
                
            uniform float uExposure;            
            uniform float uBloomStrength;       
            void main() {
                vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
                vec4 thresholdColor = finalColor;
                vec4 blurColor = texture2D(uBlurTexture, vTexcoord);
                gl_FragColor = (finalColor  + blurColor * uBloomStrength) * uExposure ;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_Bloom_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_Bloom.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_Bloom);
})();
"use strict";
var RedPostEffect_BloomThreshold;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_BloomThreshold`,
           description : `
               RedPostEffect_BloomThreshold Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_BloomThreshold Instance'
       }
   :DOC*/
    RedPostEffect_BloomThreshold = function (redGL) {
        if (!(this instanceof RedPostEffect_BloomThreshold)) return new RedPostEffect_BloomThreshold(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_BloomThreshold : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /**DOC:
           {
               title :`threshold`,
               description : `
                   최소 유효값
                   기본값 : 0.24
               `,
               return : 'Number'
           }
       :DOC*/
        this['threshold'] = 0.24;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision highp float;
            uniform sampler2D uDiffuseTexture;     
            uniform float uThreshold;
            
            void main() {
                vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
                if(0.2126 * finalColor.r + 0.7152 * finalColor.g + 0.0722 * finalColor.b < uThreshold)  finalColor.r = finalColor.g = finalColor.b = 0.0;
                gl_FragColor = finalColor;          
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_BloomThreshold_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_BloomThreshold.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_BloomThreshold);
})();
"use strict";
var RedPostEffect_Blur;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_Blur`,
           description : `
               RedPostEffect_Blur Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_Blur Instance'
       }
   :DOC*/
    RedPostEffect_Blur = function (redGL) {
        if (!(this instanceof RedPostEffect_Blur)) return new RedPostEffect_Blur(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_Blur : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vResolution = uResolution;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;      
            void main(void) {
                vec2 px = vec2(1.0/vResolution.x, 1.0/vResolution.y);
                vec4 finalColor = vec4(0.0);
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-7.0*px.x, -7.0*px.y))*0.0044299121055113265;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-6.0*px.x, -6.0*px.y))*0.00895781211794;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-5.0*px.x, -5.0*px.y))*0.0215963866053;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-4.0*px.x, -4.0*px.y))*0.0443683338718;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-3.0*px.x, -3.0*px.y))*0.0776744219933;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-2.0*px.x, -2.0*px.y))*0.115876621105;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-1.0*px.x, -1.0*px.y))*0.147308056121;
                finalColor += texture2D(uDiffuseTexture, vTexcoord                             )*0.159576912161;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 1.0*px.x,  1.0*px.y))*0.147308056121;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 2.0*px.x,  2.0*px.y))*0.115876621105;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 3.0*px.x,  3.0*px.y))*0.0776744219933;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 4.0*px.x,  4.0*px.y))*0.0443683338718;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 5.0*px.x,  5.0*px.y))*0.0215963866053;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 6.0*px.x,  6.0*px.y))*0.00895781211794;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 7.0*px.x,  7.0*px.y))*0.0044299121055113265;
                gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_Blur_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_Blur.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_Blur);
})();
"use strict";
var RedPostEffect_BlurX;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_BlurX`,
           description : `
               RedPostEffect_BlurX Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_BlurX Instance'
       }
   :DOC*/
    RedPostEffect_BlurX = function (redGL) {
        if (!(this instanceof RedPostEffect_BlurX)) return new RedPostEffect_BlurX(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_BlurX : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /**DOC:
           {
               title :`size`,
               description : `
                   블러 사이즈
                   기본값 : 50
               `,
               return : 'Number'
           }
       :DOC*/
        this['size'] = 50;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vResolution = uResolution;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;      
            uniform float uSize;
            float random(vec3 scale, float seed) {
                return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
            }
            void main() {
                vec4 finalColor = vec4(0.0);
                vec2 delta;
                float total = 0.0;
                float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
                delta = vec2(uSize/vResolution.x,0.0);
                for (float t = -10.0; t <= 10.0; t++) {
                    float percent = (t + offset - 0.5) / 10.0;
                    float weight = 1.0 - abs(percent);
                    vec4 sample = texture2D(uDiffuseTexture, vTexcoord + delta * percent);
                    sample.rgb *= sample.a;
                    finalColor += sample * weight;
                    total += weight;
                }
                finalColor = finalColor / total;
                finalColor.rgb /= finalColor.a + 0.00001;
                gl_FragColor =  finalColor ;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_BlurX_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_BlurX.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_BlurX);
})();
"use strict";
var RedPostEffect_BlurY;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_BlurY`,
           description : `
               RedPostEffect_BlurY Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_BlurY Instance'
       }
   :DOC*/
    RedPostEffect_BlurY = function (redGL) {
        if (!(this instanceof RedPostEffect_BlurY)) return new RedPostEffect_BlurY(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_BlurY : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /**DOC:
           {
               title :`size`,
               description : `
                   블러 사이즈
                   기본값 : 50
               `,
               return : 'Number'
           }
       :DOC*/
        this['size'] = 50;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vResolution = uResolution;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;      
            uniform float uSize;
            float random(vec3 scale, float seed) {
                return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
            }
            void main() {
                vec4 finalColor = vec4(0.0);
                vec2 delta;
                float total = 0.0;
                float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
                delta = vec2(0.0, uSize/vResolution.y);
                for (float t = -10.0; t <= 10.0; t++) {
                    float percent = (t + offset - 0.5) / 10.0;
                    float weight = 1.0 - abs(percent);
                    vec4 sample = texture2D(uDiffuseTexture, vTexcoord + delta * percent);
                    sample.rgb *= sample.a;
                    finalColor += sample * weight;
                    total += weight;
                }
                finalColor = finalColor / total;
                finalColor.rgb /= finalColor.a + 0.00001;
                gl_FragColor =   finalColor ;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_BlurY_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_BlurY.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_BlurY);
})();
"use strict";

var RedPostEffect_BrightnessContrast;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_BrightnessContrast`,
           description : `
               RedPostEffect_BrightnessContrast Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_BrightnessContrast Instance'
       }
   :DOC*/
    RedPostEffect_BrightnessContrast = function (redGL) {
        if (!(this instanceof RedPostEffect_BrightnessContrast)) return new RedPostEffect_BrightnessContrast(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_BrightnessContrast : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /**DOC:
           {
               title :`brightness`,
               description : `
                   밝기
                   기본값 : 0
               `,
               return : 'Number'
           }
       :DOC*/
        this['brightness'] = 0;
        /**DOC:
           {
               title :`contrast`,
               description : `
                   대조
                   기본값 : 0
               `,
               return : 'Number'
           }
       :DOC*/
        this['contrast'] = 0;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;    
            uniform float uBrightness;
            uniform float uContrast;            
            void main(void) {
                vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord );
                finalColor.rgb += uBrightness;
                if (uContrast > 0.0) finalColor.rgb = (finalColor.rgb - 0.5) / (1.0 - uContrast) + 0.5;
                else finalColor.rgb = (finalColor.rgb - 0.5) * (1.0 + uContrast) + 0.5;
                gl_FragColor = finalColor;                    
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_BrightnessContrast_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_BrightnessContrast.prototype = RedBaseMaterial.prototype;
    RedPostEffect_BrightnessContrast['NORMAL'] = [
        0, 0, 0,
        0, 1, 0,
        0, 0, 0
    ];
    RedPostEffect_BrightnessContrast['SHARPEN'] = [
        0, -1, 0,
        -1, 5, -1,
        0, -1, 0

    ];
    RedPostEffect_BrightnessContrast['BLUR'] = [
        1, 1, 1,
        1, 1, 1,
        1, 1, 1
    ];
    RedPostEffect_BrightnessContrast['EDGE'] = [
        0, 1, 0,
        1, -4, 1,
        0, 1, 0
    ];
    RedPostEffect_BrightnessContrast['EMBOSS'] = [
        -2, -1, 0,
        -1, 1, 1,
        0, 1, 2
    ];
    Object.freeze(RedPostEffect_BrightnessContrast);
})();
"use strict";
var RedPostEffect_Convolution;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_Convolution`,
           description : `
               RedPostEffect_Convolution Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_Convolution Instance'
       }
   :DOC*/
    RedPostEffect_Convolution = function (redGL, kernel) {
        if (!(this instanceof RedPostEffect_Convolution)) return new RedPostEffect_Convolution(redGL, kernel);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_Convolution : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /**DOC:
           {
               title :`kernel`,
               description : `
                   커널값.
               `,
               return : 'Array'
           }
       :DOC*/
        this['kernel'] = kernel;
        Object.defineProperty(this, 'kernel', (function () {
            var _v;
            return {
                get: function () {
                    if (!_v) _v = RedPostEffect_Convolution['NORMAL']
                    return _v
                },
                set: function (v) {
                    _v = v
                }
            }
        })());
        Object.defineProperty(this, 'kernelWeight', (function () {
            var sum;
            return {
                get: function () {
                    sum = 0;
                    for (var k in this['kernel']) sum += this['kernel'][k];
                    return sum;
                }
            }
        })());
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vResolution = uResolution;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;    
            uniform mat3 uKernel;  
            uniform float uKernelWeight;  
            void main(void) {
                vec2 perPX = vec2(1.0/vResolution.x, 1.0/vResolution.y);
                vec4 finalColor = vec4(0.0);              
                finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2(-1.0, -1.0)) * uKernel[0][0] ; 
                finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 0.0, -1.0)) * uKernel[0][1] ;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 1.0, -1.0)) * uKernel[0][2] ;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2(-1.0,  0.0)) * uKernel[1][0] ;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 0.0,  0.0)) * uKernel[1][1] ;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 1.0,  0.0)) * uKernel[1][2] ;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2(-1.0,  1.0)) * uKernel[2][0] ;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 0.0,  1.0)) * uKernel[2][1] ;
                finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 1.0,  1.0)) * uKernel[2][2] ;
                highp float weight;
                weight = uKernelWeight;
                if (0.01 > weight) {
                        weight = 1.0;
                }
                gl_FragColor = vec4((finalColor / uKernelWeight).rgb, 1.0);                
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_Convolution_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);

        }
    })();
    RedPostEffect_Convolution.prototype = RedBaseMaterial.prototype;
    /**DOC:
        {
            title :`RedPostEffect_Convolution.NORMAL`,
            code : 'CONST',
            description : `
                <code>
                [
                    0, 0, 0,
                    0, 1, 0,
                    0, 0, 0
                ]
                </code>
            `,
            return : 'Array'
        }
    :DOC*/
    RedPostEffect_Convolution['NORMAL'] = [
        0, 0, 0,
        0, 1, 0,
        0, 0, 0
    ]
    /**DOC:
        {
            title :`RedPostEffect_Convolution.SHARPEN`,
            code : 'CONST',
            description : `
                <code>
                [
                    0, -1, 0,
                    -1, 5, -1,
                    0, -1, 0
                ]
                </code>
            `,
            return : 'Array'
        }
    :DOC*/
    RedPostEffect_Convolution['SHARPEN'] = [
        0, -1, 0,
        -1, 5, -1,
        0, -1, 0
    ]
    /**DOC:
        {
            title :`RedPostEffect_Convolution.BLUR`,
            code : 'CONST',
            description : `
                <code>
                [
                    1, 1, 1,
                    1, 1, 1,
                    1, 1, 1
                ]
                </code>
            `,
            return : 'Array'
        }
    :DOC*/
    RedPostEffect_Convolution['BLUR'] = [
        1, 1, 1,
        1, 1, 1,
        1, 1, 1
    ]
    /**DOC:
        {
            title :`RedPostEffect_Convolution.EDGE`,
            code : 'CONST',
            description : `
                <code>
                [
                    0, 1, 0,
                    1, -4, 1,
                    0, 1, 0
                ]
                </code>
            `,
            return : 'Array'
        }
    :DOC*/
    RedPostEffect_Convolution['EDGE'] = [
        0, 1, 0,
        1, -4, 1,
        0, 1, 0
    ]
    /**DOC:
        {
            title :`RedPostEffect_Convolution.EMBOSS`,
            code : 'CONST',
            description : `
                <code>
                [
                    -2, -1, 0,
                    -1, 1, 1,
                    0, 1, 2
                ]
                </code>
            `,
            return : 'Array'
        }
    :DOC*/
    RedPostEffect_Convolution['EMBOSS'] = [
        -2, -1, 0,
        -1, 1, 1,
        0, 1, 2
    ]
    Object.freeze(RedPostEffect_Convolution);
})();
"use strict";
var RedPostEffect_DoF;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_DoF`,
           description : `
               RedPostEffect_DoF Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_DoF Instance'
       }
   :DOC*/
    RedPostEffect_DoF = function (redGL) {
        if (!(this instanceof RedPostEffect_DoF)) return new RedPostEffect_DoF(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_DoF : RedGL Instance만 허용됩니다.', redGL)
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['subSceneFrameBuffer'] = RedFrameBuffer(redGL);
        this['subSceneMaterial'] = RedPostEffect_DoF_DepthMaterial(redGL);

        this['diffuseTexture'] = null;
        this['blurTexture'] = null;
        this['subSceneTexture'] = null;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this['process'] = [
            RedPostEffect_BlurX(redGL),
            RedPostEffect_BlurY(redGL)
        ]
        /**DOC:
           {
               title :`focusLength`,
               description : `
                   focusLength
                   기본값 : 15
               `,
               return : 'Number'
           }
       :DOC*/
        Object.defineProperty(this, 'focusLength', (function () {
            return {
                get: function () {
                    return this['subSceneMaterial']['focusLength']
                },
                set: function (v) {
                    this['subSceneMaterial']['focusLength'] = v
                }
            }
        })());
        /**DOC:
           {
               title :`blur`,
               description : `
                   blur 정도.
                   기본값 : 20
               `,
               return : 'Number'
           }
       :DOC*/
        Object.defineProperty(this, 'blur', (function () {
            var _v = 1
            return {
                get: function () {
                    return _v
                },
                set: function (v) {
                    _v = v;
                    this['process'][0]['size'] = _v;
                    this['process'][1]['size'] = _v;
                }
            }
        })());
        this['blur'] = 10
        this.updateTexture = function (lastFrameBufferTexture, parentFramBufferTexture, subSceneTexture) {
            this['diffuseTexture'] = parentFramBufferTexture;
            this['blurTexture'] = lastFrameBufferTexture;
            this['subSceneTexture'] = subSceneTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
              
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;     
            uniform sampler2D uBlurTexture;    
            uniform sampler2D uSubSceneTexture;    
                 
            highp float unpack_depth( const in highp vec4 rgba_depth ) {
                const highp vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );
                highp float depth = dot( rgba_depth, bit_shift );
                return depth;
            }

            //http://www.nutty.ca/?page_id=352&amp;link=shadow_map	
            highp float unpack_depth2 (highp vec4 colour)
            {
                const highp vec4 bitShifts = vec4(
                    1.0,
                    1.0 / 255.0,
                    1.0 / (255.0 * 255.0),
                    1.0 / (255.0 * 255.0 * 255.0)
                );
                return dot(colour, bitShifts);
            }
            
            uniform float uDistance;           
            void main() {
                vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
                vec4 blurColor = texture2D(uBlurTexture, vTexcoord);
                vec4 depthColor = texture2D(uSubSceneTexture, vTexcoord);             
                finalColor.rgb *= (depthColor.r);
                blurColor.rgb *= (1.0-depthColor.r);
                gl_FragColor =  (finalColor + blurColor) ;
         
          
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_DoF_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_DoF.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_DoF);
})();
"use strict";
var RedPostEffect_DoF_DepthMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedPostEffect_DoF_DepthMaterial`,
            description : `
                RedPostEffect_DoF_DepthMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ]
            },
            example : `
                RedPostEffect_DoF_DepthMaterial(RedGL Instance)
            `,
            return : 'RedPostEffect_DoF_DepthMaterial Instance'
        }
    :DOC*/
    RedPostEffect_DoF_DepthMaterial = function (redGL) {
        if (!(this instanceof RedPostEffect_DoF_DepthMaterial)) return new RedPostEffect_DoF_DepthMaterial(redGL);
        /////////////////////////////////////////
        // 유니폼 프로퍼티
       
        this['focusLength'] = 15
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this);
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
                mat4 cacheScale = mat4(
                        mvMatrix[0][0], 0.0, 0.0, 0.0, 
                        0.0, mvMatrix[1][1], 0.0, 0.0, 
                        0.0, 0.0, 1.0, mvMatrix[2][2], 
                        0.0, 0.0, 0.0, 1.0 
                    );
                mat4 tMTX = cameraMTX * mvMatrix;
                tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
                tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
                tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
                return tMTX * cacheScale;
            }
            void main(void) {
          
                gl_PointSize = uPointSize;
                if(uSprite3DYn) {
                    gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
                    if(!uPerspectiveScale){
                        gl_Position /= gl_Position.w;
                        gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1]);
                    }
                }
                else gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform float uFocusLength;
            highp vec4 pack_depth( const in highp float depth ) {
                const highp vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );
                const highp vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );
                highp vec4 res = fract( depth * bit_shift );
                res -= res.xxyz * bit_mask;
                return res;
            }

            //http://www.nutty.ca/?page_id=352&amp;link=shadow_map		
            highp vec4 pack_depth2 (highp float depth)
            {
                const highp vec4 bias = vec4(1.0 / 255.0,
                            1.0 / 255.0,
                            1.0 / 255.0,
                            0.0);

                highp float r = depth;
                highp float g = fract(r * 255.0);
                highp float b = fract(g * 255.0);
                highp float a = fract(b * 255.0);
                highp vec4 colour = vec4(r, g, b, a);
                
                return colour - (colour.yzww * bias);
            }	
            void main(void) {
                float depth = 1.0 - gl_FragCoord.z / gl_FragCoord.w / uFocusLength;
                gl_FragColor = vec4(depth, depth, depth, 1.0);	        
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'depthProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })()
    RedPostEffect_DoF_DepthMaterial.prototype = RedBaseMaterial.prototype
   
    Object.freeze(RedPostEffect_DoF_DepthMaterial)
})();
"use strict";
var RedPostEffect_Film;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_Film`,
           description : `
               RedPostEffect_Film Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_Film Instance'
       }
   :DOC*/
    RedPostEffect_Film = function (redGL, width, height) {
        if (!(this instanceof RedPostEffect_Film)) return new RedPostEffect_Film(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_Film : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /**DOC:
           {
               title :`grayMode`,
               description : `
                   그레이모드
                   기본값 : false
               `,
               return : 'Boolean'
           }
       :DOC*/
        this['grayMode'] = false;
        /**DOC:
           {
               title :`scanlineIntensity`,
               description : `
                   스캔라인강도
                   기본값 : 0.5
               `,
               return : 'Number'
           }
       :DOC*/
        this['scanlineIntensity'] = 0.5;
        /**DOC:
           {
               title :`noiseIntensity`,
               description : `
                   노이즈강도
                   기본값 : 0.5
               `,
               return : 'Number'
           }
       :DOC*/
        this['noiseIntensity'] = 0.5;
        /**DOC:
           {
               title :`scanlineCount`,
               description : `
                   스캔라인 수
                   기본값 : 2048
               `,
               return : 'Number'
           }
       :DOC*/
        this['scanlineCount'] = 2048;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {             
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vTime = uTime;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform bool uGrayMode;
            uniform sampler2D uDiffuseTexture;     
            // noise effect intensity value (0 = no effect, 1 = full effect)
            uniform float uNoiseIntensity;
            // scanlines effect intensity value (0 = no effect, 1 = full effect)
            uniform float uScanlineIntensity;
            // scanlines effect count value (0 = no effect, 4096 = full effect)
            uniform float uScanlineCount;
           
            void main() {
                // sample the source
                vec4 diffuseColor = texture2D( uDiffuseTexture, vTexcoord );

                // make some noise
                float x = vTexcoord.x * vTexcoord.y * vTime;
                x = mod( x, 13.0 ) * mod( x, 123.0 );
                float dx = mod( x, 0.01 );

                // add noise
                vec3 finalColor = diffuseColor.rgb + diffuseColor.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );
                
                // get us a sine and cosine
                vec2 sc = vec2( sin( vTexcoord.y * uScanlineCount ), cos( vTexcoord.y * uScanlineCount ) );
               
                // add scanlines
                finalColor += diffuseColor.rgb * vec3( sc.x, sc.y, sc.x ) * uScanlineIntensity;
               
                // interpolate between source and result by intensity
                finalColor = diffuseColor.rgb + clamp( uNoiseIntensity, 0.0, 1.0 ) * ( finalColor - diffuseColor.rgb );
               
                // convert to grayscale if desired
                if( uGrayMode ) finalColor = vec3( finalColor.r * 0.3 + finalColor.g * 0.59 + finalColor.b * 0.11 );
                gl_FragColor =  vec4( finalColor, diffuseColor.a );
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_Film_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);

        }
    })();
    RedPostEffect_Film.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_Film);
})();
"use strict";
var RedPostEffect_GaussianBlur;
(function () {
  
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_GaussianBlur`,
           description : `
               RedPostEffect_GaussianBlur Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_GaussianBlur Instance'
       }
   :DOC*/
    RedPostEffect_GaussianBlur = function (redGL) {
        if (!(this instanceof RedPostEffect_GaussianBlur)) return new RedPostEffect_GaussianBlur(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_GaussianBlur : RedGL Instance만 허용됩니다.', redGL)
      

        /////////////////////////////////////////
        // 일반 프로퍼티
        this['_UUID'] = RedGL['makeUUID']();
        this['process'] = [
            RedPostEffect_BlurX(redGL),
            RedPostEffect_BlurY(redGL)
        ];
        /**DOC:
           {
               title :`radius`,
               description : `
                   가우시간 블러강도
                   기본값 : 20
               `,
               return : 'Number'
           }
       :DOC*/
        Object.defineProperty(this, 'radius', (function () {
            var _v = 1
            return {
                get: function () { return _v },
                set: function (v) {
                    _v = v;
                    this['process'][0]['size'] = _v;
                    this['process'][1]['size'] = _v;
                }
            }
        })());
        this['radius'] = 20;    
        console.log(this);
    }
    RedPostEffect_GaussianBlur.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_GaussianBlur);
})();
"use strict";
var RedPostEffect_Gray;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_Gray`,
           description : `
               RedPostEffect_Gray Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_Gray Instance'
       }
   :DOC*/
    RedPostEffect_Gray = function (redGL) {
        if (!(this instanceof RedPostEffect_Gray)) return new RedPostEffect_Gray(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_Gray : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vResolution = uResolution;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;      
            void main(void) {
                vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
               	highp float gray = (finalColor.r  + finalColor.g + finalColor.b)/3.0;
                gl_FragColor = vec4( gray, gray, gray, 1.0);
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_Gray_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_Gray.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_Gray);
})();
"use strict";
var RedPostEffect_HalfTone;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_HalfTone`,
           description : `
               RedPostEffect_HalfTone Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_HalfTone Instance'
       }
   :DOC*/
   //TODO: 각각의 값을 정의해봐야겠군....의미가 아리까리..
    RedPostEffect_HalfTone = function (redGL) {
        if (!(this instanceof RedPostEffect_HalfTone)) return new RedPostEffect_HalfTone(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_HalfTone : RedGL Instance만 허용됩니다.', redGL)
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        this['centerX'] = 0.0;
        this['centerY'] = 0.0;
        this['angle'] = 0;
        this['radius'] = 2;
        this['grayMode'] = false;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vResolution = uResolution;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;      
            uniform float uCenterX;
            uniform float uCenterY;
            uniform float uAngle;
            uniform float uRadius;
            uniform bool uGrayMode;            
            float pattern(float angle) {
                angle = angle * 3.141592653589793/180.0;
                float s = sin(angle), c = cos(angle);
                vec2 tex = vTexcoord;
                tex.x -= uCenterX + 0.5;
                tex.y -= uCenterY + 0.5;
                vec2 point = vec2( 
                    c * tex.x - s * tex.y, 
                    s * tex.x + c * tex.y 
                ) * vResolution / uRadius;
                return (sin(point.x) * sin(point.y)) * 4.0;
            }
            void main(void) {
                vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
                if(uGrayMode) {
                    float average = (finalColor.r + finalColor.g + finalColor.b) / 3.0;
                    gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern(uAngle)), finalColor.a);
                }else{
                    vec3 cmy = 1.0 - finalColor.rgb;
                    float k = min(cmy.x, min(cmy.y, cmy.z));
                    cmy = (cmy - k) / (1.0 - k);
                    cmy = clamp(cmy * 10.0 - 3.0 + vec3(pattern(uAngle + 0.26179), pattern(uAngle + 1.30899), pattern(uAngle)), 0.0, 1.0);
                    k = clamp(k * 10.0 - 5.0 + pattern(uAngle + 0.78539), 0.0, 1.0);
                    gl_FragColor = vec4(1.0 - cmy - k, finalColor.a);
                }
              
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_HalfTone_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_HalfTone.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_HalfTone);
})();
"use strict";

var RedPostEffect_HueSaturation;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_HueSaturation`,
           description : `
               RedPostEffect_HueSaturation Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_HueSaturation Instance'
       }
   :DOC*/
    RedPostEffect_HueSaturation = function (redGL) {
        if (!(this instanceof RedPostEffect_HueSaturation)) return new RedPostEffect_HueSaturation(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_HueSaturation : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /**DOC:
           {
               title :`hue`,
               description : `
                   색조
                   기본값 : 0
               `,
               return : 'Number'
           }
       :DOC*/
        this['hue'] = 0;
        /**DOC:
           {
               title :`saturation`,
               description : `
                   채도
                   기본값 : 0
               `,
               return : 'Number'
           }
       :DOC*/
        this['saturation'] = 0;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;    
            uniform float uHue;
            uniform float uSaturation;            
            void main(void) {
                vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord );             
                float angle = uHue * 3.14159265;
                float s = sin(angle), c = cos(angle);
                vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;
                float len = length(finalColor.rgb);
                finalColor.rgb = vec3(
                    dot(finalColor.rgb, weights.xyz),
                    dot(finalColor.rgb, weights.zxy),
                    dot(finalColor.rgb, weights.yzx)
                );                
             
                float average = (finalColor.r + finalColor.g + finalColor.b) / 3.0;
                if (uSaturation > 0.0) finalColor.rgb += (average - finalColor.rgb) * (1.0 - 1.0 / (1.001 - uSaturation));
                else finalColor.rgb += (average - finalColor.rgb) * (-uSaturation);          
                gl_FragColor = finalColor;                    
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_HueSaturation_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_HueSaturation.prototype = RedBaseMaterial.prototype
    Object.freeze(RedPostEffect_HueSaturation);
})();
"use strict";
var RedPostEffect_Invert;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_Invert`,
           description : `
               RedPostEffect_Invert Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_Invert Instance'
       }
   :DOC*/
    RedPostEffect_Invert = function (redGL) {
        if (!(this instanceof RedPostEffect_Invert)) return new RedPostEffect_Invert(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_Invert : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;
      
            void main(void) {
                vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
                finalColor.r = 1.0 - finalColor.r;
                finalColor.g = 1.0 - finalColor.g;
                finalColor.b = 1.0 - finalColor.b;
                gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_Invert_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_Invert.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_Invert);
})();
"use strict";
var RedPostEffect_Pixelize;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_Pixelize`,
           description : `
               RedPostEffect_Pixelize Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_Pixelize Instance'
       }
   :DOC*/
    RedPostEffect_Pixelize = function (redGL) {
        if (!(this instanceof RedPostEffect_Pixelize)) return new RedPostEffect_Pixelize(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_Pixelize : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /**DOC:
           {
               title :`width`,
               description : `
                   픽셀화 가로 크기
                   기본값 : 5
               `,
               return : 'Number'
           }
       :DOC*/
        this['width'] = 5;
        /**DOC:
           {
               title :`height`,
               description : `
                   픽셀화 세로 크기
                   기본값 : 5
               `,
               return : 'Number'
           }
       :DOC*/
        this['height'] = 5;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vResolution = uResolution;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;
            uniform float uWidth;
            uniform float uHeight;
            void main(void) {
               vec4 finalColor;
               float dx = 1.0/vResolution.x * uWidth;
               float dy = 1.0/vResolution.y * uHeight;
               vec2 coord = vec2(
                    dx * (floor(vTexcoord.x / dx) + 0.5),
                    dy * (floor(vTexcoord.y / dy) + 0.5)
                );
                finalColor = texture2D(uDiffuseTexture, coord);
                gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_Pixelize_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_Pixelize.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_Pixelize);
})();
"use strict";
var RedPostEffect_Threshold;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_Threshold`,
           description : `
               RedPostEffect_Threshold Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_Threshold Instance'
       }
   :DOC*/
    RedPostEffect_Threshold = function (redGL) {
        if (!(this instanceof RedPostEffect_Threshold)) return new RedPostEffect_Threshold(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_Threshold : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        /**DOC:
           {
               title :`threshold`,
               description : `
                   최소 유효값
                   기본값 : 0.24
               `,
               return : 'Number'
           }
       :DOC*/
        this['threshold'] = 0.24;
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision highp float;
            uniform sampler2D uDiffuseTexture;     
            uniform float uThreshold;
            void main() {
                vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
                float v;
                if(0.2126 * finalColor.r + 0.7152 * finalColor.g + 0.0722 * finalColor.b >= uThreshold) v = 1.0;
                else v = 0.0;
                finalColor.r = finalColor.g = finalColor.b = v;
                gl_FragColor = finalColor;          
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_Threshold_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_Threshold.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_Threshold);
})();
"use strict";

var RedPostEffect_Vignetting;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_Vignetting`,
           description : `
               RedPostEffect_Vignetting Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_Vignetting Instance'
       }
   :DOC*/
    RedPostEffect_Vignetting = function (redGL) {
        if (!(this instanceof RedPostEffect_Vignetting)) return new RedPostEffect_Vignetting(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_Vignetting : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /**DOC:
           {
               title :`size`,
               description : `
                   비네팅사이즈
                   기본값 : 0.1
               `,
               return : 'Number'
           }
       :DOC*/
        this['size'] = 0.1;
        /**DOC:
            {
                title :`size`,
                description : `
                    비네팅 강도
                    기본값 : 0.85
            `,
            return : 'Number'
            }
       :DOC*/
        this['indensity'] = 0.85;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;    
            uniform float uSize;
            uniform float uIndensity;            
            void main(void) {
                vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord );
                float dist = distance(vTexcoord, vec2(0.5, 0.5));
                finalColor.rgb *= smoothstep(0.8, uSize * 0.799, dist * (uIndensity + uSize));
                gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_Vignetting_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_Vignetting.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_Vignetting);
})();
"use strict";
var RedPostEffect_ZoomBlur;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_ZoomBlur`,
           description : `
               RedPostEffect_ZoomBlur Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_ZoomBlur Instance'
       }
   :DOC*/
    RedPostEffect_ZoomBlur = function (redGL) {
        if (!(this instanceof RedPostEffect_ZoomBlur)) return new RedPostEffect_ZoomBlur(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_ZoomBlur : RedGL Instance만 허용됩니다.', redGL);
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /**DOC:
            {
                title :`centerX`,
                description : `
                    정중앙 중심의 가로 위치
                    기본값 : 0.0
                `,
                return : 'Number'
            }
       :DOC*/
        this['centerX'] = 0.0;
        /**DOC:
            {
                title :`centerY`,
                description : `
                    정중앙 중심의 세로 위치
                    기본값 : 0.0
                `,
                return : 'Number'
            }
       :DOC*/
        this['centerY'] = 0.0;
        /**DOC:
            {
                title :`strength`,
                description : `
                    강도
                    기본값 : 0.15
                `,
                return : 'Number'
            }
       :DOC*/
        this['strength'] = 0.15;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;      
            uniform float uCenterX;
            uniform float uCenterY;
            uniform float uStrength;
            float random(vec3 scale, float seed) {
                return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
            }
            void main(void) {
                vec4 finalColor = vec4(0.0);
                vec2 center = vec2(uCenterX+0.5,-uCenterY+0.5);
                vec2 toCenter = center - vTexcoord ;
                float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
                float total = 0.0;
                
                for (float t = 0.0; t <= 30.0; t++) {
                    float percent = (t + offset) / 30.0;
                    float weight = 3.0 * (percent - percent * percent);
                    vec4 sample = texture2D(uDiffuseTexture, vTexcoord + toCenter * percent * uStrength );
                    sample.rgb *= sample.a;
                    finalColor += sample * weight;
                    total += weight;
                }
                gl_FragColor = finalColor / total;
                gl_FragColor.rgb /= gl_FragColor.a + 0.00001;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_ZoomBlur_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_ZoomBlur.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_ZoomBlur);
})();
"use strict";
var RedPostEffect_FXAA;
(function () {
    var makeProgram;
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffect_FXAA`,
           description : `
               RedPostEffect_FXAA Instance 생성.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffect_FXAA Instance'
       }
   :DOC*/
    RedPostEffect_FXAA = function (redGL) {
        if (!(this instanceof RedPostEffect_FXAA)) return new RedPostEffect_FXAA(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffect_FXAA : RedGL Instance만 허용됩니다.', redGL)
        this['frameBuffer'] = RedFrameBuffer(redGL);
        this['diffuseTexture'] = null;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
      
        this.updateTexture = function (lastFrameBufferTexture) {
            this['diffuseTexture'] = lastFrameBufferTexture;
        }
        this['bind'] = RedPostEffectManager.prototype['bind'];
        this['unbind'] = RedPostEffectManager.prototype['unbind'];
        this.checkProperty();
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vResolution = uResolution;
                gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;     
            const float FXAA_REDUCE_MIN = 1.0/ 128.0;
            const float FXAA_REDUCE_MUL = 1.0 / 8.0;
            const float FXAA_SPAN_MAX = 8.0;
            void main() {
                vec4 finalColor;
                vec2 inverseVP = vec2(1.0 / vResolution.x, 1.0 / vResolution.y);
                vec2 fragCoord = gl_FragCoord.xy;
                vec3 rgbNW = texture2D(uDiffuseTexture, (fragCoord + vec2(-1.0, -1.0)) * inverseVP).xyz;
                vec3 rgbNE = texture2D(uDiffuseTexture, (fragCoord + vec2(1.0, -1.0)) * inverseVP).xyz;
                vec3 rgbSW = texture2D(uDiffuseTexture, (fragCoord + vec2(-1.0, 1.0)) * inverseVP).xyz;
                vec3 rgbSE = texture2D(uDiffuseTexture, (fragCoord + vec2(1.0, 1.0)) * inverseVP).xyz;
                vec3 rgbM  = texture2D(uDiffuseTexture, fragCoord  * inverseVP).xyz;
                vec3 luma = vec3(0.299, 0.587, 0.114);
                float lumaNW = dot(rgbNW, luma);
                float lumaNE = dot(rgbNE, luma);
                float lumaSW = dot(rgbSW, luma);
                float lumaSE = dot(rgbSE, luma);
                float lumaM  = dot(rgbM,  luma);
                float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
                float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

                vec2 dir;
                dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
                dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

                float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

                float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
                dir = min(
                    vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX), 
                    max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)
                ) * inverseVP;
                    
                vec3 rgbA = 0.5 * (
                    texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                    texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz
                );
                vec3 rgbB = rgbA * 0.5 + 0.25 * (
                    texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * -0.5).xyz +
                    texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * 0.5).xyz
                );

                float lumaB = dot(rgbB, luma);
                if ((lumaB < lumaMin) || (lumaB > lumaMax)) finalColor = vec4(rgbA, 1.0);
                else finalColor = vec4(rgbB, 1.0);

                gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'RedPostEffect_FXAA_Program';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource);
        }
    })();
    RedPostEffect_FXAA.prototype = RedBaseMaterial.prototype;
    Object.freeze(RedPostEffect_FXAA);
})();
"use strict";
var RedPostEffectManager;
(function () {
    /**DOC:
       {
           constructorYn : true,
           title :`RedPostEffectManager`,
           description : `
               RedPostEffectManager Instance 생성.
               RedScene 생성시 내부속성으로 자동생성됨.
           `,
           params : {
               redGL : [
                   {type:'RedGL'}
               ]
           },
           return : 'RedPostEffectManager Instance'
       }
   :DOC*/
    RedPostEffectManager = function (redGL) {
        if (!(this instanceof RedPostEffectManager)) return new RedPostEffectManager(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPostEffectManager : RedGL Instance만 허용됩니다.', redGL)
        var tGL;
        var quad;
        tGL = redGL['gl'];
        /**DOC:
             {
                title :`frameBuffer`,
                code : 'PROPERTY', 
                description : `
                    이펙트 렌더링시 사용될 프레임버퍼
                `,
                return : 'RedFrameBuffer Instance'
            }
        :DOC*/
        this['frameBuffer'] = RedFrameBuffer(redGL);
        (function () {
            tGL.activeTexture(tGL.TEXTURE0 + 0)
            tGL.bindTexture(tGL.TEXTURE_2D, tGL.createTexture());
            // tGL.texImage2D(tGL.TEXTURE_2D, 0, tGL.RGBA, tGL.RGBA, tGL.UNSIGNED_BYTE, source)
            tGL.pixelStorei(tGL.UNPACK_FLIP_Y_WEBGL, true);
            tGL.texParameteri(tGL.TEXTURE_2D, tGL.TEXTURE_MIN_FILTER, tGL.NEAREST);
            tGL.texParameteri(tGL.TEXTURE_2D, tGL.TEXTURE_MAG_FILTER, tGL.NEAREST);
            tGL.texParameteri(tGL.TEXTURE_2D, tGL.TEXTURE_WRAP_S, tGL.CLAMP_TO_EDGE);
            tGL.texParameteri(tGL.TEXTURE_2D, tGL.TEXTURE_WRAP_T, tGL.CLAMP_TO_EDGE);
            try {
                tGL.generateMipmap(tGL.TEXTURE_2D)
            } catch (error) {
                console.log('밉맵을 생성할수 없음', source)
            }
            tGL.bindTexture(tGL.TEXTURE_2D, null);
        })();
        /**DOC:
             {
                title :`postEffectList`,
                code : 'PROPERTY', 
                description : `
                    이펙트 리스트
                `,
                return : 'Array'
            }
        :DOC*/
        this['postEffectList'] = [];
        /**DOC:
            {
               title :`antialiasing`,
               code : 'PROPERTY', 
               description : `
                   안티알리어싱 모드 설정
               `,
               return : 'Array'
           }
       :DOC*/
        Object.defineProperty(this, 'antialiasing', (function () {
            var _v = undefined
            return {
                get: function () {
                    return _v
                },
                set: function (v) {
                    _v = v
                }
            }
        })())
        this['antialiasing'] = undefined
        /**DOC:
            {
               title :`finalMaterial`,
               code : 'PROPERTY', 
               description : `
                   최종 프레임버퍼 렌더링을 담당할 재질.
               `,
               return : 'Array'
           }
       :DOC*/
        this['finalMaterial'] = RedBitmapMaterial(redGL, this['frameBuffer']['texture']);
        //
        this['children'] = [];
        quad = RedMesh(redGL, RedPlane(redGL), this['finalMaterial']);
        quad['useCullFace'] = false;
        this['children'].push(quad);
        //
        this['_UUID'] = RedGL['makeUUID']();
        console.log(this);
    }
    RedPostEffectManager.prototype = {
        /**DOC:
             {
                title :`addEffect`,
                code : 'METHOD', 
                description : `
                    postEffect 추가
                `,
                params : {
                    postEffect : [
                        {type:'RedGL'}
                    ]
                },
                return : 'void'
            }
        :DOC*/
        addEffect: function (postEffect) {
            this['postEffectList'].push(postEffect)
        },
        /**DOC:
             {
                title :`removeEffect`,
                code : 'METHOD', 
                description : `
                    postEffect 제거
                `,
                params : {
                    postEffect : [
                        {type:'RedGL'}
                    ]
                },
                return : 'void'
            }
        :DOC*/
        removeEffect: (function () {
            var t0;
            return function (postEffect) {
                t0 = this['postEffectList'].indexOf(postEffect);
                if (t0 != -1) this['postEffectList'].splice(t0, 1);
            }
        })(),
        /**DOC:
             {
                title :`bind`,
                code : 'METHOD', 
                description : `
                    프레임 버퍼 바인딩.
                    렌더러에서 자동호출됨.
                `,
                params : {
                    gl : [
                        {type:'WebGL Context'}
                    ]
                },
                return : 'void'
            }
        :DOC*/
        bind: function (gl) {
            this['frameBuffer'].bind(gl);
        },
        /**DOC:
             {
                title :`unbind`,
                code : 'METHOD', 
                description : `
                    프레임 버퍼 언바인딩.
                    렌더러에서 자동호출됨.
                `,
                params : {
                    gl : [
                        {type:'WebGL Context'}
                    ]
                },
                return : 'void'
            }
        :DOC*/
        unbind: function (gl) {
            this['frameBuffer'].unbind(gl);
        }
    }
    Object.freeze(RedPostEffectManager);
})();console.log('RedGL Release. last update(2018-05-14 18:03:03)');