var RedGLUtil,RedGL,RedBaseContainer,RedBaseLight,RedBaseMaterial,RedBaseObject3D,RedFrameBuffer,RedBuffer,RedGeometry,RedInterleaveInfo,RedAmbientLight,RedDirectionalLight,RedPointLight,JsonModelLoader,RedMTLLoader,RedOBJLoader,RedAxis,RedGrid,RedMesh,RedLine,RedSkyBox,RedSprite3D,RedPointUnit,RedBox,RedPlane,RedSphere,RedProgram,RedSystemShaderCode,RedShader,RedRenderer,RedRenderDebuger,RedAtlas,RedAtlasUV,RedBitmapTexture,RedAtlasTexture,RedBitmapCubeTexture,RedView,RedWorld,RedScene,RedCamera,RedBasicController,RedObitController,RedColorMaterial,RedColorPhongMaterial,RedColorPhongTextureMaterial,RedEnvironmentMaterial,RedBitmapMaterial,RedPointBitmapMaterial,RedStandardMaterial,RedGridMaterial,RedPointColorMaterial,RedSkyBoxMaterial,RedPostEffectMaterial,RedPostEffectManager,RedPostEffect_Bloom,RedPostEffect_BloomThreshold,RedPostEffect_Blur,RedPostEffect_BlurX,RedPostEffect_BlurY,RedPostEffect_BrightnessContrast,RedPostEffect_Convolution,RedPostEffect_DoF,RedPostEffect_DoF_DepthMaterial,RedPostEffect_Film,RedPostEffect_GaussianBlur,RedPostEffect_Gray,RedPostEffect_HalfTone,RedPostEffect_HueSaturation,RedPostEffect_Invert,RedPostEffect_Pixelize,RedPostEffect_Threshold,RedPostEffect_Vignetting,RedPostEffect_ZoomBlur,RedPostEffect_FXAA;!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=function(e){t.ARRAY_TYPE=e},t.toRadian=function(e){return e*i},t.equals=function(e,t){return Math.abs(e-t)<=n*Math.max(1,Math.abs(e),Math.abs(t))};var n=t.EPSILON=1e-6,i=(t.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,t.RANDOM=Math.random,Math.PI/180)},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],f=t[6],d=t[7],c=t[8],h=r[0],l=r[1],R=r[2],m=r[3],p=r[4],g=r[5],E=r[6],M=r[7],_=r[8];return e[0]=h*n+l*o+R*f,e[1]=h*i+l*s+R*d,e[2]=h*a+l*u+R*c,e[3]=m*n+p*o+g*f,e[4]=m*i+p*s+g*d,e[5]=m*a+p*u+g*c,e[6]=E*n+M*o+_*f,e[7]=E*i+M*s+_*d,e[8]=E*a+M*u+_*c,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},t.clone=function(e){var t=new a.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromValues=function(e,t,r,n,i,o,s,u,f){var d=new a.ARRAY_TYPE(9);return d[0]=e,d[1]=t,d[2]=r,d[3]=n,d[4]=i,d[5]=o,d[6]=s,d[7]=u,d[8]=f,d},t.set=function(e,t,r,n,i,a,o,s,u,f){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=f,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],f=t[7],d=t[8],c=d*o-s*f,h=-d*a+s*u,l=f*a-o*u,R=r*c+n*h+i*l;return R?(R=1/R,e[0]=c*R,e[1]=(-d*n+i*f)*R,e[2]=(s*n-i*o)*R,e[3]=h*R,e[4]=(d*r-i*u)*R,e[5]=(-s*r+i*a)*R,e[6]=l*R,e[7]=(-f*r+n*u)*R,e[8]=(o*r-n*a)*R,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],f=t[7],d=t[8];return e[0]=o*d-s*f,e[1]=i*f-n*d,e[2]=n*s-i*o,e[3]=s*u-a*d,e[4]=r*d-i*u,e[5]=i*a-r*s,e[6]=a*f-o*u,e[7]=n*u-r*f,e[8]=r*o-n*a,e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],f=e[8];return t*(f*a-o*u)+r*(-f*i+o*s)+n*(u*i-a*s)},t.multiply=n,t.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],f=t[6],d=t[7],c=t[8],h=r[0],l=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=h*n+l*o+f,e[7]=h*i+l*s+d,e[8]=h*a+l*u+c,e},t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],f=t[6],d=t[7],c=t[8],h=Math.sin(r),l=Math.cos(r);return e[0]=l*n+h*o,e[1]=l*i+h*s,e[2]=l*a+h*u,e[3]=l*o-h*n,e[4]=l*s-h*i,e[5]=l*u-h*a,e[6]=f,e[7]=d,e[8]=c,e},t.scale=function(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,f=r*o,d=n*o,c=n*s,h=i*o,l=i*s,R=i*u,m=a*o,p=a*s,g=a*u;return e[0]=1-c-R,e[3]=d-g,e[6]=h+p,e[1]=d+g,e[4]=1-f-R,e[7]=l-m,e[2]=h-p,e[5]=l+m,e[8]=1-f-c,e},t.normalFromMat4=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],f=t[7],d=t[8],c=t[9],h=t[10],l=t[11],R=t[12],m=t[13],p=t[14],g=t[15],E=r*s-n*o,M=r*u-i*o,_=r*f-a*o,v=n*u-i*s,U=n*f-a*s,b=i*f-a*u,P=d*m-c*R,L=d*p-h*R,T=d*g-l*R,y=c*p-h*m,B=c*g-l*m,x=h*g-l*p,I=E*x-M*B+_*y+v*T-U*L+b*P;return I?(I=1/I,e[0]=(s*x-u*B+f*y)*I,e[1]=(u*T-o*x-f*L)*I,e[2]=(o*B-s*T+f*P)*I,e[3]=(i*B-n*x-a*y)*I,e[4]=(r*x-i*T+a*L)*I,e[5]=(n*T-r*B-a*P)*I,e[6]=(m*b-p*U+g*v)*I,e[7]=(p*_-R*b-g*M)*I,e[8]=(R*U-m*_+g*E)*I,e):null},t.projection=function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},t.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=e[6],d=e[7],c=e[8],h=t[0],l=t[1],R=t[2],m=t[3],p=t[4],g=t[5],E=t[6],M=t[7],_=t[8];return Math.abs(r-h)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-l)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-R)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(R))&&Math.abs(o-m)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-p)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(u-g)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(f-E)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(d-M)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(c-_)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(_))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(){var e=new R.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e}function i(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function a(e,t,r){var n=new R.ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=r,n}function o(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function s(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function u(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function f(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function d(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function c(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function h(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function l(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=function(e){var t=new R.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.length=i,t.fromValues=a,t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},t.subtract=o,t.multiply=s,t.divide=u,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},t.distance=f,t.squaredDistance=d,t.squaredLength=c,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=h,t.dot=l,t.cross=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2];return e[0]=i*u-a*s,e[1]=a*o-n*u,e[2]=n*s-i*o,e},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e},t.hermite=function(e,t,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,f=o*(a-1),d=o*(3-2*a);return e[0]=t[0]*s+r[0]*u+n[0]*f+i[0]*d,e[1]=t[1]*s+r[1]*u+n[1]*f+i[1]*d,e[2]=t[2]*s+r[2]*u+n[2]*f+i[2]*d,e},t.bezier=function(e,t,r,n,i,a){var o=1-a,s=o*o,u=a*a,f=s*o,d=3*a*s,c=3*u*o,h=u*a;return e[0]=t[0]*f+r[0]*d+n[0]*c+i[0]*h,e[1]=t[1]*f+r[1]*d+n[1]*c+i[1]*h,e[2]=t[2]*f+r[2]*d+n[2]*c+i[2]*h,e},t.random=function(e,t){t=t||1;var r=2*R.RANDOM()*Math.PI,n=2*R.RANDOM()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e},t.transformMat3=function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2],f=r[3],d=f*n+s*a-u*i,c=f*i+u*n-o*a,h=f*a+o*i-s*n,l=-o*n-s*i-u*a;return e[0]=d*f+l*-o+c*-u-h*-s,e[1]=c*f+l*-s+h*-o-d*-u,e[2]=h*f+l*-u+d*-s-c*-o,e},t.rotateX=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateY=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateZ=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.angle=function(e,t){var r=a(e[0],e[1],e[2]),n=a(t[0],t[1],t[2]);h(r,r),h(n,n);var i=l(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(r-a)<=R.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=R.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=R.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))};var R=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=o,t.mul=s,t.div=u,t.dist=f,t.sqrDist=d,t.len=i,t.sqrLen=c,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,u=void 0;for(r||(r=3),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],a(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2];return t}}()},function(e,t,r){"use strict";function n(){var e=new l.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function s(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function u(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+a*a)}function f(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a}function d(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function c(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function h(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o),e}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=function(e){var t=new l.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,r,n){var i=new l.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=i,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=s,t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},t.distance=u,t.squaredDistance=f,t.length=d,t.squaredLength=c,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=h,t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e},t.random=function(e,t){return t=t||1,e[0]=l.RANDOM(),e[1]=l.RANDOM(),e[2]=l.RANDOM(),e[3]=l.RANDOM(),h(e,e),s(e,e,t),e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2],f=r[3],d=f*n+s*a-u*i,c=f*i+u*n-o*a,h=f*a+o*i-s*n,l=-o*n-s*i-u*a;return e[0]=d*f+l*-o+c*-u-h*-s,e[1]=c*f+l*-s+h*-o-d*-u,e[2]=h*f+l*-u+d*-s-c*-o,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=t[0],s=t[1],u=t[2],f=t[3];return Math.abs(r-o)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=l.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-f)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))};var l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=i,t.mul=a,t.div=o,t.dist=u,t.sqrDist=f,t.len=d,t.sqrLen=c,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,u=void 0;for(r||(r=4),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],e[3]=t[u+3],a(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];return t}}()},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=t.vec3=t.vec2=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.glMatrix=void 0;var i=n(r(0)),a=n(r(5)),o=n(r(6)),s=n(r(1)),u=n(r(7)),f=n(r(8)),d=n(r(9)),c=n(r(2)),h=n(r(3));t.glMatrix=i,t.mat2=a,t.mat2d=o,t.mat3=s,t.mat4=u,t.quat=f,t.vec2=d,t.vec3=c,t.vec4=h},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],u=r[1],f=r[2],d=r[3];return e[0]=n*s+a*u,e[1]=i*s+o*u,e[2]=n*f+a*d,e[3]=i*f+o*d,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.fromValues=function(e,t,r,n){var i=new a.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},t.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},t.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*a-i*n;return o?(o=1/o,e[0]=a*o,e[1]=-n*o,e[2]=-i*o,e[3]=r*o,e):null},t.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},t.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},t.multiply=n,t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+a*s,e[1]=i*u+o*s,e[2]=n*-s+a*u,e[3]=i*-s+o*u,e},t.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],u=r[1];return e[0]=n*s,e[1]=i*s,e[2]=a*u,e[3]=o*u,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},t.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},t.LDU=function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=i,t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=t[0],u=t[1],f=t[2],d=t[3];return Math.abs(r-s)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-f)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-d)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))},t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],f=r[0],d=r[1],c=r[2],h=r[3],l=r[4],R=r[5];return e[0]=n*f+a*d,e[1]=i*f+o*d,e[2]=n*c+a*h,e[3]=i*c+o*h,e[4]=n*l+a*R+s,e[5]=i*l+o*R+u,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.clone=function(e){var t=new a.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.fromValues=function(e,t,r,n,i,o){var s=new a.ARRAY_TYPE(6);return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s},t.set=function(e,t,r,n,i,a,o){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=r*a-n*i;return u?(u=1/u,e[0]=a*u,e[1]=-n*u,e[2]=-i*u,e[3]=r*u,e[4]=(i*s-a*o)*u,e[5]=(n*o-r*s)*u,e):null},t.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},t.multiply=n,t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],f=Math.sin(r),d=Math.cos(r);return e[0]=n*d+a*f,e[1]=i*d+o*f,e[2]=n*-f+a*d,e[3]=i*-f+o*d,e[4]=s,e[5]=u,e},t.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],f=r[0],d=r[1];return e[0]=n*f,e[1]=i*f,e[2]=a*d,e[3]=o*d,e[4]=s,e[5]=u,e},t.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],f=r[0],d=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=n*f+a*d+s,e[5]=i*f+o*d+u,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},t.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=t[0],d=t[1],c=t[2],h=t[3],l=t[4],R=t[5];return Math.abs(r-f)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-d)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-h)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-l)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(u-R)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(R))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],f=t[6],d=t[7],c=t[8],h=t[9],l=t[10],R=t[11],m=t[12],p=t[13],g=t[14],E=t[15],M=r[0],_=r[1],v=r[2],U=r[3];return e[0]=M*n+_*s+v*c+U*m,e[1]=M*i+_*u+v*h+U*p,e[2]=M*a+_*f+v*l+U*g,e[3]=M*o+_*d+v*R+U*E,M=r[4],_=r[5],v=r[6],U=r[7],e[4]=M*n+_*s+v*c+U*m,e[5]=M*i+_*u+v*h+U*p,e[6]=M*a+_*f+v*l+U*g,e[7]=M*o+_*d+v*R+U*E,M=r[8],_=r[9],v=r[10],U=r[11],e[8]=M*n+_*s+v*c+U*m,e[9]=M*i+_*u+v*h+U*p,e[10]=M*a+_*f+v*l+U*g,e[11]=M*o+_*d+v*R+U*E,M=r[12],_=r[13],v=r[14],U=r[15],e[12]=M*n+_*s+v*c+U*m,e[13]=M*i+_*u+v*h+U*p,e[14]=M*a+_*f+v*l+U*g,e[15]=M*o+_*d+v*R+U*E,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.fromValues=function(e,t,r,n,i,o,s,u,f,d,c,h,l,R,m,p){var g=new a.ARRAY_TYPE(16);return g[0]=e,g[1]=t,g[2]=r,g[3]=n,g[4]=i,g[5]=o,g[6]=s,g[7]=u,g[8]=f,g[9]=d,g[10]=c,g[11]=h,g[12]=l,g[13]=R,g[14]=m,g[15]=p,g},t.set=function(e,t,r,n,i,a,o,s,u,f,d,c,h,l,R,m,p){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=f,e[9]=d,e[10]=c,e[11]=h,e[12]=l,e[13]=R,e[14]=m,e[15]=p,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],f=t[7],d=t[8],c=t[9],h=t[10],l=t[11],R=t[12],m=t[13],p=t[14],g=t[15],E=r*s-n*o,M=r*u-i*o,_=r*f-a*o,v=n*u-i*s,U=n*f-a*s,b=i*f-a*u,P=d*m-c*R,L=d*p-h*R,T=d*g-l*R,y=c*p-h*m,B=c*g-l*m,x=h*g-l*p,I=E*x-M*B+_*y+v*T-U*L+b*P;return I?(I=1/I,e[0]=(s*x-u*B+f*y)*I,e[1]=(i*B-n*x-a*y)*I,e[2]=(m*b-p*U+g*v)*I,e[3]=(h*U-c*b-l*v)*I,e[4]=(u*T-o*x-f*L)*I,e[5]=(r*x-i*T+a*L)*I,e[6]=(p*_-R*b-g*M)*I,e[7]=(d*b-h*_+l*M)*I,e[8]=(o*B-s*T+f*P)*I,e[9]=(n*T-r*B-a*P)*I,e[10]=(R*U-m*_+g*E)*I,e[11]=(c*_-d*U-l*E)*I,e[12]=(s*L-o*y-u*P)*I,e[13]=(r*y-n*L+i*P)*I,e[14]=(m*M-R*v-p*E)*I,e[15]=(d*v-c*M+h*E)*I,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],f=t[7],d=t[8],c=t[9],h=t[10],l=t[11],R=t[12],m=t[13],p=t[14],g=t[15];return e[0]=s*(h*g-l*p)-c*(u*g-f*p)+m*(u*l-f*h),e[1]=-(n*(h*g-l*p)-c*(i*g-a*p)+m*(i*l-a*h)),e[2]=n*(u*g-f*p)-s*(i*g-a*p)+m*(i*f-a*u),e[3]=-(n*(u*l-f*h)-s*(i*l-a*h)+c*(i*f-a*u)),e[4]=-(o*(h*g-l*p)-d*(u*g-f*p)+R*(u*l-f*h)),e[5]=r*(h*g-l*p)-d*(i*g-a*p)+R*(i*l-a*h),e[6]=-(r*(u*g-f*p)-o*(i*g-a*p)+R*(i*f-a*u)),e[7]=r*(u*l-f*h)-o*(i*l-a*h)+d*(i*f-a*u),e[8]=o*(c*g-l*m)-d*(s*g-f*m)+R*(s*l-f*c),e[9]=-(r*(c*g-l*m)-d*(n*g-a*m)+R*(n*l-a*c)),e[10]=r*(s*g-f*m)-o*(n*g-a*m)+R*(n*f-a*s),e[11]=-(r*(s*l-f*c)-o*(n*l-a*c)+d*(n*f-a*s)),e[12]=-(o*(c*p-h*m)-d*(s*p-u*m)+R*(s*h-u*c)),e[13]=r*(c*p-h*m)-d*(n*p-i*m)+R*(n*h-i*c),e[14]=-(r*(s*p-u*m)-o*(n*p-i*m)+R*(n*u-i*s)),e[15]=r*(s*h-u*c)-o*(n*h-i*c)+d*(n*u-i*s),e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],f=e[8],d=e[9],c=e[10],h=e[11],l=e[12],R=e[13],m=e[14],p=e[15];return(t*o-r*a)*(c*p-h*m)-(t*s-n*a)*(d*p-h*R)+(t*u-i*a)*(d*m-c*R)+(r*s-n*o)*(f*p-h*l)-(r*u-i*o)*(f*m-c*l)+(n*u-i*s)*(f*R-d*l)},t.multiply=n,t.translate=function(e,t,r){var n=r[0],i=r[1],a=r[2],o=void 0,s=void 0,u=void 0,f=void 0,d=void 0,c=void 0,h=void 0,l=void 0,R=void 0,m=void 0,p=void 0,g=void 0;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],u=t[2],f=t[3],d=t[4],c=t[5],h=t[6],l=t[7],R=t[8],m=t[9],p=t[10],g=t[11],e[0]=o,e[1]=s,e[2]=u,e[3]=f,e[4]=d,e[5]=c,e[6]=h,e[7]=l,e[8]=R,e[9]=m,e[10]=p,e[11]=g,e[12]=o*n+d*i+R*a+t[12],e[13]=s*n+c*i+m*a+t[13],e[14]=u*n+h*i+p*a+t[14],e[15]=f*n+l*i+g*a+t[15]),e},t.scale=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,r,n){var i=n[0],o=n[1],s=n[2],u=Math.sqrt(i*i+o*o+s*s),f=void 0,d=void 0,c=void 0,h=void 0,l=void 0,R=void 0,m=void 0,p=void 0,g=void 0,E=void 0,M=void 0,_=void 0,v=void 0,U=void 0,b=void 0,P=void 0,L=void 0,T=void 0,y=void 0,B=void 0,x=void 0,I=void 0,A=void 0,w=void 0;return Math.abs(u)<a.EPSILON?null:(i*=u=1/u,o*=u,s*=u,f=Math.sin(r),c=1-(d=Math.cos(r)),h=t[0],l=t[1],R=t[2],m=t[3],p=t[4],g=t[5],E=t[6],M=t[7],_=t[8],v=t[9],U=t[10],b=t[11],P=i*i*c+d,L=o*i*c+s*f,T=s*i*c-o*f,y=i*o*c-s*f,B=o*o*c+d,x=s*o*c+i*f,I=i*s*c+o*f,A=o*s*c-i*f,w=s*s*c+d,e[0]=h*P+p*L+_*T,e[1]=l*P+g*L+v*T,e[2]=R*P+E*L+U*T,e[3]=m*P+M*L+b*T,e[4]=h*y+p*B+_*x,e[5]=l*y+g*B+v*x,e[6]=R*y+E*B+U*x,e[7]=m*y+M*B+b*x,e[8]=h*I+p*A+_*w,e[9]=l*I+g*A+v*w,e[10]=R*I+E*A+U*w,e[11]=m*I+M*A+b*w,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],u=t[7],f=t[8],d=t[9],c=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+f*n,e[5]=o*i+d*n,e[6]=s*i+c*n,e[7]=u*i+h*n,e[8]=f*i-a*n,e[9]=d*i-o*n,e[10]=c*i-s*n,e[11]=h*i-u*n,e},t.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],f=t[8],d=t[9],c=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-f*n,e[1]=o*i-d*n,e[2]=s*i-c*n,e[3]=u*i-h*n,e[8]=a*n+f*i,e[9]=o*n+d*i,e[10]=s*n+c*i,e[11]=u*n+h*i,e},t.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],f=t[4],d=t[5],c=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+f*n,e[1]=o*i+d*n,e[2]=s*i+c*n,e[3]=u*i+h*n,e[4]=f*i-a*n,e[5]=d*i-o*n,e[6]=c*i-s*n,e[7]=h*i-u*n,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,r){var n=r[0],i=r[1],o=r[2],s=Math.sqrt(n*n+i*i+o*o),u=void 0,f=void 0,d=void 0;return Math.abs(s)<a.EPSILON?null:(n*=s=1/s,i*=s,o*=s,u=Math.sin(t),d=1-(f=Math.cos(t)),e[0]=n*n*d+f,e[1]=i*n*d+o*u,e[2]=o*n*d-i*u,e[3]=0,e[4]=n*i*d-o*u,e[5]=i*i*d+f,e[6]=o*i*d+n*u,e[7]=0,e[8]=n*o*d+i*u,e[9]=i*o*d-n*u,e[10]=o*o*d+f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,u=i+i,f=a+a,d=n*s,c=n*u,h=n*f,l=i*u,R=i*f,m=a*f,p=o*s,g=o*u,E=o*f;return e[0]=1-(l+m),e[1]=c+E,e[2]=h-g,e[3]=0,e[4]=c-E,e[5]=1-(d+m),e[6]=R+p,e[7]=0,e[8]=h+g,e[9]=R-p,e[10]=1-(d+l),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],u=t[8],f=t[9],d=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(u*u+f*f+d*d),e},t.getRotation=function(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},t.fromRotationTranslationScale=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],u=i+i,f=a+a,d=o+o,c=i*u,h=i*f,l=i*d,R=a*f,m=a*d,p=o*d,g=s*u,E=s*f,M=s*d,_=n[0],v=n[1],U=n[2];return e[0]=(1-(R+p))*_,e[1]=(h+M)*_,e[2]=(l-E)*_,e[3]=0,e[4]=(h-M)*v,e[5]=(1-(c+p))*v,e[6]=(m+g)*v,e[7]=0,e[8]=(l+E)*U,e[9]=(m-g)*U,e[10]=(1-(c+R))*U,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,r,n,i){var a=t[0],o=t[1],s=t[2],u=t[3],f=a+a,d=o+o,c=s+s,h=a*f,l=a*d,R=a*c,m=o*d,p=o*c,g=s*c,E=u*f,M=u*d,_=u*c,v=n[0],U=n[1],b=n[2],P=i[0],L=i[1],T=i[2];return e[0]=(1-(m+g))*v,e[1]=(l+_)*v,e[2]=(R-M)*v,e[3]=0,e[4]=(l-_)*U,e[5]=(1-(h+g))*U,e[6]=(p+E)*U,e[7]=0,e[8]=(R+M)*b,e[9]=(p-E)*b,e[10]=(1-(h+m))*b,e[11]=0,e[12]=r[0]+P-(e[0]*P+e[4]*L+e[8]*T),e[13]=r[1]+L-(e[1]*P+e[5]*L+e[9]*T),e[14]=r[2]+T-(e[2]*P+e[6]*L+e[10]*T),e[15]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,f=r*o,d=n*o,c=n*s,h=i*o,l=i*s,R=i*u,m=a*o,p=a*s,g=a*u;return e[0]=1-c-R,e[1]=d+g,e[2]=h-p,e[3]=0,e[4]=d-g,e[5]=1-f-R,e[6]=l+m,e[7]=0,e[8]=h+p,e[9]=l-m,e[10]=1-f-c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,r,n,i,a,o){var s=1/(r-t),u=1/(i-n),f=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*u,e[10]=(o+a)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*f,e[15]=0,e},t.perspective=function(e,t,r,n,i){var a=1/Math.tan(t/2),o=1/(n-i);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*o,e[15]=0,e},t.perspectiveFromFieldOfView=function(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),f=2/(i+a);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=-(o-s)*u*.5,e[9]=(i-a)*f*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},t.ortho=function(e,t,r,n,i,a,o){var s=1/(t-r),u=1/(n-i),f=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(o+a)*f,e[15]=1,e},t.lookAt=function(e,t,r,n){var i=void 0,o=void 0,s=void 0,u=void 0,f=void 0,d=void 0,c=void 0,h=void 0,l=void 0,R=void 0,m=t[0],p=t[1],g=t[2],E=n[0],M=n[1],_=n[2],v=r[0],U=r[1],b=r[2];return Math.abs(m-v)<a.EPSILON&&Math.abs(p-U)<a.EPSILON&&Math.abs(g-b)<a.EPSILON?mat4.identity(e):(c=m-v,h=p-U,l=g-b,i=M*(l*=R=1/Math.sqrt(c*c+h*h+l*l))-_*(h*=R),o=_*(c*=R)-E*l,s=E*h-M*c,(R=Math.sqrt(i*i+o*o+s*s))?(i*=R=1/R,o*=R,s*=R):(i=0,o=0,s=0),u=h*s-l*o,f=l*i-c*s,d=c*o-h*i,(R=Math.sqrt(u*u+f*f+d*d))?(u*=R=1/R,f*=R,d*=R):(u=0,f=0,d=0),e[0]=i,e[1]=u,e[2]=c,e[3]=0,e[4]=o,e[5]=f,e[6]=h,e[7]=0,e[8]=s,e[9]=d,e[10]=l,e[11]=0,e[12]=-(i*m+o*p+s*g),e[13]=-(u*m+f*p+d*g),e[14]=-(c*m+h*p+l*g),e[15]=1,e)},t.targetTo=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=n[0],u=n[1],f=n[2],d=i-r[0],c=a-r[1],h=o-r[2],l=d*d+c*c+h*h;l>0&&(d*=l=1/Math.sqrt(l),c*=l,h*=l);var R=u*h-f*c,m=f*d-s*h,p=s*c-u*d;return e[0]=R,e[1]=m,e[2]=p,e[3]=0,e[4]=c*p-h*m,e[5]=h*R-d*p,e[6]=d*m-c*R,e[7]=0,e[8]=d,e[9]=c,e[10]=h,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=e[6],d=e[7],c=e[8],h=e[9],l=e[10],R=e[11],m=e[12],p=e[13],g=e[14],E=e[15],M=t[0],_=t[1],v=t[2],U=t[3],b=t[4],P=t[5],L=t[6],T=t[7],y=t[8],B=t[9],x=t[10],I=t[11],A=t[12],w=t[13],G=t[14],S=t[15];return Math.abs(r-M)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(n-_)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-v)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(o-U)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(U))&&Math.abs(s-b)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(u-P)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(f-L)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(d-T)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(c-y)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(h-B)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(l-x)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(R-I)<=a.EPSILON*Math.max(1,Math.abs(R),Math.abs(I))&&Math.abs(m-A)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(p-w)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(w))&&Math.abs(g-G)<=a.EPSILON*Math.max(1,Math.abs(g),Math.abs(G))&&Math.abs(E-S)<=a.EPSILON*Math.max(1,Math.abs(E),Math.abs(S))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(){var e=new f.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function a(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function o(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],u=r[1],f=r[2],d=r[3];return e[0]=n*d+o*s+i*f-a*u,e[1]=i*d+o*u+a*s-n*f,e[2]=a*d+o*f+n*u-i*s,e[3]=o*d-n*s-i*u-a*f,e}function s(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],u=r[0],f=r[1],d=r[2],c=r[3],h=void 0,l=void 0,R=void 0,m=void 0,p=void 0;return(l=i*u+a*f+o*d+s*c)<0&&(l=-l,u=-u,f=-f,d=-d,c=-c),1-l>1e-6?(h=Math.acos(l),R=Math.sin(h),m=Math.sin((1-n)*h)/R,p=Math.sin(n*h)/R):(m=1-n,p=n),e[0]=m*i+p*u,e[1]=m*a+p*f,e[2]=m*o+p*d,e[3]=m*s+p*c,e}function u(e,t){var r=t[0]+t[4]+t[8],n=void 0;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=i,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},t.setAxisAngle=a,t.getAxisAngle=function(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return 0!=n?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r},t.multiply=o,t.rotateX=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+o*s,e[1]=i*u+a*s,e[2]=a*u-i*s,e[3]=o*u-n*s,e},t.rotateY=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u-a*s,e[1]=i*u+o*s,e[2]=a*u+n*s,e[3]=o*u-i*s,e},t.rotateZ=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+i*s,e[1]=i*u-n*s,e[2]=a*u+o*s,e[3]=o*u-a*s,e},t.calculateW=function(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e},t.slerp=s,t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=a*s,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},t.fromMat3=u,t.fromEuler=function(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(r),u=Math.cos(r),f=Math.sin(n),d=Math.cos(n);return e[0]=a*u*d-o*s*f,e[1]=o*s*d+a*u*f,e[2]=o*u*f-a*s*d,e[3]=o*u*d+a*s*f,e},t.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"};var f=n(r(0)),d=n(r(1)),c=n(r(2)),h=n(r(3)),l=(t.clone=h.clone,t.fromValues=h.fromValues,t.copy=h.copy,t.set=h.set,t.add=h.add,t.mul=o,t.scale=h.scale,t.dot=h.dot,t.lerp=h.lerp,t.length=h.length),R=(t.len=l,t.squaredLength=h.squaredLength),m=(t.sqrLen=R,t.normalize=h.normalize);t.exactEquals=h.exactEquals,t.equals=h.equals,t.rotationTo=function(){var e=c.create(),t=c.fromValues(1,0,0),r=c.fromValues(0,1,0);return function(n,i,o){var s=c.dot(i,o);return s<-.999999?(c.cross(e,t,i),c.len(e)<1e-6&&c.cross(e,r,i),c.normalize(e,e),a(n,e,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(c.cross(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+s,m(n,n))}}(),t.sqlerp=function(){var e=i(),t=i();return function(r,n,i,a,o,u){return s(e,n,o,u),s(t,i,a,u),s(r,e,t,2*u*(1-u)),r}}(),t.setAxes=function(){var e=d.create();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],m(t,u(t,e))}}()},function(e,t,r){"use strict";function n(){var e=new c.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function s(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function u(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function f(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function d(e){var t=e[0],r=e[1];return t*t+r*r}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.sqrDist=t.dist=t.div=t.mul=t.sub=t.len=void 0,t.create=n,t.clone=function(e){var t=new c.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},t.fromValues=function(e,t){var r=new c.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},t.set=function(e,t,r){return e[0]=t,e[1]=r,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},t.subtract=i,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e},t.distance=s,t.squaredDistance=u,t.length=f,t.squaredLength=d,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},t.normalize=function(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},t.cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e},t.lerp=function(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e},t.random=function(e,t){t=t||1;var r=2*c.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},t.transformMat2=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e},t.transformMat2d=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e},t.transformMat3=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},t.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},t.equals=function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return Math.abs(r-i)<=c.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=c.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))};var c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.len=f,t.sub=i,t.mul=a,t.div=o,t.dist=s,t.sqrDist=u,t.sqrLen=d,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,u=void 0;for(r||(r=2),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],a(e,e,o),t[u]=e[0],t[u+1]=e[1];return t}}()}])}),function(){var e,t;RedGLUtil={throwFunc:function(){throw Array.prototype.slice.call(arguments).join(" ")},copyProto:function(e,t){for(var r in t.prototype)e.prototype[r]=t.prototype[r]},hexToRGB:function(e){var t,r;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return r=[],3==(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),t="0x"+t.join(""),r[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,r;RedGLUtil.throwFunc("RedGLUtil.hexToRGB : 잘못된 hex값입니다.",e)},rgb2hex:function(e,t,r){return"#"+(16777216+(r|t<<8|e<<16)).toString(16).slice(1)},regHex:(t=/^#(?:[0-9a-fA-F]{3}){1,2}$/,function(e){return t.test(e)}),getStrFromComment:function(t){if("string"!=typeof t&&RedGLUtil.throwFunc("getStrFromComment : 해석할 값은 문자열만 가능",t),e=t.replace("@preserve","").toString().trim().match(/(\/\*)[\s\S]+(\*\/)/g))return e[0].replace(/\/\*|\*\//g,"").trim();RedGLUtil.throwFunc("getStrFromComment : 해석할 불가능한 값",t)}},Object.freeze(RedGLUtil)}(),function(){var e,t,r,n,i,a,o,s,u,f,d,c;t=function(e){if(!(this instanceof t))return new t(e);for(r="VENDOR,VERSION,SHADING_LANGUAGE_VERSION,RENDERER,MAX_VERTEX_ATTRIBS,MAX_VARYING_VECTORS,MAX_VERTEX_UNIFORM_VECTORS,MAX_VERTEX_TEXTURE_IMAGE_UNITS,MAX_FRAGMENT_UNIFORM_VECTORS,MAX_TEXTURE_SIZE,MAX_CUBE_MAP_TEXTURE_SIZE,MAX_COMBINED_TEXTURE_IMAGE_UNITS,MAX_TEXTURE_IMAGE_UNITS,MAX_RENDERBUFFER_SIZE,MAX_VIEWPORT_DIMS,RED_BITS,GREEN_BITS,BLUE_BITS,ALPHA_BITS,DEPTH_BITS,STENCIL_BITS".split(","),n=r.length;n--;)this[i=r[n]]=e.getParameter(e[i])},e=function(){var e,t,r,n,i,a,o;return t={alpha:!1,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!1,powerPreference:"default",failIfMajorPerformanceCaveat:!1},o=["OES_element_index_uint","EXT_texture_filter_anisotropic"],e="webkit-3d,moz-webgl,3d,experimental-webgl,webgl".split(","),function(s,u){if(a=JSON.parse(JSON.stringify(t)),u)for(i in u)a[i]=u[i];for(i=e.length;i--;)if(r=s.getContext(n=e[i],a))return r.glExtension={},o.forEach(function(e){r.glExtension[e]=r.getExtension(e)}),r.version=n,r;return null}}(),(RedGL=function(r,n,i){var a,o,s,u;if(!(this instanceof RedGL))return new RedGL(r,n);r instanceof Element&&"CANVAS"==r.tagName||RedGLUtil.throwFunc("RedGL : Canvas Element만 허용"),o=this,s=!0,u=1,Object.defineProperty(this,"renderScale",{get:function(){return u},set:function(e){(u=e)<=0&&(u=.1),this.setSize(this._width,this._height,!0)}}),Object.defineProperty(this,"fullMode",{get:function(){return s},set:function(e){"boolean"!=typeof e&&RedGLUtil.throwFunc("RedGL : Boolean만 가능."),s=e,this.setSize(this._width,this._height)}}),this._canvas=r,this._width=500,this._height=500,this.gl=a=e(r),a&&(this._detect=t(a,i)),this._datas={},this._UUID=RedGL.makeUUID(),requestAnimationFrame(function(e){var t,r;window.addEventListener("resize",function(){o.setSize(o._width,o._height)}),o.setSize(o._width,o._height);var i=o._detect.MAX_COMBINED_TEXTURE_IMAGE_UNITS,s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC";for(t=RedBitmapTexture(o,s),r=RedBitmapCubeTexture(o,[s,s,s,s,s,s]),o._datas.emptyTexture={"2d":t,"3d":r};i--;)1!=i?(a.activeTexture(a.TEXTURE0+i),a.bindTexture(a.TEXTURE_2D,t.webglTexture)):(a.activeTexture(a.TEXTURE0+1),a.bindTexture(a.TEXTURE_CUBE_MAP,r.webglTexture));n&&n.call(o,!!a)})}).makeUUID=(a=0,function(){return a++}),RedGL.prototype={setSize:(u=0,f=0,function(e,t,r){this.fullMode?(o=document.documentElement?document.documentElement.clientWidth:document.body.clientWidth,s=window.innerHeight):(void 0==e&&RedGLUtil.throwFunc("RedGL setSize : width가 입력되지 않았습니다."),void 0==t&&RedGLUtil.throwFunc("RedGL setSize : height가 입력되지 않았습니다."),"string"==typeof e&&-1!=e.indexOf("%")&&RedGLUtil.throwFunc("RedGL setSize : width는 %로 입력할수 없음."),"string"==typeof t&&-1!=t.indexOf("%")&&RedGLUtil.throwFunc("RedGL setSize: height는 %로 입력할수 없음."),this._width=o=e,this._height=s=t),d=window.devicePixelRatio||1,c=this._canvas,(u!=o||f!=s||r)&&(c.width=o*d*this.renderScale,c.height=s*d*this.renderScale,c.style.width=o,c.style.height=s,u=o,f=s)})},Object.freeze(RedGL)}(),function(){var e;(RedBaseContainer=function(){RedGLUtil.throwFunc("RedBaseContainer : 생성자/직접실행으로 사용 할 수 없습니다.")}).prototype={addChild:function(t){t instanceof RedMesh||t instanceof RedSprite3D||t instanceof RedLine||t instanceof RedPointUnit||RedGLUtil.throwFunc("addChild","RedMesh,RedSprite3D,RedLine,RedPointUnit Instance만 가능"),-1!=(e=this.children.indexOf(t))&&(t=this.children.splice(e,1)),this.children.push(t)},addChildAt:function(){var e;return function(t,r){t instanceof RedMesh||t instanceof RedSprite3D||t instanceof RedLine||t instanceof RedPointUnit||RedGLUtil.throwFunc("addChildAt","RedMesh,RedSprite3D,RedLine,RedPointUnit Instance만 가능"),e=this.children.indexOf(t),this.children.splice(e,0,t)}}(),removeChild:function(){var e;return function(t){-1==(e=this.children.indexOf(t))?RedGLUtil.throwFunc("removeChild","존재하지 않는 RedMesh를 삭제하려고 함"):this.children.splice(e,1)}}(),removeChildAt:function(){return function(e){"number"!=typeof e&&RedGLUtil.throwFunc("removeChildAt","index가 Number형이 아님 "),this.children[e]&&this.children.splice(void 0,1)}},removeChildAll:function(){this.children.length=0},getChildAt:function(e){return"number"!=typeof e&&RedGLUtil.throwFunc("getChildAt","index가 Number형이 아님 "),this.children[e]},getChildIndex:function(e){return this.children.indexOf(e)},numChildren:function(e){return this.children.length}},Object.freeze(RedBaseContainer)}(),function(){var e;(RedBaseLight=function(){RedGLUtil.throwFunc("RedBaseLight : 생성자/직접실행으로 사용 할 수 없습니다.")}).prototype={addCasting:function(e){-1==this._castingList.indexOf(e)&&this._castingList.push(e)},removeCasting:function(e){this._castingList.indexOf(e)>-1&&this._castingList.splice},_castingList:[],setColor:function(t,r){t=t||"#fff",void 0==r&&(r=this.alpha),r>1&&(r=1),this.alpha=r,e=RedGLUtil.hexToRGB.call(this,t),this.color[0]=e[0],this.color[1]=e[1],this.color[2]=e[2],this.color[3]=this.alpha}},Object.freeze(RedBaseLight)}(),(RedBaseMaterial=function(){RedGLUtil.throwFunc("RedBaseMaterial : 생성자/직접실행으로 사용 할 수 없습니다.")}).prototype={checkProperty:function(){var e,t,r;for(e=(t=this.program.uniformLocation).length;e--;)(r=t[e]).location&&!this.hasOwnProperty(r.materialPropertyName)&&RedGLUtil.throwFunc("Material에 ",r.materialPropertyName,"이 정의 되지않았습니다.")}},Object.freeze(RedBaseMaterial),function(){var e;(RedBaseObject3D=function(){RedGLUtil.throwFunc("RedBaseObject3D : 생성자/직접실행으로 사용 할 수 없습니다.")}).build=function(e){this.useCullFace=!0,this.cullFace=e.BACK,this.useDepthTest=!0,this.depthTestFunc=e.LEQUAL,this.useBlendMode=!0,this.blendSrc=e.ONE,this.blendDst=e.ONE_MINUS_SRC_ALPHA,this.drawMode=e.TRIANGLES,this.pointSize=1,this.x=this.y=this.z=0,this.rotationX=this.rotationY=this.rotationZ=0,this.scaleX=this.scaleY=this.scaleZ=1,this.matrix=mat4.create(),this.normalMatrix=mat4.create(),this.children=[]},RedBaseObject3D.prototype={localToWorld:(e=mat4.create(),function(t,r,n){return t=t||0,r=r||0,n=n||0,mat4.identity(e),mat4.translate(e,e,[t,r,n]),mat4.multiply(e,this.matrix,e),[e[12],e[13],e[14]]}),worldToLocal:function(){var e,t;return e=mat4.create(),t=mat4.create(),function(r,n,i){return r=r||0,n=n||0,i=i||0,mat4.translate(e,e,[r,n,i]),mat4.multiply(t,e,this.matrix),[t[0]*r+t[1]*n+t[2]*i+t[3],t[4]*r+t[5]*n+t[6]*i+t[7],t[8]*r+t[9]*n+t[10]*i+t[11]]}}()},Object.freeze(RedBaseObject3D)}(),(RedFrameBuffer=function(e,t,r){if(!(this instanceof RedFrameBuffer))return new RedFrameBuffer(e,t,r);var n;e instanceof RedGL||RedGLUtil.throwFunc("RedFrameBuffer : RedGL Instance만 허용됩니다.",e),n=e.gl,t=t||1920,r=r||1080,t>2048&&(t=2048),r>2048&&(r=2048),this.redGL=e,this.width=t,this.height=r,this.webglFrameBuffer=n.createFramebuffer(),this.webglRenderBuffer=n.createRenderbuffer(),this.texture=RedBitmapTexture(e),this._UUID=RedGL.makeUUID(),n.bindFramebuffer(n.FRAMEBUFFER,this.webglFrameBuffer),n.bindTexture(n.TEXTURE_2D,this.texture.webglTexture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.bindRenderbuffer(n.RENDERBUFFER,this.webglRenderBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,this.width,this.height),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.texture.webglTexture,0),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.webglRenderBuffer),n.bindTexture(n.TEXTURE_2D,null),n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,null)}).prototype={bind:function(e){e.bindFramebuffer(e.FRAMEBUFFER,this.webglFrameBuffer),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture.webglTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindRenderbuffer(e.RENDERBUFFER,this.webglRenderBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this.width,this.height),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.webglTexture,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.webglRenderBuffer)},unbind:function(e){e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}},Object.freeze(RedFrameBuffer),function(){var e,t,r;e=function(e,t,r){switch(t){case RedBuffer.ARRAY_BUFFER:if(r instanceof Float32Array||r instanceof Float64Array){if(r instanceof Float32Array)return e.FLOAT;if(r instanceof Float64Array)return e.FLOAT}else RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ARRAY_BUFFER)형식을 사용해야합니다.","입력값 : "+r);break;case RedBuffer.ELEMENT_ARRAY_BUFFER:if(r instanceof Uint8Array||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array){if(r instanceof Int8Array)return e.BYTE;if(r instanceof Uint8Array)return e.UNSIGNED_BYTE;if(r instanceof Uint16Array)return e.UNSIGNED_SHORT;if(r instanceof Uint32Array)return e.UNSIGNED_INT;if(r instanceof Int16Array)return e.SHORT;if(r instanceof Int32Array)return e.INT}else RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ELEMENT_ARRAY_BUFFER)형식을 사용해야합니다.","입력값 : "+r);break;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ","입력값 : "+r)}},t=function(e,t){switch(t){case RedBuffer.ARRAY_BUFFER:return e.ARRAY_BUFFER;case RedBuffer.ELEMENT_ARRAY_BUFFER:return e.ELEMENT_ARRAY_BUFFER;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ")}},r=function(e,t,r,n){var i;switch(i=0,t){case RedBuffer.ARRAY_BUFFER:e.interleaveDefineInfoList=n,n?(0==n.length&&RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList의 정보는 1개이상의 RedInterleaveInfo Instance로 구성되어야함.",n),n.forEach(function(e){e instanceof RedInterleaveInfo||RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList의 정보는 RedInterleaveInfo Instance로만 구성되어야함.",n),e.offset=n.length<2?0:i,i+=e.size,e._UUID=RedGL.makeUUID(),n[e.attributeKey]=e}),n.length<2?(e.stride=0,e.pointNum=r.length/3):(e.stride=i,e.pointNum=r.length/i)):RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList는 반드시 정의 되어야합니다.");break;case RedBuffer.ELEMENT_ARRAY_BUFFER:e.pointNum=r.length}},(RedBuffer=function(n,i,a,o,s,u){if(!(this instanceof RedBuffer))return new RedBuffer(n,i,a,o,s,u);n instanceof RedGL||RedGLUtil.throwFunc("RedBuffer : RedGL Instance만 허용됩니다.",n),"string"!=typeof i&&RedGLUtil.throwFunc("RedBuffer : key - 문자열만 허용됩니다.","입력값 : "+i),a||RedGLUtil.throwFunc("RedBuffer : bufferType : 미입력"),a&&a!=RedBuffer.ARRAY_BUFFER&&a!=RedBuffer.ELEMENT_ARRAY_BUFFER&&RedGLUtil.throwFunc("RedBuffer : bufferType - RedBuffer.ARRAY_BUFFER or RedBuffer.ELEMENT_ARRAY_BUFFER 만 허용함.","입력값 : "+a);var f=n.gl;if(n._datas.RedBuffer||(n._datas.RedBuffer={},n._datas.RedBuffer[RedBuffer.ARRAY_BUFFER]={},n._datas.RedBuffer[RedBuffer.ELEMENT_ARRAY_BUFFER]={}),n._datas.RedBuffer[a][i])return n._datas.RedBuffer[a][i];n._datas.RedBuffer[a][i]=this,a&&a==RedBuffer.ARRAY_BUFFER&&!s&&RedGLUtil.throwFunc("RedBuffer : 신규생성시 interleaveDefineInfoList를 반드시 정의해야합니다.","입력값 : "+s),this.key=i,this.data=o,this.bufferType=a,this.glArrayType=e(f,this.bufferType,this.data),this.glBufferType=t(f,this.bufferType),this.drawMode=u||f.STATIC_DRAW,r(this,this.bufferType,this.data,s),this.webglBuffer=f.createBuffer(),this._UUID=RedGL.makeUUID(),this.upload=function(t){this.glArrayType==e(f,a,t)?(this.data=t,f.bindBuffer(this.glBufferType,this.webglBuffer),f.bufferData(this.glBufferType,this.data,this.drawMode),r(this,this.bufferType,this.data,this.interleaveDefineInfoList)):RedGLUtil.throwFunc("RedBuffer : upload - data형식이 기존 형식과 다름",t)},this.upload(this.data)}).ARRAY_BUFFER="arrayBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER="elementArrayBuffer",Object.freeze(RedBuffer)}(),RedGeometry=function(e,t){if(!(this instanceof RedGeometry))return new RedGeometry(e,t);e instanceof RedBuffer?e.bufferType!=RedBuffer.ARRAY_BUFFER&&RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer.ARRAY_BUFFER 타입만.",e):RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer Instance만 허용.",e),t&&(t instanceof RedBuffer?t.bufferType!=RedBuffer.ELEMENT_ARRAY_BUFFER&&RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer.ELEMENT_ARRAY_BUFFER 타입만.",t):RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer Instance만 허용.",t)),this.interleaveBuffer=e,this.indexBuffer=t,this._UUID=RedGL.makeUUID()},Object.freeze(RedGeometry),RedInterleaveInfo=function(e,t,r){if(!(this instanceof RedInterleaveInfo))return new RedInterleaveInfo(e,t,r);"string"!=typeof e&&RedGLUtil.throwFunc("RedInterleaveInfo : attributeKey - 문자열만 허용",e),"number"!=typeof t&&RedGLUtil.throwFunc("RedInterleaveInfo : size - 숫자만 허용",t),this.attributeKey=e,this.size=t,this.normalize=void 0!=r,this.offset=null},Object.freeze(RedInterleaveInfo),(RedAmbientLight=function(e,t,r){if(!(this instanceof RedAmbientLight))return new RedAmbientLight(e,t,r);this.color=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?.1:r,this.setColor(t||"#fff",this.alpha),this._UUID=RedGL.makeUUID(),Object.defineProperty(this,"type",{configurable:!1,writable:!1,value:RedAmbientLight.type})}).type="RedAmbientLight",RedGLUtil.copyProto(RedAmbientLight,RedBaseLight),Object.defineProperty(RedAmbientLight.prototype,"alpha",{get:function(){return this.color[3]},set:function(e){this.color[3]=e}}),Object.freeze(RedAmbientLight),(RedDirectionalLight=function(e,t,r){if(!(this instanceof RedDirectionalLight))return new RedDirectionalLight(e,t,r);this.color=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?1:r,this.setColor(t||"#fff",this.alpha),this.x=0,this.y=-1,this.z=0,this._UUID=RedGL.makeUUID(),Object.defineProperty(this,"type",{configurable:!1,writable:!1,value:RedDirectionalLight.type}),this.debug=!1,this.debugObject=RedSprite3D(e,RedBitmapMaterial(e,RedBitmapTexture(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA25pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDozQjcyMEREMTUyMDYxMUU4OTRDNTgzQTBBMEY2MkFFNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDODA1NTI0RjUyMDYxMUU4QkVBQTg3NjZCN0M1OUI2OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDODA1NTI0RTUyMDYxMUU4QkVBQTg3NjZCN0M1OUI2OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowNmFjYmZjZi05YjBkLThlNGItODZiNy1kNWViYWNjZDg4OGMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6M0I3MjBERDE1MjA2MTFFODk0QzU4M0EwQTBGNjJBRTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4vVcpuAAAHNUlEQVR42uxbeWyURRT/tiw9OAJYUekfeBCFNmqlkAgRtURQaTywWIhGSfDAAzmkggcoKopKRQXFKKZqNGmkqGAkGEQFhaQenGrAI3iUpKilaiPSytKt74XfF6evM/vN7n67+xn6kl/Sb3bmvTdvZt68eTMNtbe3O8cyhboM0GWALgN0LKkJpUv2lYQFBFbgYcI7aZF6bcf+ZmXI8L0IlYShhBLCbELPTCiSKQOcTRimfA8nFP/fDTCEMJrQw2bpEVqV71ZLXXpARmHQDDCZ8DnhI8IrFkZoI0SVb/77iEXnX4WMzyAzEAbIJSwk9Mb3RMKMFMzWmYQK/N0bMnODYAB2q42i7B5CkY+dZ153i7JGyM64Af4hVIk13cdjFoQsy1yaAZ6qz6iC7ED4gJWEjaLsRkKpoX53MX1zUaajUvBSaSNkBmoXuI/QonyHCXMIeZq6PxJ+Vb5/I/ykqZcHHmGljGXcG8RtcCfhRVFWpjgulfahEzvQjn1GvaZeBXio9AJhV1ADoUcITaJsmKHuKvxWgr91NFx8N0FG2gOhbpb1WMGbxXRd6SE/lg61wrneRPjdT51tDkOTELe3YvrVWPC9CnH+h4SPlfKLCKMQChco/oEN1UD4krAF7Vy6EO14uay2kH0N4XZCDmFJpwEQhyEvAwxF1OV66MOEd8G4znIkuJNTCNcjhO3jUb+ZsIfwOqLKFks5IzFQlxOyURYhnAvjJXQa7Cu2J2Y8gbCBsJhwskf7SzCizxJGWHTejSFGoM0W8IhFA6HLBuiWLbbbvsn4gJ2GKd8T29NWeGodHx6NdXByWQn6pxLwqDT8XgEd5hiO0zXog5HCHkr8QbiO8AMOHwPF78fDUZWL9cmeep6B527CNsK3hAMKn8HYFYo0HX2S0I8wXyRUag0y6nFwWuBl5bDFSPCiuR/WvItwg6bO+YoB7jR0fjthBXxIg0FWAdbwVIy+SvOwyzytyNTRyzDYnlSlxEYh6hunePCLsV75t82aNrx7PCiiv1h0IurfajC2K+t9ZSd5j7AIv1mnxBLNCXJK61KMEiuxCdvOds0U5o48lGCcsgDt5RIqwUGoFMbfAQMcjDcn6GdSlPfe5aJsKWFWksHaM8gFqDSN8HxC3FKUFM3CulXpa2xPydJi8FJpql+6+2WACwiDNCPX4APvBvBSaRBkBsYAY+AXXOItbo2PZ5Y14Kn6oDF+MA7HyPMVI5I6IrI2XPY9Yb9SfpZoX6c5FSZDTeA5OIZM3jnOgL7t4lDUhiN0i40BLkNkVYjGUc0pqxGxQS1m0QBR5xvHf5I8B0A268eJWL5d6q/RNwSD7EYaba2XAZZrIj5J/bA9rYbFszUj5jdJntnoWHfoMtjCT50iDZCpm6HAkG4GTMMSKFKmjzRaI6wewfdhUSc/BbpKnoehXwS6LMQSaNPo24bQuMrGAGuRkChWHIi6nrjNd0pYGxUOkWlICgwgee5X1nstQvDTYZB20ccInGCr7S7A3vLTOJT7inCFSE7k++gL8sFTypQG2Z+pOOADEYezQxrv4+iPF07uIGQGJhD6hLBXlM3C8TZZKtCcJ/ZCZmAMEMVZX6UzCXN94D0XvFRaodnv02qAXkhHLXL+u/6qRrCh0kybrIzHcXim5jhcjb9LocPVIhS3pmM+IRLPDCiE5TcrnXegQDn+ZuGzNW25I5zcvMXDLxSgzjpD52crHSx3Ot47joNu1U4cL0hsZkAIcfbkGCFyKpOiLj3qdEyK8uXL24a65qRonBkhjvmf42YGQQeQCXpL45QqkcxI1tFG4QiXaPzXBJxd+hvaciL3DudodjuhJXCOofN/I6zky8tVBo/MCvPN7vYEPXYUbcs0nXd/XwUdqqBTp/FGHxLeBf5EGOkSJyLfJIzFqPzs0X49nNV0RJbNFh1vRt3paLveo349dBmLmaieSyLoQ1I+QL0c5UTkGxad4PVZgmjNj8vRMfAbNlkmvhy9DUmdpC9H1ZliO41V59SKkTFtTe4Vdpvh9/NgxFyFt22qrZuWb4LboG3n+dDykkitTfTgG4v3JKfjW6LqOI7abekMhV2ar1Fwq6FuBZzcNkf/jEbX9jixFSZNfl6McP6gTgQn6xCmymQkxxP80us05XDDT2D3iXp5cLpl4qg+0kn0nVAKX4s/Jjp/BNuT7oED5+ZOEKHvqYa8RJXTMTOdB1m+kF8GmIQRdMR63WSoH3E6P5aOGOpuUg4/Lo2GzEAYIAc5xFyxly+L0abdssylZSKGyIXMnCAYIKQJRZ/QHI2TIeb1uCjr74f+fhiApy9fkvyFbw5Plzr+E88C90UIy3rAsX9AZaSwT8q9RviCcJJz9FXZIQu5WWIgvN71Mc8pyC384li+AEmXARwoZKtU1On8WNrm6fshp/Oj7EDsAvHSLhHkbMM5IO0UzpAB+Oj6FPJ4IRxaDmZCka5/nOwyQJcBjm0D/CvAAF/S81D+EWScAAAAAElFTkSuQmCC")))}).type="RedDirectionalLight",RedGLUtil.copyProto(RedDirectionalLight,RedBaseLight),Object.defineProperty(RedDirectionalLight.prototype,"alpha",{get:function(){return this.color[3]},set:function(e){this.color[3]=e}}),Object.freeze(RedDirectionalLight),(RedPointLight=function(e,t,r){if(!(this instanceof RedPointLight))return new RedPointLight(e,t,r);this.color=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?1:r,this.setColor(t||"#fff",this.alpha),this.x=0,this.y=0,this.z=0,this.radius=1,this._UUID=RedGL.makeUUID(),Object.defineProperty(this,"type",{configurable:!1,writable:!1,value:RedPointLight.type}),this.debug=!1,this.debugObject=RedMesh(e,RedSphere(e,1,16,16,16),RedColorMaterial(e)),this.debugObject.drawMode=e.gl.LINE_STRIP}).type="RedPointLight",RedGLUtil.copyProto(RedPointLight,RedBaseLight),Object.defineProperty(RedPointLight.prototype,"alpha",{get:function(){return this.color[3]},set:function(e){this.color[3]=e}}),Object.freeze(RedPointLight),JsonModelLoader=function(e,t,r,n){if(!(this instanceof JsonModelLoader))return new JsonModelLoader(e,t,r,n);var i=new XMLHttpRequest;i.open("GET",r,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.onreadystatechange=function(){if(4==i.readyState){var r,a,o,s;for(a=[],o=0,s=(r=JSON.parse(i.responseText)).position.length/3;o<s;o++)a.push(r.position[3*o],r.position[3*o+1],r.position[3*o+2]),a.push(r.normal[3*o],r.normal[3*o+1],r.normal[3*o+2]),r.uvs?a.push(r.uvs[2*o],r.uvs[2*o+1]):a.push(0,0);n&&n(RedBuffer(e,t,RedBuffer.ARRAY_BUFFER,new Float32Array(a),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),RedBuffer(e,t,RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(r.index)))}},i.send()},Object.freeze(JsonModelLoader),function(){var e,t;t=function(){},RedMTLLoader=function(r,n,i,a){if(!(this instanceof RedMTLLoader))return new RedMTLLoader(r,n,i,a);var o=this,s=new XMLHttpRequest;s.open("GET",n+i,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.onreadystatechange=function(){if(4==s.readyState){var n;if(o.complete=!0,200==s.status)n=e(o,r,s.responseText),o.parseData=n;else o.parseData=new t;a&&a(o.parseData)}},s.addEventListener("error",function(e){}),s.send(),this.path=n,this.fileName=i,this.complete=!1,this.parseData=null},e=function(e,r,n){var i,a,o,s,u,f,d,c,h,l,R,m,p,g;for(var E in i={},o=/^(newmtl )/,s=/^(Ns )/,u=/^(Ka )/,f=/^(Kd )/,d=/^(Ks )/,c=/^(Ni )/,h=/^(d )/,l=/^(illum )/,R=/^(map_Kd )/,/^(map_Ks )/,m=/^(map_Ns )/,p=/^(map_bump )/,(n=n.replace(/^\#[\s\S]+?\n/g,"")).split("\n").forEach(function(t){var r;o.test(t)?(r=t.replace("newmtl ","").trim(),g={name:r},i[r]=g):u.test(t)?g.Ka=t.replace("Ka ","").split(" "):f.test(t)?g.Kd=t.replace("Kd ","").split(" "):d.test(t)?g.Ks=t.replace("Ks ","").split(" "):s.test(t)?g.Ns=+t.replace("Ns ",""):c.test(t)?g.Ni=+t.replace("Ni ",""):h.test(t)?g.d=+t.replace("d ",""):l.test(t)?(g.illum=+t.replace("illum ",""),g.illum):R.test(t)?g.map_Kd=e.path+t.replace("map_Kd ",""):m.test(t)?g.map_Ns=e.path+t.replace("map_Ns ",""):p.test(t)&&(g.map_bump=e.path+t.replace("map_bump ","").split(" ")[2])}),a=new t,i)a[E]=i[E];return a},Object.freeze(RedMTLLoader)}(),function(){var e,t,r,n,i,a,o,s,u,f,d,c,h,l,R;RedOBJLoader=function(t,r,n,i){if(!(this instanceof RedOBJLoader))return new RedOBJLoader(t,r,n,i);var a=this,o=new XMLHttpRequest;o.open("GET",r+n,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.onreadystatechange=function(){4==o.readyState&&(a.result=e(a,t,o.responseText),a.modelParsingComplete=!0,a.resultMesh=void 0,i&&(a.mtlLoader?a.mtlLoader.complete&&i(a.result):i(a.result)))},o.send(),this.path=r,this.fileName=n,this.mtlLoader=null,this.modelParsingComplete=!1,this.callback=i,this.resultMesh=RedMesh(t),this.resultMesh.name="instanceOfRedOBJLoader_"+RedGL.makeUUID(),this.result=null},r=function(e,t,r){var n,i,a,o;for(n in o={},t){var s,u,f,d,c,h;if((a=t[n]).mesh,a.use&&a.resultInterleave.length)h=a.ableLight,(i=r.parseData[a.materialKey])&&(i.map_Kd?(o[i.map_Kd]?u=o[i.map_Kd]:(u=RedBitmapTexture(e,i.map_Kd),o[i.map_Kd]=u),s=h?RedStandardMaterial(e,u):RedBitmapMaterial(e,u)):i.Kd&&(f=255*i.Kd[0],d=255*i.Kd[1],c=255*i.Kd[2],s=h?RedColorPhongTextureMaterial(e,RedGLUtil.rgb2hex(f,d,c)):a.ableNormal?RedColorPhongMaterial(e,RedGLUtil.rgb2hex(f,d,c)):RedColorMaterial(e,RedGLUtil.rgb2hex(f,d,c))),s&&(i.map_Ns&&(o[i.map_Ns]?u=o[i.map_Ns]:(u=RedBitmapTexture(e,i.map_Ns),o[i.map_Ns]=u),s.specularTexture=u),i.map_bump&&(o[i.map_bump]?u=o[i.map_bump]:(u=RedBitmapTexture(e,i.map_bump),o[i.map_bump]=u),s.normalTexture=u),void 0!=i.Ns&&(s.shininess=i.Ns),a.mesh.material=s))}},t=function(e,r,n){for(var i in n){var a,o;if((a=n[i]).use){var s,u,f,d=[];a.resultPosition.length&&d.push(RedInterleaveInfo("aVertexPosition",3)),a.resultNormal.length&&d.push(RedInterleaveInfo("aVertexNormal",3)),a.resultUV.length&&d.push(RedInterleaveInfo("aTexcoord",2)),s=RedBuffer(e,i+"_interleave",RedBuffer.ARRAY_BUFFER,new Float32Array(a.resultInterleave.length?a.resultInterleave:a.resultPosition),d),a.index.length&&a.index.length&&(u=RedBuffer(e,i+"_index",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(a.index))),f=a.resultUV.length&&a.resultNormal.length?RedColorPhongTextureMaterial(e,"#00ff00"):a.resultNormal?RedColorPhongMaterial(e,"#00ff00"):RedColorMaterial(e,"#0000ff"),o=RedMesh(e,RedGeometry(s,u),f),a.ableUV=!!a.resultUV.length,a.ableNormal=!!a.resultNormal.length,a.ableLight=!!(a.ableUV&a.ableNormal)}else o=RedMesh(e);o.name=i,a.mesh=o,r.addChild(o),t(e,o,a.childrenInfo)}},l=/^(mtllib )/,R=/^(usemtl )/,i=/^o /,a=/^g /,o=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,s=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,u=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,f=/f\s+(([\d]{1,}[\s]?){3,})+/,d=/f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,c=/f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,h=/f\s+((([\d]{1,}\/\/[\d]{1,}[\s]?){3,})+)/,n=function(e,t,n){var m,p,g,E,M,_,v,U,b,P;for(g={position:[],normal:[],uv:[],points:[],normalPoints:[],uvPoints:[]},p={},m={},v=n.length;v--;)if(i.test(n[v])){U=!0;break}return U||(P={name:b="objModel"+RedGL.makeUUID(),groupName:b,index:[],position:[],resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},p[b]=E=P,m[b]=E,M=b),n.forEach(function(n){if(l.test(n))return _=RedMTLLoader(e,t.path,n.split(" ")[1],function(n){t.mtlLoader=n,t.modelParsingComplete&&t.callback&&(r(e,m,_),t.callback(t.result))}),void(t.mtlLoader=_);var v;if(R.test(n))U=n.split(" ").slice(1).join("").trim(),m[M].materialKey=U;else if(a.test(n))U=n.split(" ").slice(1).join("").trim(),p[M].use=!1,b={name:U,groupName:M,materialKey:U.replace(M+"_",""),index:[],position:E.position,resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},m[U]=E=b,p[M].childrenInfo[U]=E;else if(i.test(n)){var U,b;b={name:U=n.split(" ").slice(1).join("").trim(),groupName:U,materialKey:U,index:[],position:[],resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},p[U]=E=b,m[U]=E,M=U}if(o.test(n))v=n.split(" "),g.position.push(+v[1],+v[2],+v[3]),E.position.push(+v[1],+v[2],+v[3]),g.points[g.points.length]=[+v[1],+v[2],+v[3]];else if(s.test(n)){var P;P=n.split(" "),g.normal.push(+P[1],+P[2],+P[3]),g.normalPoints[g.normalPoints.length]=[+P[1],+P[2],+P[3]]}else if(u.test(n)){var L;L=n.split(" "),g.uv.push(+L[1],+L[2]),g.uvPoints[g.uvPoints.length]=[+L[1],+L[2]]}else if(h.test(n))(B=n.split(" ").slice(1,4)).forEach(function(e){var t,r,n;n=0,e=e.split("/"),I=+e[0]-1,T=+e[2]-1,t=g.points[I],r=g.normalPoints[T],g.position.length&&(n+=3),g.normal.length&&(n+=3),E.index.push(E.resultInterleave.length/n),g.position.length&&(E.resultPosition.push(t[0],t[1],t[2]),E.resultInterleave.push(t[0],t[1],t[2])),g.normal.length&&(E.resultNormal.push(r[0],r[1],r[2]),E.resultInterleave.push(r[0],r[1],r[2]))});else if(c.test(n)){var T;if(4==(B=n.split(" ").slice(1,5)).length){var y=B[3];B[3]=B[0],B[4]=B[2],B[5]=y}B.forEach(function(e){var t,r,n,i;i=0,e=e.split("/"),I=+e[0]-1,x=+e[1]-1,T=+e[2]-1,t=g.points[I],n=g.uvPoints[x],r=g.normalPoints[T],g.position.length&&(i+=3),g.normal.length&&(i+=3),g.uv.length&&(i+=2),E.index.push(E.resultInterleave.length/i),g.position.length&&(E.resultPosition.push(t[0],t[1],t[2]),E.resultInterleave.push(t[0],t[1],t[2])),g.normal.length&&(E.resultNormal.push(r[0],r[1],r[2]),E.resultInterleave.push(r[0],r[1],r[2])),g.uv.length&&(E.resultUV.push(n[0],n[1]),E.resultInterleave.push(n[0],n[1]))})}else if(d.test(n)){var B,x;(B=n.split(" ").slice(1,4)).forEach(function(e){var t,r,n;n=0,e=e.split("/"),I=+e[0]-1,x=+e[1]-1,t=g.points[I],r=g.uvPoints[x],g.position.length&&(n+=3),g.uv.length&&(n+=2),E.index.push(E.resultInterleave.length/n),g.position.length&&(E.resultPosition.push(t[0],t[1],t[2]),E.resultInterleave.push(t[0],t[1],t[2])),g.uv.length&&(E.resultUV.push(r[0],r[1]),E.resultInterleave.push(r[0],r[1]))})}else if(f.test(n)){var I;I=n.split(" "),E.resultInterleave=E.resultPosition=E.position,E.index.push(+I[1]-1,+I[2]-1,+I[3]-1),E.index.push(+I[1]-1,+I[3]-1,+I[4]-1)}}),{info:m,infoHierarchy:p}},e=function(e,r,i){i=i.replace(/^\#[\s\S]+?\n/g,"");var a=n(r,e,i.split("\n"));return t(r,e.resultMesh,a.infoHierarchy),new function(e){for(var t in e)this[t]=e[t]}({fileName:e.fileName,path:e.path,resultMesh:e.resultMesh,parseRawInfo:a.info,parseInfoHierarchy:a.infoHierarchy,parseInfoMaterial:e.mtlLoader})},Object.freeze(RedOBJLoader)}(),RedAxis=function(e){if(!(this instanceof RedAxis))return new RedAxis(e);var t,r,n,i;e instanceof RedGL||RedGLUtil.throwFunc("RedAxis : RedGL Instance만 허용됩니다.",e),RedBaseObject3D.build.call(this,e.gl),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#ff0000")),(r=RedMesh(e,RedBox(e),RedColorMaterial(e,"#ff0000"))).scaleX=r.scaleY=r.scaleZ=.5,r.scaleX=10,t.x=5,r.x=-5,t.children.push(r),this.children.push(t),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#00ff00")),(n=RedMesh(e,RedBox(e),RedColorMaterial(e,"#00ff00"))).scaleX=n.scaleY=n.scaleZ=.5,n.scaleY=10,t.y=5,n.y=-5,t.children.push(n),this.children.push(t),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#0000ff")),(i=RedMesh(e,RedBox(e),RedColorMaterial(e,"#0000ff"))).scaleX=i.scaleY=i.scaleZ=.5,i.scaleZ=10,t.z=5,i.z=-5,t.children.push(i),this.children.push(t),this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedAxis,RedBaseContainer),RedGLUtil.copyProto(RedAxis,RedBaseObject3D),Object.freeze(RedAxis),RedGrid=function(e,t,r,n,i){if(!(this instanceof RedGrid))return new RedGrid(e,t,r,n,i);var a;e instanceof RedGL||RedGLUtil.throwFunc("RedGrid : RedGL Instance만 허용됩니다.",e),a=e.gl,RedBaseObject3D.build.call(this,a);var o=[];t=t||100,n=[1,1,1,.7],i=[1,1,1,.5];for(var s,u=(r=r||100)/2,f=t/r,d=t/2,c=0,h=-d;c<=r;c++,h+=f){var l=c===u?n:i;o.push(-d,0,h),o.push(l[0],l[1],l[2],l[3]),o.push(d,0,h),o.push(l[0],l[1],l[2],l[3]),o.push(h,0,-d),o.push(l[0],l[1],l[2],l[3]),o.push(h,0,d),o.push(l[0],l[1],l[2],l[3])}s=RedBuffer(e,"gridInterleaveBuffer_"+r,RedBuffer.ARRAY_BUFFER,new Float32Array(o),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexColor",4)]),this.geometry=RedGeometry(s),this.material=RedGridMaterial(e),this.drawMode=a.LINES,this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedGrid,RedBaseContainer),RedGLUtil.copyProto(RedGrid,RedBaseObject3D),Object.freeze(RedGrid),RedMesh=function(e,t,r){if(!(this instanceof RedMesh))return new RedMesh(e,t,r);var n;e instanceof RedGL||RedGLUtil.throwFunc("RedMesh : RedGL Instance만 허용됩니다.",e),!t||t instanceof RedGeometry||RedGLUtil.throwFunc("RedMesh : RedGeometry Instance만 허용됩니다."),!r||r instanceof RedBaseMaterial||RedGLUtil.throwFunc("RedMesh : RedBaseMaterial 확장 Instance만 허용됩니다."),n=e.gl,RedBaseObject3D.build.call(this,n),this.geometry=t,this.material=r,this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedMesh,RedBaseContainer),RedGLUtil.copyProto(RedMesh,RedBaseObject3D),Object.freeze(RedMesh),RedLine=function(e,t){if(!(this instanceof RedLine))return new RedLine(e,t);var r,n,i,a,o;e instanceof RedGL||RedGLUtil.throwFunc("RedLine : RedGL Instance만 허용됩니다.",e),t instanceof RedColorMaterial||RedGLUtil.throwFunc("RedLine : RedColorMaterial Instance만 허용됩니다."),n=[],i=[],this._UUID=RedGL.makeUUID(),a=RedBuffer(e,"RedLine_InterleaveBuffer_"+this._UUID,RedBuffer.ARRAY_BUFFER,new Float32Array(n),[RedInterleaveInfo("aVertexPosition",3)]),o=RedBuffer(e,"RedLine_indexBuffer_"+this._UUID,RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(i)),this.addPoint=function(e,t,r){var a=n.length/3;n.push(e,t,r),i.push(a),this.upload()},this.upload=function(){a.upload(new Float32Array(n)),o.upload(new Uint16Array(i))},r=e.gl,RedBaseObject3D.build.call(this,r),this.geometry=RedGeometry(a,o),this.material=t,this.drawMode=r.LINE_STRIP},RedGLUtil.copyProto(RedLine,RedBaseContainer),RedGLUtil.copyProto(RedLine,RedBaseObject3D),Object.freeze(RedLine),RedSkyBox=function(e,t){if(!(this instanceof RedSkyBox))return new RedSkyBox(e,t);var r;e instanceof RedGL||RedGLUtil.throwFunc("RedSkyBox : RedGL Instance만 허용됩니다.",e),r=e.gl,RedBaseObject3D.build.call(this,r),this.geometry=RedBox(e),this.material=RedSkyBoxMaterial(e,RedBitmapCubeTexture(e,t)),this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedSkyBox,RedBaseObject3D),Object.freeze(RedSkyBox),RedSprite3D=function(e,t){if(!(this instanceof RedSprite3D))return new RedSprite3D(e,t);var r;e instanceof RedGL||RedGLUtil.throwFunc("RedSprite3D : RedGL Instance만 허용됩니다.",e),t instanceof RedColorMaterial||t instanceof RedBitmapMaterial||RedGLUtil.throwFunc("RedSprite3D : RedColorMaterial or RedBitmapMaterial Instance만 허용됩니다."),r=e.gl,RedBaseObject3D.build.call(this,r),this.geometry=RedPlane(e,1,1,0),this.material=t,this.perspectiveScale=!0,this.useCullFace=!1,this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedSprite3D,RedBaseContainer),RedGLUtil.copyProto(RedSprite3D,RedBaseObject3D),Object.freeze(RedSprite3D),RedPointUnit=function(e,t,r,n){if(!(this instanceof RedPointUnit))return new RedPointUnit(e,t,r,n);var i,a;n instanceof RedPointColorMaterial||n instanceof RedPointBitmapMaterial||RedGLUtil.throwFunc("RedPointUnit : material - RedPointColorMaterial Instance or RedPointBitmapMaterial Instance만 허용됩니다."),i=e.gl,RedBaseObject3D.build.call(this,i),this._UUID=RedGL.makeUUID(),a=RedBuffer(e,"RedPointUnit_"+this._UUID,RedBuffer.ARRAY_BUFFER,t,r),this.geometry=RedGeometry(a),this.material=n,this.drawMode=i.POINTS},RedGLUtil.copyProto(RedPointUnit,RedBaseContainer),RedGLUtil.copyProto(RedPointUnit,RedBaseObject3D),RedPointUnit.prototype.update=function(){},Object.freeze(RedPointUnit),function(){var e,t,r,n;r=function(e,r,n,i,a,o,s,u,f,d,c,h){var l,R,m=u/c,p=f/h,g=u/2,E=f/2,M=d/2,_=c+1,v=h+1,U=0,b=[];for(R=0;R<v;R++){var P=R*p-E;for(l=0;l<_;l++){var L=l*m-g;b[n]=L*o,b[i]=P*s,b[a]=M,e.push(b.x,b.y,b.z),b[n]=0,b[i]=0,b[a]=d>0?1:-1,e.push(b.x,b.y,b.z),e.push(l/c,1-R/h),U+=1}}for(R=0;R<h;R++)for(l=0;l<c;l++){var T=t+l+_*R,y=t+l+_*(R+1),B=t+(l+1)+_*(R+1),x=t+(l+1)+_*R;r.push(T,y,x,y,B,x),6}t+=U},e=function(e,i,a,o,s,u,f){n="RedBox_"+(i=i||1)+"_"+(a=a||1)+"_"+(o=o||1)+"_"+(s=s||1)+"_"+(u=u||1)+"_"+(f=f||1);var d=[],c=[];return t=0,r(d,c,"z","y","x",-1,-1,o,a,i,f,u),r(d,c,"z","y","x",1,-1,o,a,-i,f,u),r(d,c,"x","z","y",1,1,i,o,a,s,f),r(d,c,"x","z","y",1,-1,i,o,-a,s,f),r(d,c,"x","y","z",1,-1,i,a,o,s,u),r(d,c,"x","y","z",-1,-1,i,a,-o,s,u),{interleaveData:d,indexData:c,type:n,interleaveBuffer:RedBuffer(e,n+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(d),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,n+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(c))}},(RedBox=function(t,r,n,i,a,o,s){if(!(this instanceof RedBox))return new RedBox(t,r,n,i,a,o,s);if(!(t instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";var u;if(u=e(t,r,n,i,a,o,s),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[u.type])return t._datas.Primitives[u.type];t._datas.Primitives[u.type]=this,this.interleaveBuffer=u.interleaveBuffer,this.indexBuffer=u.indexBuffer,this._UUID=RedGL.makeUUID()}).prototype=RedGeometry.prototype,Object.freeze(RedBox)}(),function(){var e,t,r,n,i,a,o,s,u,f,d,c,h,l,R,m,p,g;e=function(e,E,M,_,v){E=E||1,M=M||1,_=_||1,v=v||1,t=E/2,r=M/2,n=Math.floor(_)||1,i=Math.floor(v)||1,a=n+1,o=i+1,s=E/n,u=M/i,g="RedPlane_"+E+"_"+M+"_"+_+"_"+v;var U=[],b=[];for(d=0;d<o;d++)for(h=d*u-r,f=0;f<a;f++)c=f*s-t,U.push(c,-h,0),U.push(0,0,1),U.push(f/n,1-d/i);for(d=0;d<i;d++)for(f=0;f<n;f++)l=f+a*d,R=f+a*(d+1),m=f+1+a*(d+1),p=f+1+a*d,b.push(l,R,p,R,m,p);return{interleaveData:U,indexData:b,type:g,interleaveBuffer:RedBuffer(e,g+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(U),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,g+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(b))}},(RedPlane=function(t,r,n,i,a){if(!(this instanceof RedPlane))return new RedPlane(t,r,n,i,a);if(!(t instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";var o;if(o=e(t,r,n,i,a),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[o.type])return t._datas.Primitives[o.type];t._datas.Primitives[o.type]=this,this.interleaveBuffer=o.interleaveBuffer,this.indexBuffer=o.indexBuffer,this._UUID=RedGL.makeUUID()}).prototype=RedGeometry.prototype,Object.freeze(RedPlane)}(),function(){var e,t,r,n,i,a,o,s,u,f,d,c,h;d=[],c=new Float32Array([0,0,0]),h=new Float32Array([0,0,0]),e=function(e,l,R,m,p,g,E,M){l=l||1,R=Math.max(3,Math.floor(R)||8),m=Math.max(2,Math.floor(m)||6),p=void 0!==p?p:0,g=void 0!==g?g:2*Math.PI,E=void 0!==E?E:0,M=void 0!==M?M:Math.PI,t=E+M,i=0,d.length=0,c[0]=0,c[1]=0,c[2]=0,h[0]=0,h[1]=0,h[2]=0,f="RedSphere_"+l+"_"+R+"_"+m+"_"+p+"_"+g+"_"+E+"_"+M;var _=[],v=[];for(n=0;n<=m;n++){var U=[],b=n/m;for(r=0;r<=R;r++){var P=r/R;c.x=-l*Math.cos(p+P*g)*Math.sin(E+b*M),c.y=l*Math.cos(E+b*M),c.z=l*Math.sin(p+P*g)*Math.sin(E+b*M),_.push(c.x,c.y,c.z),h[0]=c.x,h[1]=c.y,h[2]=c.z,vec3.normalize(h,h),_.push(h[0],h[1],h[2]),_.push(P,1-b),U.push(i++)}d.push(U)}for(n=0;n<m;n++)for(r=0;r<R;r++)a=d[n][r+1],o=d[n][r],s=d[n+1][r],u=d[n+1][r+1],(0!==n||E>0)&&v.push(a,o,u),(n!==m-1||t<Math.PI)&&v.push(o,s,u);return{interleaveData:_,indexData:v,type:f,interleaveBuffer:RedBuffer(e,f+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(_),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,f+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(v))}},(RedSphere=function(t,r,n,i,a,o,s,u){if(!(this instanceof RedSphere))return new RedSphere(t,r,n,i,a,o,s,u);if(!(t instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";var f;if(f=e(t,r,n,i,a,o,s,u),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[f.type])return t._datas.Primitives[f.type];t._datas.Primitives[f.type]=this,this.interleaveBuffer=f.interleaveBuffer,this.indexBuffer=f.indexBuffer,this._UUID=RedGL.makeUUID()}).prototype=RedGeometry.prototype,Object.freeze(RedSphere)}(),function(){var e,t,r,n,i,a;e=function(e,t,r,i){return n=e.createProgram(),e.attachShader(n,r.webglShader),e.attachShader(n,i.webglShader),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||RedGLUtil.throwFunc("프로그램을 초기화 할 수 없습니다."),n.key=t,n.vShaderKey=r.key,n.fShaderKey=i.key,e.useProgram(n),n},i=function(){},a=function(){},t=function(e,t,n){n.parseData.attribute&&n.parseData.attribute.list.forEach(function(r){var n=new i;n._UUID=RedGL.makeUUID(),n.location=t.getAttribLocation(e.webglProgram,r.name),-1==n.location&&(n.msg="쉐이더 main 함수에서 사용되고 있지 않음"),n.attributeType=r.attributeType,n.name=r.name,n.enabled=!1,-1!=n.location&&e.attributeLocation.push(n),e.attributeLocation[r.name]=n}),n.parseData.uniform&&n.parseData.uniform.list.forEach(function(n){var i,o,s=new a;switch(s._UUID=RedGL.makeUUID(),s.location=t.getUniformLocation(e.webglProgram,n.name),s.uniformType=n.uniformType,n.arrayNum,n.uniformType){case"sampler2D":i="sampler2D",o="uniform1i",s.samplerIndex=r,8==++r&&(r=2);break;case"samplerCube":i="samplerCube",o="uniform1i",s.samplerIndex=r,8==++r&&(r=2);break;case"float":i="float",o="uniform1f";break;case"int":i="int",o="uniform1i";break;case"mat4":i="mat",o="uniformMatrix4fv";break;case"mat3":i="mat",o="uniformMatrix3fv";break;case"mat2":i="mat",o="uniformMatrix2fv";break;case"vec4":i="vec",o="uniform4fv";break;case"vec3":i="vec",o="uniform3fv";break;case"vec2":i="vec",o="uniform2fv";break;case"ivec4":i="vec",o="uniform4iv";break;case"ivec3":i="vec",o="uniform3iv";break;case"ivec2":i="vec",o="uniform2iv";break;case"bvec4":i="vec",o="uniform4iv";break;case"bvec3":i="vec",o="uniform3iv";break;case"bvec2":i="vec",o="uniform2iv";break;case"bool":i="bool",o="uniform1i"}s.renderType=i,s.renderMethod=o,s.name=n.name,s.materialPropertyName=n.name.charAt(1).toLowerCase()+n.name.substr(2),s.arrayNum=n.arrayNum,s.location||(s.msg="쉐이더 main 함수에서 사용되고 있지 않음"),n.systemUniformYn?(s.location&&e.systemUniformLocation.push(s),e.systemUniformLocation[n.name]=s):(s.location&&e.uniformLocation.push(s),e.uniformLocation[n.name]=s)})},(RedProgram=function(n,i,a,o){var s,u,f;return this instanceof RedProgram?(n instanceof RedGL||RedGLUtil.throwFunc("RedProgram : RedGL Instance만 허용됩니다.","입력값 : "+n),"string"!=typeof i&&RedGLUtil.throwFunc("RedProgram : key - 문자열만 허용됩니다.","입력값 : "+i),s=n.gl,n._datas.RedProgram||(n._datas.RedProgram={}),RedProgram.hasKey(n,i)?n._datas.RedProgram[i]:(u=a?RedShader(n,i+"_VS",RedShader.VERTEX,a):null,f=o?RedShader(n,i+"_FS",RedShader.FRAGMENT,o):null,u&&f?n._datas.RedProgram[i]=this:RedGLUtil.throwFunc("RedProgram : 신규 생성시 vertexShader, fragmentShader 모두 입력해야함."),this.key=i,this.webglProgram=e(s,i,u,f),this.attributeLocation=[],this.uniformLocation=[],this.systemUniformLocation=[],s.useProgram(this.webglProgram),r=2,t(this,s,u),t(this,s,f),void(this._UUID=RedGL.makeUUID()))):new RedProgram(n,i,a,o)}).prototype={},RedProgram.hasKey=function(e,t){return e instanceof RedGL||RedGLUtil.throwFunc("RedProgram : RedGL Instance만 허용됩니다.","입력값 : "+e),e._datas.RedProgram||(e._datas.RedProgram={}),!!e._datas.RedProgram[t]},Object.freeze(RedProgram)}(),[(RedSystemShaderCode={vShareSource:["attribute vec3 aVertexPosition","attribute vec3 aVertexNormal","attribute vec4 aVertexColor","varying vec3 vVertexNormal","attribute float aPointSize","uniform float uPointSize","attribute vec2 aTexcoord","varying vec2 vTexcoord","uniform vec4 uAtlascoord","uniform float uTime","varying float vTime","uniform vec2 uResolution","varying vec2 vResolution","uniform mat4 uMMatrix","uniform mat4 uNMatrix","uniform mat4 uPMatrix","uniform mat4 uCameraMatrix","uniform bool uSprite3DYn","uniform bool uPerspectiveScale"],fShareSource:["varying vec3 vVertexNormal","varying vec2 vTexcoord","varying float vTime","varying vec2 vResolution","uniform bool uUseFog","uniform float uFogDistance","uniform float uFogDensity","uniform vec4 uFogColor","const int cDIRETIONAL_MAX = 3","uniform vec3 uDirectionalLightPosition[3]","uniform vec4 uDirectionalLightColor[3]","uniform float uDirectionalLightIntensity[3]","uniform int uDirectionalLightNum","const int cPOINT_MAX = 5","uniform vec3 uPointLightPosition[5]","uniform vec4 uPointLightColor[5]","uniform float uPointLightRadius[5]","uniform float uPointLightIntensity[5]","uniform int uPointLightNum","uniform vec4 uAmbientLightColor","uniform float uAmbientIntensity"],systemUniform:{}}).vShareSource,RedSystemShaderCode.fShareSource].forEach(function(e){e.forEach(function(e){"uniform"==(e=e.split(" "))[0]&&(RedSystemShaderCode.systemUniform[e[2]]=1)})}),Object.freeze(RedSystemShaderCode),function(){var e,t,r,n,i,a,o,s;e=function(e,t,r){switch(r){case RedShader.VERTEX:return(i=e.createShader(e.VERTEX_SHADER)).key=t,i.type=r,i;case RedShader.FRAGMENT:return(i=e.createShader(e.FRAGMENT_SHADER)).key=t,i.type=r,i;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요. RedShader.VERTEX or RedShader.FRAGMENT 만 허용됩니다")}},t=function(e,t,r,n){e.shaderSource(r,n.lastSource),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)||RedGLUtil.throwFunc("RedShader : 쉐이더 컴파일에 실패하였습니다.\n",e.getShaderInfoLog(r))},n=function(){var e;return function(t,r){switch(t){case RedShader.VERTEX:e=RedSystemShaderCode.vShareSource.concat();break;case RedShader.FRAGMENT:e=RedSystemShaderCode.fShareSource.concat();break;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요. RedShader.VERTEX or RedShader.FRAGMENT 만 허용됩니다")}return r.forEach(function(t){t=t.replace(";",""),-1==e.indexOf(t)?e.push(t):RedGLUtil.throwFunc("RedShader : ","\n1. 중복 선언 이거나","\n2. RedSystemShaderCode에 정의된 선언\n","입력값 : "+t)}),e}}(),r=function(e,t){return t=(t=t.replace(/\s+$/,"")).replace(/  /g,"").trim(),a={etc:{list:[],map:{},source:""}},o=t.match(/attribute[\s\S]+?\;|uniform[\s\S]+?\;|varying[\s\S]+?\;|const[\s\S]+?\;|precision[\s\S]+?\;/g),(o=n(e,o=o||[])).sort(),o.forEach(function(e){var r,n,i,o,s,u,f;if(e=e.trim(),t=t.replace(e+";",""),(r=e.split(" "))[2])switch(n=r[0],o=r[1],i=r[2].replace(";","").split("["),u=(u=e.split("="))[1]?u[1].trim().replace(";",""):null,s=i.length>1?+i[1].split("]")[0]:0,i=i[0],n){case"precision":break;case"attribute":"a"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : attribute의 첫글자는 a로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : attribute의 두번째 글자는 대문자 시작해야합니다.",i);break;case"uniform":"u"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : uniform의 첫글자는 u로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : uniform의 두번째 글자는 대문자 시작해야합니다.",i);break;case"varying":"v"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : varying의 첫글자는 v로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : varying의 두번째 글자는 대문자 시작해야합니다.",i);break;case"const":"c"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : const의 첫글자는 c로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : const의 두번째 글자는 대문자 시작해야합니다.",i);break;default:RedGLUtil.throwFunc("RedShader : 체크되지 못하는값인데 뭐냐",i)}else n="var",o=r[0],s=(i=r[1].replace(";","").split("[")).length>1?+i[1].split("]")[0]:0,i=i[0];a[n]||(a[n]={},a[n].list=[],a[n].map={},a[n].source=""),f={name:i,arrayNum:s,value:u,systemUniformYn:!!RedSystemShaderCode.systemUniform[s?i+"["+s+"]":i]},"uniform"==n&&(f.uniformType=o),"attribute"==n&&(f.attributeType=o),"varying"==n&&(f.varyingType=o),a[n].list.push(f),a[n].map[i]=e,a[n].source+=e+";\n"}),[t+="\n"].forEach(function(e){var t=e.split(" "),r=t[1].replace(/\([\s\S]+/g,"").trim();a.etc.list.push({uniformType:t[0],name:r}),a.etc.map[r]=e,a.etc.source+=e+"\n"}),s="",a.precision&&(s+=a.precision.source+"\n//attribute\n"),a.const&&(s+=a.const.source+"\n//const\n"),a.attribute&&(s+=a.attribute.source+"\n//uniform\n"),a.uniform&&(s+=a.uniform.source+"\n//varying\n"),a.varying&&(s+=a.varying.source+"\n//var\n"),a.var&&(s+=a.var.source+"\n//etc\n"),a.etc&&(s+=a.etc.source),a.lastSource=s,e!=RedShader.FRAGMENT||a.precision||RedGLUtil.throwFunc("RedShader : FRAGMENT Shader는 precision를 반드시 선언해야함"),a},(RedShader=function(n,i,a,o){var s;if(!(this instanceof RedShader))return new RedShader(n,i,a,o);if(n instanceof RedGL||RedGLUtil.throwFunc("RedShader : RedGL Instance만 허용됩니다.","입력값 : "+n),"string"!=typeof i&&RedGLUtil.throwFunc("RedShader : key - 문자열만 허용됩니다.","입력값 : "+i),a!=RedShader.VERTEX&&a!=RedShader.FRAGMENT&&RedGLUtil.throwFunc("RedShader : type - RedShader.VERTEX or RedShader.FRAGMENT 만 허용됩니다.","입력값 : "+a),n._datas.RedShader||(n._datas.RedShader={},n._datas.RedShader[RedShader.VERTEX]={},n._datas.RedShader[RedShader.FRAGMENT]={}),o)"string"!=typeof o&&RedGLUtil.throwFunc("RedShader : source - 문자열만 허용됩니다."),RedShader.hasKey(n,i,a)?RedGLUtil.throwFunc("RedShader : key - 이미 정의된 키로 생성을 시도.","\n키 :",i,"\n타입 :"+a):n._datas.RedShader[a][i]=this;else{if(RedShader.hasKey(n,i,a))return n._datas.RedShader[a][i];RedGLUtil.throwFunc("RedShader : "+a+" 타입에 존재하지 않는 key를 검색하려고합니다.","입력값 : "+i)}s=n.gl,this.webglShader=e(s,i,a),this.parseData=r(a,o),t(s,0,this.webglShader,this.parseData),this.key=i,this.type=a,this._UUID=RedGL.makeUUID(),Object.freeze(this)}).hasKey=function(e,t,r){return!!e._datas.RedShader[r][t]},RedShader.FRAGMENT="fragmentShader",RedShader.VERTEX="vertexShader",Object.freeze(RedShader)}(),function(){var e,t,r,n,i,a,o,s,u,f;(RedRenderer=function(){if(!(this instanceof RedRenderer))return new RedRenderer;this.world=null,this._tickKey=null,this._callback=null,this._UUID=RedGL.makeUUID(),this.renderInfo={},this.cacheUniformInfo=[],this.cacheAttrInfo=[],this.cacheBySamplerIndex=[],this.cacheState=[],this.renderDebuger=RedRenderDebuger()}).prototype={start:(e=function(n){t.worldRender(r,n),t._callback&&t._callback(n),t._tickKey=requestAnimationFrame(e)},function(n,i){n instanceof RedGL||RedGLUtil.throwFunc("RedGL Instance만 허용"),n.world instanceof RedWorld||RedGLUtil.throwFunc("RedWorld Instance만 허용"),(t=this).world=n.world,r=n,t._tickKey=requestAnimationFrame(e),t._callback=i}),stop:function(){cancelAnimationFrame(this._tickKey)}},RedRenderer.prototype.worldRender=function(){var e,t,r,o,s,u,f,d,c,h,l,R,m,p,g,E,M;return f=[],o=function(t){return t.forEach(function(r,n){"number"==typeof t[n]?t[n]=r:t[n]=n<2?e[n+2]*parseFloat(t[n])/100:e[n]*parseFloat(t[n])/100}),t},M=[],E=[],s=function(e,t,r,i,a){for(var o in l=e.gl,f.length=0,e._datas.RedProgram){var s,u,d,_,v,U,b,P,L,T,y;for(c=e._datas.RedProgram[o],n!=c._UUID&&l.useProgram(c.webglProgram),n=c._UUID,h=c.systemUniformLocation,(R=h.uTime)&&(m=R.location,p=R._UUID,m&&E[p]!=t&&(l.uniform1f(m,t),E[p]=t)),(R=h.uResolution)&&(m=R.location,p=R._UUID,g=[a[2],a[3]],m&&E[p]!=g.toString()&&(l.uniform2fv(m,g),E[p]=g.toString())),(R=h.uUseFog)&&(m=R.location,v=r.useFog?1:0,p=R._UUID,m&&E[p]!=v&&(l[R.renderMethod](m,v),E[p]=v)),(R=h.uFogDensity)&&(m=R.location,v=r.fogDensity,p=R._UUID,m&&E[p]!=v&&(l.uniform1f(m,v),E[p]=v)),(R=h.uFogColor)&&(m=R.location,M[0]=r._fogR,M[1]=r._fogG,M[2]=r._fogB,M[3]=1,v=M,p=R._UUID,m&&E[p]!=v.toString()&&(l.uniform4fv(m,v),E[p]=v.toString())),(R=h.uFogDistance)&&(m=R.location,v=r.fogDistance,p=R._UUID,m&&E[p]!=v&&(l.uniform1f(m,v),E[p]=v)),(R=h.uCameraMatrix)&&(m=R.location,v=i.matrix,p=R._UUID,m&&E[p]!=v.toString()&&(l.uniformMatrix4fv(m,!1,v),E[p]=v.toString())),(R=h.uPMatrix)&&(m=R.location,v=i.perspectiveMTX,p=R._UUID,m&&E[p]!=v.toString()&&(l.uniformMatrix4fv(m,!1,v),E[p]=v.toString())),(d=r._lightInfo[RedAmbientLight.type])&&(R=h.uAmbientLightColor,m=R.location,p=R._UUID,v=d.color,m&&E[p]!=v.toString()&&(l.uniform4fv(m,v),E[p]=v.toString()),R=h.uAmbientIntensity,m=R.location,p=R._UUID,v=d.intensity,m&&E[p]!=v&&(l.uniform1f(m,v),E[p]=v)),y=vec3.create(),U=new Float32Array(9),P=new Float32Array(12),L=new Float32Array(3),s=(u=r._lightInfo[RedDirectionalLight.type]).length;s--;)d=u[s],vec3.set(y,d.x,d.y,d.z),d.debug&&((_=d.debugObject).x=y[0],_.y=y[1],_.z=y[2],_.material.color=d.color,f.push(_)),(R=h.uDirectionalLightPosition)&&(m=R.location)&&(vec3.normalize(y,y),U[0+3*s]=y[0],U[1+3*s]=y[1],U[2+3*s]=y[2]),(R=h.uDirectionalLightColor)&&(m=R.location)&&(P[0+4*s]=d.color[0],P[1+4*s]=d.color[1],P[2+4*s]=d.color[2],P[3+4*s]=d.color[3]),R&&(R=h.uDirectionalLightIntensity,(m=R.location)&&(L[s]=d.intensity));for((R=h.uDirectionalLightPosition)&&(m=R.location,p=R._UUID,v=U,m&&E[p]!=v.toString()&&(l.uniform3fv(m,v),E[p]=v.toString())),R=h.uDirectionalLightColor,m=R.location,p=R._UUID,v=P,m&&E[p]!=v.toString()&&(l.uniform4fv(m,v),E[p]=v.toString()),R=h.uDirectionalLightIntensity,m=R.location,p=R._UUID,v=L,m&&E[p]!=v.toString()&&(l.uniform1fv(m,v),E[p]=v.toString()),R=h.uDirectionalLightNum,m=R.location,p=R._UUID,v=u.length,m&&E[p]!=v&&(l.uniform1i(m,v),E[p]=v),y=vec3.create(),b=new Float32Array(15),P=new Float32Array(20),L=new Float32Array(5),T=new Float32Array(5),s=(u=r._lightInfo[RedPointLight.type]).length;s--;)d=u[s],vec3.set(y,d.x,d.y,d.z),d.debug&&((_=d.debugObject).x=y[0],_.y=y[1],_.z=y[2],_.scaleX=_.scaleY=_.scaleZ=d.radius,_.material.color=d.color,f.push(_)),R=h.uPointLightPosition,(m=R.location)&&(b[0+3*s]=y[0],b[1+3*s]=y[1],b[2+3*s]=y[2]),R=h.uPointLightColor,(m=R.location)&&(P[0+4*s]=d.color[0],P[1+4*s]=d.color[1],P[2+4*s]=d.color[2],P[3+4*s]=d.color[3]),R=h.uPointLightIntensity,(m=R.location)&&(L[s]=d.intensity),R=h.uPointLightRadius,(m=R.location)&&(T[s]=d.radius);R=h.uPointLightPosition,m=R.location,p=R._UUID,v=b,m&&E[p]!=v.toString()&&(l.uniform3fv(m,v),E[p]=v.toString()),R=h.uPointLightColor,m=R.location,p=R._UUID,v=P,m&&E[p]!=v.toString()&&(l.uniform4fv(m,v),E[p]=v.toString()),R=h.uPointLightIntensity,m=R.location,p=R._UUID,v=L,m&&E[p]!=v.toString()&&(l.uniform1fv(m,v),E[p]=v.toString()),R=h.uPointLightRadius,m=R.location,p=R._UUID,v=T,m&&E[p]!=v.toString()&&(l.uniform1fv(m,v),E[p]=v.toString()),R=h.uPointLightNum,m=R.location,p=R._UUID,v=u.length,m&&E[p]!=v&&(l.uniform1i(m,v),E[p]=v)}return f},u=function(e){e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.frontFace(e.CCW),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.enable(e.SCISSOR_TEST),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0)},d=function(){var t,n,o,s,u,f,d,c,h,l,R,m,p,g,E,M;return h=mat4.create(),c=new Float32Array(2),n=function(e,r,n,a,l){o=t.material=r,s=o.program,e.useProgram(s.webglProgram),f=s.systemUniformLocation,u=f.uPMatrix,(d=u.location)&&(mat4.ortho(h,-.5,.5,-.5,.5,-i.farClipping,i.farClipping),e.uniformMatrix4fv(d,!1,h)),u=f.uResolution,(d=u.location)&&(c[0]=n,c[1]=a,e.uniform2fv(d,c)),l&&(u=f.uCameraMatrix,d=u.location,mat4.identity(h),e.uniformMatrix4fv(d,!1,h))},m=function(e,t,r){E=t.frameBuffer.width,M=t.frameBuffer.height,(p!=E||g!=M||r)&&(e.viewport(0,0,E,M),e.scissor(0,0,E,M)),n(e,t,E,M),p=E,g=M},function(o,s,u,f,d,c){p=null,g=null,u.unbind(s),t=u.children[0],R=l=u.frameBuffer.texture,u.frameBuffer.width=s.drawingBufferWidth,u.frameBuffer.height=s.drawingBufferHeight;var h=u.postEffectList.concat();u.antialiasing&&h.push(u.antialiasing);var E=function(e){var t,n;n=e.subFrameBufferInfo,e.process&&e.process.length&&(t=R,e.process.forEach(function(e){E(e)})),n&&(n.frameBuffer.bind(s),s.viewport(0,0,n.frameBuffer.width,n.frameBuffer.height),s.scissor(0,0,n.frameBuffer.width,n.frameBuffer.height),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),r.sceneRender(o,s,i.orthographicYn,a.children,d,c,n.renderMaterial),n.frameBuffer.unbind(s),p=n.frameBuffer.width,g=n.frameBuffer.height),e.frameBuffer&&(m(s,e),e.bind(s),e.updateTexture(R,t),r.sceneRender(o,s,!0,u.children,d,c),e.unbind(s),R=e.frameBuffer.texture),n&&n.process&&n.process.forEach(function(e){E(e)})};h.forEach(function(e){E(e)}),R!=l&&(u.finalMaterial.diffuseTexture=R,s.viewport(f[0],e[3]-f[3]-f[1],f[2],f[3]),s.scissor(f[0],e[3]-f[3]-f[1],f[2],f[3]),n(s,u.finalMaterial,f[2],f[3],!0),r.sceneRender(o,s,!0,u.children,d,c)),u.finalMaterial.diffuseTexture=u.frameBuffer.texture}}(),function(n,c){var h,l,R;h=n.gl,r=this,e=[0,0,h.drawingBufferWidth,h.drawingBufferHeight],h.viewport(0,0,h.drawingBufferWidth,h.drawingBufferHeight),h.scissor(0,0,h.drawingBufferWidth,h.drawingBufferHeight),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),u(h),r.renderInfo={},this.cacheAttrInfo.length=0,r.world._viewList.forEach(function(u){(l=u._viewRect)[0]=u._x,l[1]=u._y,l[2]=u._width,l[3]=u._height,i=u.camera,a=u.scene,o(l),R=r.renderInfo[u.key]={orthographicYn:i.orthographicYn,x:u._x,y:u._y,width:u._width,height:u._height,viewRectX:l[0],viewRectY:l[1],viewRectWidth:l[2],viewRectHeight:l[3],key:u.key,call:0},h.viewport(l[0],e[3]-l[3]-l[1],l[2],l[3]),h.scissor(l[0],e[3]-l[3]-l[1],l[2],l[3]),a.useBackgroundColor?(h.clearColor(a._r,a._g,a._b,1),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT)):(h.clearColor(0,0,0,0),h.clear(h.DEPTH_BUFFER_BIT)),i instanceof RedCamera||(i.update(),i=i.camera),i.update(),t=i.perspectiveMTX,mat4.identity(t),i.orthographicYn?(mat4.ortho(t,-.5,.5,-.5,.5,-i.farClipping,i.farClipping),mat4.translate(t,t,[-.5,.5,0]),mat4.scale(t,t,[1/l[2],-1/l[3],1]),mat4.identity(i.matrix),h.disable(h.CULL_FACE)):(mat4.perspective(t,i.fov*Math.PI/180,l[2]/l[3],i.nearClipping,i.farClipping),h.enable(h.CULL_FACE)),a.postEffectManager.postEffectList.length&&(a.postEffectManager.bind(h),mat4.perspective(t,i.fov*Math.PI/180,a.postEffectManager.frameBuffer.width/a.postEffectManager.frameBuffer.height,i.nearClipping,i.farClipping),h.viewport(0,0,a.postEffectManager.frameBuffer.width,a.postEffectManager.frameBuffer.height),h.scissor(0,0,a.postEffectManager.frameBuffer.width,a.postEffectManager.frameBuffer.height)),s(n,c,a,i,l),a.skyBox&&(h.cullFace(h.FRONT),a.skyBox.scaleX=a.skyBox.scaleY=a.skyBox.scaleZ=i.farClipping,r.sceneRender(n,h,i.orthographicYn,[a.skyBox],c,R),h.cullFace(h.BACK),h.clear(h.DEPTH_BUFFER_BIT)),r.sceneRender(n,h,i.orthographicYn,a.children,c,R),a.grid&&r.sceneRender(n,h,i.orthographicYn,[a.grid],c,R),a.axis&&r.sceneRender(n,h,i.orthographicYn,a.axis.children,c,R),f.length&&r.sceneRender(n,h,i.orthographicYn,f,c,R),a.postEffectManager.postEffectList.length&&d(n,h,a.postEffectManager,l,c,R)}),this.renderDebuger.visible&&this.renderDebuger.update(n,r.renderInfo)}}(),RedRenderer.prototype.sceneRender=(o=function(e,t,r,i,a,d,c,h,l,R,m,p){var g,E,M,_,v,U,b,P,L,T,y,B,x,I,A,w,G,S,F,D,C,N,O,k,j,X,Y,z,V,Z,W,H,q,J,Q,K,$,ee,te,re,ne,ie,ae,oe,se,ue,fe,de,ce,he,le,Re,me,pe,ge,Ee,Me,_e,ve,Ue,be,Pe,Le,Te,ye,Be,xe,Ie,Ae,we,Ge,Se,Fe,De,Ce,Ne,Oe,ke,je,Xe,Ye,ze,Ve,Ze,We,He,qe,Je,Qe,Ke,$e,et,tt,rt,nt,it,at,ot,st,ut,ft,dt,ct;for(M=Float32Array.BYTES_PER_ELEMENT,_=Math.PI/180,st=3.141592653589793,ut=6.283185307179586,ft=1.27323954,dt=.405284735,ct=1.5707963267948966,f=null,g=r.length;g--;){if(d.call++,C=(v=r[g]).matrix,N=v.normalMatrix,U=v.geometry,X=v instanceof RedSprite3D,U){for(b=p||v.material,n!=b.program._UUID&&t.useProgram(b.program.webglProgram),n=b.program._UUID,L=b.program.attributeLocation,T=b.program.uniformLocation,y=b.program.systemUniformLocation,G=U.interleaveBuffer,S=U.indexBuffer,P=G.interleaveDefineInfoList,O=G._UUID,E=L.length;E--;)B=P[(I=L[E]).name],u!=O&&t.bindBuffer(t.ARRAY_BUFFER,G.webglBuffer),u=O,I&&B&&c[w=I.location]!=B._UUID&&(!I.enabled&&(t.enableVertexAttribArray(w),I.enabled=!0),t.vertexAttribPointer(w,B.size,G.glArrayType,B.normalize,G.stride*M,B.offset*M),c[w]=B._UUID);for(E=T.length;E--;)A=(x=T[E]).location,O=x._UUID,D=x.renderType,F=b[x.materialPropertyName],k=h[O]==F,"sampler2D"==D||"samplerCube"==D?(j=x.samplerIndex,F?(l[j]==F._UUID||(f!=j&&t.activeTexture(t.TEXTURE0+(f=j)),t.bindTexture("sampler2D"==D?t.TEXTURE_2D:t.TEXTURE_CUBE_MAP,F.webglTexture),l[O]!=j&&t[x.renderMethod](A,l[O]=j),l[j]=F._UUID),y.uAtlascoord.location&&h[O=y.uAtlascoord._UUID]!=F.atlascoord.data._UUID&&(t.uniform4fv(y.uAtlascoord.location,F.atlascoord.data),h[O]=F.atlascoord.data._UUID)):"sampler2D"==D?0==l[j]||(0!=f&&t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e._datas.emptyTexture["2d"].webglTexture),0!=l[O]&&t[x.renderMethod](A,l[O]=0),l[j]=0,f=0):1==l[j]||(1!=f&&t.activeTexture(t.TEXTURE0+1),t.bindTexture(t.TEXTURE_CUBE_MAP,e._datas.emptyTexture["3d"].webglTexture),1!=l[O]&&t[x.renderMethod](A,l[O]=1),l[j]=1,f=1)):(void 0==F&&RedGLUtil.throwFunc("RedRenderer : Material에 ",x.materialPropertyName,"이 정의 되지않았습니다."),"float"==D?!k&&t[x.renderMethod](A,h[O]=F):"int"==D?!k&&t[x.renderMethod](A,h[O]=F):"bool"==D?!k&&t[x.renderMethod](A,h[O]=F):"vec"==D?t[x.renderMethod](A,h[O]=F):"mat"==D?t[x.renderMethod](A,!1,F):RedGLUtil.throwFunc("RedRenderer : 처리할수없는 타입입니다.","tRenderType -",D))}v.skeletonYn?Y=C:(C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,Y=C,Be=v.x,xe=v.y,Ie=v.z,Y[12]=Y[0]*Be+Y[4]*xe+Y[8]*Ie+Y[12],Y[13]=Y[1]*Be+Y[5]*xe+Y[9]*Ie+Y[13],Y[14]=Y[2]*Be+Y[6]*xe+Y[10]*Ie+Y[14],Y[15]=Y[3]*Be+Y[7]*xe+Y[11]*Ie+Y[15],X?(J=0*_,Q=0*_,K=0):(J=v.rotationX*_,Q=v.rotationY*_,K=v.rotationZ*_),(ot=J%ut)<-st?ot+=ut:ot>st&&(ot-=ut),z=(ot=ot<0?ft*ot+dt*ot*ot:ft*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,(ot=(J+ct)%ut)<-st?ot+=ut:ot>st&&(ot-=ut),W=(ot=ot<0?ft*ot+dt*ot*ot:ft*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,(ot=Q%ut)<-st?ot+=ut:ot>st&&(ot-=ut),V=(ot=ot<0?ft*ot+dt*ot*ot:ft*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,(ot=(Q+ct)%ut)<-st?ot+=ut:ot>st&&(ot-=ut),H=(ot=ot<0?ft*ot+dt*ot*ot:ft*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,(ot=K%ut)<-st?ot+=ut:ot>st&&(ot-=ut),Z=(ot=ot<0?ft*ot+dt*ot*ot:ft*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,(ot=(K+ct)%ut)<-st?ot+=ut:ot>st&&(ot-=ut),q=(ot=ot<0?ft*ot+dt*ot*ot:ft*ot-dt*ot*ot)<0?.225*(ot*-ot-ot)+ot:.225*(ot*ot-ot)+ot,$=Y[0],ee=Y[1],te=Y[2],ne=Y[4],ie=Y[5],ae=Y[6],se=Y[8],ue=Y[9],fe=Y[10],Me=H*q,_e=z*V*q-W*Z,ve=W*V*q+z*Z,Ue=H*Z,be=z*V*Z+W*q,Pe=W*V*Z-z*q,Le=-V,Te=z*H,ye=W*H,Y[0]=$*Me+ne*_e+se*ve,Y[1]=ee*Me+ie*_e+ue*ve,Y[2]=te*Me+ae*_e+fe*ve,Y[4]=$*Ue+ne*be+se*Pe,Y[5]=ee*Ue+ie*be+ue*Pe,Y[6]=te*Ue+ae*be+fe*Pe,Y[8]=$*Le+ne*Te+se*ye,Y[9]=ee*Le+ie*Te+ue*ye,Y[10]=te*Le+ae*Te+fe*ye,Be=v.scaleX,xe=1*v.scaleY,Ie=v.scaleZ,Y[0]=Y[0]*Be,Y[1]=Y[1]*Be,Y[2]=Y[2]*Be,Y[3]=Y[3]*Be,Y[4]=Y[4]*xe,Y[5]=Y[5]*xe,Y[6]=Y[6]*xe,Y[7]=Y[7]*xe,Y[8]=Y[8]*Ie,Y[9]=Y[9]*Ie,Y[10]=Y[10]*Ie,Y[11]=Y[11]*Ie,Y[12]=Y[12],Y[13]=Y[13],Y[14]=Y[14],Y[15]=Y[15],m&&($=m[0],ee=m[1],te=m[2],re=m[3],ne=m[4],ie=m[5],ae=m[6],oe=m[7],se=m[8],ue=m[9],fe=m[10],de=m[11],ce=m[12],he=m[13],le=m[14],Re=m[15],me=C[0],pe=C[1],ge=C[2],Ee=C[3],C[0]=me*$+pe*ne+ge*se+Ee*ce,C[1]=me*ee+pe*ie+ge*ue+Ee*he,C[2]=me*te+pe*ae+ge*fe+Ee*le,C[3]=me*re+pe*oe+ge*de+Ee*Re,me=C[4],pe=C[5],ge=C[6],Ee=C[7],C[4]=me*$+pe*ne+ge*se+Ee*ce,C[5]=me*ee+pe*ie+ge*ue+Ee*he,C[6]=me*te+pe*ae+ge*fe+Ee*le,C[7]=me*re+pe*oe+ge*de+Ee*Re,me=C[8],pe=C[9],ge=C[10],Ee=C[11],C[8]=me*$+pe*ne+ge*se+Ee*ce,C[9]=me*ee+pe*ie+ge*ue+Ee*he,C[10]=me*te+pe*ae+ge*fe+Ee*le,C[11]=me*re+pe*oe+ge*de+Ee*Re,me=C[12],pe=C[13],ge=C[14],Ee=C[15],C[12]=me*$+pe*ne+ge*se+Ee*ce,C[13]=me*ee+pe*ie+ge*ue+Ee*he,C[14]=me*te+pe*ae+ge*fe+Ee*le,C[15]=me*re+pe*oe+ge*de+Ee*Re)),U&&t.uniformMatrix4fv(y.uMMatrix.location,!1,C),U&&y.uNMatrix.location&&(Ae=C[0],we=C[1],Ge=C[2],Se=C[3],Fe=C[4],De=C[5],Ce=C[6],Ne=C[7],Oe=C[8],ke=C[9],je=C[10],Xe=C[11],ze=C[12],Ve=C[13],Ze=C[14],at=1/(at=(Ye=Ae*De-we*Fe)*(it=je*(We=C[15])-Xe*Ze)-(He=Ae*Ce-Ge*Fe)*(nt=ke*We-Xe*Ve)+(qe=Ae*Ne-Se*Fe)*(rt=ke*Ze-je*Ve)+(Je=we*Ce-Ge*De)*(tt=Oe*We-Xe*ze)-(Qe=we*Ne-Se*De)*(et=Oe*Ze-je*ze)+(Ke=Ge*Ne-Se*Ce)*($e=Oe*Ve-ke*ze)),N[0]=(De*it-Ce*nt+Ne*rt)*at,N[1]=(-we*it+Ge*nt-Se*rt)*at,N[2]=(Ve*Ke-Ze*Qe+We*Je)*at,N[3]=(-ke*Ke+je*Qe-Xe*Je)*at,N[4]=(-Fe*it+Ce*tt-Ne*et)*at,N[5]=(Ae*it-Ge*tt+Se*et)*at,N[6]=(-ze*Ke+Ze*qe-We*He)*at,N[7]=(Oe*Ke-je*qe+Xe*He)*at,N[8]=(Fe*nt-De*tt+Ne*$e)*at,N[9]=(-Ae*nt+we*tt-Se*$e)*at,N[10]=(ze*Qe-Ve*qe+We*Ye)*at,N[11]=(-Oe*Qe+ke*qe-Xe*Ye)*at,N[12]=(-Fe*rt+De*et-Ce*$e)*at,N[13]=(Ae*rt-we*et+Ge*$e)*at,N[14]=(-ze*Je+Ve*He-Ze*Ye)*at,N[15]=(Oe*Je-ke*He+je*Ye)*at,ee=N[1],te=N[2],re=N[3],ae=N[6],oe=N[7],de=N[11],N[1]=N[4],N[2]=N[8],N[3]=N[12],N[4]=ee,N[6]=N[9],N[7]=N[13],N[8]=te,N[9]=ae,N[11]=N[14],N[12]=re,N[13]=oe,N[14]=de,t.uniformMatrix4fv(y.uNMatrix.location,!1,N)),U&&(y.uPointSize.location&&R.pointSize!=v.pointSize&&t.uniform1f(y.uPointSize.location,R.pointSize=v.pointSize),R.useCullFace!=v.useCullFace&&((R.useCullFace=v.useCullFace)?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE)),R.cullFace!=v.cullFace&&t.cullFace(R.cullFace=v.cullFace),R.useDepthTest!=v.useDepthTest&&((R.useDepthTest=v.useDepthTest)?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)),R.depthTestFunc!=v.depthTestFunc&&t.depthFunc(v.depthTestFunc),R.useBlendMode!=v.useBlendMode&&((R.useBlendMode=v.useBlendMode)?t.enable(t.BLEND):t.disable(t.BLEND)),R.blendSrc==v.blendSrc&&R.blendDst==v.blendDst||(t.blendFunc(v.blendSrc,v.blendDst),R.blendSrc=v.blendSrc,R.blendDst=v.blendDst),y.uSprite3DYn.location&&(F=X,h[O=y.uSprite3DYn._UUID]!=F&&(t[y.uSprite3DYn.renderMethod](y.uSprite3DYn.location,F),h[O]=F),O=y.uPerspectiveScale._UUID,F=v.perspectiveScale,h[O]!=F&&(t[y.uPerspectiveScale.renderMethod](y.uPerspectiveScale.location,F),h[O]=F)),S?(s!=S._UUID&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,S.webglBuffer),t.drawElements(v.drawMode,S.pointNum,S.glArrayType,0),s=S._UUID):t.drawArrays(v.drawMode,0,G.pointNum)),v.children.length&&o(e,t,v.children,i,a,d,c,h,l,R,C,p)}},function(e,t,r,n,i,a,s){void 0==this.cacheState.pointSize&&(this.cacheState.pointSize=null),this.cacheState.useCullFace||(this.cacheState.useCullFace=null),this.cacheState.cullFace||(this.cacheState.cullFace=null),this.cacheState.useDepthTest||(this.cacheState.useDepthTest=null),this.cacheState.depthTestFunc||(this.cacheState.depthTestFunc=null),this.cacheState.useBlendMode||(this.cacheState.useBlendMode=null),this.cacheState.blendSrc||(this.cacheState.blendSrc=null),this.cacheState.blendDst||(this.cacheState.blendDst=null),this.cacheBySamplerIndex.length=0,o(e,t,n,r,i,a,this.cacheAttrInfo,this.cacheUniformInfo,this.cacheBySamplerIndex,this.cacheState,void 0,s)}),Object.freeze(RedRenderer)}(),(RedRenderDebuger=function(){if(!(this instanceof RedRenderDebuger))return new RedRenderDebuger;this.renderResult||(this.renderResult=document.createElement("div"),this._contentBox=document.createElement("div"),this._etcBox=document.createElement("div"),this.renderResult.appendChild(this._contentBox),this.renderResult.appendChild(this._etcBox),this.renderResult.style.cssText="position:absolute;bottom:0px;left:0px;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;background:rgba(0,0,0,0.6);padding:3px;width:300px",this._etcBox.style.cssText="position:relative;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;background:rgba(0,0,0,0.6);padding:3px",this._etcBox.innerHTML='<a href="https://redcamel.github.io/RedGL2/redDoc/index.html" stlye="color:#fff;text-decoration:none">API document</a>'),this._visible=!1}).prototype={update:function(e,t){for(var r in this._contentBox.innerHTML="",t)this._contentBox.innerHTML+='<div style="padding:3px"><div><b>RedView : key - '+t[r].key+"</b></div> orthographicYn - "+t[r].orthographicYn+" <br>call - "+t[r].call+" <br> width - "+t[r].width+" / height - "+t[r].height+" <br> viewRectWidth - "+t[r].viewRectWidth+" / viewRectHeight - "+t[r].viewRectHeight+" <br> x - "+t[r].x+" / y - "+t[r].y+"</div><br>";this._contentBox.innerHTML+='<div style="padding:3px;background:#000">renderScale : '+e.renderScale+"</div>"}},Object.defineProperty(RedRenderDebuger.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible=e,this._visible?document.body.appendChild(this.renderResult):this.renderResult.parentNode&&document.body.removeChild(this.renderResult)}}),Object.freeze(RedRenderDebuger),function(){var e,t;function r(e,t,r,n){this.x=e,this.y=t,this.w=r,this.h=n}(RedAtlas=function(r,n,i){if(!(this instanceof RedAtlas))return new RedAtlas(r,n,i);r instanceof RedGL||RedGLUtil.throwFunc("RedBitmapMaterial : RedGL Instance만 허용됩니다.",r),r._datas.RedAtlas||(r._datas.RedAtlas={atlasInfoList:[new e],atlasMap:{}}),(t=r._detect.MAX_TEXTURE_SIZE)>2048&&(t=2048),this.redGL=r,this.loadList(n,i)}).prototype={getAtlasMap:function(){return this.redGL._datas.RedAtlas.atlasMap},getAtlasInfoList:function(){return this.redGL._datas.RedAtlas.atlasInfoList},loadList:function(e,t){var r,n,i,a;for(a=0,i=this,r=0,n=e.length,r=0;r<n;r++){var o=new Image;o.id=o.src=e[r],o.onload=function(){(i.atlasPack(i.redGL,this),++a==e.length)&&(i.redGL._datas.RedAtlas.atlasInfoList.forEach(function(e){e.texture=RedBitmapTexture(i.redGL,e.canvas)}),t&&t.call(i,i.redGL._datas.RedAtlas))}}},atlasPack:function(t,r){var n,i;if(n=t._datas.RedAtlas.atlasInfoList,!(i=t._datas.RedAtlas.atlasMap)[r.id]){var a,o,s,u;if(!1===(u=(s=n[0]).pack(r))){for(a=0,o=n.length;a<o&&!(u=(s=n[a]).pack(r));a++);!1===u&&(n.push(s=new e),u=s.pack(r))}i[r.id]={atlas:s,rect:s.uv()[r.id]},s.texture||(s.texture=RedBitmapTexture(t,s.canvas))}}},r.prototype.fitsIn=function(e){return e.w>=this.w&&e.h>=this.h},r.prototype.sameSizeAs=function(e){return this.w===e.w&&this.h===e.h},(e=function(e,n,i,a){if(void 0==e){var o=document.createElement("canvas");document.body.appendChild(o),o.style.display="none",o.width=t,o.height=t,this.canvas=o,e=n=0,i=this.canvas.width,a=this.canvas.height}2===arguments.length&&(i=e,a=n,e=n=0),this._UUID=RedGL.makeUUID(),this.left=this.right=null,this.rect=new r(e,n,i,a),this.filled=!1,this.tilepad=!1,this._cache=[],this._uvcache=Object.create(null)}).prototype.pack=function(t){return this._cache=[],this._uvcache=Object.create(null),t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),null!==this.left?this._ontoCanvas(this.left.pack(t)||this.right.pack(t)):!(this.filled||!t.fitsIn(this.rect))&&(t.sameSizeAs(this.rect)?(this.filled=!0,this._ontoCanvas(this)):(this.rect.w-t.w>this.rect.h-t.h?(this.left=new e(this.rect.x,this.rect.y,t.w,this.rect.h),this.right=new e(this.rect.x+t.w,this.rect.y,this.rect.w-t.w,this.rect.h)):(this.left=new e(this.rect.x,this.rect.y,this.rect.w,t.h),this.right=new e(this.rect.x,this.rect.y+t.h,this.rect.w,this.rect.h-t.h)),this._ontoCanvas(this.left.pack(t))))},e.prototype.expand=function(t){var r,n=this;if(t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),this.rect.w<this.rect.h?((r=new e(0,0,this.rect.w+t.w,this.rect.h)).right=new e(this.rect.w,0,t.w,this.rect.h),r.left=this):((r=new e(0,0,this.rect.w,this.rect.h+t.h)).right=new e(0,this.rect.h,this.rect.w,t.h),r.left=this),["canvas","context","img"].forEach(function(e){n[e]&&(r[e]=n[e],n[e]=null)}),r.canvas){r.context||(r.context=r.canvas.getContext("2d"));var i=r.context.getImageData(0,0,r.canvas.width,r.canvas.height);r.canvas.width=r.rect.w,r.canvas.height=r.rect.h,r.context.putImageData(i,0,0)}return!1===r.pack(t)?r.expand(t):r},e.prototype.index=function(){var e=this;return e._cache.length>0?e._cache:(function t(r){null!==r.left?(t(r.left),t(r.right)):r.rect.name&&e._cache.push(r.rect)}(e),e._cache)},e.prototype.uv=function(e,t){var r=this;e=e||r.rect.w,t=t||r.rect.h;var n=this.tilepad;return function i(a){if(null!==a.left)i(a.left),i(a.right);else if(void 0!==a.rect.name){var o=n?a.rect.w/4:0;r._uvcache[a.rect.name]=[[a.rect.x+o,a.rect.y+o],[a.rect.x+o+(a.rect.w-2*o),a.rect.y+o],[a.rect.x+o+(a.rect.w-2*o),a.rect.y+o+(a.rect.h-2*o)],[a.rect.x+o,a.rect.y+o+(a.rect.h-2*o)]].map(function(r){return 0!==r[0]&&(r[0]=r[0]/e),0!==r[1]&&(r[1]=r[1]/t),r})}}(r),r._uvcache},e.prototype.json=function(t){return t?("string"==typeof t&&(t=JSON.parse(t)),function t(r){if(r&&r.rect){var n=new e(r.rect.x,r.rect.y,r.rect.w,r.rect.h);return r.left&&(n.left=t(r.left)),r.right&&(n.right=t(r.right)),n}}(t)):JSON.stringify(function e(t){var r={left:null,right:null,rect:t.rect,filled:t.filled};return null!==t.left&&(r.left=e(t.left),r.right=e(t.right)),r}(this),null,2)},e.prototype._tilepad=function(e){var t=this.img;if(!t)return e;var n=t.width/2,i=document.createElement("canvas");i.name=t.name||t.src,i.id=t.id||"",i.width=t.width+t.width,i.height=t.height+t.height;var a=i.getContext("2d"),o=a.createPattern(t,"repeat");return a.fillStyle=o,a.translate(n,n),a.fillRect(-n,-n,i.width+n,i.height+n),a.translate(-n,-n),this.img=i,new r(e.x,e.y,this.img.width,this.img.height)},e.prototype._ontoCanvas=function(e){return e&&this.img&&this.canvas&&(this.context||(this.context=this.canvas.getContext("2d")),this.context.clearRect(e.rect.x,e.rect.y,e.rect.w,e.rect.h),this.context.drawImage(this.img,e.rect.x,e.rect.y,e.rect.w,e.rect.h),e.rect.name=this.img.id||this.img.name||this.img.src||null),e},e.prototype._toRect=function(e){return!e.nodeName||"IMG"!==e.nodeName&&"CANVAS"!==e.nodeName||(this.img=e,e=new r(e.x,e.y,e.width,e.height)),e instanceof r||(e=new r(e.x||0,e.y||0,e.w||e.width,e.h||e.height)),e},e.prototype._debug=function(){if(this.canvas){var e=this.canvas.getContext("2d");this.index().forEach(function(t){e.lineWidth=1,e.strokeStyle="red",e.strokeRect(t.x,t.y,t.w,t.h)})}}}(),function(){var e,t,r=new Float32Array([0,0,1,1]),n={};r._UUID=RedGL.makeUUID(),(RedAtlasUV=function(i,a){if(!(this instanceof RedAtlasUV))return new RedAtlasUV(i,a);i instanceof RedGL||RedGLUtil.throwFunc("RedAtlasUV : RedGL Instance만 허용됩니다.",i),a?(t=[a[0][0],1-a[2][1],a[1][0]-a[0][0],a[2][1]-a[0][1]],e=t.toString(),n[e]?this.data=n[e]:(this.data=n[e]=t,this.data._UUID=RedGL.makeUUID())):this.data=r}).prototype={},Object.freeze(RedAtlasUV)}(),function(){var e,t,r;e=function(e,t){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,2,2,0,e.LUMINANCE,e.UNSIGNED_BYTE,new Uint8Array([128,64,0,192])),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.generateMipmap(e.TEXTURE_2D),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.bindTexture(e.TEXTURE_2D,null),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0)},r=function(e,t,r,n){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n.min?n.min:e.LINEAR_MIPMAP_NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n.max?n.max:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,n.wrap_s?n.wrap_s:e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,n.wrap_t?n.wrap_t:e.REPEAT),e.glExtension.EXT_texture_filter_anisotropic&&n.anisotropic&&e.texParameterf(e.TEXTURE_2D,e.glExtension.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.anisotropic);try{e.generateMipmap(e.TEXTURE_2D)}catch(e){}e.bindTexture(e.TEXTURE_2D,null)},t=function(t,n,i,a){var o,s,u,f;a||(a={}),u=function(e){e.removeEventListener("error",o),e.removeEventListener("load",s)},o=function(){var e="couldn't load image: "+i;RedGLUtil.throwFunc(e),u(this)},s=function(){u(this),r(t,n,this,a)},e(t,n),i instanceof HTMLCanvasElement?r(t,n,i,a):((f=new Image).crossOrigin="anonymous",f.src=i,f.addEventListener("error",o),f.addEventListener("load",s))},(RedBitmapTexture=function(e,r,n){var i;if(!(this instanceof RedBitmapTexture))return new RedBitmapTexture(e,r,n);e instanceof RedGL||RedGLUtil.throwFunc("RedBitmapTexture : RedGL Instance만 허용됩니다.",e),i=e.gl,this.webglTexture=i.createTexture(),this.atlascoord=RedAtlasUV(e),this._UUID=RedGL.makeUUID(),r&&t(i,this.webglTexture,r,n)}).prototype={},Object.freeze(RedBitmapTexture)}(),function(){var e;(RedAtlasTexture=function(t,r){if(!(this instanceof RedAtlasTexture))return new RedAtlasTexture(t,r);t instanceof RedGL||RedGLUtil.throwFunc("RedAtlasTexture : RedGL Instance만 허용됩니다.",t),e=t._datas.RedAtlas.atlasMap[r],this.webglTexture=e.atlas.texture.webglTexture,this.atlascoord=RedAtlasUV(t,e.rect),this._UUID=e.atlas._UUID}).prototype=RedBitmapTexture.prototype,Object.freeze(RedAtlasTexture)}(),function(){var e,t,r;(r=new Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC",e=function(e,t){e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,t),[r,r,r,r,r,r].forEach(function(t,n){e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},t=function(t,r,n,i){var a,o,s,u,f,d=[];for(i||(i={}),s=function(e){e.removeEventListener("error",a),e.removeEventListener("load",o)},a=function(){var e="couldn't load image: "+src;RedGLUtil.throwFunc(e),s(this)},o=function(){if(6==++f){s(this),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_CUBE_MAP,r);for(var e=d.length;e--;)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,d[e]);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,i.min?i.min:t.LINEAR_MIPMAP_NEAREST),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,i.max?i.max:t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,i.wrap_s?i.wrap_s:t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,i.wrap_t?i.wrap_t:t.CLAMP_TO_EDGE);try{t.generateMipmap(t.TEXTURE_CUBE_MAP)}catch(e){}t.bindTexture(t.TEXTURE_CUBE_MAP,null)}else s(this)},u=6,f=0;u--;){var c;e(t,r),(c=new Image).crossOrigin="anonymous",c.src=n[u],c.addEventListener("error",a),c.addEventListener("load",o),d[u]=c}},(RedBitmapCubeTexture=function(e,r,n){var i;if(!(this instanceof RedBitmapCubeTexture))return new RedBitmapCubeTexture(e,r,n);e instanceof RedGL||RedGLUtil.throwFunc("RedBitmapCubeTexture : RedGL Instance만 허용됩니다.",e),i=e.gl,this.webglTexture=i.createTexture(),this.atlascoord=RedAtlasUV(e),this._UUID=RedGL.makeUUID(),t(i,this.webglTexture,r,n)}).prototype={},Object.freeze(RedBitmapCubeTexture)}(),function(){var e;e={},(RedView=function(t,r,n){if(e[t]){if(!r&&!n)return e[t];RedGLUtil.throwFunc("RedView : "+t,"는 이미 생성된 RedView key입니다.","입력값 : "+t)}if(!(this instanceof RedView))return new RedView(t,r,n);"string"!=typeof t&&RedGLUtil.throwFunc("RedView : key : 문자열만 허용","입력값 : "+t),r||n||RedGLUtil.throwFunc("RedView : 존재하지 않는 key입니다.","입력값 : "+t),!r||r instanceof RedScene||RedGLUtil.throwFunc("RedView : RedScene Instance만 허용","입력값 : "+r),n?n instanceof RedCamera||n instanceof RedBasicController||n instanceof RedObitController||RedGLUtil.throwFunc("RedView : RedCamera or XXController Instance만 허용"):RedGLUtil.throwFunc("RedView : RedCamera or XXController Instance만 허용","입력값 : "+n),this.key=t,this.scene=r,this.camera=n,this._width="100%",this._height="100%",this._x=0,this._y=0,this._viewRect=[0,0,0,0],e[t]=this}).prototype={setSize:function(e,t){this._width=void 0!=e?e:"100%",this._height=void 0!=t?t:"100%"},setLocation:function(e,t){this._x=void 0!=e?e:0,this._y=void 0!=t?t:0}},Object.freeze(RedView)}(),(RedWorld=function(){if(!(this instanceof RedWorld))return new RedWorld;this._viewList=[],this._viewMap={},this._UUID=RedGL.makeUUID()}).prototype={addView:function(e){e instanceof RedView||RedGLUtil.throwFunc("RedWorld :addView Instance만 허용함.","입력값 : "+e),this._viewMap[e.key]=e,this._viewList.push(e)},getView:function(e){return"string"!=typeof e&&RedGLUtil.throwFunc("RedWorld :getView 문자열만 허용함.","입력값 : "+e),this._viewMap[e]},delView:function(e){var t,r;"string"!=typeof e&&RedGLUtil.throwFunc("RedWorld :delView 문자열만 허용함.","입력값 : "+e),(t=this._viewMap[e])&&(r=this._viewList.indexOf(t),this._viewList.splice(r,1),delete this._viewMap[e])},hasView:function(e){return"string"!=typeof e&&RedGLUtil.throwFunc("RedWorld :hasView 문자열만 허용함.","입력값 : "+e),!!this._viewMap[e]},getViewList:function(){return this._viewList.concat()}},Object.freeze(RedWorld),function(){var e;(RedScene=function(e,t){if(e instanceof RedGL||RedGLUtil.throwFunc("RedScene : RedGL Instance만 허용됩니다.",e),!(this instanceof RedScene))return new RedScene(e,t);var r,n,i,a,o;Object.defineProperty(this,"backgroundColor",(o="#000000",{get:function(){return o},set:function(e){"string"!=typeof(o=e||"#000000")&&RedGLUtil.throwFunc("RedScene : backgroundColor hex 문자열만 허용함","입력값 : "+o),RedGLUtil.regHex(o)||RedGLUtil.throwFunc("RedScene : backgroundColor hex 형식을 사용해야함","입력값 : "+o),a=RedGLUtil.hexToRGB.call(this,o),this._r=a[0],this._g=a[1],this._b=a[2]}})),this.backgroundColor=t||"#000000",this.useBackgroundColor=!0,this.useFog=!1,this.fogDensity=.5,Object.defineProperty(this,"fogDensity",function(){var e=.5;return{get:function(){return e},set:function(t){"number"!=typeof t&&RedGLUtil.throwFunc("RedScene : fogDensity 숫자만허용함","입력값 : "+t),t<0&&(t=0),e=t}}}()),Object.defineProperty(this,"fogDistance",function(){var e=25;return{get:function(){return e},set:function(t){"number"!=typeof t&&RedGLUtil.throwFunc("RedScene : fogDistance 숫자만허용함","입력값 : "+t),t<0&&(t=0),e=t}}}()),Object.defineProperty(this,"fogColor",function(){var e,t="#ffffff";return{get:function(){return t},set:function(r){"string"!=typeof(t=r||"#ffffff")&&RedGLUtil.throwFunc("RedScene : fogColor hex 문자열만 허용함","입력값 : "+t),RedGLUtil.regHex(t)||RedGLUtil.throwFunc("RedScene : fogColor hex 형식을 사용해야함","입력값 : "+t),e=RedGLUtil.hexToRGB.call(this,t),this._fogR=e[0],this._fogG=e[1],this._fogB=e[2]}}}()),this.fogColor="#ffffff",this.children=[],Object.defineProperty(this,"skyBox",{get:function(){return r},set:function(e){return e instanceof RedSkyBox||!e||RedGLUtil.throwFunc("RedScene : RedSkyBox Instance만 허용됩니다."),r=e}}),Object.defineProperty(this,"grid",{get:function(){return n},set:function(e){return e instanceof RedGrid||!e||RedGLUtil.throwFunc("RedScene : RedGrid Instance만 허용됩니다."),n=e}}),Object.defineProperty(this,"axis",{get:function(){return i},set:function(e){return e instanceof RedAxis||!e||RedGLUtil.throwFunc("RedScene : RedAxis Instance만 허용됩니다."),i=e}}),this.postEffectManager=RedPostEffectManager(e),this._lightInfo={RedAmbientLight:null,RedDirectionalLight:[],RedPointLight:[]},this._UUID=RedGL.makeUUID()}).prototype={_r:0,_g:0,_b:0,_fogR:1,_fogG:1,_fogB:1,addLight:function(e){switch(e.type){case RedAmbientLight.type:this._lightInfo[e.type]=e;break;case RedDirectionalLight.type:case RedPointLight.type:this._lightInfo[e.type].push(e);break;default:RedGLUtil.throwFunc("RedScene : RedBaseLight 확장객체만 가능")}},removeLight:function(t){switch(t.type){case RedAmbientLight.type:this._lightInfo[t.type]==t&&(this._lightInfo[t.type]=null);break;case RedDirectionalLight.type:case RedPointLight.type:(e=this._lightInfo[t.type].indexOf(t))>-1&&this._lightInfo[t.type].splice(e,1);break;default:RedGLUtil.throwFunc("RedScene : RedBaseLight 확장객체만 가능")}}},RedGLUtil.copyProto(RedScene,RedBaseContainer),Object.freeze(RedScene)}(),function(){var e,t;(RedCamera=function(){if(!(this instanceof RedCamera))return new RedCamera;this.x=this.y=this.z=0,this.targetX=this.targetY=this.targetZ=0,this.fov=45,this.nearClipping=.01,this.farClipping=1e4,this.orthographicYn=!1,this.matrix=mat4.create(),this.perspectiveMTX=mat4.create(),this._UUID=RedGL.makeUUID()}).prototype.update=function(){new Float32Array([0,1,0]);return function(){this.lookAt(this.targetX,this.targetY,this.targetZ)}}(),RedCamera.prototype.lookAt=(e=new Float32Array([0,1,0]),t=[],function(r,n,i){t[0]=this.targetX=r,t[1]=this.targetY=n,t[2]=this.targetZ=i,mat4.identity(this.matrix),mat4.lookAt(this.matrix,[this.x,this.y,this.z],t,e)}),Object.freeze(RedCamera)}(),(RedBasicController=function(e){if(!(this instanceof RedBasicController))return new RedBasicController(e);this.keyBuffer={},this.speed=1,this.delay=.1,this.speedRotation=1,this.delayRotation=.1,this.maxAcceleration=3,Object.defineProperty(this,"x",{get:function(){return this._targetObject.x},set:function(e){this._targetObject.x=e,this._desirePosition[0]=e}}),Object.defineProperty(this,"y",{get:function(){return this._targetObject.y},set:function(e){this._targetObject.y=e,this._desirePosition[1]=e}}),Object.defineProperty(this,"z",{get:function(){return this._targetObject.z},set:function(e){this._targetObject.z=e,this._desirePosition[2]=e}}),Object.defineProperty(this,"tilt",{get:function(){return this._desireTilt},set:function(e){this._targetObject.rotationX=e,this._desireTilt=e}}),Object.defineProperty(this,"pan",{get:function(){return this._desirePan},set:function(e){this._targetObject.rotationY=e,this._desirePan=e}}),this.camera=RedCamera(),this.keyNameMapper={moveForward:"w",moveBack:"s",moveLeft:"a",moveRight:"d",moveUp:"t",moveDown:"g",turnLeft:"q",turnRight:"e",turnUp:"r",turnDown:"f"},this._desirePosition=[0,0,0],this._targetObject=RedMesh(e),this._desirePan=0,this._desireTilt=0,function(t){var r,n,i,a,o,s,u,f,d;s=0,u=0,f=0,d=0,r=function(e){t.keyBuffer[e.key]=1},n=function(e){t.keyBuffer[e.key]=0},i=function(t){s=t.x,u=t.y,e._canvas.addEventListener("mousemove",a),window.addEventListener("mouseup",o)},a=function(e){f=e.x-s,d=e.y-u,s=e.x,u=e.y,t._desirePan-=f*t.speedRotation*.1,t._desireTilt-=d*t.speedRotation*.1},o=function(){e._canvas.removeEventListener("mousemove",a),window.removeEventListener("mouseup",o)},window.addEventListener("keydown",r),window.addEventListener("keyup",n),e._canvas.addEventListener("mousedown",i)}(this)}).prototype.update=function(){var e,t,r,n,i,a,o,s,u,f,d,c,h,l,R,m,p,g;return new Float32Array([0,1,0]),c=mat4.create(),f=mat4.create(),d=mat4.create(),h=vec3.create(),R=0,function(E){e=0,t=0,n=!1,i=!1,a=this.speed,o=this.speedRotation,s=this.delay,u=this.delayRotation,l=this.camera,g=this._desirePosition,m=this.keyBuffer,p=this.keyNameMapper,h[0]=0,h[1]=0,h[2]=0,m[p.turnLeft]&&(i=!0,e=o),m[p.turnRight]&&(i=!0,e=-o),m[p.turnUp]&&(i=!0,t=o),m[p.turnDown]&&(i=!0,t=-o),m[p.moveForward]&&(n=!0,h[2]=-R*a),m[p.moveBack]&&(n=!0,h[2]=R*a),m[p.moveLeft]&&(n=!0,h[0]=-R*a),m[p.moveRight]&&(n=!0,h[0]=R*a),m[p.moveUp]&&(n=!0,h[1]=R*a),m[p.moveDown]&&(n=!0,h[1]=-R*a),i||n?(R+=.1)>this.maxAcceleration&&(R=this.maxAcceleration):(R+=-.1)<0&&(R=0),r=this._targetObject,i&&(this._desirePan+=e,this._desireTilt+=t),r.rotationY+=(this._desirePan-r.rotationY)*u,r.rotationX+=(this._desireTilt-r.rotationX)*u,(n||i)&&(f=r.matrix,mat4.identity(c),mat4.rotateY(c,c,r.rotationY*Math.PI/180),mat4.rotateX(c,c,r.rotationX*Math.PI/180),mat4.translate(c,c,h),mat4.identity(f),mat4.translate(f,f,[r.x,r.y,r.z]),mat4.multiply(f,f,c),g[0]=f[12],g[1]=f[13],g[2]=f[14]),r.x+=(g[0]-r.x)*s,r.y+=(g[1]-r.y)*s,r.z+=(g[2]-r.z)*s,r.rotationY+=(this._desirePan-r.rotationY)*u,r.rotationX+=(this._desireTilt-r.rotationX)*u,f=r.matrix,mat4.identity(f),mat4.translate(f,f,[r.x,r.y,r.z]),mat4.rotateY(f,f,r.rotationY*Math.PI/180),mat4.rotateX(f,f,r.rotationX*Math.PI/180),d=mat4.clone(f),mat4.translate(d,d,[0,0,.01]),l.x=d[12],l.y=d[13],l.z=d[14],l.lookAt(r.x,r.y,r.z)}}(),Object.freeze(RedBasicController),(RedObitController=function(e){var t;if(!(this instanceof RedObitController))return new RedObitController(e);this.speedDistance=2,this.delayDistance=.1,this.speedRotation=3,this.delayRotation=.1,this.centerX=0,this.centerY=0,this.centerZ=0,this.distance=15,this.tilt=0,Object.defineProperty(this,"minTilt",(t=-90,{get:function(){return t},set:function(e){e<-90&&(e=-90),t=e}})),Object.defineProperty(this,"maxTilt",function(){var e=90;return{get:function(){return e},set:function(t){t>90&&(t=90),e=t}}}()),this.pan=0,this.camera=RedCamera(),this._currentPan=0,this._currentTilt=0,this._currentDistance=0,function(t){var r,n,i,a,o,s,u,f;o=0,s=0,u=0,f=0,r=function(t){o=t.x,s=t.y,e._canvas.addEventListener("mousemove",n),window.addEventListener("mouseup",i)},n=function(e){u=e.x-o,f=e.y-s,o=e.x,s=e.y,t.pan-=u*t.speedRotation*.1,t.tilt-=f*t.speedRotation*.1},i=function(){e._canvas.removeEventListener("mousemove",n),window.removeEventListener("mouseup",i)},a=function(e){t.distance+=e.deltaY/100*t.speedDistance},e._canvas.addEventListener("mousedown",r),e._canvas.addEventListener("wheel",a)}(this)}).prototype.update=function(){var e,t,r;return new Float32Array([0,1,0]),function(n){this.tilt<this.minTilt&&(this.tilt=this.minTilt+.01),this.tilt>this.maxTilt&&(this.tilt=this.maxTilt-.01),this.speedRotation,e=this.delayRotation,t=this.camera,r=t.matrix,this._currentPan+=(this.pan-this._currentPan)*e,this._currentTilt+=(this.tilt-this._currentTilt)*e,this._currentDistance+=(this.distance-this._currentDistance)*this.delayDistance,mat4.identity(r),mat4.rotateY(r,r,this._currentPan*Math.PI/180),mat4.rotateX(r,r,this._currentTilt*Math.PI/180),mat4.translate(r,r,[0,0,this._currentDistance]),t.x=r[12],t.y=r[13],t.z=r[14],t.lookAt(this.centerX,this.centerY,this.centerZ)}}(),Object.freeze(RedObitController),function(){var e,t,r,n;RedColorMaterial=function(t,r,n){if(!(this instanceof RedColorMaterial))return new RedColorMaterial(t,r,n);this.color=new Float32Array(4),this.setColor(r||"#ff0000",void 0==n?1:n),this.program=e(t),this._UUID=RedGL.makeUUID(),this.checkProperty()},t=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
uniform vec4 uColor;
varying vec4 vColor;
void main(void) {
vColor = uColor;
gl_PointSize = uPointSize;
if(uSprite3DYn) {
gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
if(!uPerspectiveScale){
gl_Position /= gl_Position.w;
gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1]);
}
}
else gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = vColor * vColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"colorProgram",t,r)},RedColorMaterial.prototype=RedBaseMaterial.prototype,RedColorMaterial.prototype.setColor=function(e,t){e=e||"#ff2211",void 0==t&&(t=1),t>1&&(t=1),n=RedGLUtil.hexToRGB.call(this,e),this.color[0]=n[0],this.color[1]=n[1],this.color[2]=n[2],this.color[3]=t},Object.freeze(RedColorMaterial)}(),function(){var e,t,r;RedColorPhongMaterial=function(t,r,n){if(!(this instanceof RedColorPhongMaterial))return new RedColorPhongMaterial(t,r,n);this.color=new Float32Array(4),this.shininess=16,this.specularPower=1,this.setColor(r||"#ff0000",void 0==n?1:n),this.program=e(t),this._UUID=RedGL.makeUUID(),this.checkProperty()},t=function(){
/* @preserve
uniform vec4 uColor;
varying vec4 vColor;
varying vec4 vVertexPositionEye4;
void main(void) {
vColor = uColor;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform float uShininess;
uniform float uSpecularPower;
varying vec4 vVertexPositionEye4;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 la = uAmbientLightColor * uAmbientLightColor.a;
vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
vec4 texelColor = vColor;
// texelColor.rgb *= texelColor.a;
vec3 N = normalize(vVertexNormal);
vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
float specularTextureValue = 1.0;
float specular;
vec3 L;
vec3 R;
highp float lambertTerm;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPosition[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), uShininess);
ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
}
}
vec3 pointDirection;
highp float distanceLength;
highp float attenuation;
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
distanceLength = length(pointDirection);
if(uPointLightRadius[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(pointDirection);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), uShininess);
ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
}
}
}
vec4 finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"colorPhongProgram",t,r)},RedColorPhongMaterial.prototype=RedBaseMaterial.prototype,RedColorPhongMaterial.prototype.setColor=RedColorMaterial.prototype.setColor,Object.freeze(RedColorPhongMaterial)}(),function(){var e,t,r;RedColorPhongTextureMaterial=function(t,r,n,i,a,o){if(!(this instanceof RedColorPhongTextureMaterial))return new RedColorPhongTextureMaterial(t,r,n,i,a,o);this.color=new Float32Array(4),this.normalTexture=i,this.specularTexture=a,this.displacementTexture=o,this.shininess=16,this.specularPower=1,this.displacementPower=0,this.setColor(r||"#ff0000",void 0==n?1:n),this.program=e(t),this._UUID=RedGL.makeUUID(),this.checkProperty()},t=function(){
/* @preserve
uniform vec4 uColor;
varying vec4 vColor;
uniform sampler2D uDisplacementTexture;
uniform float uDisplacementPower;
varying vec4 vVertexPositionEye4;
void main(void) {
vColor = uColor;
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(uDisplacementTexture, vTexcoord).x * uDisplacementPower ;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uNormalTexture;
uniform sampler2D uSpecularTexture;
uniform float uShininess;
uniform float uSpecularPower;
varying vec4 vVertexPositionEye4;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 la = uAmbientLightColor * uAmbientLightColor.a;
vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
vec4 texelColor = vColor;
// texelColor.rgb *= texelColor.a;
vec3 N = normalize(vVertexNormal);
vec4 normalColor = texture2D(uNormalTexture, vTexcoord);
if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb  - 0.5));
vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
float specularTextureValue = 1.0;
specularTextureValue = texture2D(uSpecularTexture, vTexcoord).r;
float specular;
vec3 L;
vec3 R;
highp float lambertTerm;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPosition[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), uShininess);
ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
}
}
vec3 pointDirection;
highp float distanceLength;
highp float attenuation;
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
distanceLength = length(pointDirection);
if(uPointLightRadius[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(pointDirection);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), uShininess);
ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
}
}
}
vec4 finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"colorPhongTextureProgram",t,r)},RedColorPhongTextureMaterial.prototype=RedBaseMaterial.prototype,RedColorPhongTextureMaterial.prototype.setColor=RedColorMaterial.prototype.setColor,Object.freeze(RedColorPhongTextureMaterial)}(),function(){var e,t,r;RedEnvironmentMaterial=function(t,r,n,i,a,o){if(!(this instanceof RedEnvironmentMaterial))return new RedEnvironmentMaterial(t,r,n,i,a,o);t instanceof RedGL||RedGLUtil.throwFunc("RedEnvironmentMaterial : RedGL Instance만 허용됩니다.",t),r instanceof RedBitmapTexture||RedGLUtil.throwFunc("RedEnvironmentMaterial : diffuseTexture - RedBitmapTexture Instance만 허용됩니다."),!n||n instanceof RedBitmapCubeTexture||RedGLUtil.throwFunc("RedEnvironmentMaterial : environmentTexture - RedBitmapCubeTexture Instance만 허용됩니다."),!i||i instanceof RedBitmapTexture||RedGLUtil.throwFunc("RedEnvironmentMaterial : normalTexture - RedBitmapTexture Instance만 허용됩니다."),!a||a instanceof RedBitmapTexture||RedGLUtil.throwFunc("RedEnvironmentMaterial : specularTexture - RedBitmapTexture Instance만 허용됩니다."),!o||o instanceof RedBitmapTexture||RedGLUtil.throwFunc("RedEnvironmentMaterial : displacementTexture - RedBitmapTexture Instance만 허용됩니다."),this.diffuseTexture=r,this.environmentTexture=n,this.normalTexture=i,this.specularTexture=a,this.displacementTexture=o,this.shininess=8,this.specularPower=1,this.reflectionPower=1,this.displacementPower=0,this.program=e(t),this._UUID=RedGL.makeUUID(),this.checkProperty()},t=function(){
/* @preserve
varying vec4 vVertexPositionEye4;
varying vec3 vReflectionCubeCoord;
uniform sampler2D uDisplacementTexture;
uniform float uDisplacementPower;
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(uDisplacementTexture, vTexcoord).x * uDisplacementPower ;
vReflectionCubeCoord = -vVertexPositionEye4.xyz;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform sampler2D uNormalTexture;
uniform sampler2D uSpecularTexture;
uniform samplerCube uEnvironmentTexture;
uniform float uShininess;
uniform float uSpecularPower;
uniform float uReflectionPower;
varying vec4 vVertexPositionEye4;
varying vec3 vReflectionCubeCoord;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 la = uAmbientLightColor * uAmbientLightColor.a;
vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
vec4 texelColor = texture2D(uDiffuseTexture, vTexcoord);
texelColor.rgb *= texelColor.a;
if(texelColor.a ==0.0) discard;
vec3 N = normalize(vVertexNormal);
vec4 normalColor = texture2D(uNormalTexture, vTexcoord);
if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb  - 0.5));
vec4 reflectionColor = textureCube(uEnvironmentTexture, 2.0 * dot(vReflectionCubeCoord,vVertexNormal) * vVertexNormal - vReflectionCubeCoord);
texelColor = texelColor * (1.0 - uReflectionPower) + reflectionColor * uReflectionPower;
vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
float specularTextureValue = 1.0;
specularTextureValue = texture2D(uSpecularTexture, vTexcoord).r;
float specular;
vec3 L;
vec3 R;
highp float lambertTerm;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPosition[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), uShininess);
ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
}
}
vec3 pointDirection;
highp float distanceLength;
highp float attenuation;
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
distanceLength = length(pointDirection);
if(uPointLightRadius[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(pointDirection);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), uShininess);
ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
}
}
}
vec4 finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"environmentProgram",t,r)},RedEnvironmentMaterial.prototype=RedBaseMaterial.prototype,Object.freeze(RedEnvironmentMaterial)}(),function(){var e,t,r;RedBitmapMaterial=function(t,r){if(!(this instanceof RedBitmapMaterial))return new RedBitmapMaterial(t,r);t instanceof RedGL||RedGLUtil.throwFunc("RedBitmapMaterial : RedGL Instance만 허용됩니다.",t),r instanceof RedBitmapTexture||RedGLUtil.throwFunc("RedBitmapMaterial : RedBitmapTexture Instance만 허용됩니다."),this.diffuseTexture=r,this.program=e(t),this._UUID=RedGL.makeUUID(),this.checkProperty()},t=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_PointSize = uPointSize;
if(uSprite3DYn) {
gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
if(!uPerspectiveScale){
gl_Position /= gl_Position.w;
gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1]);
}
}
else gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
finalColor.rgb *= finalColor.a;
if(finalColor.a ==0.0) discard;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"bitmapProgram",t,r)},RedBitmapMaterial.prototype=RedBaseMaterial.prototype,Object.freeze(RedBitmapMaterial)}(),function(){var e,t,r;RedPointBitmapMaterial=function(t,r){if(!(this instanceof RedPointBitmapMaterial))return new RedPointBitmapMaterial(t,r);t instanceof RedGL||RedGLUtil.throwFunc("RedPointBitmapMaterial : RedGL Instance만 허용됩니다.",t),r instanceof RedBitmapTexture||RedGLUtil.throwFunc("RedPointBitmapMaterial : RedBitmapTexture Instance만 허용됩니다."),this.diffuseTexture=r,this.program=e(t),this.alphaTest=1e-5,this._UUID=RedGL.makeUUID(),this.checkProperty()},t=function(){
/* @preserve
void main(void) {
gl_PointSize = aPointSize;
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float uAlphaTest;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vec2(gl_PointCoord.x, - gl_PointCoord.y));
finalColor.rgb *= finalColor.a;
if(finalColor.a < uAlphaTest) discard;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"pointBitmapProgram",t,r)},RedPointBitmapMaterial.prototype=RedBaseMaterial.prototype,Object.freeze(RedPointBitmapMaterial)}(),function(){var e,t,r;RedStandardMaterial=function(t,r,n,i,a){if(!(this instanceof RedStandardMaterial))return new RedStandardMaterial(t,r,n,i,a);t instanceof RedGL||RedGLUtil.throwFunc("RedStandardMaterial : RedGL Instance만 허용됩니다.",t),r instanceof RedBitmapTexture||RedGLUtil.throwFunc("RedStandardMaterial : diffuseTexture - RedBitmapTexture Instance만 허용됩니다."),!n||n instanceof RedBitmapTexture||RedGLUtil.throwFunc("RedStandardMaterial : normalTexture - RedBitmapTexture Instance만 허용됩니다."),!i||i instanceof RedBitmapTexture||RedGLUtil.throwFunc("RedStandardMaterial : specularTexture - RedBitmapTexture Instance만 허용됩니다."),!a||a instanceof RedBitmapTexture||RedGLUtil.throwFunc("RedStandardMaterial : displacementTexture - RedBitmapTexture Instance만 허용됩니다."),this.diffuseTexture=r,this.normalTexture=n,this.specularTexture=i,this.displacementTexture=a,this.shininess=16,this.specularPower=1,this.displacementPower=0,this.program=e(t),this._UUID=RedGL.makeUUID(),this.checkProperty()},t=function(){
/* @preserve
uniform sampler2D uDisplacementTexture;
uniform float uDisplacementPower;
varying vec4 vVertexPositionEye4;
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(uDisplacementTexture, vTexcoord).x * uDisplacementPower ;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform sampler2D uNormalTexture;
uniform sampler2D uSpecularTexture;
uniform float uShininess;
uniform float uSpecularPower;
varying vec4 vVertexPositionEye4;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 la = uAmbientLightColor * uAmbientLightColor.a;
vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
vec4 texelColor = texture2D(uDiffuseTexture, vTexcoord);
texelColor.rgb *= texelColor.a;
if(texelColor.a ==0.0) discard;
vec3 N = normalize(vVertexNormal);
vec4 normalColor = texture2D(uNormalTexture, vTexcoord);
if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb  - 0.5));
vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
float specularTextureValue = 1.0;
specularTextureValue = texture2D(uSpecularTexture, vTexcoord).r;
float specular;
vec3 L;
vec3 R;
highp float lambertTerm;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPosition[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), uShininess);
ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
}
}
vec3 pointDirection;
highp float distanceLength;
highp float attenuation;
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
distanceLength = length(pointDirection);
if(uPointLightRadius[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(pointDirection);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
R = reflect(L, N);
specular = pow( max(dot(R, -L), 0.0), uShininess);
ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
}
}
}
vec4 finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"standardProgram",t,r)},RedStandardMaterial.prototype=RedBaseMaterial.prototype,Object.freeze(RedStandardMaterial)}(),function(){var e,t,r;RedGridMaterial=function(t){if(!(this instanceof RedGridMaterial))return new RedGridMaterial(t);this.program=e(t),this._UUID=RedGL.makeUUID(),this.checkProperty(),Object.seal(this)},t=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
vColor = aVertexColor;
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
varying vec4 vColor;
void main(void) {
vec4 finalColor = vColor;
finalColor.rgb *= vColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"gridMaterialProgram",t,r)},RedGridMaterial.prototype=RedBaseMaterial.prototype,Object.freeze(RedGridMaterial)}(),function(){var e,t,r;RedPointColorMaterial=function(t){if(!(this instanceof RedPointColorMaterial))return new RedPointColorMaterial(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPointColorMaterial : RedGL Instance만 허용됩니다.",t),this.program=e(t),this._UUID=RedGL.makeUUID(),this.checkProperty()},t=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
gl_PointSize = aPointSize;
vColor = aVertexColor;
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = vColor * vColor.a;
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"pointColorProgram",t,r)},RedPointColorMaterial.prototype=RedBaseMaterial.prototype,Object.freeze(RedPointColorMaterial)}(),function(){var e,t,r;RedSkyBoxMaterial=function(t,r){if(!(this instanceof RedSkyBoxMaterial))return new RedSkyBoxMaterial(t,r);t instanceof RedGL||RedGLUtil.throwFunc("RedSkyBoxMaterial : RedGL Instance만 허용됩니다.",t),!r||r instanceof RedBitmapCubeTexture||RedGLUtil.throwFunc("RedSkyBoxMaterial : skyboxTexture - RedBitmapCubeTexture Instance만 허용됩니다."),this.skyboxTexture=r,this.program=e(t),this._UUID=RedGL.makeUUID(),this.checkProperty()},t=function(){
/* @preserve
varying vec3 vReflectionCubeCoord;
void main(void) {
vReflectionCubeCoord = (uMMatrix *vec4(-aVertexPosition, 0.0)).xyz;
gl_Position = uPMatrix * uCameraMatrix * uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform samplerCube uSkyboxTexture;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
varying vec3 vReflectionCubeCoord;
void main(void) {
vec4 finalColor = textureCube(uSkyboxTexture, vReflectionCubeCoord);
if(uUseFog) gl_FragColor = fog( fogFactor(uFogDistance, uFogDensity), uFogColor, finalColor);
else gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"skyboxProgram",t,r)},RedSkyBoxMaterial.prototype=RedBaseMaterial.prototype,Object.freeze(RedSkyBoxMaterial)}(),function(){var e,t,r;RedPostEffectMaterial=function(t,r){if(!(this instanceof RedPostEffectMaterial))return new RedPostEffectMaterial(t,r);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffectMaterial : RedGL Instance만 허용됩니다.",t),r instanceof RedBitmapTexture||RedGLUtil.throwFunc("RedPostEffectMaterial : RedBitmapTexture Instance만 허용됩니다."),this.diffuseTexture=r,this.program=e(t),this._UUID=RedGL.makeUUID(),this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffectMaterial_Program",t,r)},RedPostEffectMaterial.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffectMaterial)}(),function(){var e;(RedPostEffectManager=function(e){if(!(this instanceof RedPostEffectManager))return new RedPostEffectManager(e);var t,r,n;e instanceof RedGL||RedGLUtil.throwFunc("RedPostEffectManager : RedGL Instance만 허용됩니다.",e),t=e.gl,this.frameBuffer=RedFrameBuffer(e),function(){t.activeTexture(t.TEXTURE0+0),t.bindTexture(t.TEXTURE_2D,t.createTexture()),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);try{t.generateMipmap(t.TEXTURE_2D)}catch(e){}t.bindTexture(t.TEXTURE_2D,null)}(),this.postEffectList=[],Object.defineProperty(this,"antialiasing",(n=void 0,{get:function(){return n},set:function(e){n=e}})),this.antialiasing=void 0,this.finalMaterial=RedPostEffectMaterial(e,this.frameBuffer.texture),this.children=[],(r=RedMesh(e,RedPlane(e),this.finalMaterial)).useCullFace=!1,this.children.push(r),this._UUID=RedGL.makeUUID()}).prototype={addEffect:function(e){this.postEffectList.push(e)},removeEffect:function(t){-1!=(e=this.postEffectList.indexOf(t))&&this.postEffectList.splice(e,1)},bind:function(e){this.frameBuffer.bind(e)},unbind:function(e){this.frameBuffer.unbind(e)}},Object.freeze(RedPostEffectManager)}(),function(){var e,t,r;RedPostEffect_Bloom=function(t){if(!(this instanceof RedPostEffect_Bloom))return new RedPostEffect_Bloom(t);var r;t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Bloom : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.blurTexture=null,this.program=e(t),this._UUID=RedGL.makeUUID(),this.process=[RedPostEffect_BloomThreshold(t),RedPostEffect_BlurX(t),RedPostEffect_BlurY(t)],Object.defineProperty(this,"blur",(r=1,{get:function(){return r},set:function(e){r=e,this.process[1].size=r,this.process[2].size=r}})),this.blur=20,this.exposure=1,this.bloomStrength=1.2,Object.defineProperty(this,"threshold",function(){var e=.3;return{get:function(){return e},set:function(t){this.process[0].threshold=e=t}}}()),this.threshold=.3,this.updateTexture=function(e,t){this.diffuseTexture=t,this.blurTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform sampler2D uBlurTexture;
uniform float uExposure;
uniform float uBloomStrength;
void main() {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
vec4 thresholdColor = finalColor;
vec4 blurColor = texture2D(uBlurTexture, vTexcoord);
gl_FragColor = (finalColor  + blurColor * uBloomStrength) * uExposure ;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_Bloom_Program",t,r)},RedPostEffect_Bloom.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_Bloom)}(),function(){var e,t,r;RedPostEffect_BloomThreshold=function(t){if(!(this instanceof RedPostEffect_BloomThreshold))return new RedPostEffect_BloomThreshold(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BloomThreshold : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.threshold=.24,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision highp float;
uniform sampler2D uDiffuseTexture;
uniform float uThreshold;
void main() {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
if(0.2126 * finalColor.r + 0.7152 * finalColor.g + 0.0722 * finalColor.b < uThreshold)  finalColor.r = finalColor.g = finalColor.b = 0.0;
gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_BloomThreshold_Program",t,r)},RedPostEffect_BloomThreshold.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_BloomThreshold)}(),function(){var e,t,r;RedPostEffect_Blur=function(t){if(!(this instanceof RedPostEffect_Blur))return new RedPostEffect_Blur(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Blur : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
void main(void) {
vec2 px = vec2(1.0/vResolution.x, 1.0/vResolution.y);
vec4 finalColor = vec4(0.0);
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-7.0*px.x, -7.0*px.y))*0.0044299121055113265;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-6.0*px.x, -6.0*px.y))*0.00895781211794;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-5.0*px.x, -5.0*px.y))*0.0215963866053;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-4.0*px.x, -4.0*px.y))*0.0443683338718;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-3.0*px.x, -3.0*px.y))*0.0776744219933;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-2.0*px.x, -2.0*px.y))*0.115876621105;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2(-1.0*px.x, -1.0*px.y))*0.147308056121;
finalColor += texture2D(uDiffuseTexture, vTexcoord                             )*0.159576912161;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 1.0*px.x,  1.0*px.y))*0.147308056121;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 2.0*px.x,  2.0*px.y))*0.115876621105;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 3.0*px.x,  3.0*px.y))*0.0776744219933;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 4.0*px.x,  4.0*px.y))*0.0443683338718;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 5.0*px.x,  5.0*px.y))*0.0215963866053;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 6.0*px.x,  6.0*px.y))*0.00895781211794;
finalColor += texture2D(uDiffuseTexture, vTexcoord + vec2( 7.0*px.x,  7.0*px.y))*0.0044299121055113265;
gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_Blur_Program",t,r)},RedPostEffect_Blur.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_Blur)}(),function(){var e,t,r;RedPostEffect_BlurX=function(t){if(!(this instanceof RedPostEffect_BlurX))return new RedPostEffect_BlurX(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BlurX : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.size=50,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float uSize;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main() {
vec4 finalColor = vec4(0.0);
vec2 delta;
float total = 0.0;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
delta = vec2(uSize/vResolution.x,0.0);
for (float t = -10.0; t <= 10.0; t++) {
float percent = (t + offset - 0.5) / 10.0;
float weight = 1.0 - abs(percent);
vec4 sample = texture2D(uDiffuseTexture, vTexcoord + delta * percent);
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
finalColor = finalColor / total;
finalColor.rgb /= finalColor.a + 0.00001;
gl_FragColor =  finalColor ;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_BlurX_Program",t,r)},RedPostEffect_BlurX.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_BlurX)}(),function(){var e,t,r;RedPostEffect_BlurY=function(t){if(!(this instanceof RedPostEffect_BlurY))return new RedPostEffect_BlurY(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BlurY : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.size=50,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float uSize;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main() {
vec4 finalColor = vec4(0.0);
vec2 delta;
float total = 0.0;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
delta = vec2(0.0, uSize/vResolution.y);
for (float t = -10.0; t <= 10.0; t++) {
float percent = (t + offset - 0.5) / 10.0;
float weight = 1.0 - abs(percent);
vec4 sample = texture2D(uDiffuseTexture, vTexcoord + delta * percent);
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
finalColor = finalColor / total;
finalColor.rgb /= finalColor.a + 0.00001;
gl_FragColor =   finalColor ;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_BlurY_Program",t,r)},RedPostEffect_BlurY.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_BlurY)}(),function(){var e,t,r,n;RedPostEffect_BrightnessContrast=function(t){if(!(this instanceof RedPostEffect_BrightnessContrast))return new RedPostEffect_BrightnessContrast(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BrightnessContrast : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.brightness=0,this.contrast=0,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float uBrightness;
uniform float uContrast;
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord );
finalColor.rgb += uBrightness;
if (uContrast > 0.0) finalColor.rgb = (finalColor.rgb - 0.5) / (1.0 - uContrast) + 0.5;
else finalColor.rgb = (finalColor.rgb - 0.5) * (1.0 + uContrast) + 0.5;
gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),n="RedPostEffect_BrightnessContrast_Program",e=function(e){return RedProgram(e,n,t,r)},RedPostEffect_BrightnessContrast.prototype=RedBaseMaterial.prototype,RedPostEffect_BrightnessContrast.NORMAL=[0,0,0,0,1,0,0,0,0],RedPostEffect_BrightnessContrast.SHARPEN=[0,-1,0,-1,5,-1,0,-1,0],RedPostEffect_BrightnessContrast.BLUR=[1,1,1,1,1,1,1,1,1],RedPostEffect_BrightnessContrast.EDGE=[0,1,0,1,-4,1,0,1,0],RedPostEffect_BrightnessContrast.EMBOSS=[-2,-1,0,-1,1,1,0,1,2],Object.freeze(RedPostEffect_BrightnessContrast)}(),function(){var e,t,r;RedPostEffect_Convolution=function(t,r){if(!(this instanceof RedPostEffect_Convolution))return new RedPostEffect_Convolution(t,r);var n,i;t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Convolution : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.kernel=r,Object.defineProperty(this,"kernel",{get:function(){return n||(n=RedPostEffect_Convolution.NORMAL),n},set:function(e){n=e}}),Object.defineProperty(this,"kernelWeight",{get:function(){for(var e in i=0,this.kernel)i+=this.kernel[e];return i}}),this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform mat3 uKernel;
uniform float uKernelWeight;
void main(void) {
vec2 perPX = vec2(1.0/vResolution.x, 1.0/vResolution.y);
vec4 finalColor = vec4(0.0);
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2(-1.0, -1.0)) * uKernel[0][0] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 0.0, -1.0)) * uKernel[0][1] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 1.0, -1.0)) * uKernel[0][2] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2(-1.0,  0.0)) * uKernel[1][0] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 0.0,  0.0)) * uKernel[1][1] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 1.0,  0.0)) * uKernel[1][2] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2(-1.0,  1.0)) * uKernel[2][0] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 0.0,  1.0)) * uKernel[2][1] ;
finalColor += texture2D(uDiffuseTexture, vTexcoord + perPX * vec2( 1.0,  1.0)) * uKernel[2][2] ;
highp float weight;
weight = uKernelWeight;
if (0.01 > weight) {
weight = 1.0;
}
gl_FragColor = vec4((finalColor / uKernelWeight).rgb, 1.0);
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_Convolution_Program",t,r)},RedPostEffect_Convolution.prototype=RedBaseMaterial.prototype,RedPostEffect_Convolution.NORMAL=[0,0,0,0,1,0,0,0,0],RedPostEffect_Convolution.SHARPEN=[0,-1,0,-1,5,-1,0,-1,0],RedPostEffect_Convolution.BLUR=[1,1,1,1,1,1,1,1,1],RedPostEffect_Convolution.EDGE=[0,1,0,1,-4,1,0,1,0],RedPostEffect_Convolution.EMBOSS=[-2,-1,0,-1,1,1,0,1,2],Object.freeze(RedPostEffect_Convolution)}(),function(){var e,t,r;RedPostEffect_DoF=function(t){if(!(this instanceof RedPostEffect_DoF))return new RedPostEffect_DoF(t);var r;t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_DoF : RedGL Instance만 허용됩니다.",t),this.subFrameBufferInfo={frameBuffer:RedFrameBuffer(t),renderMaterial:RedPostEffect_DoF_DepthMaterial(t),process:[]},this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.blurTexture=null,this.depthTexture=null,this.program=e(t),this._UUID=RedGL.makeUUID(),this.process=[RedPostEffect_BlurX(t),RedPostEffect_BlurY(t)],Object.defineProperty(this,"focusLength",{get:function(){return this.subFrameBufferInfo.renderMaterial.focusLength},set:function(e){this.subFrameBufferInfo.renderMaterial.focusLength=e}}),Object.defineProperty(this,"blur",(r=1,{get:function(){return r},set:function(e){r=e,this.process[0].size=r,this.process[1].size=r}})),this.blur=10,this.updateTexture=function(e,t){this.diffuseTexture=t,this.blurTexture=e,this.depthTexture=this.subFrameBufferInfo.frameBuffer.texture},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform sampler2D uBlurTexture;
uniform sampler2D uDepthTexture;
uniform float uDistance;
void main() {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
vec4 blurColor = texture2D(uBlurTexture, vTexcoord);
vec4 depthColor = texture2D(uDepthTexture, vTexcoord);
finalColor.rgb *= (depthColor.r);
blurColor.rgb *= (1.0-depthColor.r);
gl_FragColor =  (finalColor + blurColor) ;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_DoF_Program",t,r)},RedPostEffect_DoF.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_DoF)}(),function(){var e,t,r;RedPostEffect_DoF_DepthMaterial=function(t){if(!(this instanceof RedPostEffect_DoF_DepthMaterial))return new RedPostEffect_DoF_DepthMaterial(t);this.focusLength=15,this.program=e(t),this._UUID=RedGL.makeUUID(),this.checkProperty()},t=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
gl_PointSize = uPointSize;
if(uSprite3DYn) {
gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
if(!uPerspectiveScale){
gl_Position /= gl_Position.w;
gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1]);
}
}
else gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform float uFocusLength;
void main(void) {
float depth = 1.0 - gl_FragCoord.z / gl_FragCoord.w / uFocusLength;
gl_FragColor = vec4(depth, depth, depth, 1.0);
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_DoF_depthProgram",t,r)},RedPostEffect_DoF_DepthMaterial.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_DoF_DepthMaterial)}(),function(){var e,t,r;RedPostEffect_Film=function(t,r,n){if(!(this instanceof RedPostEffect_Film))return new RedPostEffect_Film(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Film : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.grayMode=!1,this.scanlineIntensity=.5,this.noiseIntensity=.5,this.scanlineCount=2048,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vTime = uTime;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform bool uGrayMode;
uniform sampler2D uDiffuseTexture;
// noise effect intensity value (0 = no effect, 1 = full effect)
uniform float uNoiseIntensity;
// scanlines effect intensity value (0 = no effect, 1 = full effect)
uniform float uScanlineIntensity;
// scanlines effect count value (0 = no effect, 4096 = full effect)
uniform float uScanlineCount;
void main() {
// sample the source
vec4 diffuseColor = texture2D( uDiffuseTexture, vTexcoord );
// make some noise
float x = vTexcoord.x * vTexcoord.y * vTime;
x = mod( x, 13.0 ) * mod( x, 123.0 );
float dx = mod( x, 0.01 );
// add noise
vec3 finalColor = diffuseColor.rgb + diffuseColor.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );
// get us a sine and cosine
vec2 sc = vec2( sin( vTexcoord.y * uScanlineCount ), cos( vTexcoord.y * uScanlineCount ) );
// add scanlines
finalColor += diffuseColor.rgb * vec3( sc.x, sc.y, sc.x ) * uScanlineIntensity;
// interpolate between source and result by intensity
finalColor = diffuseColor.rgb + clamp( uNoiseIntensity, 0.0, 1.0 ) * ( finalColor - diffuseColor.rgb );
// convert to grayscale if desired
if( uGrayMode ) finalColor = vec3( finalColor.r * 0.3 + finalColor.g * 0.59 + finalColor.b * 0.11 );
gl_FragColor =  vec4( finalColor, diffuseColor.a );
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_Film_Program",t,r)},RedPostEffect_Film.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_Film)}(),(RedPostEffect_GaussianBlur=function(e){if(!(this instanceof RedPostEffect_GaussianBlur))return new RedPostEffect_GaussianBlur(e);var t;e instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_GaussianBlur : RedGL Instance만 허용됩니다.",e),this._UUID=RedGL.makeUUID(),this.process=[RedPostEffect_BlurX(e),RedPostEffect_BlurY(e)],Object.defineProperty(this,"radius",(t=1,{get:function(){return t},set:function(e){t=e,this.process[0].size=t,this.process[1].size=t}})),this.radius=20}).prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_GaussianBlur),function(){var e,t,r;RedPostEffect_Gray=function(t){if(!(this instanceof RedPostEffect_Gray))return new RedPostEffect_Gray(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Gray : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
highp float gray = (finalColor.r  + finalColor.g + finalColor.b)/3.0;
gl_FragColor = vec4( gray, gray, gray, 1.0);
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_Gray_Program",t,r)},RedPostEffect_Gray.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_Gray)}(),function(){var e,t,r;RedPostEffect_HalfTone=function(t){if(!(this instanceof RedPostEffect_HalfTone))return new RedPostEffect_HalfTone(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_HalfTone : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.centerX=0,this.centerY=0,this.angle=0,this.radius=2,this.grayMode=!1,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float uCenterX;
uniform float uCenterY;
uniform float uAngle;
uniform float uRadius;
uniform bool uGrayMode;
float pattern(float angle) {
angle = angle * 3.141592653589793/180.0;
float s = sin(angle), c = cos(angle);
vec2 tex = vTexcoord;
tex.x -= uCenterX + 0.5;
tex.y -= uCenterY + 0.5;
vec2 point = vec2(
c * tex.x - s * tex.y,
s * tex.x + c * tex.y
) * vResolution / uRadius;
return (sin(point.x) * sin(point.y)) * 4.0;
}
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
if(uGrayMode) {
float average = (finalColor.r + finalColor.g + finalColor.b) / 3.0;
gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern(uAngle)), finalColor.a);
}else{
vec3 cmy = 1.0 - finalColor.rgb;
float k = min(cmy.x, min(cmy.y, cmy.z));
cmy = (cmy - k) / (1.0 - k);
cmy = clamp(cmy * 10.0 - 3.0 + vec3(pattern(uAngle + 0.26179), pattern(uAngle + 1.30899), pattern(uAngle)), 0.0, 1.0);
k = clamp(k * 10.0 - 5.0 + pattern(uAngle + 0.78539), 0.0, 1.0);
gl_FragColor = vec4(1.0 - cmy - k, finalColor.a);
}
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_HalfTone_Program",t,r)},RedPostEffect_HalfTone.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_HalfTone)}(),function(){var e,t,r;RedPostEffect_HueSaturation=function(t){if(!(this instanceof RedPostEffect_HueSaturation))return new RedPostEffect_HueSaturation(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_HueSaturation : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.hue=0,this.saturation=0,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float uHue;
uniform float uSaturation;
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord );
float angle = uHue * 3.14159265;
float s = sin(angle), c = cos(angle);
vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;
float len = length(finalColor.rgb);
finalColor.rgb = vec3(
dot(finalColor.rgb, weights.xyz),
dot(finalColor.rgb, weights.zxy),
dot(finalColor.rgb, weights.yzx)
);
float average = (finalColor.r + finalColor.g + finalColor.b) / 3.0;
if (uSaturation > 0.0) finalColor.rgb += (average - finalColor.rgb) * (1.0 - 1.0 / (1.001 - uSaturation));
else finalColor.rgb += (average - finalColor.rgb) * (-uSaturation);
gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_HueSaturation_Program",t,r)},RedPostEffect_HueSaturation.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_HueSaturation)}(),function(){var e,t,r;RedPostEffect_Invert=function(t){if(!(this instanceof RedPostEffect_Invert))return new RedPostEffect_Invert(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Invert : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
finalColor.r = 1.0 - finalColor.r;
finalColor.g = 1.0 - finalColor.g;
finalColor.b = 1.0 - finalColor.b;
gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_Invert_Program",t,r)},RedPostEffect_Invert.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_Invert)}(),function(){var e,t,r;RedPostEffect_Pixelize=function(t){if(!(this instanceof RedPostEffect_Pixelize))return new RedPostEffect_Pixelize(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Pixelize : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.width=5,this.height=5,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float uWidth;
uniform float uHeight;
void main(void) {
vec4 finalColor;
float dx = 1.0/vResolution.x * uWidth;
float dy = 1.0/vResolution.y * uHeight;
vec2 coord = vec2(
dx * (floor(vTexcoord.x / dx) + 0.5),
dy * (floor(vTexcoord.y / dy) + 0.5)
);
finalColor = texture2D(uDiffuseTexture, coord);
gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_Pixelize_Program",t,r)},RedPostEffect_Pixelize.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_Pixelize)}(),function(){var e,t,r;RedPostEffect_Threshold=function(t){if(!(this instanceof RedPostEffect_Threshold))return new RedPostEffect_Threshold(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Threshold : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.program=e(t),this._UUID=RedGL.makeUUID(),this.threshold=.24,this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision highp float;
uniform sampler2D uDiffuseTexture;
uniform float uThreshold;
void main() {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord);
float v;
if(0.2126 * finalColor.r + 0.7152 * finalColor.g + 0.0722 * finalColor.b >= uThreshold) v = 1.0;
else v = 0.0;
finalColor.r = finalColor.g = finalColor.b = v;
gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_Threshold_Program",t,r)},RedPostEffect_Threshold.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_Threshold)}(),function(){var e,t,r;RedPostEffect_Vignetting=function(t){if(!(this instanceof RedPostEffect_Vignetting))return new RedPostEffect_Vignetting(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Vignetting : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.size=.1,this.indensity=.85,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float uSize;
uniform float uIndensity;
void main(void) {
vec4 finalColor = texture2D(uDiffuseTexture, vTexcoord );
float dist = distance(vTexcoord, vec2(0.5, 0.5));
finalColor.rgb *= smoothstep(0.8, uSize * 0.799, dist * (uIndensity + uSize));
gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_Vignetting_Program",t,r)},RedPostEffect_Vignetting.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_Vignetting)}(),function(){var e,t,r;RedPostEffect_ZoomBlur=function(t){if(!(this instanceof RedPostEffect_ZoomBlur))return new RedPostEffect_ZoomBlur(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_ZoomBlur : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.centerX=0,this.centerY=0,this.strength=.15,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
uniform float uCenterX;
uniform float uCenterY;
uniform float uStrength;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main(void) {
vec4 finalColor = vec4(0.0);
vec2 center = vec2(uCenterX+0.5,-uCenterY+0.5);
vec2 toCenter = center - vTexcoord ;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
float total = 0.0;
for (float t = 0.0; t <= 30.0; t++) {
float percent = (t + offset) / 30.0;
float weight = 3.0 * (percent - percent * percent);
vec4 sample = texture2D(uDiffuseTexture, vTexcoord + toCenter * percent * uStrength );
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
gl_FragColor = finalColor / total;
gl_FragColor.rgb /= gl_FragColor.a + 0.00001;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_ZoomBlur_Program",t,r)},RedPostEffect_ZoomBlur.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_ZoomBlur)}(),function(){var e,t,r;RedPostEffect_FXAA=function(t){if(!(this instanceof RedPostEffect_FXAA))return new RedPostEffect_FXAA(t);t instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_FXAA : RedGL Instance만 허용됩니다.",t),this.frameBuffer=RedFrameBuffer(t),this.diffuseTexture=null,this.program=e(t),this._UUID=RedGL.makeUUID(),this.updateTexture=function(e){this.diffuseTexture=e},this.bind=RedPostEffectManager.prototype.bind,this.unbind=RedPostEffectManager.prototype.unbind,this.checkProperty()},t=function(){
/* @preserve
void main(void) {
vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},r=function(){
/* @preserve
precision mediump float;
uniform sampler2D uDiffuseTexture;
const float FXAA_REDUCE_MIN = 1.0/ 128.0;
const float FXAA_REDUCE_MUL = 1.0 / 8.0;
const float FXAA_SPAN_MAX = 8.0;
void main() {
vec4 finalColor;
vec2 inverseVP = vec2(1.0 / vResolution.x, 1.0 / vResolution.y);
vec2 fragCoord = gl_FragCoord.xy;
vec3 rgbNW = texture2D(uDiffuseTexture, (fragCoord + vec2(-1.0, -1.0)) * inverseVP).xyz;
vec3 rgbNE = texture2D(uDiffuseTexture, (fragCoord + vec2(1.0, -1.0)) * inverseVP).xyz;
vec3 rgbSW = texture2D(uDiffuseTexture, (fragCoord + vec2(-1.0, 1.0)) * inverseVP).xyz;
vec3 rgbSE = texture2D(uDiffuseTexture, (fragCoord + vec2(1.0, 1.0)) * inverseVP).xyz;
vec3 rgbM  = texture2D(uDiffuseTexture, fragCoord  * inverseVP).xyz;
vec3 luma = vec3(0.299, 0.587, 0.114);
float lumaNW = dot(rgbNW, luma);
float lumaNE = dot(rgbNE, luma);
float lumaSW = dot(rgbSW, luma);
float lumaSE = dot(rgbSE, luma);
float lumaM  = dot(rgbM,  luma);
float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));
vec2 dir;
dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));
float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);
float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
dir = min(
vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)
) * inverseVP;
vec3 rgbA = 0.5 * (
texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz
);
vec3 rgbB = rgbA * 0.5 + 0.25 * (
texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * -0.5).xyz +
texture2D(uDiffuseTexture, fragCoord * inverseVP + dir * 0.5).xyz
);
float lumaB = dot(rgbB, luma);
if ((lumaB < lumaMin) || (lumaB > lumaMax)) finalColor = vec4(rgbA, 1.0);
else finalColor = vec4(rgbB, 1.0);
gl_FragColor = finalColor;
}
*/},t=RedGLUtil.getStrFromComment(t.toString()),r=RedGLUtil.getStrFromComment(r.toString()),e=function(e){return RedProgram(e,"RedPostEffect_FXAA_Program",t,r)},RedPostEffect_FXAA.prototype=RedBaseMaterial.prototype,Object.freeze(RedPostEffect_FXAA)}();console.log('RedGL Release. last update(2018-06-01 09:40:48)');