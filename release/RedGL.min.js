var RedDefinePropertyInfo,RedGLDetect,RedGLUtil,RedGL,RedBaseController,RedBaseTexture,RedBaseObject3D,RedBaseContainer,RedBaseLight,RedFrameBuffer,RedBuffer,RedGeometry,RedInterleaveInfo,RedBaseMaterial,RedAtlas,RedAtlasUV,RedTextureOptionChecker,RedBitmapTexture,RedVideoTexture,RedAtlasTexture,RedDDSTexture,RedBitmapCubeTexture,RedColorMaterial,RedColorPhongMaterial,RedColorPhongTextureMaterial,RedEnvironmentMaterial,RedBitmapMaterial,RedParticleColorMaterial,RedParticleBitmapMaterial,RedPointColorMaterial,RedPointBitmapMaterial,RedSheetMaterial,RedStandardMaterial,RedVideoMaterial,RedAmbientLight,RedDirectionalLight,RedPointLight,JsonModelLoader,RedMTLLoader,RedOBJLoader,RedDAELoader,RedAxis,RedGrid,RedMesh,RedLine,RedSkyBox,RedSprite3D,RedPointUnit,RedParticleUnit,RedParticleEmitter,RedBox,RedPlane,RedSphere,RedProgram,RedSystemShaderCode,RedShader,RedRenderer,RedRenderDebuger,RedSystemUniformUpdater,RedView,RedWorld,RedScene,RedCamera,RedBasicController,RedObitController,RedGridMaterial,RedSkyBoxMaterial,RedDirectionalShadowMaterial,RedPostEffectMaterial,RedDirectionalShadow,RedShadowManager,RedText,RedPostEffectManager,RedBasePostEffect,RedPostEffect_Bloom,RedPostEffect_BloomThreshold,RedPostEffect_Blur,RedPostEffect_BlurX,RedPostEffect_BlurY,RedPostEffect_GaussianBlur,RedPostEffect_ZoomBlur,RedPostEffect_BrightnessContrast,RedPostEffect_Threshold,RedPostEffect_Invert,RedPostEffect_Gray,RedPostEffect_HueSaturation,RedPostEffect_HalfTone,RedPostEffect_Pixelize,RedPostEffect_Convolution,RedPostEffect_DoF,RedPostEffect_DoF_DepthMaterial,RedPostEffect_Film,RedPostEffect_Vignetting,RedPostEffect_FXAA;!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=function(e){t.ARRAY_TYPE=e},t.toRadian=function(e){return e*i},t.equals=function(e,t){return Math.abs(e-t)<=n*Math.max(1,Math.abs(e),Math.abs(t))};var n=t.EPSILON=1e-6,i=(t.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,t.RANDOM=Math.random,Math.PI/180)},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],l=r[0],h=r[1],R=r[2],m=r[3],p=r[4],_=r[5],P=r[6],g=r[7],E=r[8];return e[0]=l*n+h*o+R*f,e[1]=l*i+h*s+R*c,e[2]=l*a+h*d+R*u,e[3]=m*n+p*o+_*f,e[4]=m*i+p*s+_*c,e[5]=m*a+p*d+_*u,e[6]=P*n+g*o+E*f,e[7]=P*i+g*s+E*c,e[8]=P*a+g*d+E*u,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},t.clone=function(e){var t=new a.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromValues=function(e,t,r,n,i,o,s,d,f){var c=new a.ARRAY_TYPE(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c[4]=i,c[5]=o,c[6]=s,c[7]=d,c[8]=f,c},t.set=function(e,t,r,n,i,a,o,s,d,f){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=d,e[8]=f,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=c*o-s*f,l=-c*a+s*d,h=f*a-o*d,R=r*u+n*l+i*h;return R?(R=1/R,e[0]=u*R,e[1]=(-c*n+i*f)*R,e[2]=(s*n-i*o)*R,e[3]=l*R,e[4]=(c*r-i*d)*R,e[5]=(-s*r+i*a)*R,e[6]=h*R,e[7]=(-f*r+n*d)*R,e[8]=(o*r-n*a)*R,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8];return e[0]=o*c-s*f,e[1]=i*f-n*c,e[2]=n*s-i*o,e[3]=s*d-a*c,e[4]=r*c-i*d,e[5]=i*a-r*s,e[6]=a*f-o*d,e[7]=n*d-r*f,e[8]=r*o-n*a,e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],d=e[7],f=e[8];return t*(f*a-o*d)+r*(-f*i+o*s)+n*(d*i-a*s)},t.multiply=n,t.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],l=r[0],h=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=d,e[6]=l*n+h*o+f,e[7]=l*i+h*s+c,e[8]=l*a+h*d+u,e},t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],l=Math.sin(r),h=Math.cos(r);return e[0]=h*n+l*o,e[1]=h*i+l*s,e[2]=h*a+l*d,e[3]=h*o-l*n,e[4]=h*s-l*i,e[5]=h*d-l*a,e[6]=f,e[7]=c,e[8]=u,e},t.scale=function(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,d=i+i,f=r*o,c=n*o,u=n*s,l=i*o,h=i*s,R=i*d,m=a*o,p=a*s,_=a*d;return e[0]=1-u-R,e[3]=c-_,e[6]=l+p,e[1]=c+_,e[4]=1-f-R,e[7]=h-m,e[2]=l-p,e[5]=h+m,e[8]=1-f-u,e},t.normalFromMat4=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=t[9],l=t[10],h=t[11],R=t[12],m=t[13],p=t[14],_=t[15],P=r*s-n*o,g=r*d-i*o,E=r*f-a*o,y=n*d-i*s,M=n*f-a*s,T=i*f-a*d,v=c*m-u*R,b=c*p-l*R,L=c*_-h*R,w=u*p-l*m,x=u*_-h*m,U=l*_-h*p,I=P*U-g*x+E*w+y*L-M*b+T*v;return I?(I=1/I,e[0]=(s*U-d*x+f*w)*I,e[1]=(d*L-o*U-f*b)*I,e[2]=(o*x-s*L+f*v)*I,e[3]=(i*x-n*U-a*w)*I,e[4]=(r*U-i*L+a*b)*I,e[5]=(n*L-r*x-a*v)*I,e[6]=(m*T-p*M+_*y)*I,e[7]=(p*E-R*T-_*g)*I,e[8]=(R*M-m*E+_*P)*I,e):null},t.projection=function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},t.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],d=e[5],f=e[6],c=e[7],u=e[8],l=t[0],h=t[1],R=t[2],m=t[3],p=t[4],_=t[5],P=t[6],g=t[7],E=t[8];return Math.abs(r-l)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-h)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-R)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(R))&&Math.abs(o-m)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-p)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(d-_)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(_))&&Math.abs(f-P)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(c-g)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(u-E)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(){var e=new R.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e}function i(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function a(e,t,r){var n=new R.ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=r,n}function o(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function s(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function d(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function f(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function c(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function u(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function l(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function h(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=function(e){var t=new R.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.length=i,t.fromValues=a,t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},t.subtract=o,t.multiply=s,t.divide=d,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},t.distance=f,t.squaredDistance=c,t.squaredLength=u,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=l,t.dot=h,t.cross=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],d=r[2];return e[0]=i*d-a*s,e[1]=a*o-n*d,e[2]=n*s-i*o,e},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e},t.hermite=function(e,t,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,d=o*(a-2)+a,f=o*(a-1),c=o*(3-2*a);return e[0]=t[0]*s+r[0]*d+n[0]*f+i[0]*c,e[1]=t[1]*s+r[1]*d+n[1]*f+i[1]*c,e[2]=t[2]*s+r[2]*d+n[2]*f+i[2]*c,e},t.bezier=function(e,t,r,n,i,a){var o=1-a,s=o*o,d=a*a,f=s*o,c=3*a*s,u=3*d*o,l=d*a;return e[0]=t[0]*f+r[0]*c+n[0]*u+i[0]*l,e[1]=t[1]*f+r[1]*c+n[1]*u+i[1]*l,e[2]=t[2]*f+r[2]*c+n[2]*u+i[2]*l,e},t.random=function(e,t){t=t||1;var r=2*R.RANDOM()*Math.PI,n=2*R.RANDOM()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e},t.transformMat3=function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],d=r[2],f=r[3],c=f*n+s*a-d*i,u=f*i+d*n-o*a,l=f*a+o*i-s*n,h=-o*n-s*i-d*a;return e[0]=c*f+h*-o+u*-d-l*-s,e[1]=u*f+h*-s+l*-o-c*-d,e[2]=l*f+h*-d+c*-s-u*-o,e},t.rotateX=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateY=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateZ=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.angle=function(e,t){var r=a(e[0],e[1],e[2]),n=a(t[0],t[1],t[2]);l(r,r),l(n,n);var i=h(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(r-a)<=R.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=R.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=R.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))};var R=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=o,t.mul=s,t.div=d,t.dist=f,t.sqrDist=c,t.len=i,t.sqrLen=u,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,d=void 0;for(r||(r=3),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,d=n;d<s;d+=r)e[0]=t[d],e[1]=t[d+1],e[2]=t[d+2],a(e,e,o),t[d]=e[0],t[d+1]=e[1],t[d+2]=e[2];return t}}()},function(e,t,r){"use strict";function n(){var e=new h.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function s(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function d(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+a*a)}function f(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a}function c(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function u(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function l(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o),e}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=function(e){var t=new h.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,r,n){var i=new h.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=i,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=s,t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},t.distance=d,t.squaredDistance=f,t.length=c,t.squaredLength=u,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=l,t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e},t.random=function(e,t){return t=t||1,e[0]=h.RANDOM(),e[1]=h.RANDOM(),e[2]=h.RANDOM(),e[3]=h.RANDOM(),l(e,e),s(e,e,t),e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],d=r[2],f=r[3],c=f*n+s*a-d*i,u=f*i+d*n-o*a,l=f*a+o*i-s*n,h=-o*n-s*i-d*a;return e[0]=c*f+h*-o+u*-d-l*-s,e[1]=u*f+h*-s+l*-o-c*-d,e[2]=l*f+h*-d+c*-s-u*-o,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=t[0],s=t[1],d=t[2],f=t[3];return Math.abs(r-o)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-d)<=h.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-f)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))};var h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=i,t.mul=a,t.div=o,t.dist=d,t.sqrDist=f,t.len=c,t.sqrLen=u,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,d=void 0;for(r||(r=4),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,d=n;d<s;d+=r)e[0]=t[d],e[1]=t[d+1],e[2]=t[d+2],e[3]=t[d+3],a(e,e,o),t[d]=e[0],t[d+1]=e[1],t[d+2]=e[2],t[d+3]=e[3];return t}}()},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=t.vec3=t.vec2=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.glMatrix=void 0;var i=n(r(0)),a=n(r(5)),o=n(r(6)),s=n(r(1)),d=n(r(7)),f=n(r(8)),c=n(r(9)),u=n(r(2)),l=n(r(3));t.glMatrix=i,t.mat2=a,t.mat2d=o,t.mat3=s,t.mat4=d,t.quat=f,t.vec2=c,t.vec3=u,t.vec4=l},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],d=r[1],f=r[2],c=r[3];return e[0]=n*s+a*d,e[1]=i*s+o*d,e[2]=n*f+a*c,e[3]=i*f+o*c,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.fromValues=function(e,t,r,n){var i=new a.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},t.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},t.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*a-i*n;return o?(o=1/o,e[0]=a*o,e[1]=-n*o,e[2]=-i*o,e[3]=r*o,e):null},t.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},t.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},t.multiply=n,t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=n*d+a*s,e[1]=i*d+o*s,e[2]=n*-s+a*d,e[3]=i*-s+o*d,e},t.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],d=r[1];return e[0]=n*s,e[1]=i*s,e[2]=a*d,e[3]=o*d,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},t.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},t.LDU=function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=i,t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=t[0],d=t[1],f=t[2],c=t[3];return Math.abs(r-s)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-d)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(i-f)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-c)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=r[0],c=r[1],u=r[2],l=r[3],h=r[4],R=r[5];return e[0]=n*f+a*c,e[1]=i*f+o*c,e[2]=n*u+a*l,e[3]=i*u+o*l,e[4]=n*h+a*R+s,e[5]=i*h+o*R+d,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.clone=function(e){var t=new a.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.fromValues=function(e,t,r,n,i,o){var s=new a.ARRAY_TYPE(6);return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s},t.set=function(e,t,r,n,i,a,o){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=r*a-n*i;return d?(d=1/d,e[0]=a*d,e[1]=-n*d,e[2]=-i*d,e[3]=r*d,e[4]=(i*s-a*o)*d,e[5]=(n*o-r*s)*d,e):null},t.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},t.multiply=n,t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=Math.sin(r),c=Math.cos(r);return e[0]=n*c+a*f,e[1]=i*c+o*f,e[2]=n*-f+a*c,e[3]=i*-f+o*c,e[4]=s,e[5]=d,e},t.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=r[0],c=r[1];return e[0]=n*f,e[1]=i*f,e[2]=a*c,e[3]=o*c,e[4]=s,e[5]=d,e},t.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=r[0],c=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=n*f+a*c+s,e[5]=i*f+o*c+d,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},t.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],d=e[5],f=t[0],c=t[1],u=t[2],l=t[3],h=t[4],R=t[5];return Math.abs(r-f)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-c)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-u)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-l)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(s-h)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(d-R)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],l=t[9],h=t[10],R=t[11],m=t[12],p=t[13],_=t[14],P=t[15],g=r[0],E=r[1],y=r[2],M=r[3];return e[0]=g*n+E*s+y*u+M*m,e[1]=g*i+E*d+y*l+M*p,e[2]=g*a+E*f+y*h+M*_,e[3]=g*o+E*c+y*R+M*P,g=r[4],E=r[5],y=r[6],M=r[7],e[4]=g*n+E*s+y*u+M*m,e[5]=g*i+E*d+y*l+M*p,e[6]=g*a+E*f+y*h+M*_,e[7]=g*o+E*c+y*R+M*P,g=r[8],E=r[9],y=r[10],M=r[11],e[8]=g*n+E*s+y*u+M*m,e[9]=g*i+E*d+y*l+M*p,e[10]=g*a+E*f+y*h+M*_,e[11]=g*o+E*c+y*R+M*P,g=r[12],E=r[13],y=r[14],M=r[15],e[12]=g*n+E*s+y*u+M*m,e[13]=g*i+E*d+y*l+M*p,e[14]=g*a+E*f+y*h+M*_,e[15]=g*o+E*c+y*R+M*P,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.fromValues=function(e,t,r,n,i,o,s,d,f,c,u,l,h,R,m,p){var _=new a.ARRAY_TYPE(16);return _[0]=e,_[1]=t,_[2]=r,_[3]=n,_[4]=i,_[5]=o,_[6]=s,_[7]=d,_[8]=f,_[9]=c,_[10]=u,_[11]=l,_[12]=h,_[13]=R,_[14]=m,_[15]=p,_},t.set=function(e,t,r,n,i,a,o,s,d,f,c,u,l,h,R,m,p){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=d,e[8]=f,e[9]=c,e[10]=u,e[11]=l,e[12]=h,e[13]=R,e[14]=m,e[15]=p,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=t[9],l=t[10],h=t[11],R=t[12],m=t[13],p=t[14],_=t[15],P=r*s-n*o,g=r*d-i*o,E=r*f-a*o,y=n*d-i*s,M=n*f-a*s,T=i*f-a*d,v=c*m-u*R,b=c*p-l*R,L=c*_-h*R,w=u*p-l*m,x=u*_-h*m,U=l*_-h*p,I=P*U-g*x+E*w+y*L-M*b+T*v;return I?(I=1/I,e[0]=(s*U-d*x+f*w)*I,e[1]=(i*x-n*U-a*w)*I,e[2]=(m*T-p*M+_*y)*I,e[3]=(l*M-u*T-h*y)*I,e[4]=(d*L-o*U-f*b)*I,e[5]=(r*U-i*L+a*b)*I,e[6]=(p*E-R*T-_*g)*I,e[7]=(c*T-l*E+h*g)*I,e[8]=(o*x-s*L+f*v)*I,e[9]=(n*L-r*x-a*v)*I,e[10]=(R*M-m*E+_*P)*I,e[11]=(u*E-c*M-h*P)*I,e[12]=(s*b-o*w-d*v)*I,e[13]=(r*w-n*b+i*v)*I,e[14]=(m*g-R*y-p*P)*I,e[15]=(c*y-u*g+l*P)*I,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=t[9],l=t[10],h=t[11],R=t[12],m=t[13],p=t[14],_=t[15];return e[0]=s*(l*_-h*p)-u*(d*_-f*p)+m*(d*h-f*l),e[1]=-(n*(l*_-h*p)-u*(i*_-a*p)+m*(i*h-a*l)),e[2]=n*(d*_-f*p)-s*(i*_-a*p)+m*(i*f-a*d),e[3]=-(n*(d*h-f*l)-s*(i*h-a*l)+u*(i*f-a*d)),e[4]=-(o*(l*_-h*p)-c*(d*_-f*p)+R*(d*h-f*l)),e[5]=r*(l*_-h*p)-c*(i*_-a*p)+R*(i*h-a*l),e[6]=-(r*(d*_-f*p)-o*(i*_-a*p)+R*(i*f-a*d)),e[7]=r*(d*h-f*l)-o*(i*h-a*l)+c*(i*f-a*d),e[8]=o*(u*_-h*m)-c*(s*_-f*m)+R*(s*h-f*u),e[9]=-(r*(u*_-h*m)-c*(n*_-a*m)+R*(n*h-a*u)),e[10]=r*(s*_-f*m)-o*(n*_-a*m)+R*(n*f-a*s),e[11]=-(r*(s*h-f*u)-o*(n*h-a*u)+c*(n*f-a*s)),e[12]=-(o*(u*p-l*m)-c*(s*p-d*m)+R*(s*l-d*u)),e[13]=r*(u*p-l*m)-c*(n*p-i*m)+R*(n*l-i*u),e[14]=-(r*(s*p-d*m)-o*(n*p-i*m)+R*(n*d-i*s)),e[15]=r*(s*l-d*u)-o*(n*l-i*u)+c*(n*d-i*s),e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],d=e[7],f=e[8],c=e[9],u=e[10],l=e[11],h=e[12],R=e[13],m=e[14],p=e[15];return(t*o-r*a)*(u*p-l*m)-(t*s-n*a)*(c*p-l*R)+(t*d-i*a)*(c*m-u*R)+(r*s-n*o)*(f*p-l*h)-(r*d-i*o)*(f*m-u*h)+(n*d-i*s)*(f*R-c*h)},t.multiply=n,t.translate=function(e,t,r){var n=r[0],i=r[1],a=r[2],o=void 0,s=void 0,d=void 0,f=void 0,c=void 0,u=void 0,l=void 0,h=void 0,R=void 0,m=void 0,p=void 0,_=void 0;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],d=t[2],f=t[3],c=t[4],u=t[5],l=t[6],h=t[7],R=t[8],m=t[9],p=t[10],_=t[11],e[0]=o,e[1]=s,e[2]=d,e[3]=f,e[4]=c,e[5]=u,e[6]=l,e[7]=h,e[8]=R,e[9]=m,e[10]=p,e[11]=_,e[12]=o*n+c*i+R*a+t[12],e[13]=s*n+u*i+m*a+t[13],e[14]=d*n+l*i+p*a+t[14],e[15]=f*n+h*i+_*a+t[15]),e},t.scale=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,r,n){var i=n[0],o=n[1],s=n[2],d=Math.sqrt(i*i+o*o+s*s),f=void 0,c=void 0,u=void 0,l=void 0,h=void 0,R=void 0,m=void 0,p=void 0,_=void 0,P=void 0,g=void 0,E=void 0,y=void 0,M=void 0,T=void 0,v=void 0,b=void 0,L=void 0,w=void 0,x=void 0,U=void 0,I=void 0,D=void 0,B=void 0;return Math.abs(d)<a.EPSILON?null:(i*=d=1/d,o*=d,s*=d,f=Math.sin(r),u=1-(c=Math.cos(r)),l=t[0],h=t[1],R=t[2],m=t[3],p=t[4],_=t[5],P=t[6],g=t[7],E=t[8],y=t[9],M=t[10],T=t[11],v=i*i*u+c,b=o*i*u+s*f,L=s*i*u-o*f,w=i*o*u-s*f,x=o*o*u+c,U=s*o*u+i*f,I=i*s*u+o*f,D=o*s*u-i*f,B=s*s*u+c,e[0]=l*v+p*b+E*L,e[1]=h*v+_*b+y*L,e[2]=R*v+P*b+M*L,e[3]=m*v+g*b+T*L,e[4]=l*w+p*x+E*U,e[5]=h*w+_*x+y*U,e[6]=R*w+P*x+M*U,e[7]=m*w+g*x+T*U,e[8]=l*I+p*D+E*B,e[9]=h*I+_*D+y*B,e[10]=R*I+P*D+M*B,e[11]=m*I+g*D+T*B,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],d=t[7],f=t[8],c=t[9],u=t[10],l=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+f*n,e[5]=o*i+c*n,e[6]=s*i+u*n,e[7]=d*i+l*n,e[8]=f*i-a*n,e[9]=c*i-o*n,e[10]=u*i-s*n,e[11]=l*i-d*n,e},t.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],d=t[3],f=t[8],c=t[9],u=t[10],l=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-f*n,e[1]=o*i-c*n,e[2]=s*i-u*n,e[3]=d*i-l*n,e[8]=a*n+f*i,e[9]=o*n+c*i,e[10]=s*n+u*i,e[11]=d*n+l*i,e},t.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],d=t[3],f=t[4],c=t[5],u=t[6],l=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+f*n,e[1]=o*i+c*n,e[2]=s*i+u*n,e[3]=d*i+l*n,e[4]=f*i-a*n,e[5]=c*i-o*n,e[6]=u*i-s*n,e[7]=l*i-d*n,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,r){var n=r[0],i=r[1],o=r[2],s=Math.sqrt(n*n+i*i+o*o),d=void 0,f=void 0,c=void 0;return Math.abs(s)<a.EPSILON?null:(n*=s=1/s,i*=s,o*=s,d=Math.sin(t),c=1-(f=Math.cos(t)),e[0]=n*n*c+f,e[1]=i*n*c+o*d,e[2]=o*n*c-i*d,e[3]=0,e[4]=n*i*c-o*d,e[5]=i*i*c+f,e[6]=o*i*c+n*d,e[7]=0,e[8]=n*o*c+i*d,e[9]=i*o*c-n*d,e[10]=o*o*c+f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,d=i+i,f=a+a,c=n*s,u=n*d,l=n*f,h=i*d,R=i*f,m=a*f,p=o*s,_=o*d,P=o*f;return e[0]=1-(h+m),e[1]=u+P,e[2]=l-_,e[3]=0,e[4]=u-P,e[5]=1-(c+m),e[6]=R+p,e[7]=0,e[8]=l+_,e[9]=R-p,e[10]=1-(c+h),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],d=t[8],f=t[9],c=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(d*d+f*f+c*c),e},t.getRotation=function(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},t.fromRotationTranslationScale=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],d=i+i,f=a+a,c=o+o,u=i*d,l=i*f,h=i*c,R=a*f,m=a*c,p=o*c,_=s*d,P=s*f,g=s*c,E=n[0],y=n[1],M=n[2];return e[0]=(1-(R+p))*E,e[1]=(l+g)*E,e[2]=(h-P)*E,e[3]=0,e[4]=(l-g)*y,e[5]=(1-(u+p))*y,e[6]=(m+_)*y,e[7]=0,e[8]=(h+P)*M,e[9]=(m-_)*M,e[10]=(1-(u+R))*M,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,r,n,i){var a=t[0],o=t[1],s=t[2],d=t[3],f=a+a,c=o+o,u=s+s,l=a*f,h=a*c,R=a*u,m=o*c,p=o*u,_=s*u,P=d*f,g=d*c,E=d*u,y=n[0],M=n[1],T=n[2],v=i[0],b=i[1],L=i[2];return e[0]=(1-(m+_))*y,e[1]=(h+E)*y,e[2]=(R-g)*y,e[3]=0,e[4]=(h-E)*M,e[5]=(1-(l+_))*M,e[6]=(p+P)*M,e[7]=0,e[8]=(R+g)*T,e[9]=(p-P)*T,e[10]=(1-(l+m))*T,e[11]=0,e[12]=r[0]+v-(e[0]*v+e[4]*b+e[8]*L),e[13]=r[1]+b-(e[1]*v+e[5]*b+e[9]*L),e[14]=r[2]+L-(e[2]*v+e[6]*b+e[10]*L),e[15]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,d=i+i,f=r*o,c=n*o,u=n*s,l=i*o,h=i*s,R=i*d,m=a*o,p=a*s,_=a*d;return e[0]=1-u-R,e[1]=c+_,e[2]=l-p,e[3]=0,e[4]=c-_,e[5]=1-f-R,e[6]=h+m,e[7]=0,e[8]=l+p,e[9]=h-m,e[10]=1-f-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,r,n,i,a,o){var s=1/(r-t),d=1/(i-n),f=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*d,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*d,e[10]=(o+a)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*f,e[15]=0,e},t.perspective=function(e,t,r,n,i){var a=1/Math.tan(t/2),o=1/(n-i);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*o,e[15]=0,e},t.perspectiveFromFieldOfView=function(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),d=2/(o+s),f=2/(i+a);return e[0]=d,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=-(o-s)*d*.5,e[9]=(i-a)*f*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},t.ortho=function(e,t,r,n,i,a,o){var s=1/(t-r),d=1/(n-i),f=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*d,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*d,e[14]=(o+a)*f,e[15]=1,e},t.lookAt=function(e,t,r,n){var i=void 0,o=void 0,s=void 0,d=void 0,f=void 0,c=void 0,u=void 0,l=void 0,h=void 0,R=void 0,m=t[0],p=t[1],_=t[2],P=n[0],g=n[1],E=n[2],y=r[0],M=r[1],T=r[2];return Math.abs(m-y)<a.EPSILON&&Math.abs(p-M)<a.EPSILON&&Math.abs(_-T)<a.EPSILON?mat4.identity(e):(u=m-y,l=p-M,h=_-T,i=g*(h*=R=1/Math.sqrt(u*u+l*l+h*h))-E*(l*=R),o=E*(u*=R)-P*h,s=P*l-g*u,(R=Math.sqrt(i*i+o*o+s*s))?(i*=R=1/R,o*=R,s*=R):(i=0,o=0,s=0),d=l*s-h*o,f=h*i-u*s,c=u*o-l*i,(R=Math.sqrt(d*d+f*f+c*c))?(d*=R=1/R,f*=R,c*=R):(d=0,f=0,c=0),e[0]=i,e[1]=d,e[2]=u,e[3]=0,e[4]=o,e[5]=f,e[6]=l,e[7]=0,e[8]=s,e[9]=c,e[10]=h,e[11]=0,e[12]=-(i*m+o*p+s*_),e[13]=-(d*m+f*p+c*_),e[14]=-(u*m+l*p+h*_),e[15]=1,e)},t.targetTo=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=n[0],d=n[1],f=n[2],c=i-r[0],u=a-r[1],l=o-r[2],h=c*c+u*u+l*l;h>0&&(c*=h=1/Math.sqrt(h),u*=h,l*=h);var R=d*l-f*u,m=f*c-s*l,p=s*u-d*c;return e[0]=R,e[1]=m,e[2]=p,e[3]=0,e[4]=u*p-l*m,e[5]=l*R-c*p,e[6]=c*m-u*R,e[7]=0,e[8]=c,e[9]=u,e[10]=l,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],d=e[5],f=e[6],c=e[7],u=e[8],l=e[9],h=e[10],R=e[11],m=e[12],p=e[13],_=e[14],P=e[15],g=t[0],E=t[1],y=t[2],M=t[3],T=t[4],v=t[5],b=t[6],L=t[7],w=t[8],x=t[9],U=t[10],I=t[11],D=t[12],B=t[13],A=t[14],S=t[15];return Math.abs(r-g)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-E)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(i-y)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(o-M)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(s-T)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(d-v)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(v))&&Math.abs(f-b)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(b))&&Math.abs(c-L)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(L))&&Math.abs(u-w)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(l-x)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(h-U)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(U))&&Math.abs(R-I)<=a.EPSILON*Math.max(1,Math.abs(R),Math.abs(I))&&Math.abs(m-D)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(p-B)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(_-A)<=a.EPSILON*Math.max(1,Math.abs(_),Math.abs(A))&&Math.abs(P-S)<=a.EPSILON*Math.max(1,Math.abs(P),Math.abs(S))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(){var e=new f.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function a(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function o(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],d=r[1],f=r[2],c=r[3];return e[0]=n*c+o*s+i*f-a*d,e[1]=i*c+o*d+a*s-n*f,e[2]=a*c+o*f+n*d-i*s,e[3]=o*c-n*s-i*d-a*f,e}function s(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],d=r[0],f=r[1],c=r[2],u=r[3],l=void 0,h=void 0,R=void 0,m=void 0,p=void 0;return(h=i*d+a*f+o*c+s*u)<0&&(h=-h,d=-d,f=-f,c=-c,u=-u),1-h>1e-6?(l=Math.acos(h),R=Math.sin(l),m=Math.sin((1-n)*l)/R,p=Math.sin(n*l)/R):(m=1-n,p=n),e[0]=m*i+p*d,e[1]=m*a+p*f,e[2]=m*o+p*c,e[3]=m*s+p*u,e}function d(e,t){var r=t[0]+t[4]+t[8],n=void 0;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=i,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},t.setAxisAngle=a,t.getAxisAngle=function(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return 0!=n?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r},t.multiply=o,t.rotateX=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=n*d+o*s,e[1]=i*d+a*s,e[2]=a*d-i*s,e[3]=o*d-n*s,e},t.rotateY=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=n*d-a*s,e[1]=i*d+o*s,e[2]=a*d+n*s,e[3]=o*d-i*s,e},t.rotateZ=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=n*d+i*s,e[1]=i*d-n*s,e[2]=a*d+o*s,e[3]=o*d-a*s,e},t.calculateW=function(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e},t.slerp=s,t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=a*s,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},t.fromMat3=d,t.fromEuler=function(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(r),d=Math.cos(r),f=Math.sin(n),c=Math.cos(n);return e[0]=a*d*c-o*s*f,e[1]=o*s*c+a*d*f,e[2]=o*d*f-a*s*c,e[3]=o*d*c+a*s*f,e},t.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"};var f=n(r(0)),c=n(r(1)),u=n(r(2)),l=n(r(3)),h=(t.clone=l.clone,t.fromValues=l.fromValues,t.copy=l.copy,t.set=l.set,t.add=l.add,t.mul=o,t.scale=l.scale,t.dot=l.dot,t.lerp=l.lerp,t.length=l.length),R=(t.len=h,t.squaredLength=l.squaredLength),m=(t.sqrLen=R,t.normalize=l.normalize);t.exactEquals=l.exactEquals,t.equals=l.equals,t.rotationTo=function(){var e=u.create(),t=u.fromValues(1,0,0),r=u.fromValues(0,1,0);return function(n,i,o){var s=u.dot(i,o);return s<-.999999?(u.cross(e,t,i),u.len(e)<1e-6&&u.cross(e,r,i),u.normalize(e,e),a(n,e,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(u.cross(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+s,m(n,n))}}(),t.sqlerp=function(){var e=i(),t=i();return function(r,n,i,a,o,d){return s(e,n,o,d),s(t,i,a,d),s(r,e,t,2*d*(1-d)),r}}(),t.setAxes=function(){var e=c.create();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],m(t,d(t,e))}}()},function(e,t,r){"use strict";function n(){var e=new u.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function s(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function d(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function f(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function c(e){var t=e[0],r=e[1];return t*t+r*r}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.sqrDist=t.dist=t.div=t.mul=t.sub=t.len=void 0,t.create=n,t.clone=function(e){var t=new u.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},t.fromValues=function(e,t){var r=new u.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},t.set=function(e,t,r){return e[0]=t,e[1]=r,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},t.subtract=i,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e},t.distance=s,t.squaredDistance=d,t.length=f,t.squaredLength=c,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},t.normalize=function(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},t.cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e},t.lerp=function(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e},t.random=function(e,t){t=t||1;var r=2*u.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},t.transformMat2=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e},t.transformMat2d=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e},t.transformMat3=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},t.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},t.equals=function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return Math.abs(r-i)<=u.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=u.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))};var u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.len=f,t.sub=i,t.mul=a,t.div=o,t.dist=s,t.sqrDist=d,t.sqrLen=c,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,d=void 0;for(r||(r=2),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,d=n;d<s;d+=r)e[0]=t[d],e[1]=t[d+1],a(e,e,o),t[d]=e[0],t[d+1]=e[1];return t}}()}])}),function(){var e;e=function(e,t,r,n,i){var a,o;switch(e.hasOwnProperty(r)&&RedGLUtil.throwFunc(t+" - "+r+" : 이미 정의된 속성"),n){case"hex":a={get:function(){return this["_"+r]},set:function(e){"string"==typeof e||RedGLUtil.throwFunc(t+" - "+r+" 문자열만 허용함","입력값 : "+e),RedGLUtil.regHex(e)||RedGLUtil.throwFunc(t+" - "+r+" : hex 형식만 허용함."+e),this["_"+r]=e,i&&i.callback&&i.callback.call(this,e)}};break;case"boolean":i=void 0==i||i,a={get:function(){return this["_"+r]},set:function(e){"boolean"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : boolean만 허용함."+e),this["_"+r]=e,i&&i.callback&&i.callback.call(this,e)}};break;case"number":if(i){var s=i.min,d=i.max;i.hasOwnProperty("min")&&i.hasOwnProperty("max")?a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함.","입력값 : "+e),e<s&&(e=s),e>d&&(e=d),this["_"+r]=e,i&&i.callback&&i.callback.call(this,e)}}:i.hasOwnProperty("min")?a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함.","입력값 : "+e),e<s&&(e=s),this["_"+r]=e,i&&i.callback&&i.callback.call(this,e)}}:i.hasOwnProperty("max")&&(a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함.","입력값 : "+e),e>d&&(e=d),this["_"+r]=e,i&&i.callback&&i.callback.call(this,e)}})}else a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함.","입력값 : "+e),this["_"+r]=e}};break;case"sampler2D":o="RedBaseTexture";break;case"samplerCube":o="RedBitmapCubeTexture";break;case"samplerVideo":o="RedVideoTexture";break;default:RedGLUtil.throwFunc(r+" - type : "+n+" / "+r+" : 정의할수없는 타입입니다.")}if(o){var f=window[o];a=i&&i.essential?{get:function(){return this["_"+r]},set:function(e){f==RedBitmapCubeTexture?e instanceof f||RedGLUtil.throwFunc(t+" - "+r+" : "+o+" Instance만 허용.","입력값 : "+e):!(e instanceof RedBitmapCubeTexture)&&e instanceof f||RedGLUtil.throwFunc(t+" - "+r+" : "+o+" Instance만 허용.","입력값 : "+e),this["_"+r]=e,i&&i.callback&&i.callback.call(this)}}:{get:function(){return this["_"+r]},set:function(e){e&&(f==RedBitmapCubeTexture?e instanceof f||RedGLUtil.throwFunc(t+" - "+r+" : "+o+" Instance만 허용.","입력값 : "+e):!(e instanceof RedBitmapCubeTexture)&&e instanceof f||RedGLUtil.throwFunc(t+" - "+r+" : "+o+" Instance만 허용.","입력값 : "+e)),this["_"+r]=e,i&&i.callback&&i.callback.call(this)}}}e["_"+r]=null,Object.defineProperty(e,r,a)},(RedDefinePropertyInfo={}).definePrototype=function(t,r,n,i){e(window[t].prototype,t,r,n,i)},Object.freeze(RedDefinePropertyInfo)}(),RedGLDetect=function(e){if(!(this instanceof RedGLDetect))return new RedGLDetect(e);var t,r,n,i,a;for(n in t={basic:["VENDOR","VERSION","SHADING_LANGUAGE_VERSION","RENDERER"],frameBuffer:["MAX_COLOR_ATTACHMENTS","MAX_RENDERBUFFER_SIZE","MAX_VIEWPORT_DIMS","RED_BITS","GREEN_BITS","BLUE_BITS","ALPHA_BITS","DEPTH_BITS","STENCIL_BITS"],vertexShader:["MAX_VERTEX_ATTRIBS","MAX_VARYING_VECTORS","MAX_VERTEX_UNIFORM_VECTORS"],fragmentShader:["MAX_FRAGMENT_UNIFORM_VECTORS"],texture:["MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE","MAX_COMBINED_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_IMAGE_UNITS","MAX_VERTEX_TEXTURE_IMAGE_UNITS"]})for(r=(a=t[n]).length,this[n]={};r--;)this[n][i=a[r]]=e.getParameter(e[i])},Object.freeze(RedGLDetect),function(){var e,t,r;RedGLUtil={throwFunc:function(){throw"RedGL Error : "+Array.prototype.slice.call(arguments).join(" ")},hexToRGB_ZeroToOne:function(e){var t,r;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return r=[],3==(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),t="0x"+t.join(""),r[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,r;RedGLUtil.throwFunc("RedGLUtil.hexToRGB_ZeroToOne : 잘못된 hex값입니다.",e)},rgb2hex:function(e,t,r){return"#"+(16777216+(r|t<<8|e<<16)).toString(16).slice(1)},regHex:(r=/^#(?:[0-9a-fA-F]{3}){1,2}$/,function(e){return r.test(e)}),getStrFromComment:function(e){if("string"!=typeof e&&RedGLUtil.throwFunc("getStrFromComment : 해석할 값은 문자열만 가능",e),t=e.replace("@preserve","").toString().trim().match(/(\/\*)[\s\S]+(\*\/)/g))return t[0].replace(/\/\*|\*\//g,"").trim();RedGLUtil.throwFunc("getStrFromComment : 해석할 불가능한 값",e)},isPowerOf2:function(e){return 0==(e&e-1)},nextHighestPowerOfTwo:function(t){for(--t,e=1;e<32;e<<=1)t|=t>>e;return t+1},calculateNormals:function(e,t){var r,n,i=[];for(r=0;r<e.length;r+=3)i[r+0]=0,i[r+1]=0,i[r+2]=0;for(r=0;r<t.length;r+=3){var a,o,s,d,f=[],c=[],u=[];for(a=3*t[r],o=3*t[r+1],s=3*t[r+2],f[0]=e[s+0]-e[o+0],f[1]=e[s+1]-e[o+1],f[2]=e[s+2]-e[o+2],c[0]=e[a+0]-e[o+0],c[1]=e[a+1]-e[o+1],c[2]=e[a+2]-e[o+2],u[0]=f[1]*c[2]-f[2]*c[1],u[1]=f[2]*c[0]-f[0]*c[2],u[2]=f[0]*c[1]-f[1]*c[0],n=0;n<3;n++)i[(d=3*t[r+n])+0]=i[d+0]+u[0],i[d+1]=i[d+1]+u[1],i[d+2]=i[d+2]+u[2]}for(r=0;r<e.length;r+=3){var l=[];l[0]=i[r+0],l[1]=i[r+1],l[2]=i[r+2];var h=Math.sqrt(l[0]*l[0]+l[1]*l[1]+l[2]*l[2]);0==h&&(h=1),l[0]=l[0]/h,l[1]=l[1]/h,l[2]=l[2]/h,i[r+0]=l[0],i[r+1]=l[1],i[r+2]=l[2]}return i}},Object.freeze(RedGLUtil)}(),function(){var e,t,r,n,i,a,o,s,d,f,c,u,l,h,R,m,p;i={alpha:!1,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!1,powerPreference:"default",failIfMajorPerformanceCaveat:!1},f=["OES_element_index_uint","OES_standard_derivatives","EXT_texture_filter_anisotropic","WEBGL_compressed_texture_s3tc"],r="webkit-3d,moz-webgl,3d,experimental-webgl,webgl,webgl2".split(","),n=[],e=function(e,t,c){if(d=JSON.parse(JSON.stringify(i)),t)for(s in t)d[s]=t[s];for(c?(n.length=0,n.push(c)):n=r.concat(),s=n.length;s--;)if(a=e.getContext(o=n[s],d))return a.glExtension={},f.forEach(function(e){a.glExtension[e]=a.getExtension(e)}),a.version=o,a;return null},t=function(e,t){var r,n,i,a;for(r=e.detect.texture.MAX_COMBINED_TEXTURE_IMAGE_UNITS,a=RedBaseTexture.EMPTY_BASE64,n=RedBitmapTexture(e,a),i=RedBitmapCubeTexture(e,[a,a,a,a,a,a]),e._datas.emptyTexture={"2d":n,"3d":i};r--;)1==r?(t.activeTexture(t.TEXTURE0+1),t.bindTexture(t.TEXTURE_CUBE_MAP,i.webglTexture)):(t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,n.webglTexture))},(RedGL=function(r,n,i,a,o){var s,d;performance.now();return this instanceof RedGL?(r instanceof Element&&"CANVAS"==r.tagName||RedGLUtil.throwFunc("RedGL : Canvas Element만 허용"),d=this,this._datas={},this._width="100%",this._height="100%",this._renderScale=1,this._viewRect=[0,0,0,0],this._canvas=r,this.gl=s=e(r,i,a),s?(this.detect=RedGLDetect(s),this._UUID=RedGL.makeUUID(),RedSystemShaderCode.init&&RedSystemShaderCode.init(),void requestAnimationFrame(function(){if(window.addEventListener("resize",function(){d.setSize(d._width,d._height)}),d.setSize(d._width,d._height),t(d,s),o){var e=performance.now();RedBitmapMaterial(d,d._datas.emptyTexture["2d"]),e=performance.now()-e;var r=performance.now();RedColorMaterial(d),r=performance.now()-r;var i=performance.now();RedColorPhongMaterial(d),i=performance.now()-i;var a=performance.now();RedColorPhongTextureMaterial(d),a=performance.now()-a;var f=performance.now();RedEnvironmentMaterial(d,d._datas.emptyTexture["2d"],d._datas.emptyTexture["3d"]),f=performance.now()-f;var c=performance.now();RedSheetMaterial(d,d._datas.emptyTexture["2d"]),c=performance.now()-c;var u=performance.now();RedStandardMaterial(d,d._datas.emptyTexture["2d"]),u=performance.now()-u}n&&n.call(d,!!s)})):n?n.call(d,!!s):0):new RedGL(r,n,i,a,o)}).makeUUID=(c=0,function(){return c++}),RedGL.prototype={setSize:(h=0,R=0,function(e,t,r){void 0==e&&RedGLUtil.throwFunc("RedGL setSize : width가 입력되지 않았습니다."),void 0==t&&RedGLUtil.throwFunc("RedGL setSize : height가 입력되지 않았습니다."),u=this._width=e,l=this._height=t,"number"!=typeof u&&(u.indexOf("%")>-1?u=(document.documentElement?document.documentElement.clientWidth:document.body.clientWidth)*parseFloat(u)/100:RedGLUtil.throwFunc("RedGL setSize : width는 0이상의 숫자나 %만 허용.",u)),"number"!=typeof l&&(l.indexOf("%")>-1?l=window.innerHeight*parseFloat(l)/100:RedGLUtil.throwFunc("RedGL setSize : height는 0이상의 숫자나 %만 허용.",l)),m=window.devicePixelRatio||1,p=this._canvas,(h!=u||R!=l||r)&&(p.width=u*m*this._renderScale,p.height=l*m*this._renderScale,p.style.width=u,p.style.height=l,h=u,R=l),this._viewRect[2]=h,this._viewRect[3]=R})},RedDefinePropertyInfo.definePrototype("RedGL","renderScale","number",{min:.1,max:1,callback:function(){this.setSize(this._width,this._height,!0)}}),Object.freeze(RedGL)}(),(RedBaseController=function(){}).prototype={update:function(){RedGLUtil.throwFunc("RedBaseController : update - 재정의 해서 써라")}},Object.freeze(RedBaseController),function(){var e;(RedBaseTexture=function(){}).EMPTY_BASE64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC",(e=new Image).src=RedBaseTexture.EMPTY_BASE64,RedBaseTexture.prototype={setEmptyTexture:function(t,r){this instanceof RedBitmapCubeTexture?(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_CUBE_MAP,r),[e,e,e,e,e,e].forEach(function(r,n){t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_CUBE_MAP,null)):(t.activeTexture(t.TEXTURE0+0),t.bindTexture(t.TEXTURE_2D,r),t.pixelStorei(t.UNPACK_ALIGNMENT,1),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,2,2,0,t.LUMINANCE,t.UNSIGNED_BYTE,new Uint8Array([128,64,0,192])),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.generateMipmap(t.TEXTURE_2D),t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.bindTexture(t.TEXTURE_2D,null))}},RedBaseTexture.prototype._load=function(){RedGLUtil.throwFunc("RedBaseTexture - _load : 반드시 재정의해야함")},RedBaseTexture.prototype.src=function(){RedGLUtil.throwFunc("RedBaseTexture - src : 반드시 재정의해야함")},Object.defineProperty(RedBaseTexture.prototype,"callback",{get:function(){return this._callback},set:function(e){e&&"function"!=typeof e&&RedGLUtil.throwFunc("RedBaseTexture : callback은 함수만 허용.","입력값 :",e),this._callback=e}}),Object.freeze(RedBaseTexture)}(),function(){var e,t,r,n,i,a;(RedBaseObject3D=function(){}).build=function(e){this.useCullFace=!0,this.cullFace=e.BACK,this.useDepthMask=!0,this.useDepthTest=!0,this.depthTestFunc=e.LEQUAL,this.useBlendMode=!0,this.blendSrc=e.SRC_ALPHA,this.blendDst=e.ONE_MINUS_SRC_ALPHA,this.drawMode=e.TRIANGLES,this.pointSize=1,this.x=this.y=this.z=0,this.rotationX=this.rotationY=this.rotationZ=0,this.scaleX=this.scaleY=this.scaleZ=1,this.autoUpdateMatrix=!0,this.matrix=mat4.create(),this.normalMatrix=mat4.create(),this.children=[],this.useLOD=!1,this._lodLevels={}},RedBaseObject3D.prototype={addLOD:function(e,t,r,n){r||n||RedGL.throwFunc("RedBaseObject3D - addLOD : geometry, material 둘중하나는 반드시 입력되어야함"),a={level:e,distance:t,geometry:r||this.geometry,material:n||this.material},this._lodLevels[e]=a},removeLOD:function(e){this._lodLevels[e]&&delete this._lodLevels[e]},localToWorld:(i=mat4.create(),function(e,t,r){return e=e||0,t=t||0,r=r||0,mat4.identity(i),mat4.translate(i,i,[e,t,r]),mat4.multiply(i,this.matrix,i),[i[12],i[13],i[14]]}),worldToLocal:function(){var e,t;return e=mat4.create(),t=mat4.create(),function(r,n,i){return r=r||0,n=n||0,i=i||0,mat4.translate(e,e,[r,n,i]),mat4.multiply(t,e,this.matrix),[t[0]*r+t[1]*n+t[2]*i+t[3],t[4]*r+t[5]*n+t[6]*i+t[7],t[8]*r+t[9]*n+t[10]*i+t[11]]}}(),getScreenPoint:(n=mat4.create(),r={x:0,y:0,z:0,w:0},function(i){return mat4.identity(n),e=i.camera,t=i._viewRect,e instanceof RedBaseController&&(e=e.camera),mat4.multiply(n,e.perspectiveMTX,e.matrix),mat4.multiply(n,n,this.matrix),r.x=n[12],r.y=n[13],r.z=n[14],r.w=n[15],r.x=.5*r.x/r.w+.5,r.y=.5*r.y/r.w+.5,[(t[0]+r.x*t[2])/window.devicePixelRatio,(t[1]+(1-r.y)*t[3])/window.devicePixelRatio]})},Object.defineProperty(RedBaseObject3D.prototype,"geometry",{get:function(){return this._geometry},set:function(e){!e||e instanceof RedGeometry||RedGLUtil.throwFunc("geometry : RedGeometry Instance만 허용.","입력값 : "+e),this._geometry=e}}),Object.defineProperty(RedBaseObject3D.prototype,"material",{get:function(){return this._material},set:function(e){!e||e instanceof RedBaseMaterial||RedGLUtil.throwFunc("material : RedBaseMaterial Instance만 허용.","입력값 : "+e),this._material=e}}),Object.freeze(RedBaseObject3D)}(),function(){var e;(RedBaseContainer=function(){}).prototype=new RedBaseObject3D,RedBaseContainer.prototype.sortGeometry=function(e){if(e)for(var t=this.children.length;t--;)this.children[t].sortGeometry(e);this.children.sort(function(e,t){return(e=e._geometry.interleaveBuffer._UUID)<(t=t._geometry.interleaveBuffer._UUID)?-1:e>t?1:0})},RedBaseContainer.prototype.sortMaterial=function(e){if(e)for(var t=this.children.length;t--;)this.children[t].sortMaterial(e);this.children.sort(function(e,t){return(e=e._material.program._UUID)<(t=t._material.program._UUID)?-1:e>t?1:0})},RedBaseContainer.prototype.sortGeometryAndMaterial=function(e){if(e)for(var t=this.children.length;t--;)this.children[t].sortGeometryAndMaterial(e);this.children.sort(function(e,t){if((e=e._geometry.interleaveBuffer._UUID)==(t=t._geometry.interleaveBuffer._UUID)){var r=e._material.program._UUID,n=t._material.program._UUID;return r<n?-1:r>n?1:0}return e<t?-1:e>t?1:0})},RedBaseContainer.prototype.addChild=function(e){e instanceof RedBaseObject3D||RedGLUtil.throwFunc("addChild","RedBaseObject3D Instance만 가능","입력값 : "+e),this.children.indexOf(e)>-1&&this.removeChild(e),this.children.push(e)},RedBaseContainer.prototype.addChildAt=function(e,t){"number"==typeof t||RedGLUtil.throwFunc("addChildAt","index는 숫자만 입력가능","입력값 : "+t),e instanceof RedBaseObject3D||RedGLUtil.throwFunc("addChildAt","RedBaseObject3D Instance만 가능","입력값 : "+e),this.children.indexOf(e)>-1&&this.removeChild(e),this.children.length<t&&(t=this.children.length),t?this.children.splice(t,0,e):this.children.push(e)},RedBaseContainer.prototype.removeChild=function(t){-1==(e=this.children.indexOf(t))?RedGLUtil.throwFunc("removeChild","존재하지 않는 RedMesh를 삭제하려고 함"):this.children.splice(e,1)},RedBaseContainer.prototype.removeChildAt=function(e){"number"!=typeof e&&RedGLUtil.throwFunc("removeChildAt","index가 Number형이 아님 ","입력값 : "+e),this.children[e]?this.children.splice(e,1):RedGLUtil.throwFunc("removeChildAt","index 해당인덱스에 위치한 자식이 없음.","입력값 : "+e)},RedBaseContainer.prototype.removeChildAll=function(){this.children.length=0},RedBaseContainer.prototype.getChildAt=function(e){return"number"==typeof e||RedGLUtil.throwFunc("getChildAt","index가 Number형이 아님 "),this.children[e]},RedBaseContainer.prototype.getChildIndex=function(e){return this.children.indexOf(e)},RedBaseContainer.prototype.numChildren=function(){return this.children.length},Object.freeze(RedBaseContainer)}(),function(){var e;(RedBaseLight=function(){}).prototype={},RedDefinePropertyInfo.definePrototype("RedBaseLight","intensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedBaseLight","alpha","number",{min:0,max:1,callback:function(e){this._lightColor[3]=this._alpha=e}}),RedDefinePropertyInfo.definePrototype("RedBaseLight","color","hex",{callback:function(){e=RedGLUtil.hexToRGB_ZeroToOne.call(this,this._color),this._lightColor[0]=e[0],this._lightColor[1]=e[1],this._lightColor[2]=e[2],this._lightColor[3]=this._alpha}}),Object.freeze(RedBaseLight)}(),(RedFrameBuffer=function(e,t,r){if(!(this instanceof RedFrameBuffer))return new RedFrameBuffer(e,t,r);var n;e instanceof RedGL||RedGLUtil.throwFunc("RedFrameBuffer : RedGL Instance만 허용.",e),t&&("number"==typeof t||RedGLUtil.throwFunc("RedFrameBuffer : width - 숫자만 허용","입력값 : ",t)),r&&("number"==typeof r||RedGLUtil.throwFunc("RedFrameBuffer : height - 숫자만 허용","입력값 : ",r)),n=e.gl,t=t||1920,r=r||1080,t>e.detect.texture.MAX_TEXTURE_SIZE&&(t=e.detect.texture.MAX_TEXTURE_SIZE),r>e.detect.texture.MAX_TEXTURE_SIZE&&(r=e.detect.texture.MAX_TEXTURE_SIZE),this.redGL=e,this.width=t,this.height=r,this.webglFrameBuffer=n.createFramebuffer(),this.webglRenderBuffer=n.createRenderbuffer(),this.texture=RedBitmapTexture(e),this._UUID=RedGL.makeUUID(),n.bindFramebuffer(n.FRAMEBUFFER,this.webglFrameBuffer),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.texture.webglTexture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.bindRenderbuffer(n.RENDERBUFFER,this.webglRenderBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,this.width,this.height),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.texture.webglTexture,0),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.webglRenderBuffer),n.bindTexture(n.TEXTURE_2D,null),n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,null)}).prototype={bind:function(e){e.bindFramebuffer(e.FRAMEBUFFER,this.webglFrameBuffer),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture.webglTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindRenderbuffer(e.RENDERBUFFER,this.webglRenderBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this.width,this.height),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.webglTexture,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.webglRenderBuffer)},unbind:function(e){e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}},RedDefinePropertyInfo.definePrototype("RedFrameBuffer","width","number",{min:2}),RedDefinePropertyInfo.definePrototype("RedFrameBuffer","height","number",{min:2}),Object.freeze(RedFrameBuffer),function(){var e,t,r;e=function(e,t,r){switch(t){case RedBuffer.ARRAY_BUFFER:if(r instanceof Float32Array)return e.FLOAT;if(r instanceof Float64Array)return e.FLOAT;RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ARRAY_BUFFER)형식을 사용해야합니다.","입력값 : "+r);break;case RedBuffer.ELEMENT_ARRAY_BUFFER:if(r instanceof Int8Array)return e.BYTE;if(r instanceof Int16Array)return e.SHORT;if(r instanceof Int32Array)return e.INT;if(r instanceof Uint8Array)return e.UNSIGNED_BYTE;if(r instanceof Uint16Array)return e.UNSIGNED_SHORT;if(r instanceof Uint32Array)return e.UNSIGNED_INT;RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ELEMENT_ARRAY_BUFFER)형식을 사용해야합니다.","입력값 : "+r);break;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ","입력값 : "+t)}},t=function(e,t){switch(t){case RedBuffer.ARRAY_BUFFER:return e.ARRAY_BUFFER;case RedBuffer.ELEMENT_ARRAY_BUFFER:return e.ELEMENT_ARRAY_BUFFER;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ")}},r=function(e,t,r,n){var i,a,o,s,d;switch(r instanceof Float32Array?d=Float32Array.BYTES_PER_ELEMENT:r instanceof Float64Array&&(d=Float64Array.BYTES_PER_ELEMENT),i=0,t){case RedBuffer.ARRAY_BUFFER:if(e.interleaveDefineInfoList=n,n){for(0==n.length&&RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList의 정보는 1개이상의 RedInterleaveInfo Instance로 구성되어야함.",n),a=0,o=n.length;a<o;a++)(s=n[a])instanceof RedInterleaveInfo||RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList의 정보는 RedInterleaveInfo Instance로만 구성되어야함.",n),s.offset=o<2?0:i,s.offset_BYTES_PER_ELEMENT=o<2?0:i*d,i+=s.size,s._UUID=RedGL.makeUUID(),n[s.attributeKey]=s;o<2?(e.stride=0,e.stride_BYTES_PER_ELEMENT=0,e.pointNum=r.length/3):(e.stride=i,e.stride_BYTES_PER_ELEMENT=i*d,e.pointNum=r.length/i),e.pointNum!=parseInt(e.pointNum)&&RedGLUtil.throwFunc("RedBuffer : ARRAY_BUFFER의 pointNum이 정수로 떨어지지 않음. 데이터구성과 interleaveDefineInfoList 구성 확인 필요")}else RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList는 반드시 정의 되어야함.");break;case RedBuffer.ELEMENT_ARRAY_BUFFER:e.pointNum=r.length}},(RedBuffer=function(n,i,a,o,s,d){if(!(this instanceof RedBuffer))return new RedBuffer(n,i,a,o,s,d);n instanceof RedGL||RedGLUtil.throwFunc("RedBuffer : RedGL Instance만 허용.",n),"string"==typeof i||RedGLUtil.throwFunc("RedBuffer : key - 문자열만 허용.","입력값 : "+i),a||RedGLUtil.throwFunc("RedBuffer : bufferType : 미입력, 반드시 입력해야함."),a==RedBuffer.ARRAY_BUFFER||a==RedBuffer.ELEMENT_ARRAY_BUFFER||RedGLUtil.throwFunc("RedBuffer : bufferType - RedBuffer.ARRAY_BUFFER or RedBuffer.ELEMENT_ARRAY_BUFFER 만 허용함.","입력값 : "+a);var f=n.gl;if(n._datas.RedBuffer||(n._datas.RedBuffer={},n._datas.RedBuffer[RedBuffer.ARRAY_BUFFER]={},n._datas.RedBuffer[RedBuffer.ELEMENT_ARRAY_BUFFER]={}),n._datas.RedBuffer[a][i])return n._datas.RedBuffer[a][i];n._datas.RedBuffer[a][i]=this,a!=RedBuffer.ARRAY_BUFFER||s||RedGLUtil.throwFunc("RedBuffer : 신규생성시 interleaveDefineInfoList를 반드시 정의해야합니다.","입력값 : "+s),this.key=i,this.data=o,this.bufferType=a,this.glBufferType=t(f,this.bufferType),this.glArrayType=e(f,this.bufferType,this.data),this.drawMode=d||f.STATIC_DRAW,r(this,this.bufferType,this.data,s),this.webglBuffer=f.createBuffer(),this._UUID=RedGL.makeUUID(),this.upload=function(t){this.glArrayType==e(f,a,t)?(this.data=t,f.bindBuffer(this.glBufferType,this.webglBuffer),f.bufferData(this.glBufferType,this.data,this.drawMode),r(this,this.bufferType,this.data,this.interleaveDefineInfoList),this.bufferType==RedBuffer.ARRAY_BUFFER&&(this.triangleNum=this.data.length/(this.stride?this.stride:3)),this.bufferType==RedBuffer.ELEMENT_ARRAY_BUFFER&&(this.triangleNum=this.pointNum/3)):RedGLUtil.throwFunc("RedBuffer : upload - data형식이 기존 형식과 다름",t)},this.upload(this.data)}).ARRAY_BUFFER="arrayBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER="elementArrayBuffer",Object.freeze(RedBuffer)}(),RedGeometry=function(e,t){if(!(this instanceof RedGeometry))return new RedGeometry(e,t);e instanceof RedBuffer||RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer Instance만 허용.",e),e.bufferType==RedBuffer.ARRAY_BUFFER||RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer.ARRAY_BUFFER 타입만 허용.",e),t&&(e||RedGLUtil.throwFunc("RedGeometry : indexBuffer는 반드시 interleaveBuffer와 쌍으로 입력되어야함.",t),t instanceof RedBuffer||RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer Instance만 허용.",t),t.bufferType==RedBuffer.ELEMENT_ARRAY_BUFFER||RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer.ELEMENT_ARRAY_BUFFER 타입만 허용.",t)),this.interleaveBuffer=e,this.indexBuffer=t,this._UUID=RedGL.makeUUID()},Object.freeze(RedGeometry),RedInterleaveInfo=function(e,t,r){if(!(this instanceof RedInterleaveInfo))return new RedInterleaveInfo(e,t,r);"string"==typeof e||RedGLUtil.throwFunc("RedInterleaveInfo : attributeKey - 문자열만 허용",e),"a"==e.charAt(0)||RedGLUtil.throwFunc("RedInterleaveInfo : attributeKey 첫글자는 a로 시작해야합니다.",e),e.charAt(1)==e.charAt(1).toUpperCase()||RedInterleaveInfo.throwFunc("RedInterleaveInfo : attributeKey 두번째 글자는 대문자 시작해야합니다.",e),"number"==typeof t||RedGLUtil.throwFunc("RedInterleaveInfo : size - 숫자만 허용",t),this.attributeKey=e,this.size=t,this.normalize=void 0!=r,this.offset=null},Object.freeze(RedInterleaveInfo),function(){var e,t,r,n,i;(RedBaseMaterial=function(){}).prototype={makeProgramList:(i=function(e,t,r,n,i){this._prepareProgramYn=!0,this._makePrepareProgram=function(){return RedProgram.makeProgram(e,t,r,n,i)}},n=function(e,t,r,a,o,s,d){var f,c;for((d=d.concat()).sort(),f=d.length;f--;)c=d[f],c=""==t?c:t+"_"+c,e._programList.basic[a+"_"+c]||(e._programList.basic[a+"_"+c]=RedProgram.makeProgram(r,a,o,s,c.split("_")),e._programList.fog[a+"_"+c]=new i(r,a,o,s,(c+"_fog").split("_")),e._programList.sprite3D[a+"_"+c]=new i(r,a,o,s,(c+"_sprite3D").split("_")),e._programList.fog_sprite3D[a+"_"+c]=new i(r,a,o,s,(c+"_fog_sprite3D").split("_")),e._programList.directionalShadow[a+"_"+c]=new i(r,a,o,s,(c+"_directionalShadow").split("_")),e._programList.directionalShadow_fog[a+"_"+c]=new i(r,a,o,s,(c+"_directionalShadow_fog").split("_")),e._programList.directionalShadow_sprite3D[a+"_"+c]=new i(r,a,o,s,(c+"_directionalShadow_sprite3D").split("_")),e._programList.directionalShadow_fog_sprite3D[a+"_"+c]=new i(r,a,o,s,(c+"_directionalShadow_fog_sprite3D").split("_")),n(e,c,r,a,o,s,d.concat().slice(f+1)))},function(e,t,r,a,o,s){s||(s=[]),t._datas.RedProgramGroup||(t._datas.RedProgramGroup={}),t._datas.RedProgramGroup[r]?e._programList=t._datas.RedProgramGroup[r]:(e._programList={basic:{},fog:{},sprite3D:{},fog_sprite3D:{},directionalShadow:{},directionalShadow_fog:{},directionalShadow_sprite3D:{},directionalShadow_fog_sprite3D:{}},n(e,"",t,r,a,o,s),e._programList.basic[r]=RedProgram.makeProgram(t,r,a,o),e._programList.fog[r]=new i(t,r,a,o,["fog"]),e._programList.sprite3D[r]=new i(t,r,a,o,["sprite3D"]),e._programList.fog_sprite3D[r]=new i(t,r,a,o,["fog","sprite3D"]),e._programList.directionalShadow[r]=new i(t,r,a,o,["directionalShadow"]),e._programList.directionalShadow_fog[r]=new i(t,r,a,o,["fog","directionalShadow"]),e._programList.directionalShadow_sprite3D[r]=new i(t,r,a,o,["sprite3D","directionalShadow"]),e._programList.directionalShadow_fog_sprite3D[r]=new i(t,r,a,o,["fog","directionalShadow","sprite3D"]),t._datas.RedProgramGroup[r]=e._programList),e.program=e._programList.basic[r]}),_searchProgram:function(n,i){if(r=[],i)for(e=i.length;e--;)this[t=i[e]]&&r.push(t);r.length?(r.sort(),r=n+"_"+r.join("_")):r=n,this.program=this._programList.basic[r]},checkUniformAndProperty:function(){var e,t,r;return function(){for(t=this.program.uniformLocation,e=t.length;e--;)r=t[e],!r.location||r.materialPropertyName in this||RedGLUtil.throwFunc(this.program.key+"- ",r.materialPropertyName,"속성이 정의 되지않았습니다.")}}()},Object.freeze(RedBaseMaterial)}(),function(){var e,t;function r(e,t,r,n){this.x=e,this.y=t,this.w=r,this.h=n}(RedAtlas=function(r,n,i){if(!(this instanceof RedAtlas))return new RedAtlas(r,n,i);r instanceof RedGL||RedGLUtil.throwFunc("RedBitmapMaterial : RedGL Instance만 허용.",r),r._datas.RedAtlas||(r._datas.RedAtlas={atlasInfoList:[new e],atlasMap:{}}),(t=r.detect.texture.MAX_TEXTURE_SIZE)>2048&&(t=2048),this.redGL=r,this.loadList(n,i)}).prototype={getAtlasMap:function(){return this.redGL._datas.RedAtlas.atlasMap},getAtlasInfoList:function(){return this.redGL._datas.RedAtlas.atlasInfoList},loadList:function(e,t){var r,n,i,a;for(a=0,i=this,r=0,n=e.length,r=0;r<n;r++){var o=new Image;o.id=o.src=e[r],o.onload=function(){(i.atlasPack(i.redGL,this),++a==e.length)&&(i.redGL._datas.RedAtlas.atlasInfoList.forEach(function(e){e.texture=RedBitmapTexture(i.redGL,e.canvas)}),t&&t.call(i,i.redGL._datas.RedAtlas))}}},atlasPack:function(t,r){var n,i;if(n=t._datas.RedAtlas.atlasInfoList,!(i=t._datas.RedAtlas.atlasMap)[r.id]){var a,o,s,d;if(!1===(d=(s=n[0]).pack(r))){for(a=0,o=n.length;a<o&&!(d=(s=n[a]).pack(r));a++);!1===d&&(n.push(s=new e),d=s.pack(r))}i[r.id]={atlas:s,rect:s.uv()[r.id]},s.texture||(s.texture=RedBitmapTexture(t,s.canvas))}}},r.prototype.fitsIn=function(e){return e.w>=this.w&&e.h>=this.h},r.prototype.sameSizeAs=function(e){return this.w===e.w&&this.h===e.h},(e=function(e,n,i,a){if(void 0==e){var o=document.createElement("canvas");document.body.appendChild(o),o.style.display="none",o.width=t,o.height=t,this.canvas=o,e=n=0,i=this.canvas.width,a=this.canvas.height}2===arguments.length&&(i=e,a=n,e=n=0),this._UUID=RedGL.makeUUID(),this.left=this.right=null,this.rect=new r(e,n,i,a),this.filled=!1,this.tilepad=!1,this._cache=[],this._uvcache=Object.create(null)}).prototype.pack=function(t){return this._cache=[],this._uvcache=Object.create(null),t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),null!==this.left?this._ontoCanvas(this.left.pack(t)||this.right.pack(t)):!(this.filled||!t.fitsIn(this.rect))&&(t.sameSizeAs(this.rect)?(this.filled=!0,this._ontoCanvas(this)):(this.rect.w-t.w>this.rect.h-t.h?(this.left=new e(this.rect.x,this.rect.y,t.w,this.rect.h),this.right=new e(this.rect.x+t.w,this.rect.y,this.rect.w-t.w,this.rect.h)):(this.left=new e(this.rect.x,this.rect.y,this.rect.w,t.h),this.right=new e(this.rect.x,this.rect.y+t.h,this.rect.w,this.rect.h-t.h)),this._ontoCanvas(this.left.pack(t))))},e.prototype.expand=function(t){var r,n=this;if(t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),this.rect.w<this.rect.h?((r=new e(0,0,this.rect.w+t.w,this.rect.h)).right=new e(this.rect.w,0,t.w,this.rect.h),r.left=this):((r=new e(0,0,this.rect.w,this.rect.h+t.h)).right=new e(0,this.rect.h,this.rect.w,t.h),r.left=this),["canvas","context","img"].forEach(function(e){n[e]&&(r[e]=n[e],n[e]=null)}),r.canvas){r.context||(r.context=r.canvas.getContext("2d"));var i=r.context.getImageData(0,0,r.canvas.width,r.canvas.height);r.canvas.width=r.rect.w,r.canvas.height=r.rect.h,r.context.putImageData(i,0,0)}return!1===r.pack(t)?r.expand(t):r},e.prototype.index=function(){var e=this;return e._cache.length>0?e._cache:(function t(r){null!==r.left?(t(r.left),t(r.right)):r.rect.name&&e._cache.push(r.rect)}(e),e._cache)},e.prototype.uv=function(e,t){var r=this;e=e||r.rect.w,t=t||r.rect.h;var n=this.tilepad;return function i(a){if(null!==a.left)i(a.left),i(a.right);else if(void 0!==a.rect.name){var o=n?a.rect.w/4:0;r._uvcache[a.rect.name]=[[a.rect.x+o,a.rect.y+o],[a.rect.x+o+(a.rect.w-2*o),a.rect.y+o],[a.rect.x+o+(a.rect.w-2*o),a.rect.y+o+(a.rect.h-2*o)],[a.rect.x+o,a.rect.y+o+(a.rect.h-2*o)]].map(function(r){return 0!==r[0]&&(r[0]=r[0]/e),0!==r[1]&&(r[1]=r[1]/t),r})}}(r),r._uvcache},e.prototype.json=function(t){return t?("string"==typeof t&&(t=JSON.parse(t)),function t(r){if(r&&r.rect){var n=new e(r.rect.x,r.rect.y,r.rect.w,r.rect.h);return r.left&&(n.left=t(r.left)),r.right&&(n.right=t(r.right)),n}}(t)):JSON.stringify(function e(t){var r={left:null,right:null,rect:t.rect,filled:t.filled};return null!==t.left&&(r.left=e(t.left),r.right=e(t.right)),r}(this),null,2)},e.prototype._tilepad=function(e){var t=this.img;if(!t)return e;var n=t.width/2,i=document.createElement("canvas");i.name=t.name||t.src,i.id=t.id||"",i.width=t.width+t.width,i.height=t.height+t.height;var a=i.getContext("2d"),o=a.createPattern(t,"repeat");return a.fillStyle=o,a.translate(n,n),a.fillRect(-n,-n,i.width+n,i.height+n),a.translate(-n,-n),this.img=i,new r(e.x,e.y,this.img.width,this.img.height)},e.prototype._ontoCanvas=function(e){return e&&this.img&&this.canvas&&(this.context||(this.context=this.canvas.getContext("2d")),this.context.clearRect(e.rect.x,e.rect.y,e.rect.w,e.rect.h),this.context.drawImage(this.img,e.rect.x,e.rect.y,e.rect.w,e.rect.h),e.rect.name=this.img.id||this.img.name||this.img.src||null),e},e.prototype._toRect=function(e){return!e.nodeName||"IMG"!==e.nodeName&&"CANVAS"!==e.nodeName||(this.img=e,e=new r(e.x,e.y,e.width,e.height)),e instanceof r||(e=new r(e.x||0,e.y||0,e.w||e.width,e.h||e.height)),e},e.prototype._debug=function(){if(this.canvas){var e=this.canvas.getContext("2d");this.index().forEach(function(t){e.lineWidth=1,e.strokeStyle="red",e.strokeRect(t.x,t.y,t.w,t.h)})}}}(),function(){var e,t,r=new Float32Array([0,0,1,1]),n={};r._UUID=RedGL.makeUUID(),(RedAtlasUV=function(i,a){if(!(this instanceof RedAtlasUV))return new RedAtlasUV(i,a);i instanceof RedGL||RedGLUtil.throwFunc("RedAtlasUV : RedGL Instance만 허용.",i),a?(t=[a[0][0],1-a[2][1],a[1][0]-a[0][0],a[2][1]-a[0][1]],e=t.toString(),n[e]?this.data=n[e]:(this.data=n[e]=t,this.data._UUID=RedGL.makeUUID())):this.data=r}).prototype={},Object.freeze(RedAtlasUV)}(),RedTextureOptionChecker={check:function(e,t,r){t&&(t.min&&t.min!=r.LINEAR&&t.min!=r.NEAREST&&t.min!=r.NEAREST_MIPMAP_NEAREST&&t.min!=r.LINEAR_MIPMAP_NEAREST&&t.min!=r.NEAREST_MIPMAP_LINEAR&&t.min!=r.LINEAR_MIPMAP_LINEAR&&RedGLUtil.throwFunc(e+": min 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.min),t.mag&&t.mag!=r.LINEAR&&t.mag!=r.NEAREST&&RedGLUtil.throwFunc(e+" : mag 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.mag),t.wrap_s&&t.wrap_s!=r.REPEAT&&t.wrap_s!=r.CLAMP_TO_EDGE&&t.wrap_s!=r.MIRRORED_REPEAT&&RedGLUtil.throwFunc(e+" : wrap_s 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.wrap_s),t.wrap_t&&t.wrap_t!=r.REPEAT&&t.wrap_t!=r.CLAMP_TO_EDGE&&t.wrap_t!=r.MIRRORED_REPEAT&&RedGLUtil.throwFunc(e+" : wrap_t 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.wrap_t))}},Object.freeze(RedTextureOptionChecker),function(){var e,t,r;t=function(e,t,r,n){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n.min?n.min:e.LINEAR_MIPMAP_NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n.mag?n.mag:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,n.wrap_s?n.wrap_s:e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,n.wrap_t?n.wrap_t:e.REPEAT),e.glExtension.EXT_texture_filter_anisotropic&&n.anisotropic&&e.texParameterf(e.TEXTURE_2D,e.glExtension.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.anisotropic);try{e.generateMipmap(e.TEXTURE_2D)}catch(e){}e.bindTexture(e.TEXTURE_2D,null)},e=function(e,n,i,a,o,s){var d,f,c,u;o||(o={}),a instanceof HTMLCanvasElement?t(e,i,a,o):(u=function(e){e.removeEventListener("error",f),e.removeEventListener("load",c)},f=function(){u(this),s&&s.call(n,!1)},c=function(){u(this);var n,a,d=this;if(d instanceof HTMLImageElement&&(!RedGLUtil.isPowerOf2(d.width)||!RedGLUtil.isPowerOf2(d.height))){var f=document.createElement("canvas"),c=f.getContext("2d");n=RedGLUtil.nextHighestPowerOfTwo(d.width),a=RedGLUtil.nextHighestPowerOfTwo(d.height),n>r&&(n=r),a>r&&(a=r),f.width=n,f.height=a,c.drawImage(d,0,0,n,a),d=f}t(e,i,d,o),s&&s.call(this,!0)},(d=new Image).crossOrigin="anonymous",d.src=a,d.addEventListener("error",f),d.addEventListener("load",c))},(RedBitmapTexture=function(t,n,i,a){var o;if(!(this instanceof RedBitmapTexture))return new RedBitmapTexture(t,n,i,a);t instanceof RedGL||RedGLUtil.throwFunc("RedBitmapTexture : RedGL Instance만 허용.",t),o=t.gl,r=t.detect.texture.MAX_TEXTURE_SIZE,RedTextureOptionChecker.check("RedBitmapTexture",i,o),this.webglTexture=o.createTexture(),this.atlascoord=RedAtlasUV(t),this._load=function(t){t&&this.setEmptyTexture(o,this.webglTexture),this._src&&e(o,this,this.webglTexture,this._src,this._option,this._callback)},this._option=i,this.callback=a,this.src=n,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseTexture,Object.defineProperty(RedBitmapTexture.prototype,"src",{get:function(){return this._src},set:function(e){!e||"string"==typeof e||e instanceof HTMLCanvasElement||RedGLUtil.throwFunc("RedBitmapTexture : src는 문자열 or Canvas Element만 허용.","입력값 : "+e),this._src=e,this._load(!0)}}),Object.defineProperty(RedBitmapTexture.prototype,"option",{get:function(){return this._option},set:function(e){this._option=e,this._load(!1)}}),Object.freeze(RedBitmapTexture)}(),function(){var e,t;t=function(e,t,r){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,null)},e=function(e,r,n,i,a){var o,s,d,f;d=function(e){e.removeEventListener("error",o),e.removeEventListener("canplaythrough",s)},o=function(){d(this),a&&a.call(r,!1)},s=function(){d(this),this.play(),r._videoDom.loaded=!0,t(e,n,this),a&&a.call(r,!0)},i instanceof HTMLVideoElement?f=i:(f=document.createElement("video")).src=i,f.loop=1,f.muted=!0,f.setAttribute("autoplay",""),f.style.cssText="position:absolute;top:0px;left:0px;z-index:200",r._videoDom=f,r._videoDom.loaded=!1,f.addEventListener("error",o),f.addEventListener("canplaythrough",s)},(RedVideoTexture=function(t,r,n){var i;if(!(this instanceof RedVideoTexture))return new RedVideoTexture(t,r,n);t instanceof RedGL||RedGLUtil.throwFunc("RedVideoTexture : RedGL Instance만 허용.",t),i=t.gl,this.webglTexture=i.createTexture(),this.atlascoord=RedAtlasUV(t),this._UUID=RedGL.makeUUID(),this._load=function(t){t&&this.setEmptyTexture(i,this.webglTexture),this._src&&e(i,this,this.webglTexture,this._src,this._callback)},this.callback=n,this.src=r}).prototype=new RedBaseTexture,Object.defineProperty(RedVideoTexture.prototype,"src",{get:function(){return this._src},set:function(e){!e||"string"==typeof e||e instanceof HTMLVideoElement||RedGLUtil.throwFunc("RedVideoTexture : src는 문자열 or HTMLVideoElement만 허용.","입력값 : "+e),this._src=e,this._load(!0)}}),Object.freeze(RedVideoTexture)}(),function(){var e;(RedAtlasTexture=function(t,r){if(!(this instanceof RedAtlasTexture))return new RedAtlasTexture(t,r);t instanceof RedGL||RedGLUtil.throwFunc("RedAtlasTexture : RedGL Instance만 허용.",t),e=t._datas.RedAtlas.atlasMap[r],this.webglTexture=e.atlas.texture.webglTexture,this.atlascoord=RedAtlasUV(t,e.rect),this._UUID=e.atlas._UUID}).prototype=new RedBaseTexture,Object.freeze(RedAtlasTexture)}(),(RedDDSTexture=function(e,t,r,n){var i;if(!(this instanceof RedDDSTexture))return new RedDDSTexture(e,t,r,n);e instanceof RedGL||RedGLUtil.throwFunc("RedDDSTexture : RedGL Instance만 허용.",e),(i=e.gl).glExtension.WEBGL_compressed_texture_s3tc||RedGLUtil.throwFunc("RedDDSTexture : WEBGL_compressed_texture_s3tc확장을 지원하지않는 하드웨어입니다."),RedTextureOptionChecker.check("RedDDSTexture",r,i),this.webglTexture=i.createTexture(),this.atlascoord=RedAtlasUV(e),this._load=function(e){e&&this.setEmptyTexture(i,this.webglTexture),this._src&&this.loadDDSTexture(i,i.glExtension.WEBGL_compressed_texture_s3tc,this._src,this._callback)},this.callback=n,this.src=t,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseTexture,Object.defineProperty(RedDDSTexture.prototype,"src",{get:function(){return this._src},set:function(e){!e||"string"==typeof e||e instanceof HTMLCanvasElement||RedGLUtil.throwFunc("RedDDSTexture : src는 문자열 or Canvas Element만 허용.","입력값 : "+e),this._src=e,this._load(!0)}}),function(e){"use strict";function t(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var r=t("DXT1"),n=t("DXT3"),i=t("DXT5"),a=e.uploadDDSLevels=function(e,t,a,o){var s,d,f,c,u,l,h,R,m,p=new Int32Array(a,0,31);if(542327876!=p[0])return 0;if(4&!p[20])return 0;switch(p[21]){case r:s=8,d=t.COMPRESSED_RGBA_S3TC_DXT1_EXT;break;case n:s=16,d=t.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case i:s=16,d=t.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return null}for(R=1,131072&p[2]&&!1!==o&&(R=Math.max(1,p[7])),f=p[4],c=p[3],l=p[1]+4,m=0;m<R;++m)u=Math.max(4,f)/4*Math.max(4,c)/4*s,h=new Uint8Array(a,l,u),e.compressedTexImage2D(e.TEXTURE_2D,m,d,f,c,0,h),l+=u,f*=.5,c*=.5;return R};e.loadDDSTexture=function(e,t,r,n,i){var o=this.webglTexture,s=new XMLHttpRequest;return s.open("GET",r,!0),s.responseType="arraybuffer",n||(n={}),s.onload=function(){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,o);var r=a(e,t,this.response);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n.min?n.min:r>1?e.LINEAR_MIPMAP_NEAREST:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n.mag?n.mag:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),i&&i(!0)},s.onerror=function(){i&&i(!1)},s.send(null),o}}(RedDDSTexture.prototype),Object.freeze(RedDDSTexture),function(){var e;e=function(e,t,r,n,i,a){var o,s,d,f,c,u,l=[];for(i=i||{},d=function(e){e.removeEventListener("error",o),e.removeEventListener("load",s)},o=function(){d(this),0==u&&a.call(t,!1),u++},s=function(){if(6==++c){d(this),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,r);for(var n=l.length;n--;)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l[n]);e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,i.min?i.min:e.LINEAR_MIPMAP_NEAREST),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,i.mag?i.mag:e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,i.wrap_s?i.wrap_s:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,i.wrap_t?i.wrap_t:e.CLAMP_TO_EDGE);try{e.generateMipmap(e.TEXTURE_CUBE_MAP)}catch(e){}e.bindTexture(e.TEXTURE_CUBE_MAP,null),0==u&&a&&a.call(t,!0)}else d(this)},f=6,c=0,u=0;f--;){var h;(h=new Image).crossOrigin="anonymous",h.src=n[f],h.addEventListener("error",o),h.addEventListener("load",s),l[f]=h}},(RedBitmapCubeTexture=function(t,r,n,i){var a;if(!(this instanceof RedBitmapCubeTexture))return new RedBitmapCubeTexture(t,r,n,i);t instanceof RedGL||RedGLUtil.throwFunc("RedBitmapCubeTexture : RedGL Instance만 허용.","입력값 : "+t),a=t.gl,RedTextureOptionChecker.check("RedBitmapCubeTexture",n,a),this.webglTexture=a.createTexture(),this.atlascoord=RedAtlasUV(t),this._UUID=RedGL.makeUUID(),this._load=function(t){t&&this.setEmptyTexture(a,this.webglTexture),this._srcList&&e(a,this,this.webglTexture,this._srcList,this._option,this._callback)},this._option=n,this.callback=i,this.srcList=r}).prototype=new RedBaseTexture,Object.defineProperty(RedBitmapCubeTexture.prototype,"srcList",{get:function(){return this._srcList},set:function(e){e instanceof Array||RedGLUtil.throwFunc("RedBitmapCubeTexture : srcList는 배열만 허용.","입력값 : "+e),6==e.length||RedGLUtil.throwFunc("RedBitmapCubeTexture : srcList 길이는 6이어야함","입력값 : "+e),this._srcList=e,this._load(!0)}}),Object.defineProperty(RedBitmapCubeTexture.prototype,"option",{get:function(){return this._option},set:function(e){this._option=e,this._load(!1)}}),Object.freeze(RedBitmapCubeTexture)}(),function(){var e,t,r,n;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
gl_PointSize = uPointSize;
//#define#sprite3D#true# gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
//#define#sprite3D#true# if(!u_PerspectiveScale){
//#define#sprite3D#true#   gl_Position /= gl_Position.w;
//#define#sprite3D#true#   gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1] * uResolution.x/uResolution.y);
//#define#sprite3D#true# }
//#define#sprite3D#false# gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform vec4 u_color;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = u_color * u_color.a;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedColorMaterial=function(n,i,a){if(!(this instanceof RedColorMaterial))return new RedColorMaterial(n,i,a);n instanceof RedGL||RedGLUtil.throwFunc("RedColorMaterial : RedGL Instance만 허용.","입력값 : "+n),this.makeProgramList(this,n,"RedColorMaterialProgram",e,t),this._color=new Float32Array(4),this.alpha=void 0==a?1:a,this.color=i||"#ff0000",this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedColorMaterial.DEFINE_OBJECT_COLOR={get:function(){return this._colorHex},set:function(e){this._colorHex=e||"#ff2211",n=RedGLUtil.hexToRGB_ZeroToOne.call(this,this._colorHex),this._color[0]=n[0],this._color[1]=n[1],this._color[2]=n[2],this._color[3]=this._alpha}},RedColorMaterial.DEFINE_OBJECT_ALPHA={min:0,max:1,callback:function(e){this._color[3]=this._alpha=e}},Object.defineProperty(RedColorMaterial.prototype,"color",RedColorMaterial.DEFINE_OBJECT_COLOR),RedDefinePropertyInfo.definePrototype("RedColorMaterial","alpha","number",RedColorMaterial.DEFINE_OBJECT_ALPHA),Object.freeze(RedColorMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec4 vVertexPositionEye4;
void main(void) {
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform float u_shininess;
uniform float u_specularPower;
uniform vec4 u_color;
varying vec4 vVertexPositionEye4;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
vec4 la;
vec4 ld;
vec4 ls;
vec4 texelColor;
vec4 specularLightColor= vec4(1.0, 1.0, 1.0, 1.0);
vec4 finalColor;
vec3 N;
vec3 L;
float lambertTerm;
float specular;
float specularTextureValue;
float distanceLength;
float attenuation;
void main(void) {
la = uAmbientLightColor * uAmbientLightColor.a;
ld = vec4(0.0, 0.0, 0.0, 1.0);
ls = vec4(0.0, 0.0, 0.0, 1.0);
texelColor = u_color;
// texelColor.rgb *= texelColor.a;
N = normalize(vVertexNormal);
specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
specularTextureValue = 1.0;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPositionList[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uDirectionalLightColorList[i] * texelColor * lambertTerm * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uDirectionalLightIntensityList[i];
}
}
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
L =  -uPointLightPositionList[i] + vVertexPositionEye4.xyz;
distanceLength = length(L);
if(uPointLightRadiusList[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(L);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uPointLightColorList[i] * texelColor * lambertTerm * attenuation * uPointLightIntensityList[i] * uPointLightColorList[i].a;
specular = pow( max(dot( reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensityList[i] ;
}
}
}
vec4 finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedColorPhongMaterial=function(n,i,a){if(!(this instanceof RedColorPhongMaterial))return new RedColorPhongMaterial(n,i,a);n instanceof RedGL||RedGLUtil.throwFunc("RedColorPhongMaterial : RedGL Instance만 허용.","입력값 : "+n),this.makeProgramList(this,n,"RedColorPhongMaterialProgram",e,t),this._color=new Float32Array(4),this.shininess=16,this.specularPower=1,this.alpha=void 0==a?1:a,this.color=i||"#ff0000",this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,Object.defineProperty(RedColorPhongMaterial.prototype,"color",RedColorMaterial.DEFINE_OBJECT_COLOR),RedDefinePropertyInfo.definePrototype("RedColorPhongMaterial","alpha","number",RedColorMaterial.DEFINE_OBJECT_ALPHA),RedDefinePropertyInfo.definePrototype("RedColorPhongMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongMaterial","specularPower","number",{min:0}),Object.freeze(RedColorPhongMaterial)}(),function(){var e,t,r,n=["normalTexture","specularTexture","displacementTexture"];e=function(){
/* @preserve
//#define#displacementTexture# uniform sampler2D u_displacementTexture;
//#define#displacementTexture# uniform float u_displacementPower;
//#define#displacementTexture# uniform float u_displacementFlowSpeedX;
//#define#displacementTexture# uniform float u_displacementFlowSpeedY;
varying vec4 vVertexPositionEye4;
void main(void) {
vTexcoord = aTexcoord;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
//#define#displacementTexture# vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(u_displacementTexture, vTexcoord + vec2(
//#define#displacementTexture#    u_displacementFlowSpeedX * (uTime/1000.0),
//#define#displacementTexture#    u_displacementFlowSpeedY * (uTime/1000.0)
//#define#displacementTexture# )).x * u_displacementPower ;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
}
*/},t=function(){
/* @preserve
precision mediump float;
//#define#normalTexture# uniform sampler2D u_normalTexture;
//#define#specularTexture# uniform sampler2D u_specularTexture;
//#define#normalTexture# uniform float u_normalPower;
uniform float u_shininess;
uniform float u_specularPower;
uniform vec4 u_color;
varying vec4 vVertexPositionEye4;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
vec4 la;
vec4 ld;
vec4 ls;
vec4 texelColor;
vec4 specularLightColor= vec4(1.0, 1.0, 1.0, 1.0);
vec4 finalColor;
vec3 N;
vec3 L;
float lambertTerm;
float specular;
float specularTextureValue;
float distanceLength;
float attenuation;
void main(void) {
la = uAmbientLightColor * uAmbientLightColor.a;
ld = vec4(0.0, 0.0, 0.0, 1.0);
ls = vec4(0.0, 0.0, 0.0, 1.0);
texelColor = u_color;
// texelColor.rgb *= texelColor.a;
N = normalize(vVertexNormal);
//#define#normalTexture# vec4 normalColor = texture2D(u_normalTexture, vTexcoord);
//#define#normalTexture# if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb * u_normalPower  - 0.5));
specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
float specularTextureValue = 1.0;
//#define#specularTexture# specularTextureValue = texture2D(u_specularTexture, vTexcoord).r;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPositionList[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uDirectionalLightColorList[i] * texelColor * lambertTerm * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * pow( max(dot(reflect(L, N), -L), 0.0), u_shininess) * u_specularPower * specularTextureValue * uDirectionalLightIntensityList[i];
}
}
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
L =  -uPointLightPositionList[i] + vVertexPositionEye4.xyz;
distanceLength = length(L);
if(uPointLightRadiusList[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(L);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uPointLightColorList[i] * texelColor * lambertTerm * attenuation * uPointLightIntensityList[i] * uPointLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensityList[i] ;
}
}
}
finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/};var i={callback:function(){this._searchProgram("RedColorPhongTextureMaterialProgram",n)}};(RedColorPhongTextureMaterial=function(i,a,o,s,d,f){if(!(this instanceof RedColorPhongTextureMaterial))return new RedColorPhongTextureMaterial(i,a,o,s,d,f);i instanceof RedGL||RedGLUtil.throwFunc("RedColorPhongTextureMaterial : RedGL Instance만 허용.","입력값 : "+i),this.makeProgramList(this,i,"RedColorPhongTextureMaterialProgram",e,t,n),this._color=new Float32Array(4),this.normalTexture=s,this.specularTexture=d,this.displacementTexture=f,this.normalPower=1,this.shininess=16,this.specularPower=1,this.displacementPower=0,this.displacementFlowSpeedX=0,this.displacementFlowSpeedY=0,this.alpha=void 0==o?1:o,this.color=a||"#ff0000",this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,Object.defineProperty(RedColorPhongTextureMaterial.prototype,"color",RedColorMaterial.DEFINE_OBJECT_COLOR),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","alpha","number",RedColorMaterial.DEFINE_OBJECT_ALPHA),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","normalTexture","sampler2D",i),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","specularTexture","sampler2D",i),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementTexture","sampler2D",i),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","normalPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","specularPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementFlowSpeedX","number"),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementFlowSpeedY","number"),Object.freeze(RedColorPhongTextureMaterial)}(),function(){var e,t,r,n=["diffuseTexture","normalTexture","specularTexture","displacementTexture"];e=function(){
/* @preserve
varying vec4 vVertexPositionEye4;
varying vec3 vReflectionCubeCoord;
//#define#displacementTexture# uniform sampler2D u_displacementTexture;
//#define#displacementTexture# uniform float u_displacementPower;
//#define#displacementTexture# uniform float u_displacementFlowSpeedX;
//#define#displacementTexture# uniform float u_displacementFlowSpeedY;
void main(void) {
vTexcoord = aTexcoord;
vVertexNormal = (uNMatrix * vec4(aVertexNormal,1.0)).xyz;
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
//#define#displacementTexture# vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(u_displacementTexture, vTexcoord + vec2(
//#define#displacementTexture#    u_displacementFlowSpeedX * (uTime/1000.0),
//#define#displacementTexture#    u_displacementFlowSpeedY * (uTime/1000.0)
//#define#displacementTexture# )).x * u_displacementPower ;
vReflectionCubeCoord = -vVertexPositionEye4.xyz;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;
}
*/},t=function(){
/* @preserve
precision mediump float;
//#define#diffuseTexture# uniform sampler2D u_diffuseTexture;
//#define#normalTexture# uniform sampler2D u_normalTexture;
//#define#specularTexture# uniform sampler2D u_specularTexture;
uniform samplerCube u_environmentTexture;
//#define#normalTexture# uniform float u_normalPower;
uniform float u_shininess;
uniform float u_specularPower;
uniform float u_reflectionPower;
uniform float u_alpha;
varying vec4 vVertexPositionEye4;
varying vec3 vReflectionCubeCoord;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
vec4 la;
vec4 ld;
vec4 ls;
vec4 texelColor= vec4(0.0,0.0,0.0,0.0);
vec4 reflectionColor;
vec4 specularLightColor= vec4(1.0, 1.0, 1.0, 1.0);
vec4 finalColor;
vec3 N;
vec3 L;
float lambertTerm;
float specular;
float specularTextureValue;
float distanceLength;
float attenuation;
void main(void) {
la = uAmbientLightColor * uAmbientLightColor.a;
ld = vec4(0.0, 0.0, 0.0, 1.0);
ls = vec4(0.0, 0.0, 0.0, 1.0);
texelColor = vec4(0.0,0.0,0.0,0.0);
//#define#diffuseTexture# texelColor = texture2D(u_diffuseTexture, vTexcoord);
//#define#diffuseTexture# texelColor.rgb *= texelColor.a;
//#define#diffuseTexture# if(texelColor.a ==0.0) discard;
N = normalize(vVertexNormal);
//#define#normalTexture# vec4 normalColor = texture2D(u_normalTexture, vTexcoord);
//#define#normalTexture# if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb * u_normalPower  - 0.5));
reflectionColor = textureCube(u_environmentTexture, 2.0 * dot(vReflectionCubeCoord, N) * N - vReflectionCubeCoord);
texelColor = mix(texelColor,reflectionColor ,u_reflectionPower);
specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
specularTextureValue = 1.0;
//#define#specularTexture#  specularTextureValue = texture2D(u_specularTexture, vTexcoord).r;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPositionList[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uDirectionalLightColorList[i] * texelColor * lambertTerm * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * pow( max(dot(reflect(L, N), -L), 0.0), u_shininess) * u_specularPower * specularTextureValue * uDirectionalLightIntensityList[i];
}
}
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
L =  -uPointLightPositionList[i] + vVertexPositionEye4.xyz;
distanceLength = length(L);
if(uPointLightRadiusList[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(L);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uPointLightColorList[i] * texelColor * lambertTerm * attenuation * uPointLightIntensityList[i] * uPointLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensityList[i] ;
}
}
}
finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a * u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedEnvironmentMaterial=function(i,a,o,s,d,f){if(!(this instanceof RedEnvironmentMaterial))return new RedEnvironmentMaterial(i,a,o,s,d,f);i instanceof RedGL||RedGLUtil.throwFunc("RedEnvironmentMaterial : RedGL Instance만 허용.",i),o instanceof RedBitmapCubeTexture||RedGLUtil.throwFunc("RedEnvironmentMaterial : environmentTexture - RedBitmapCubeTexture Instance만 허용."),this.makeProgramList(this,i,"RedEnvironmentMaterialProgram",e,t,n),this.diffuseTexture=a,this.environmentTexture=o,this.normalTexture=s,this.specularTexture=d,this.displacementTexture=f,this.normalPower=1,this.shininess=8,this.specularPower=1,this.reflectionPower=1,this.displacementPower=0,this.displacementFlowSpeedX=0,this.displacementFlowSpeedY=0,this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial;var i={callback:function(){this._searchProgram("RedEnvironmentMaterialProgram",n)}};RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","alpha","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","diffuseTexture","sampler2D",i),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","environmentTexture","samplerCube",{essential:!0,callback:i.callback}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","normalTexture","sampler2D",i),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","specularTexture","sampler2D",i),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementTexture","sampler2D",i),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","normalPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","specularPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","reflectionPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementFlowSpeedX","number"),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementFlowSpeedY","number"),Object.freeze(RedEnvironmentMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
vTexcoord = aTexcoord;
gl_PointSize = uPointSize;
//#define#sprite3D#true# gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
//#define#sprite3D#true# if(!u_PerspectiveScale){
//#define#sprite3D#true#   gl_Position /= gl_Position.w;
//#define#sprite3D#true#   gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1] * uResolution.x/uResolution.y);
//#define#sprite3D#true# }
//#define#sprite3D#false# gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_alpha;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
finalColor.rgb *= finalColor.a;
if(finalColor.a ==0.0) discard;
finalColor.a *= u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedBitmapMaterial=function(n,i){if(!(this instanceof RedBitmapMaterial))return new RedBitmapMaterial(n,i);n instanceof RedGL||RedGLUtil.throwFunc("RedBitmapMaterial : RedGL Instance만 허용.",n),this.makeProgramList(this,n,"RedBitmapMaterialProgram",e,t),this.diffuseTexture=i,this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedBitmapMaterial","diffuseTexture","sampler2D",{essential:!0}),RedDefinePropertyInfo.definePrototype("RedBitmapMaterial","alpha","number",{min:0,max:1}),Object.freeze(RedBitmapMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
vColor = aVertexColor;
gl_Position = uPMatrix * uCameraMatrix* vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize/gl_Position.w * uResolution.y;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform float u_alpha;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = vColor;
finalColor.a *= u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedParticleColorMaterial=function(n){if(!(this instanceof RedParticleColorMaterial))return new RedParticleColorMaterial(n);n instanceof RedGL||RedGLUtil.throwFunc("RedParticleColorMaterial : RedGL Instance만 허용.",n),this.makeProgramList(this,n,"particleColorProgram",e,t),this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedParticleColorMaterial","alpha","number",{min:0,max:1}),Object.freeze(RedParticleColorMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
gl_Position = uPMatrix * uCameraMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize/gl_Position.w * uResolution.y;
vColor = aVertexColor;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_alphaTest;
uniform float u_alpha;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vec2(gl_PointCoord.x, - gl_PointCoord.y));
finalColor.rgb *= finalColor.a;
finalColor.rgb += vColor.rgb * vColor.a;
finalColor.a *= vColor.a;
finalColor.a *= u_alpha;
if(finalColor.a < u_alphaTest) discard;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedParticleBitmapMaterial=function(n,i){if(!(this instanceof RedParticleBitmapMaterial))return new RedParticleBitmapMaterial(n,i);n instanceof RedGL||RedGLUtil.throwFunc("RedParticleBitmapMaterial : RedGL Instance만 허용.",n),this.makeProgramList(this,n,"particleBitmapProgram",e,t),this.diffuseTexture=i,this.alpha=1,this.alphaTest=.01,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedParticleBitmapMaterial","diffuseTexture","sampler2D",{essential:!0}),RedDefinePropertyInfo.definePrototype("RedParticleBitmapMaterial","alpha","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedParticleBitmapMaterial","alphaTest","number",{min:0,max:1}),Object.freeze(RedParticleBitmapMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
vColor = aVertexColor;
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize/gl_Position.w * uResolution.y;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform float u_alpha;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = vColor;
finalColor.a *= u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedPointColorMaterial=function(n){if(!(this instanceof RedPointColorMaterial))return new RedPointColorMaterial(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPointColorMaterial : RedGL Instance만 허용.",n),this.makeProgramList(this,n,"pointColorProgram",e,t),this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedPointColorMaterial","alpha","number",{min:0,max:1}),Object.freeze(RedPointColorMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize/gl_Position.w * uResolution.y;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_alphaTest;
uniform float u_alpha;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vec2(gl_PointCoord.x, - gl_PointCoord.y));
finalColor.rgb *= finalColor.a;
if(finalColor.a < u_alphaTest) discard;
finalColor.a *= u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedPointBitmapMaterial=function(n,i){if(!(this instanceof RedPointBitmapMaterial))return new RedPointBitmapMaterial(n,i);n instanceof RedGL||RedGLUtil.throwFunc("RedPointBitmapMaterial : RedGL Instance만 허용.",n),this.makeProgramList(this,n,"pointBitmapProgram",e,t),this.diffuseTexture=i,this.alpha=1,this.alphaTest=.1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedPointBitmapMaterial","alpha","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedPointBitmapMaterial","alphaTest","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedPointBitmapMaterial","diffuseTexture","sampler2D",{essential:!0}),Object.freeze(RedPointBitmapMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
uniform vec4 u_sheetRect;
void main(void) {
vTexcoord = aTexcoord;
vTexcoord = vec2(
vTexcoord.s * u_sheetRect.x + u_sheetRect.z,
vTexcoord.t * u_sheetRect.y - u_sheetRect.w
);
gl_PointSize = uPointSize;
//#define#sprite3D#true# gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
//#define#sprite3D#true# if(!u_PerspectiveScale){
//#define#sprite3D#true#   gl_Position /= gl_Position.w;
//#define#sprite3D#true#   gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1] * uResolution.x/uResolution.y);
//#define#sprite3D#true# }
//#define#sprite3D#false# gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_alpha;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
finalColor.rgb *= finalColor.a;
if(finalColor.a ==0.0) discard;
finalColor.a *= u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedSheetMaterial=function(n,i,a,o,s,d){if(!(this instanceof RedSheetMaterial))return new RedSheetMaterial(n,i,a,o,s,d);n instanceof RedGL||RedGLUtil.throwFunc("RedSheetMaterial : RedGL Instance만 허용.",n),a=a||60,o=o||1,s=s||1,d=d||1,this.makeProgramList(this,n,"RedSheetMaterialProgram",e,t),this.diffuseTexture=i,this._sheetRect=new Float32Array(4),this.alpha=1,this._perFrameTime=0,this._nextFrameTime=0,this._playYn=!0,this.segmentW=o,this.segmentH=s,this.totalFrame=d,this.frameRate=a,this.currentIndex=0,this.loop=!0,this._aniMap={},this.__RedSheetMaterialYn=!0,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedSheetMaterial.prototype.addAction=function(e,t){this._aniMap[e]=t},RedSheetMaterial.prototype.setAction=function(e){this.diffuseTexture=this._aniMap[e].texture,this.segmentW=this._aniMap[e].segmentW,this.segmentH=this._aniMap[e].segmentH,this.totalFrame=this._aniMap[e].totalFrame,this.frameRate=this._aniMap[e].frameRate,this.currentIndex=0,this._nextFrameTime=0},RedSheetMaterial.prototype.play=function(){this._playYn=!0},RedSheetMaterial.prototype.stop=function(){this._playYn=!1,this.currentIndex=0},RedSheetMaterial.prototype.pause=function(){this._playYn=!1},RedSheetMaterial.prototype.gotoAndStop=function(e){e>this.totalFrame-1&&(e=this.totalFrame-1),e<0&&(e=0),this._playYn=!1,this.currentIndex=e},RedSheetMaterial.prototype.gotoAndPlay=function(e){e>this.totalFrame-1&&(e=this.totalFrame-1),e<0&&(e=0),this._playYn=!0,this.currentIndex=e,this._nextFrameTime=0},RedDefinePropertyInfo.definePrototype("RedSheetMaterial","diffuseTexture","sampler2D",{essential:!0}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","totalFrame","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","loop","boolean",!0),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","frameRate","number",{min:1,callback:function(){this._perFrameTime=1e3/this._frameRate}}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","segmentW","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","segmentH","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","alpha","number",{min:0,max:1}),Object.freeze(RedSheetMaterial)}(),function(){var e,t,r,n=["normalTexture","specularTexture","displacementTexture"];e=function(){
/* @preserve
//#define#displacementTexture# uniform sampler2D u_displacementTexture;
//#define#displacementTexture# uniform float u_displacementPower;
//#define#displacementTexture# uniform float u_displacementFlowSpeedX;
//#define#displacementTexture# uniform float u_displacementFlowSpeedY;
varying vec4 vVertexPositionEye4;
void main(void) {
vTexcoord = aTexcoord;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
//#define#displacementTexture# vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(u_displacementTexture, vTexcoord + vec2(
//#define#displacementTexture#    u_displacementFlowSpeedX * (uTime/1000.0),
//#define#displacementTexture#    u_displacementFlowSpeedY * (uTime/1000.0)
//#define#displacementTexture# )).x * u_displacementPower ;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;
//#define#directionalShadow#true# vResolution = uResolution;
//#define#directionalShadow#true# vShadowPos = cTexUnitConverter  *  uDirectionalShadowLightMatrix * uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
//#define#normalTexture# uniform sampler2D u_normalTexture;
//#define#specularTexture# uniform sampler2D u_specularTexture;
//#define#normalTexture# uniform float u_normalPower;
uniform float u_shininess;
uniform float u_specularPower;
uniform float u_alpha;
varying vec4 vVertexPositionEye4;
float cShadowAcneRemover = 0.0007;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
float decodeFloat (vec4 color) {
const vec4 cBitShift = vec4(
1.0 / (256.0 * 256.0 * 256.0),
1.0 / (256.0 * 256.0),
1.0 / 256.0,
1
);
return dot(color, cBitShift);
}
vec4 la;
vec4 ld;
vec4 ls;
vec4 texelColor;
vec4 specularLightColor= vec4(1.0, 1.0, 1.0, 1.0);
vec4 finalColor;
vec3 N;
vec3 L;
float lambertTerm;
float specular;
float specularTextureValue;
float distanceLength;
float attenuation;
void main(void) {
la = uAmbientLightColor * uAmbientLightColor.a;
ld = vec4(0.0, 0.0, 0.0, 1.0);
ls = vec4(0.0, 0.0, 0.0, 1.0);
texelColor = texture2D(u_diffuseTexture, vTexcoord);
texelColor.rgb *= texelColor.a;
if(texelColor.a ==0.0) discard;
///////////////////////////////////////////////////////////////////////////////////////
//#define#directionalShadow#true#	vec3 fragmentDepth = vShadowPos.xyz;
//#define#directionalShadow#true#    fragmentDepth.z -= cShadowAcneRemover;
//#define#directionalShadow#true#	float amountInLight = 0.0;
//#define#directionalShadow#true#	for (int x = -1; x <= 1; x++) {
//#define#directionalShadow#true#	    for (int y = -1; y <= 1; y++) {
//#define#directionalShadow#true#	        vec2 tUV = fragmentDepth.xy + vec2(float(x)/vResolution.x, float(y)/vResolution.y) ;
//#define#directionalShadow#true#            if(tUV.x<0.0) continue;
//#define#directionalShadow#true#            if(tUV.x>1.0) continue;
//#define#directionalShadow#true#            if(tUV.y<0.0) continue;
//#define#directionalShadow#true#            if(tUV.y>1.0) continue;
//#define#directionalShadow#true#	        float texelDepth = decodeFloat(texture2D(uDirectionalShadowTexture,tUV));
//#define#directionalShadow#true#	        if (fragmentDepth.z < texelDepth ) amountInLight += 0.5;
//#define#directionalShadow#true#	       // texelColor =  texture2D(uDirectionalShadowTexture,tUV);
//#define#directionalShadow#true#	    }
//#define#directionalShadow#true#	}
//#define#directionalShadow#true#	amountInLight /= 9.0;
//#define#directionalShadow#true#	texelColor.rgb *= (1.0-amountInLight);
///////////////////////////////////////////////////////////////////////////////////////
N = normalize(vVertexNormal);
//#define#normalTexture# vec4 normalColor = texture2D(u_normalTexture, vTexcoord);
//#define#normalTexture# if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb * u_normalPower  - 0.5));
specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
specularTextureValue = 1.0;
//#define#specularTexture# specularTextureValue = texture2D(u_specularTexture, vTexcoord).r;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPositionList[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uDirectionalLightColorList[i] * texelColor * lambertTerm * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * pow( max(dot(reflect(L, N), -L), 0.0), u_shininess) * u_specularPower * specularTextureValue * uDirectionalLightIntensityList[i];
}
}
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
L =  -uPointLightPositionList[i] + vVertexPositionEye4.xyz;
distanceLength = length(L);
if(uPointLightRadiusList[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(L);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uPointLightColorList[i] * texelColor * lambertTerm * attenuation * uPointLightIntensityList[i] * uPointLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensityList[i] ;
}
}
}
finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a * u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/};var i={callback:function(){this._searchProgram("RedStandardMaterialProgram",n)}};(RedStandardMaterial=function(i,a,o,s,d){if(!(this instanceof RedStandardMaterial))return new RedStandardMaterial(i,a,o,s,d);i instanceof RedGL||RedGLUtil.throwFunc("RedStandardMaterial : RedGL Instance만 허용.",i),this.makeProgramList(this,i,"RedStandardMaterialProgram",e,t,n),this.diffuseTexture=a,this.normalTexture=o,this.specularTexture=s,this.displacementTexture=d,this.normalPower=1,this.shininess=16,this.specularPower=1,this.displacementPower=0,this.displacementFlowSpeedX=0,this.displacementFlowSpeedY=0,this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedStandardMaterial","alpha","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","diffuseTexture","sampler2D",{essential:!0,callback:i.callback}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","normalTexture","sampler2D",i),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","specularTexture","sampler2D",i),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementTexture","sampler2D",i),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","normalPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","specularPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementFlowSpeedX","number"),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementFlowSpeedY","number"),Object.freeze(RedStandardMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
vTexcoord = aTexcoord;
gl_PointSize = uPointSize;
//#define#sprite3D#true# gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
//#define#sprite3D#true# if(!u_PerspectiveScale){
//#define#sprite3D#true#   gl_Position /= gl_Position.w;
//#define#sprite3D#true#   gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1] * uResolution.x/uResolution.y);
//#define#sprite3D#true# }
//#define#sprite3D#false# gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_videoTexture;
uniform float u_alpha;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_videoTexture, vTexcoord);
finalColor.rgb *= finalColor.a;
if(finalColor.a ==0.0) discard;
finalColor.a = u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedVideoMaterial=function(n,i){if(!(this instanceof RedVideoMaterial))return new RedVideoMaterial(n,i);n instanceof RedGL||RedGLUtil.throwFunc("RedVideoMaterial : RedGL Instance만 허용.",n),this.makeProgramList(this,n,"RedVideoMaterialProgram",e,t),this.videoTexture=i,this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedVideoMaterial","alpha","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedVideoMaterial","videoTexture","samplerVideo",{essential:!0}),Object.freeze(RedVideoMaterial)}(),(RedAmbientLight=function(e,t,r){if(!(this instanceof RedAmbientLight))return new RedAmbientLight(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedAmbientLight : RedGL Instance만 허용.","입력값 : "+e),this._lightColor=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?.1:r,this.color=t||"#fff",this._UUID=RedGL.makeUUID()}).TYPE="RedAmbientLight",RedAmbientLight.prototype=new RedBaseLight,Object.defineProperty(RedAmbientLight.prototype,"TYPE",{configurable:!1,writable:!1,value:RedAmbientLight.TYPE}),Object.freeze(RedAmbientLight),(RedDirectionalLight=function(e,t,r){if(!(this instanceof RedDirectionalLight))return new RedDirectionalLight(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedDirectionalLight : RedGL Instance만 허용.","입력값 : "+e),this._lightColor=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?1:r,this.color=t||"#fff",this.x=0,this.y=-1,this.z=0,this._UUID=RedGL.makeUUID(),this.debug=!1,this._debugObject=RedSprite3D(e,RedBitmapMaterial(e,RedBitmapTexture(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA25pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDozQjcyMEREMTUyMDYxMUU4OTRDNTgzQTBBMEY2MkFFNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDODA1NTI0RjUyMDYxMUU4QkVBQTg3NjZCN0M1OUI2OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDODA1NTI0RTUyMDYxMUU4QkVBQTg3NjZCN0M1OUI2OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowNmFjYmZjZi05YjBkLThlNGItODZiNy1kNWViYWNjZDg4OGMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6M0I3MjBERDE1MjA2MTFFODk0QzU4M0EwQTBGNjJBRTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4vVcpuAAAHNUlEQVR42uxbeWyURRT/tiw9OAJYUekfeBCFNmqlkAgRtURQaTywWIhGSfDAAzmkggcoKopKRQXFKKZqNGmkqGAkGEQFhaQenGrAI3iUpKilaiPSytKt74XfF6evM/vN7n67+xn6kl/Sb3bmvTdvZt68eTMNtbe3O8cyhboM0GWALgN0LKkJpUv2lYQFBFbgYcI7aZF6bcf+ZmXI8L0IlYShhBLCbELPTCiSKQOcTRimfA8nFP/fDTCEMJrQw2bpEVqV71ZLXXpARmHQDDCZ8DnhI8IrFkZoI0SVb/77iEXnX4WMzyAzEAbIJSwk9Mb3RMKMFMzWmYQK/N0bMnODYAB2q42i7B5CkY+dZ153i7JGyM64Af4hVIk13cdjFoQsy1yaAZ6qz6iC7ED4gJWEjaLsRkKpoX53MX1zUaajUvBSaSNkBmoXuI/QonyHCXMIeZq6PxJ+Vb5/I/ykqZcHHmGljGXcG8RtcCfhRVFWpjgulfahEzvQjn1GvaZeBXio9AJhV1ADoUcITaJsmKHuKvxWgr91NFx8N0FG2gOhbpb1WMGbxXRd6SE/lg61wrneRPjdT51tDkOTELe3YvrVWPC9CnH+h4SPlfKLCKMQChco/oEN1UD4krAF7Vy6EO14uay2kH0N4XZCDmFJpwEQhyEvAwxF1OV66MOEd8G4znIkuJNTCNcjhO3jUb+ZsIfwOqLKFks5IzFQlxOyURYhnAvjJXQa7Cu2J2Y8gbCBsJhwskf7SzCizxJGWHTejSFGoM0W8IhFA6HLBuiWLbbbvsn4gJ2GKd8T29NWeGodHx6NdXByWQn6pxLwqDT8XgEd5hiO0zXog5HCHkr8QbiO8AMOHwPF78fDUZWL9cmeep6B527CNsK3hAMKn8HYFYo0HX2S0I8wXyRUag0y6nFwWuBl5bDFSPCiuR/WvItwg6bO+YoB7jR0fjthBXxIg0FWAdbwVIy+SvOwyzytyNTRyzDYnlSlxEYh6hunePCLsV75t82aNrx7PCiiv1h0IurfajC2K+t9ZSd5j7AIv1mnxBLNCXJK61KMEiuxCdvOds0U5o48lGCcsgDt5RIqwUGoFMbfAQMcjDcn6GdSlPfe5aJsKWFWksHaM8gFqDSN8HxC3FKUFM3CulXpa2xPydJi8FJpql+6+2WACwiDNCPX4APvBvBSaRBkBsYAY+AXXOItbo2PZ5Y14Kn6oDF+MA7HyPMVI5I6IrI2XPY9Yb9SfpZoX6c5FSZDTeA5OIZM3jnOgL7t4lDUhiN0i40BLkNkVYjGUc0pqxGxQS1m0QBR5xvHf5I8B0A268eJWL5d6q/RNwSD7EYaba2XAZZrIj5J/bA9rYbFszUj5jdJntnoWHfoMtjCT50iDZCpm6HAkG4GTMMSKFKmjzRaI6wewfdhUSc/BbpKnoehXwS6LMQSaNPo24bQuMrGAGuRkChWHIi6nrjNd0pYGxUOkWlICgwgee5X1nstQvDTYZB20ccInGCr7S7A3vLTOJT7inCFSE7k++gL8sFTypQG2Z+pOOADEYezQxrv4+iPF07uIGQGJhD6hLBXlM3C8TZZKtCcJ/ZCZmAMEMVZX6UzCXN94D0XvFRaodnv02qAXkhHLXL+u/6qRrCh0kybrIzHcXim5jhcjb9LocPVIhS3pmM+IRLPDCiE5TcrnXegQDn+ZuGzNW25I5zcvMXDLxSgzjpD52crHSx3Ot47joNu1U4cL0hsZkAIcfbkGCFyKpOiLj3qdEyK8uXL24a65qRonBkhjvmf42YGQQeQCXpL45QqkcxI1tFG4QiXaPzXBJxd+hvaciL3DudodjuhJXCOofN/I6zky8tVBo/MCvPN7vYEPXYUbcs0nXd/XwUdqqBTp/FGHxLeBf5EGOkSJyLfJIzFqPzs0X49nNV0RJbNFh1vRt3paLveo349dBmLmaieSyLoQ1I+QL0c5UTkGxad4PVZgmjNj8vRMfAbNlkmvhy9DUmdpC9H1ZliO41V59SKkTFtTe4Vdpvh9/NgxFyFt22qrZuWb4LboG3n+dDykkitTfTgG4v3JKfjW6LqOI7abekMhV2ar1Fwq6FuBZzcNkf/jEbX9jixFSZNfl6McP6gTgQn6xCmymQkxxP80us05XDDT2D3iXp5cLpl4qg+0kn0nVAKX4s/Jjp/BNuT7oED5+ZOEKHvqYa8RJXTMTOdB1m+kF8GmIQRdMR63WSoH3E6P5aOGOpuUg4/Lo2GzEAYIAc5xFyxly+L0abdssylZSKGyIXMnCAYIKQJRZ/QHI2TIeb1uCjr74f+fhiApy9fkvyFbw5Plzr+E88C90UIy3rAsX9AZaSwT8q9RviCcJJz9FXZIQu5WWIgvN71Mc8pyC384li+AEmXARwoZKtU1On8WNrm6fshp/Oj7EDsAvHSLhHkbMM5IO0UzpAB+Oj6FPJ4IRxaDmZCka5/nOwyQJcBjm0D/CvAAF/S81D+EWScAAAAAElFTkSuQmCC")))}).TYPE="RedDirectionalLight",RedDirectionalLight.prototype=new RedBaseLight,Object.defineProperty(RedDirectionalLight.prototype,"TYPE",{configurable:!1,writable:!1,value:RedDirectionalLight.TYPE}),Object.freeze(RedDirectionalLight),(RedPointLight=function(e,t,r){if(!(this instanceof RedPointLight))return new RedPointLight(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedPointLight : RedGL Instance만 허용.","입력값 : "+e),this._lightColor=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?1:r,this.color=t||"#fff",this.x=0,this.y=0,this.z=0,this.radius=1,this.debug=!1,this._debugObject=RedMesh(e,RedSphere(e,1,16,16,16),RedColorMaterial(e)),this._debugObject.drawMode=e.gl.LINE_STRIP,this._UUID=RedGL.makeUUID()}).TYPE="RedPointLight",RedPointLight.prototype=new RedBaseLight,Object.defineProperty(RedPointLight.prototype,"TYPE",{configurable:!1,writable:!1,value:RedPointLight.TYPE}),RedDefinePropertyInfo.definePrototype("RedPointLight","radius","number",{min:0}),Object.freeze(RedPointLight),JsonModelLoader=function(e,t,r,n){if(!(this instanceof JsonModelLoader))return new JsonModelLoader(e,t,r,n);var i=new XMLHttpRequest;i.open("GET",r,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.onreadystatechange=function(){if(4==i.readyState){var r,a,o,s;for(a=[],o=0,s=(r=JSON.parse(i.responseText)).position.length/3;o<s;o++)a.push(r.position[3*o],r.position[3*o+1],r.position[3*o+2]),a.push(r.normal[3*o],r.normal[3*o+1],r.normal[3*o+2]),r.uvs?a.push(r.uvs[2*o],r.uvs[2*o+1]):a.push(0,0);n&&n(RedBuffer(e,t,RedBuffer.ARRAY_BUFFER,new Float32Array(a),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),RedBuffer(e,t,RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(r.index)))}},i.send()},Object.freeze(JsonModelLoader),function(){var e,t;t=function(){},RedMTLLoader=function(r,n,i,a){if(!(this instanceof RedMTLLoader))return new RedMTLLoader(r,n,i,a);var o=this,s=new XMLHttpRequest;s.open("GET",n+i,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.onreadystatechange=function(){if(4==s.readyState){var n;if(o.complete=!0,200==s.status)n=e(o,r,s.responseText),o.parseData=n;else o.parseData=new t;a&&a(o.parseData)}},s.addEventListener("error",function(e){}),s.send(),this.path=n,this.fileName=i,this.complete=!1,this.parseData=null},e=function(e,r,n){var i,a,o,s,d,f,c,u,l,h,R,m,p,_;for(var P in i={},o=/^(newmtl )/,s=/^(Ns )/,d=/^(Ka )/,f=/^(Kd )/,c=/^(Ks )/,u=/^(Ni )/,l=/^(d )/,h=/^(illum )/,R=/^(map_Kd )/,/^(map_Ks )/,m=/^(map_Ns )/,p=/^(map_bump )/,(n=n.replace(/^\#[\s\S]+?\n/g,"")).split("\n").forEach(function(t){var r;o.test(t)?(r=t.replace("newmtl ","").trim(),_={name:r},i[r]=_):d.test(t)?_.Ka=t.replace("Ka ","").split(" "):f.test(t)?_.Kd=t.replace("Kd ","").split(" "):c.test(t)?_.Ks=t.replace("Ks ","").split(" "):s.test(t)?_.Ns=+t.replace("Ns ",""):u.test(t)?_.Ni=+t.replace("Ni ",""):l.test(t)?_.d=+t.replace("d ",""):h.test(t)?(_.illum=+t.replace("illum ",""),_.illum):R.test(t)?_.map_Kd=e.path+t.replace("map_Kd ",""):m.test(t)?_.map_Ns=e.path+t.replace("map_Ns ",""):p.test(t)&&(_.map_bump=e.path+t.replace("map_bump ","").split(" ")[2])}),a=new t,i)a[P]=i[P];return a},Object.freeze(RedMTLLoader)}(),function(){var e,t,r,n,i,a,o,s,d,f,c,u,l,h,R;RedOBJLoader=function(t,r,n,i){if(!(this instanceof RedOBJLoader))return new RedOBJLoader(t,r,n,i);var a=this,o=new XMLHttpRequest;o.open("GET",r+n,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.onreadystatechange=function(){4==o.readyState&&(a.result=e(a,t,o.responseText),a.modelParsingComplete=!0,a.resultMesh=void 0,i&&(a.mtlLoader?a.mtlLoader.complete&&i(a.result):i(a.result)))},o.send(),this.path=r,this.fileName=n,this.mtlLoader=null,this.modelParsingComplete=!1,this.callback=i,this.resultMesh=RedMesh(t),this.resultMesh.name="instanceOfRedOBJLoader_"+RedGL.makeUUID(),this.result=null},r=function(e,t,r){var n,i,a,o;for(n in o={},t){var s,d,f,c,u,l;if((a=t[n]).mesh,a.use&&a.resultInterleave.length)l=a.ableLight,(i=r.parseData[a.materialKey])&&(i.map_Kd?(o[i.map_Kd]?d=o[i.map_Kd]:(d=RedBitmapTexture(e,i.map_Kd),o[i.map_Kd]=d),s=l?RedStandardMaterial(e,d):RedBitmapMaterial(e,d)):i.Kd&&(f=255*i.Kd[0],c=255*i.Kd[1],u=255*i.Kd[2],s=l?RedColorPhongTextureMaterial(e,RedGLUtil.rgb2hex(f,c,u)):a.ableNormal?RedColorPhongMaterial(e,RedGLUtil.rgb2hex(f,c,u)):RedColorMaterial(e,RedGLUtil.rgb2hex(f,c,u))),s&&(i.map_Ns&&(o[i.map_Ns]?d=o[i.map_Ns]:(d=RedBitmapTexture(e,i.map_Ns),o[i.map_Ns]=d),s.specularTexture=d),i.map_bump&&(o[i.map_bump]?d=o[i.map_bump]:(d=RedBitmapTexture(e,i.map_bump),o[i.map_bump]=d),s.normalTexture=d),void 0!=i.Ns&&(s.shininess=i.Ns),a.mesh.material=s))}},t=function(e,r,n){for(var i in n){var a,o;if((a=n[i]).use){var s,d,f,c=[];a.resultPosition.length&&c.push(RedInterleaveInfo("aVertexPosition",3)),a.resultNormal.length&&c.push(RedInterleaveInfo("aVertexNormal",3)),a.resultUV.length&&c.push(RedInterleaveInfo("aTexcoord",2)),s=RedBuffer(e,i+"_interleave",RedBuffer.ARRAY_BUFFER,new Float32Array(a.resultInterleave.length?a.resultInterleave:a.resultPosition),c),a.index.length&&a.index.length&&(d=RedBuffer(e,i+"_index",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(a.index))),f=a.resultUV.length&&a.resultNormal.length?RedColorPhongTextureMaterial(e,"#00ff00"):a.resultNormal?RedColorPhongMaterial(e,"#00ff00"):RedColorMaterial(e,"#0000ff"),o=RedMesh(e,RedGeometry(s,d),f),a.ableUV=!!a.resultUV.length,a.ableNormal=!!a.resultNormal.length,a.ableLight=!!(a.ableUV&a.ableNormal)}else o=RedMesh(e);o.name=i,a.mesh=o,r.addChild(o),t(e,o,a.childrenInfo)}},h=/^(mtllib )/,R=/^(usemtl )/,i=/^o /,a=/^g /,o=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,s=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,d=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,f=/f\s+(([\d]{1,}[\s]?){3,})+/,c=/f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,u=/f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,l=/f\s+((([\d]{1,}\/\/[\d]{1,}[\s]?){3,})+)/,n=function(e,t,n){var m,p,_,P,g,E,y,M,T,v;for(_={position:[],normal:[],uv:[],points:[],normalPoints:[],uvPoints:[]},p={},m={},y=n.length;y--;)if(i.test(n[y])){M=!0;break}return M||(v={name:T="objModel"+RedGL.makeUUID(),groupName:T,index:[],position:[],resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},p[T]=P=v,m[T]=P,g=T),n.forEach(function(n){if(h.test(n))return E=RedMTLLoader(e,t.path,n.split(" ")[1],function(n){t.mtlLoader=n,t.modelParsingComplete&&t.callback&&(r(e,m,E),t.callback(t.result))}),void(t.mtlLoader=E);var y;if(R.test(n))M=n.split(" ").slice(1).join("").trim(),m[g].materialKey=M;else if(a.test(n))M=n.split(" ").slice(1).join("").trim(),p[g].use=!1,T={name:M,groupName:g,materialKey:M.replace(g+"_",""),index:[],position:P.position,resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},m[M]=P=T,p[g].childrenInfo[M]=P;else if(i.test(n)){var M,T;T={name:M=n.split(" ").slice(1).join("").trim(),groupName:M,materialKey:M,index:[],position:[],resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},p[M]=P=T,m[M]=P,g=M}if(o.test(n))y=n.split(" "),_.position.push(+y[1],+y[2],+y[3]),P.position.push(+y[1],+y[2],+y[3]),_.points[_.points.length]=[+y[1],+y[2],+y[3]];else if(s.test(n)){var v;v=n.split(" "),_.normal.push(+v[1],+v[2],+v[3]),_.normalPoints[_.normalPoints.length]=[+v[1],+v[2],+v[3]]}else if(d.test(n)){var b;b=n.split(" "),_.uv.push(+b[1],+b[2]),_.uvPoints[_.uvPoints.length]=[+b[1],+b[2]]}else if(l.test(n))(x=n.split(" ").slice(1,4)).forEach(function(e){var t,r,n;n=0,e=e.split("/"),I=+e[0]-1,L=+e[2]-1,t=_.points[I],r=_.normalPoints[L],_.position.length&&(n+=3),_.normal.length&&(n+=3),P.index.push(P.resultInterleave.length/n),_.position.length&&(P.resultPosition.push(t[0],t[1],t[2]),P.resultInterleave.push(t[0],t[1],t[2])),_.normal.length&&(P.resultNormal.push(r[0],r[1],r[2]),P.resultInterleave.push(r[0],r[1],r[2]))});else if(u.test(n)){var L;if(4==(x=n.split(" ").slice(1,5)).length){var w=x[3];x[3]=x[0],x[4]=x[2],x[5]=w}x.forEach(function(e){var t,r,n,i;i=0,e=e.split("/"),I=+e[0]-1,U=+e[1]-1,L=+e[2]-1,t=_.points[I],n=_.uvPoints[U],r=_.normalPoints[L],_.position.length&&(i+=3),_.normal.length&&(i+=3),_.uv.length&&(i+=2),P.index.push(P.resultInterleave.length/i),_.position.length&&(P.resultPosition.push(t[0],t[1],t[2]),P.resultInterleave.push(t[0],t[1],t[2])),_.normal.length&&(P.resultNormal.push(r[0],r[1],r[2]),P.resultInterleave.push(r[0],r[1],r[2])),_.uv.length&&(P.resultUV.push(n[0],n[1]),P.resultInterleave.push(n[0],n[1]))})}else if(c.test(n)){var x,U;(x=n.split(" ").slice(1,4)).forEach(function(e){var t,r,n;n=0,e=e.split("/"),I=+e[0]-1,U=+e[1]-1,t=_.points[I],r=_.uvPoints[U],_.position.length&&(n+=3),_.uv.length&&(n+=2),P.index.push(P.resultInterleave.length/n),_.position.length&&(P.resultPosition.push(t[0],t[1],t[2]),P.resultInterleave.push(t[0],t[1],t[2])),_.uv.length&&(P.resultUV.push(r[0],r[1]),P.resultInterleave.push(r[0],r[1]))})}else if(f.test(n)){var I;I=n.split(" "),P.resultInterleave=P.resultPosition=P.position,P.index.push(+I[1]-1,+I[2]-1,+I[3]-1),P.index.push(+I[1]-1,+I[3]-1,+I[4]-1)}}),{info:m,infoHierarchy:p}},e=function(e,r,i){i=i.replace(/^\#[\s\S]+?\n/g,"");var a=n(r,e,i.split("\n"));return t(r,e.resultMesh,a.infoHierarchy),new function(e){for(var t in e)this[t]=e[t]}({fileName:e.fileName,path:e.path,resultMesh:e.resultMesh,parseRawInfo:a.info,parseInfoHierarchy:a.infoHierarchy,parseInfoMaterial:e.mtlLoader})},Object.freeze(RedOBJLoader)}(),function(){var e,t,r,n,i,a,o,s;RedDAELoader=function(t,r,n,i){if(!(this instanceof RedDAELoader))return new RedDAELoader(t,r,n,i);var a=this,o=new XMLHttpRequest;o.open("GET",r+n,!0),o.setRequestHeader("Content-Type","application/xml; charset=UTF-8"),o.onreadystatechange=function(){if(4==o.readyState&&200===o.status){var r=new DOMParser;a.result=e(a,t,r.parseFromString(o.responseText,"text/xml")),i&&i(a.result)}},o.send(),this.path=r,this.fileName=n,this.callback=i,this.resultMesh=RedMesh(t),this.resultMesh.name="instanceOfRedDAELoader_"+RedGL.makeUUID(),this.result=null},n=function(e){var t,r,n,i,a,o,s=[],d=[],f=[];for(i=(n=e[0].querySelector("float_array"))?n.textContent.split(" ").map(Number):null,a=(n=e[1].querySelector("float_array"))?n.textContent.split(" ").map(Number):null,o=(n=e[2].querySelector("float_array"))?n.textContent.split(" ").map(Number):null,t=0,r=i.length/3;t<r;t++)s.push([i[3*t+0],i[3*t+1],i[3*t+2]]);if(a)for(t=0,r=a.length/3;t<r;t++)d.push([a[3*t+0],a[3*t+1],a[3*t+2]]);if(o)for(t=0,r=o.length/2;t<r;t++)f.push([o[2*t+0],o[2*t+1]]);return{pointList:s,normalPointList:d,uvPointList:f}},i=function(e,t,r){var n={};return r.querySelectorAll("library_images image").forEach(function(r){n[r.getAttribute("id")]=RedBitmapTexture(e,t.path+r.querySelector("init_from").textContent)}),n},a=function(e,t){var r={};return e.querySelectorAll("library_effects effect").forEach(function(e){r[e.getAttribute("id")]={texture:t[e.querySelector("newparam init_from").textContent]}}),r},o=function(e,t){var r={};return e.querySelectorAll("library_materials material").forEach(function(e){r[e.getAttribute("id")]={effect:t[e.querySelector("instance_effect").getAttribute("url").replace("#","")]}}),r},t=function(e,t,r){var n=i(e,t,r),s=a(r,n);return{textureMap:n,effectMap:s,materialMap:o(r,s)}},s=function(e,t,r,n){n.forEach(function(n){var i,a=[],o=n.children.length;for(i={name:n.getAttribute("id"),parent:t,children:[]},r.push(i);o--;)"node"==n.children[o].nodeName&&a.push(n.children[o]);e[n.getAttribute("id")]=i,s(e,i,i.children,a)})},r=function(e,r,i){i.querySelectorAll("library_geometries geometry mesh").forEach(function(a){var o,s,d;o=a.querySelectorAll("source"),s=n(o),d=t(r,e,i);var f=a.querySelectorAll("source").length;a.querySelectorAll("polylist").forEach(function(t,n){var i,a,o,c=[],u=[],l=[],h=[],R=[];t.querySelector("p").textContent.split(" ").forEach(function(e,t){t%f==0?u.push(+e):t%f==1?l.push(+e):t%f==2&&h.push(+e)});var m={};u.forEach(function(e,t){c[8*e+0]=s.pointList[e][0],c[8*e+1]=s.pointList[e][1],c[8*e+2]=s.pointList[e][2],m[e]||(m[e]=[]),m[e].push(t),c[8*e+3]=s.normalPointList[l[t]][0],c[8*e+4]=s.normalPointList[l[t]][1],c[8*e+5]=s.normalPointList[l[t]][2],c[8*e+6]=s.uvPointList[h[t]][0],c[8*e+7]=s.uvPointList[h[t]][1],R.push(e)}),i=RedBuffer(r,"daeInterleaveBuffer"+RedGL.makeUUID(),RedBuffer.ARRAY_BUFFER,new Float32Array(c),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),a=RedBuffer(r,"daeIndexData"+RedGL.makeUUID(),RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(R)),(o=RedMesh(r)).geometry=RedGeometry(i,a);var p=d.materialMap[t.getAttribute("material")].effect.texture;o.material=RedStandardMaterial(r,p),e.resultMesh.addChild(o)})})},e=function(e,t,n){r(e,t,n);return{fileName:e.fileName,path:e.path,resultMesh:e.resultMesh}},Object.freeze(RedDAELoader)}(),(RedAxis=function(e){if(!(this instanceof RedAxis))return new RedAxis(e);var t,r,n,i,a,o;e instanceof RedGL||RedGLUtil.throwFunc("RedAxis : RedGL Instance만 허용.",e),RedBaseObject3D.build.call(this,e.gl),n=RedBox(e),i=RedColorMaterial(e,"#ff0000"),a=RedColorMaterial(e,"#00ff00"),o=RedColorMaterial(e,"#0000ff"),t=RedMesh(e,n,i),(r=RedMesh(e,n,i)).scaleX=r.scaleY=r.scaleZ=.5,r.scaleX=10,t.x=5,r.x=-5,t.children.push(r),this.children.push(t),t=RedMesh(e,n,a),(r=RedMesh(e,n,a)).scaleX=r.scaleY=r.scaleZ=.5,r.scaleY=10,t.y=5,r.y=-5,t.children.push(r),this.children.push(t),t=RedMesh(e,n,o),(r=RedMesh(e,n,o)).scaleX=r.scaleY=r.scaleZ=.5,r.scaleZ=10,t.z=5,r.z=-5,t.children.push(r),this.children.push(t),this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,Object.freeze(RedAxis),function(){var e,t,r,n,i,a;(RedGrid=function(e,t,r,n,i){if(!(this instanceof RedGrid))return new RedGrid(e,t,r,n,i);var a;e instanceof RedGL||RedGLUtil.throwFunc("RedGrid : RedGL Instance만 허용.",e),a=e.gl,RedBaseObject3D.build.call(this,a),this._redGL=e,this.size=t||100,this.divisions=r||100,this.color1=n||"#cccccc",this.color2=i||"#666666",this.geometry=this._makeGridGeometry(),this.material=RedGridMaterial(e),this.drawMode=a.LINES,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,RedGrid.prototype._makeGridGeometry=function(){if(this.color2){var o=[];for(e=this._divisions/2,t=this._size/this._divisions,r=this._size/2,n=0,i=-r;n<=this._divisions;n++,i+=t)a=n===e?RedGLUtil.hexToRGB_ZeroToOne(this.color1):RedGLUtil.hexToRGB_ZeroToOne(this.color2),o.push(-r,0,i,a[0],a[1],a[2],1,r,0,i,a[0],a[1],a[2],1,i,0,-r,a[0],a[1],a[2],1,i,0,r,a[0],a[1],a[2],1);return RedGeometry(RedBuffer(this._redGL,"gridInterleaveBuffer_"+this._size+"_"+this._divisions+"_"+this.color1+"_"+this.color2,RedBuffer.ARRAY_BUFFER,new Float32Array(o),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexColor",4)]))}},RedGrid.prototype._update=function(){this.geometry=this._makeGridGeometry()},RedDefinePropertyInfo.definePrototype("RedGrid","size","number",{min:1,callback:function(){this._update()}}),RedDefinePropertyInfo.definePrototype("RedGrid","divisions","number",{min:1,callback:function(){this._update()}}),Object.defineProperty(RedGrid.prototype,"color1",{get:function(){return this._color1},set:function(e){return RedGLUtil.regHex(e)||RedGLUtil.throwFunc("RedGrid : color1 hex 형식만 허용.",e),this._color1=e,this._update(),this._color1}}),Object.defineProperty(RedGrid.prototype,"color2",{get:function(){return this._color2},set:function(e){return RedGLUtil.regHex(e)||RedGLUtil.throwFunc("RedGrid : color2 hex 형식만 허용.",e),this._color2=e,this._update(),this._color2}}),Object.defineProperty(RedGrid.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedGridMaterial||RedGLUtil.throwFunc("RedGrid : RedGridMaterial Instance만 허용.","입력값 : "+e),this._material=e}}),Object.freeze(RedGrid)}(),(RedMesh=function(e,t,r){if(!(this instanceof RedMesh))return new RedMesh(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedMesh : RedGL Instance만 허용.",e),RedBaseObject3D.build.call(this,e.gl),this.geometry=t,this.material=r,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,Object.freeze(RedMesh),(RedLine=function(e,t){if(!(this instanceof RedLine))return new RedLine(e,t);var r;e instanceof RedGL||RedGLUtil.throwFunc("RedLine : RedGL Instance만 허용.",e),(t=t||RedColorMaterial(e))instanceof RedColorMaterial||RedGLUtil.throwFunc("RedLine : RedColorMaterial Instance만 허용."),r=e.gl,RedBaseObject3D.build.call(this,r),this._interleaveData=[],this._indexData=[],this._UUID=RedGL.makeUUID(),this._interleaveBuffer=RedBuffer(e,"RedLine_InterleaveBuffer_"+this._UUID,RedBuffer.ARRAY_BUFFER,new Float32Array(this._interleaveData),[RedInterleaveInfo("aVertexPosition",3)]),this.geometry=RedGeometry(this._interleaveBuffer),this.material=t,this.drawMode=r.LINE_STRIP}).prototype=new RedBaseContainer,RedLine.prototype.addPoint=function(e,t,r){"number"==typeof e||RedGLUtil.throwFunc("RedLine : addPoint - x값은 숫자만 허용","입력값 : "+e),"number"==typeof t||RedGLUtil.throwFunc("RedLine : addPoint - y값은 숫자만 허용","입력값 : "+t),"number"==typeof r||RedGLUtil.throwFunc("RedLine : addPoint - z값은 숫자만 허용","입력값 : "+r),this._interleaveData.push(e,t,r),this._upload()},RedLine.prototype.removeAllPoint=function(){this._interleaveData.length=0,this._upload()},RedLine.prototype._upload=function(){this._interleaveBuffer.upload(new Float32Array(this._interleaveData))},Object.defineProperty(RedLine.prototype,"geometry",{get:function(){return this._geometry},set:function(e){this._geometry&&RedGLUtil.throwFunc("RedLine : geometry - 임의로 설정을 허용하지 않음","입력값 : "+e),this._geometry=e}}),Object.defineProperty(RedLine.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedColorMaterial||RedGLUtil.throwFunc("RedLine : RedColorMaterial Instance만 허용.","입력값 : "+e),this._material=e}}),Object.freeze(RedLine),(RedSkyBox=function(e,t){if(!(this instanceof RedSkyBox))return new RedSkyBox(e,t);e instanceof RedGL||RedGLUtil.throwFunc("RedSkyBox : RedGL Instance만 허용.",e),RedBaseObject3D.build.call(this,e.gl),this.geometry=RedBox(e),this.material=RedSkyBoxMaterial(e,RedBitmapCubeTexture(e,t)),this.cullFace=e.gl.FRONT,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseObject3D,Object.defineProperty(RedSkyBox.prototype,"geometry",{get:function(){return this._geometry},set:function(e){this._geometry&&RedGLUtil.throwFunc("RedSkyBox : geometry - 임의로 설정을 허용하지 않음","입력값 : "+e),this._geometry=e}}),Object.defineProperty(RedSkyBox.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedSkyBoxMaterial||RedGLUtil.throwFunc("RedSkyBox : RedSkyBoxMaterial Instance만 허용.","입력값 : "+e),this._material=e}}),Object.freeze(RedSkyBox),(RedSprite3D=function(e,t){if(!(this instanceof RedSprite3D))return new RedSprite3D(e,t);e instanceof RedGL||RedGLUtil.throwFunc("RedSprite3D : RedGL Instance만 허용.",e),RedBaseObject3D.build.call(this,e.gl),this.geometry=RedPlane(e,1,1,0),this.material=t,this.perspectiveScale=!0,this.sprite3DYn=!0,this.useCullFace=!1,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,RedDefinePropertyInfo.definePrototype("RedSprite3D","perspectiveScale","boolean",!0),RedDefinePropertyInfo.definePrototype("RedSprite3D","sprite3DYn","boolean",!0),Object.defineProperty(RedSprite3D.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedColorMaterial||e instanceof RedBitmapMaterial||e instanceof RedSheetMaterial||e instanceof RedVideoMaterial||RedGLUtil.throwFunc("RedSprite3D : RedColorMaterial or RedBitmapMaterial or RedSheetMaterial Instance만 허용.","입력값 : "+e),this._material=e}}),Object.freeze(RedSprite3D),(RedPointUnit=function(e,t,r,n){if(!(this instanceof RedPointUnit))return new RedPointUnit(e,t,r,n);var i;t instanceof Array||RedGLUtil.throwFunc("RedLine : interleaveData - Array Instance만 허용.","입력값 :",e),e instanceof RedGL||RedGLUtil.throwFunc("RedLine : RedGL Instance만 허용.",e),i=e.gl,RedBaseObject3D.build.call(this,i),this._UUID=RedGL.makeUUID(),this.geometry=RedGeometry(RedBuffer(e,"RedPointUnit_"+this._UUID,RedBuffer.ARRAY_BUFFER,new Float32Array(t),r,e.gl.DYNAMIC_DRAW)),this.material=n,this.drawMode=i.POINTS,this.useDepthMask=!1}).prototype=new RedBaseContainer,RedPointUnit.prototype.update=function(e){this._geometry.interleaveBuffer.upload(new Float32Array(e))},Object.defineProperty(RedPointUnit.prototype,"geometry",{get:function(){return this._geometry},set:function(e){this._geometry&&RedGLUtil.throwFunc("RedPointUnit : geometry - 임의 설정을 허용하지 않음","입력값 : "+e),this._geometry=e}}),Object.defineProperty(RedPointUnit.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedPointColorMaterial||e instanceof RedPointBitmapMaterial||RedGLUtil.throwFunc("RedPointUnit : material - RedPointColorMaterial Instance or RedPointBitmapMaterial Instance만 허용."),this._material=e}}),Object.freeze(RedPointUnit),(RedParticleUnit=function(e){this.startTime=null,this.age=0,this.lifeTime=2==e.length?Math.random()*(e[1]-e[0])+e[0]:e[0],this.initLifeTime=this.lifeTime,this._gravitySum=0}).prototype.addRule=function(e,t){this[e]={startCenter:null,start:2==t.start.length?Math.random()*(t.start[1]-t.start[0])+t.start[0]:t.start,end:2==t.end.length?Math.random()*(t.end[1]-t.end[0])+t.end[0]:t.end,ease:t.ease},this[e].gap=this[e].end-this[e].start},Object.freeze(RedParticleUnit),(RedParticleEmitter=function(e,t,r){if(!(this instanceof RedParticleEmitter))return new RedPointUnit(e,r);RedBaseObject3D.build.call(this,e.gl),this.list=[],this._interleaveData=[],this.info=t,this.geometry=RedGeometry(RedBuffer(e,"RedParticleEmitter_Buffer"+RedGL.makeUUID(),RedBuffer.ARRAY_BUFFER,new Float32Array(this._interleaveData),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aPointSize",1),RedInterleaveInfo("aVertexColor",4)],e.gl.DYNAMIC_DRAW)),this.material=r,this.drawMode=e.gl.POINTS,this.blendSrc=e.gl.SRC_ALPHA,this.blendDst=e.gl.ONE,this.useDepthMask=!1,this._UUID=RedGL.makeUUID()}).QuintIn=1,RedParticleEmitter.QuintOut=2,RedParticleEmitter.QuintInOut=3,RedParticleEmitter.BackIn=4,RedParticleEmitter.BackOut=5,RedParticleEmitter.BackInOut=6,RedParticleEmitter.CircIn=7,RedParticleEmitter.CircOut=8,RedParticleEmitter.CircInOut=9,RedParticleEmitter.CubicIn=10,RedParticleEmitter.CubicOut=11,RedParticleEmitter.CubicInOut=12,RedParticleEmitter.ExpoIn=13,RedParticleEmitter.ExpoOut=14,RedParticleEmitter.ExpoInOut=15,RedParticleEmitter.QuadIn=16,RedParticleEmitter.QuadOut=17,RedParticleEmitter.QuadInOut=18,RedParticleEmitter.QuartIn=19,RedParticleEmitter.QuartOut=20,RedParticleEmitter.QuartInOut=21,RedParticleEmitter.SineIn=22,RedParticleEmitter.SineOut=23,RedParticleEmitter.SineInOut=24,RedParticleEmitter.ElasticIn=25,RedParticleEmitter.ElasticOut=26,RedParticleEmitter.ElasticInOut=27,RedParticleEmitter.prototype=new RedBaseContainer,RedParticleEmitter.prototype.update=function(e){var t,r,n,i,a,o,s,d,f,c,u,l,h,R,m,p,_,P,g,E;if(t=Math.pow,r=Math.sin,n=Math.cos,i=Math.sqrt,s=.5*(a=Math.PI),o=2*a,d=this.list.length,R=(h=this.info).particle,d<h.max)for((f=h.emitCount)+d>h.max&&(f=h.max-d);f--;)m=this.list[d+f]=new RedParticleUnit(h.lifeTime),this._interleaveData.push(this.x,this.y,this.z),this._interleaveData.push(0),"random"==h.tint?this._interleaveData.push(Math.random(),Math.random(),Math.random(),1):this._interleaveData.push(h.tint[0],h.tint[1],h.tint[2],1),h.particle&&(R.movementX&&m.addRule("movementX",R.movementX),R.movementY&&m.addRule("movementY",R.movementY),R.movementZ&&m.addRule("movementZ",R.movementZ),R.scale&&m.addRule("scale",R.scale),R.alpha&&m.addRule("alpha",R.alpha));for(d=this.list.length;d--;)if((c=this.list[d]).startTime||(c.startTime=e,c.age=0),c.age=e-c.startTime,l=8*d,(u=c.age/c.lifeTime)<1)for(E=u,c.startCenter||(c.startCenter=[this.x,this.y,this.z]),f=(_="movementX,movementY,movementZ,scale,alpha".split(",")).length;f--;)E=u,(p=c[P=_[f]].ease)&&(1==p?E*=E*E*E*E:2==p?E=(E-=1)*E*E*E*E+1:3==p?E=(E*=2)<1?E*E*E*E*E*.5:.5*((E-=2)*E*E*E*E+2):4==p?E=E*E*(1.70158*E+E-1.70158):5==p?E=(E-=1)*E*(1.70158*E+E+1.70158)+1:6==p?E=(E*=2)<1?.5*E*E*(1.70158*E+E-1.70158):.5*(E-=2)*E*(1.70158*E+E+1.70158)+1:7==p?E=-1*(i(1-E*E)-1):8==p?E=i(1-(E-=1)*E):9==p?E=(E*=2)<1?-.5*(i(1-E*E)-1):.5*i(1-(E-=2)*E)+.5:10==p?E*=E*E:11==p?E=(E-=1)*E*E+1:12==p?E=(E*=2)<1?E*E*E*.5:.5*((E-=2)*E*E+2):13==p?E=0==E?0:t(2,10*(E-1)):14==p?E=1==E?1:1-t(2,-10*E):15==p?E=(E*=2)<1?0==E?0:.5*t(2,10*(E-1)):2==E?1:-.5*t(2,-10*(E-1))+1:16==p?E*=E:17==p?E*=2-E:18==p?E=(E*=2)<1?E*E*.5:.5*((2-(E-=1))*E+1):19==p?E*=E*E*E:20==p?E=1-(E-=1)*E*E*E:21==p?E=(E*=2)<1?E*E*E*E*.5:1-(E-=2)*E*E*E*.5:22==p?E=1-n(E*s):23==p?E=r(E*s):24==p?E=.5*(1-n(E*a)):25==p?E=0===E?0:1===E?1:-1*t(2,10*(E-=1))*r((E-.075)*o/.3):26==p?E=0===E?0:1===E?1:t(2,-10*E)*r((E-.075)*o/.3)+1:27==p&&(0===E||1===E||(E*=2),E=E<1?-.5*t(2,10*(E-=1))*r((E-.075)*o/.3):.5*t(2,-10*(E-=1))*r((E-.075)*o/.3)+1)),"movementX"==P&&(g=0),"movementY"==P&&(g=1),"movementZ"==P&&(g=2),"scale"==P&&(g=3),"alpha"==P&&(g=7),this._interleaveData[l+g]=g<3?c.startCenter[g]+c[P].start+c[P].gap*E:c[P].start+c[P].gap*E,h.gravity&&(c._gravitySum-=h.gravity),this._interleaveData[l+1]+=c._gravitySum;else this._interleaveData[l+0]=c.startCenter[0]=this.x,this._interleaveData[l+1]=c.startCenter[1]=this.y,this._interleaveData[l+2]=c.startCenter[2]=this.z,this._interleaveData[l+3]=c.scale.start,"random"==h.tint?(this._interleaveData[l+4]=Math.random(),this._interleaveData[l+5]=Math.random(),this._interleaveData[l+6]=Math.random()):(this._interleaveData[l+4]=h.tint[0],this._interleaveData[l+5]=h.tint[1],this._interleaveData[l+6]=h.tint[2]),this._interleaveData[l+7]=c.alpha.start,c._gravitySum=0,c.startTime=null,c.age=-1;this._geometry.interleaveBuffer.upload(new Float32Array(this._interleaveData))},Object.defineProperty(RedParticleUnit.prototype,"geometry",{get:function(){return this._geometry},set:function(e){this._geometry&&RedGLUtil.throwFunc("RedParticleUnit : geometry - 임의 설정을 허용하지 않음","입력값 : "+e),this._geometry=e}}),Object.defineProperty(RedParticleUnit.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedParticleColorMaterial||e instanceof RedParticleBitmapMaterial||RedGLUtil.throwFunc("RedParticleEmitter : material - RedParticleColorMaterial Instance or RedParticleBitmapMaterial Instance만 허용."),this._material=e}}),Object.freeze(RedParticleEmitter),function(){var e,t,r;r=function(e,r,n,i,a,o,s,d,f,c,u,l){var h,R,m=d/u,p=f/l,_=d/2,P=f/2,g=c/2,E=u+1,y=l+1,M=0,T=[];for(R=0;R<y;R++){var v=R*p-P;for(h=0;h<E;h++){var b=h*m-_;T[n]=b*o,T[i]=v*s,T[a]=g,e.push(T.x,T.y,T.z),T[n]=0,T[i]=0,T[a]=c>0?1:-1,e.push(T.x,T.y,T.z),e.push(h/u,1-R/l),M+=1}}for(R=0;R<l;R++)for(h=0;h<u;h++){var L=t+h+E*R,w=t+h+E*(R+1),x=t+(h+1)+E*(R+1),U=t+(h+1)+E*R;r.push(L,w,U,w,x,U),6}t+=M},e=function(e,n,i,a,o,s,d,f){var c=[],u=[];return t=0,r(c,u,"z","y","x",-1,-1,o,a,i,f,d),r(c,u,"z","y","x",1,-1,o,a,-i,f,d),r(c,u,"x","z","y",1,1,i,o,a,s,f),r(c,u,"x","z","y",1,-1,i,o,-a,s,f),r(c,u,"x","y","z",1,-1,i,a,o,s,d),r(c,u,"x","y","z",-1,-1,i,a,-o,s,d),{interleaveData:c,indexData:u,type:n,interleaveBuffer:RedBuffer(e,n+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(c),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,n+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(u))}},(RedBox=function(t,r,n,i,a,o,s){return this instanceof RedBox?(t instanceof RedGL||RedGLUtil.throwFunc("RedBox : RedGL Instance만 허용.",t),d="RedBox_"+(r=r||1)+"_"+(n=n||1)+"_"+(i=i||1)+"_"+(a=a||1)+"_"+(o=o||1)+"_"+(s=s||1),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[d]?t._datas.Primitives[d]:(t._datas.Primitives[d]=this,f=e(t,d,r,n,i,a,o,s),this.interleaveBuffer=f.interleaveBuffer,this.indexBuffer=f.indexBuffer,void(this._UUID=RedGL.makeUUID()))):new RedBox(t,r,n,i,a,o,s);var d,f}).prototype=Object.create(RedGeometry.prototype),Object.freeze(RedBox)}(),function(){var e,t,r,n,i,a,o,s,d,f,c,u,l,h,R,m,p;e=function(e,_,P,g,E,y){t=P/2,r=g/2,n=Math.floor(E)||1,i=Math.floor(y)||1,a=n+1,o=i+1,s=P/n,d=g/i;var M=[],T=[];for(c=0;c<o;c++)for(l=c*d-r,f=0;f<a;f++)u=f*s-t,M.push(u,-l,0,0,0,1,f/n,1-c/i);for(c=0;c<i;c++)for(f=0;f<n;f++)h=f+a*c,R=f+a*(c+1),m=f+1+a*(c+1),p=f+1+a*c,T.push(h,R,p,R,m,p);return{interleaveData:M,indexData:T,type:_,interleaveBuffer:RedBuffer(e,_+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(M),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,_+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint32Array(T))}},(RedPlane=function(t,r,n,i,a){return this instanceof RedPlane?(t instanceof RedGL||RedGLUtil.throwFunc("RedPlane : RedGL Instance만 허용.",t),o="RedPlane_"+(r=r||1)+"_"+(n=n||1)+"_"+(i=i||1)+"_"+(a=a||1),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[o]?t._datas.Primitives[o]:(t._datas.Primitives[o]=this,s=e(t,o,r,n,i,a),this.interleaveBuffer=s.interleaveBuffer,this.indexBuffer=s.indexBuffer,void(this._UUID=RedGL.makeUUID()))):new RedPlane(t,r,n,i,a);var o,s}).prototype=Object.create(RedGeometry.prototype),Object.freeze(RedPlane)}(),function(){var e,t,r,n,i,a,o,s,d,f,c,u;f=[],c=new Float32Array([0,0,0]),u=new Float32Array([0,0,0]),e=function(e,l,h,R,m,p,_,P,g){t=P+g,i=0,f.length=0,c[0]=0,c[1]=0,c[2]=0,u[0]=0,u[1]=0,u[2]=0;var E=[],y=[];for(n=0;n<=m;n++){var M=[],T=n/m;for(r=0;r<=R;r++){var v=r/R;c.x=-h*Math.cos(p+v*_)*Math.sin(P+T*g),c.y=h*Math.cos(P+T*g),c.z=h*Math.sin(p+v*_)*Math.sin(P+T*g),E.push(c.x,c.y,c.z),u[0]=c.x,u[1]=c.y,u[2]=c.z,vec3.normalize(u,u),E.push(u[0],u[1],u[2]),E.push(v,1-T),M.push(i++)}f.push(M)}for(n=0;n<m;n++)for(r=0;r<R;r++)a=f[n][r+1],o=f[n][r],s=f[n+1][r],d=f[n+1][r+1],(0!==n||P>0)&&y.push(a,o,d),(n!==m-1||t<Math.PI)&&y.push(o,s,d);return{interleaveData:E,indexData:y,type:l,interleaveBuffer:RedBuffer(e,l+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(E),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,l+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(y))}},(RedSphere=function(t,r,n,i,a,o,s,d){return this instanceof RedSphere?(t instanceof RedGL||RedGLUtil.throwFunc("RedPrimitive : RedGL Instance만 허용.",t),f="RedSphere_"+(r=r||1)+"_"+(n=Math.max(3,Math.floor(n)||8))+"_"+(i=Math.max(2,Math.floor(i)||6))+"_"+(a=void 0!==a?a:0)+"_"+(o=void 0!==o?o:2*Math.PI)+"_"+(s=void 0!==s?s:0)+"_"+(d=void 0!==d?d:Math.PI),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[f]?t._datas.Primitives[f]:(t._datas.Primitives[f]=this,c=e(t,f,r,n,i,a,o,s,d),this.interleaveBuffer=c.interleaveBuffer,this.indexBuffer=c.indexBuffer,void(this._UUID=RedGL.makeUUID()))):new RedSphere(t,r,n,i,a,o,s,d);var f,c}).prototype=Object.create(RedGeometry.prototype),Object.freeze(RedSphere)}(),function(){var e,t,r,n,i,a,o,s,d,f,c;r=2,e=function(e,t,r,n){if(i=e.createProgram(),e.attachShader(i,r.webglShader),e.attachShader(i,n.webglShader),r.parseData.uniform)for(s in a=r.parseData.uniform.map,o=n.parseData.uniform.map,a)o[s]&&RedGLUtil.throwFunc("vertexShader와 fragmentShader에 중복된 유니폼 선언이 존재함.","중복선언 : "+s);if(r.parseData.const)for(s in a=r.parseData.const.map,o=n.parseData.const.map,a)o[s]&&RedGLUtil.throwFunc("vertexShader와 fragmentShader에 중복된 상수 선언이 존재함.","중복선언 : "+s);return e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)||RedGLUtil.throwFunc("RedProgram : 프로그램을 초기화 할 수 없습니다.",e.getProgramInfoLog(i)),i.key=t,i.vShaderKey=r.key,i.vShaderOriginSource=r.originSource,i.fShaderKey=n.key,i.fShaderOriginKey=r.originSource,i},c={},d=function(){},f=function(){},t=function(e,t,i){var a,o,s,u;performance.now();if(i.parseData.attribute)for(a=(s=i.parseData.attribute.list).length;a--;)o=s[a],(p=new d)._UUID=RedGL.makeUUID(),p.location=t.getAttribLocation(e.webglProgram,o.name),-1==p.location?(p.msg="쉐이더 main 함수에서 사용되고 있지 않음",p.use=!1):p.use=!0,p.attributeType=o.attributeType,p.name=o.name,p.enabled=!1,u=e.attributeLocation.length,-1!=p.location&&(e.attributeLocation[u]=p),e.attributeLocation[p.name]=p;if(i.parseData.uniform)for(a=(s=i.parseData.uniform.list).length;a--;){var l,h,R,m,p;switch(o=s[a],(p=new f)._UUID=RedGL.makeUUID(),p.uniformType=o.uniformType,l=o.arrayNum,R=1e5,o.uniformType){case"sampler2D":h="sampler2D",R=0,m="uniform1i",p.samplerIndex=r,++r==n&&(r=2);break;case"samplerCube":h="samplerCube",R=1,m="uniform1i",p.samplerIndex=r,++r==n&&(r=2);break;case"float":h="float",R=l?12:11,m=l?"uniform1fv":"uniform1f";break;case"int":h="int",R=l?12:11,m=l?"uniform1iv":"uniform1i";break;case"bool":h="bool",R=l?12:11,m=l?"uniform1iv":"uniform1i";break;case"vec4":h="vec",R=12,m="uniform4fv";break;case"vec3":h="vec",R=12,m="uniform3fv";break;case"vec2":h="vec",R=12,m="uniform2fv";break;case"ivec4":h="vec",R=12,m="uniform4iv";break;case"ivec3":h="vec",R=12,m="uniform3iv";break;case"ivec2":h="vec",R=12,m="uniform2iv";break;case"bvec4":h="vec",R=12,m="uniform4iv";break;case"bvec3":h="vec",R=12,m="uniform3iv";break;case"bvec2":h="vec",R=12,m="uniform2iv";break;case"mat4":h="mat",R=13,m="uniformMatrix4fv";break;case"mat3":h="mat",R=13,m="uniformMatrix3fv";break;case"mat2":h="mat",R=13,m="uniformMatrix2fv"}p.location=t.getUniformLocation(e.webglProgram,o.name),p.renderType=h,p.renderMethod=m,p.renderTypeIndex=R,p.name=o.name,c[o.name]||(c[o.name]=o.name.charAt(1).toLowerCase()+o.name.substr(2)),p.materialPropertyName=c[o.name],p.arrayNum=o.arrayNum,p.location?p.use=!0:(p.msg="쉐이더 main 함수에서 사용되고 있지 않음",p.use=!1),o.systemUniformYn?(u=e.systemUniformLocation.length,p.use&&(e.systemUniformLocation[u]=p),e.systemUniformLocation[o.name]=p):(u=e.uniformLocation.length,p.use&&(e.uniformLocation[u]=p),e.uniformLocation[o.name]=p)}performance.now()},(RedProgram=function(r,i,a,o){var s,d,f;return this instanceof RedProgram?(r instanceof RedGL||RedGLUtil.throwFunc("RedProgram : RedGL Instance만 허용.","입력값 : "+r),"string"==typeof i||RedGLUtil.throwFunc("RedProgram : key - 문자열만 허용.","입력값 : "+i),s=r.gl,r._datas.RedProgram||(r._datas.RedProgram={},r._datas.RedProgramList=[]),RedProgram.hasKey(r,i)?r._datas.RedProgram[i]:(d=a?RedShader(r,i+"_VS",RedShader.VERTEX,a):null,f=o?RedShader(r,i+"_FS",RedShader.FRAGMENT,o):null,d&&f?r._datas.RedProgram[i]=this:RedGLUtil.throwFunc("RedProgram : 신규 생성시 vertexShader, fragmentShader 모두 입력해야함."),r._datas.RedProgramList.push(this),this.key=i,this.webglProgram=e(s,i,d,f),this.attributeLocation=[],this.uniformLocation=[],this.systemUniformLocation=[],s.useProgram(this.webglProgram),n=r.detect.texture.MAX_COMBINED_TEXTURE_IMAGE_UNITS,t(this,s,d),t(this,s,f),void(this._UUID=RedGL.makeUUID()))):new RedProgram(r,i,a,o)}).prototype={},RedProgram.hasKey=function(e,t){return e instanceof RedGL||RedGLUtil.throwFunc("RedProgram : RedGL Instance만 허용.","입력값 : "+e),e._datas.RedProgram||(e._datas.RedProgram={},e._datas.RedProgramList=[]),!!e._datas.RedProgram[t]},RedProgram.makeProgram=function(e,t,r,n,i){var a;t.indexOf("_")>-1&&RedGLUtil.throwFunc("RedProgram : 프로그램이름에 _ 는 허용하지 않음.","입력값 : "+t),r="string"==typeof r?r:RedGLUtil.getStrFromComment(r.toString()),n="string"==typeof n?n:RedGLUtil.getStrFromComment(n.toString());var o=!1,s=!1,d=!1;if(i){i.sort(),t+="_"+i.join("_");for(var f=i.length;f--;)"fog"==i[f]&&(o=!0),"sprite3D"==i[f]&&(s=!0),"directionalShadow"==i[f]&&(d=!0),"fog"!=i[f]&&"sprite3D"!=i[f]&&"directionalShadow"!=i[f]&&(a=new RegExp("//#define#"+i[f]+"#","gi"),r=r.replace(a,""),n=n.replace(a,""))}return a=new RegExp("//#define#fog#"+(o?"true":"false")+"#","gi"),r=r.replace(a,""),n=n.replace(a,""),a=new RegExp("//#define#sprite3D#"+(s?"true":"false")+"#","gi"),r=r.replace(a,""),n=n.replace(a,""),a=new RegExp("//#define#directionalShadow#"+(d?"true":"false")+"#","gi"),r=r.replace(a,""),n=n.replace(a,""),RedProgram(e,t,r,n)},Object.freeze(RedProgram)}(),(RedSystemShaderCode={}).init=function(){(RedSystemShaderCode={vShareSource:["attribute vec3 aVertexPosition","attribute vec3 aVertexNormal","attribute vec4 aVertexColor","varying vec3 vVertexNormal","attribute float aPointSize","uniform float uPointSize","attribute vec2 aTexcoord","varying vec2 vTexcoord","uniform float uTime","varying float vTime","uniform vec2 uResolution","varying vec2 vResolution","uniform mat4 uMMatrix","uniform mat4 uNMatrix","uniform mat4 uPMatrix","uniform mat4 uCameraMatrix","uniform bool u_PerspectiveScale","uniform mat4 uDirectionalShadowLightMatrix","varying highp vec4 vShadowPos","const mat4 cTexUnitConverter = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0)"],fShareSource:["varying vec3 vVertexNormal","varying vec2 vTexcoord","varying float vTime","varying vec2 vResolution","uniform float u_FogDistance","uniform float u_FogDensity","uniform vec4 uFogColor","const int cDIRETIONAL_MAX = 3","uniform vec3 uDirectionalLightPositionList[3]","uniform vec4 uDirectionalLightColorList[3]","uniform float uDirectionalLightIntensityList[3]","uniform int uDirectionalLightNum","const int cPOINT_MAX = 5","uniform vec3 uPointLightPositionList[5]","uniform vec4 uPointLightColorList[5]","uniform float uPointLightRadiusList[5]","uniform float uPointLightIntensityList[5]","uniform int uPointLightNum","uniform vec4 uAmbientLightColor","uniform float uAmbientIntensity","uniform sampler2D uDirectionalShadowTexture","varying highp vec4 vShadowPos"],systemUniform:{}}).MAX_DIRECTIONAL_LIGHT=3,RedSystemShaderCode.MAX_POINT_LIGHT=5,[RedSystemShaderCode.vShareSource,RedSystemShaderCode.fShareSource].forEach(function(e){e.forEach(function(e){"uniform"==(e=e.split(" "))[0]&&(RedSystemShaderCode.systemUniform[e[2]]=1)})}),Object.freeze(RedSystemShaderCode)},function(){var e,t,r,n,i,a,o,s,d,f;e=function(e,t,r){switch(r){case RedShader.VERTEX:return(i=e.createShader(e.VERTEX_SHADER))||(e.isContextLost()?RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - WebGL 컨텍스트가 손실"):RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - GPU메모리가 부족일 가능성이 큼")),i.key=t,i.type=r,i;case RedShader.FRAGMENT:return(i=e.createShader(e.FRAGMENT_SHADER))||(e.isContextLost()?RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - WebGL 컨텍스트가 손실"):RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - GPU메모리가 부족일 가능성이 큼")),i.key=t,i.type=r,i;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요. RedShader.VERTEX or RedShader.FRAGMENT 만 허용")}},t=function(e,t,r,n){e.shaderSource(r,n.lastSource),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)||RedGLUtil.throwFunc("RedShader : 쉐이더 컴파일에 실패하였습니다.\n",e.getShaderInfoLog(r))},n=function(e,t){var r;switch(e){case RedShader.VERTEX:r=RedSystemShaderCode.vShareSource.concat();break;case RedShader.FRAGMENT:r=RedSystemShaderCode.fShareSource.concat();break;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요. RedShader.VERTEX or RedShader.FRAGMENT 만 허용")}for(a=t.length;a--;)o=(o=t[a]).replace(";",""),-1==r.indexOf(o)?r.push(o):RedGLUtil.throwFunc("RedShader : ","\n1. 중복 선언 이거나","\n2. RedSystemShaderCode에 정의된 선언\n","입력값 : "+o);return r},r=function(e,t){return t=(t=t.replace(/\s+$/,"")).replace(/  /g,"").trim(),s={etc:""},d=t.match(/attribute[\s\S]+?\;|uniform[\s\S]+?\;|varying[\s\S]+?\;|const[\s\S]+?\;|precision[\s\S]+?\;/g),(d=n(e,d=d||[])).sort(),d.forEach(function(e){var r,n,i,a,o,d,f,c,u;if(e=e.trim(),t=t.replace(e+";",""),("highp"==(r=e.split(" "))[1]||"mediump"==r[1]||"lowp"==r[1])&&(u=r[1],r.splice(1,1),r.push(u),c=u),r[2])switch(n=r[0],a=r[1],i=r[2].replace(";","").split("["),d=(d=e.split("="))[1]?d[1].trim().replace(";",""):null,o=i.length>1?+i[1].split("]")[0]:0,i=i[0],n){case"precision":break;case"attribute":"a"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : attribute의 첫글자는 a로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : attribute의 두번째 글자는 대문자 시작해야합니다.",i);break;case"uniform":"u"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : uniform의 첫글자는 u로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : uniform의 두번째 글자는 대문자 시작해야합니다.",i);break;case"varying":"v"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : varying의 첫글자는 v로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : varying의 두번째 글자는 대문자 시작해야합니다.",i);break;case"const":"c"!=i.charAt(0)&&RedGLUtil.throwFunc("RedShader : const의 첫글자는 c로 시작해야합니다.",i),i.charAt(1)!=i.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : const의 두번째 글자는 대문자 시작해야합니다.",i);break;default:RedGLUtil.throwFunc("RedShader : 체크되지 못하는값인데 뭐냐",i)}else RedGLUtil.throwFunc("RedShader : 체크되지 못하는값인데 뭐냐",r);s[n]||(s[n]={},s[n].list=[],s[n].map={},s[n].source=""),f={name:i,arrayNum:o,value:d,precision:c,systemUniformYn:!!RedSystemShaderCode.systemUniform[o?i+"["+o+"]":i]},"uniform"==n&&(f.uniformType=a),"attribute"==n&&(f.attributeType=a),"varying"==n&&(f.varyingType=a),s[n].list.push(f),s[n].map[i]=e,s[n].source+=e+";\n"}),t=(t+="\n").trim(),s.etc=t+"\n",f="",s.precision&&(f+=s.precision.source+"\n//const\n"),s.const&&(f+=s.const.source+"\n//attribute\n"),s.attribute&&(f+=s.attribute.source+"\n//uniform\n"),s.uniform&&(f+=s.uniform.source+"\n//varying\n"),s.varying&&(f+=s.varying.source+"\n//etc\n"),s.etc&&(f+=s.etc),s.lastSource=f,e!=RedShader.FRAGMENT||s.precision||RedGLUtil.throwFunc("RedShader : FRAGMENT Shader는 precision를 반드시 선언해야함"),s},(RedShader=function(n,i,a,o){var s;if(!(this instanceof RedShader))return new RedShader(n,i,a,o);if(n instanceof RedGL||RedGLUtil.throwFunc("RedShader : RedGL Instance만 허용.","입력값 : "+n),"string"==typeof i||RedGLUtil.throwFunc("RedShader : key - 문자열만 허용.","입력값 : "+i),a!=RedShader.VERTEX&&a!=RedShader.FRAGMENT&&RedGLUtil.throwFunc("RedShader : type - RedShader.VERTEX or RedShader.FRAGMENT 만 허용.","입력값 : "+a),n._datas.RedShader||(n._datas.RedShader={},n._datas.RedShader[RedShader.VERTEX]={},n._datas.RedShader[RedShader.FRAGMENT]={}),o)"string"==typeof o||RedGLUtil.throwFunc("RedShader : source - 문자열만 허용."),RedShader.hasKey(n,i,a)?RedGLUtil.throwFunc("RedShader : key - 이미 정의된 키로 생성을 시도.","\n키 :",i,"\n타입 :"+a):n._datas.RedShader[a][i]=this;else{if(RedShader.hasKey(n,i,a))return n._datas.RedShader[a][i];RedGLUtil.throwFunc("RedShader : "+a+" 타입에 존재하지 않는 key를 검색하려고합니다.","입력값 : "+i)}s=n.gl,this.webglShader=e(s,i,a),this.parseData=r(a,o),this.originSource=o,t(s,0,this.webglShader,this.parseData),this.key=i,this.type=a,this._UUID=RedGL.makeUUID(),Object.freeze(this)}).hasKey=function(e,t,r){return!!e._datas.RedShader[r][t]},RedShader.FRAGMENT="fragmentShader",RedShader.VERTEX="vertexShader",Object.freeze(RedShader)}(),function(){var e,t,r,n,i,a,o,s;(RedRenderer=function(){if(!(this instanceof RedRenderer))return new RedRenderer;this.world=null,this._tickKey=null,this._callback=null,this._UUID=RedGL.makeUUID(),this.renderInfo={},this.cacheState=[],this.cacheInfo={cacheUniformInfo:[],cacheAttrInfo:[],cacheSamplerIndex:[],cacheTexture:[],cacheSystemUniformInfo:[]},this.renderDebuger=RedRenderDebuger(),this.worldRect=[],this._glInitialized=!1}).prototype={start:(e=function(n){t.worldRender(r,n),t._callback&&t._callback(n),t._tickKey=requestAnimationFrame(e)},function(n,i){n instanceof RedGL||RedGLUtil.throwFunc("RedGL Instance만 허용"),n.world instanceof RedWorld||RedGLUtil.throwFunc("RedWorld Instance만 허용"),(t=this).world=n.world,r=n,t._callback=i,t._tickKey=requestAnimationFrame(e)}),render:function(e,t){e instanceof RedGL||RedGLUtil.throwFunc("RedGL Instance만 허용"),this.worldRender(e,t),this.world=e.world},stop:function(){cancelAnimationFrame(this._tickKey)}},RedRenderer.prototype.worldRender=function(){var e,t,r,i,a,o,s;return o=[],r=function(t){for(s=t.length;s--;)"number"==typeof t[s]?t[s]=t[s]:t[s]=s<2?e[s+2]*parseFloat(t[s])/100:e[s]*parseFloat(t[s])/100;return t},i=function(e,t,r){n=RedSystemUniformUpdater.update(e,this,t,r,n,o)},a=function(e){e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.frontFace(e.CCW),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.enable(e.SCISSOR_TEST),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DITHER),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0)},function(n,s){var d,f,c,u,l,h,R,m,p;for(d=n.gl,(e=(t=this).worldRect)[0]=0,e[1]=0,e[2]=d.drawingBufferWidth,e[3]=d.drawingBufferHeight,d.viewport(0,0,d.drawingBufferWidth,d.drawingBufferHeight),d.scissor(0,0,d.drawingBufferWidth,d.drawingBufferHeight),d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT),t._glInitialized||(a(d),t._glInitialized=!0),t.renderInfo={},t.cacheInfo.cacheAttrInfo.length=0,n.gl.activeTexture(n.gl.TEXTURE0),n.gl.bindTexture(n.gl.TEXTURE_2D,n._datas.emptyTexture["2d"].webglTexture),n.gl.activeTexture(n.gl.TEXTURE0+1),n.gl.bindTexture(n.gl.TEXTURE_CUBE_MAP,n._datas.emptyTexture["3d"].webglTexture),h=0,R=t.world._viewList.length;h<R;h++)(p=(m=t.world._viewList[h])._viewRect)[0]=m._x,p[1]=m._y,p[2]=m._width,p[3]=m._height,l=m.camera,f=m.scene,r(p),t.renderInfo[m.key]||(t.renderInfo[m.key]={}),(c=t.renderInfo[m.key]).orthographicYn=l instanceof RedBaseController?l.camera.orthographicYn:l.orthographicYn,c.x=m._x,c.y=m._y,c.width=m._width,c.height=m._height,c.viewRectX=p[0],c.viewRectY=p[1],c.viewRectWidth=p[2],c.viewRectHeight=p[3],c.key=m.key,c.call=0,c.triangleNum=0,c.viewRenderTime=0,c.postEffectRenderTime=0,d.viewport(p[0],e[3]-p[3]-p[1],p[2],p[3]),d.scissor(p[0],e[3]-p[3]-p[1],p[2],p[3]),f._useBackgroundColor?(f._useFog?d.clearColor(f._fogR,f._fogG,f._fogB,1):d.clearColor(f._r,f._g,f._b,1),d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT)):(d.clearColor(0,0,0,1),d.clear(d.DEPTH_BUFFER_BIT)),l instanceof RedBaseController&&(l.update(),l=l.camera),l.autoUpdateMatrix&&l.update(),u=l.perspectiveMTX,mat4.identity(u),l.orthographicYn?(mat4.ortho(u,-.5,.5,-.5,.5,-l.farClipping,l.farClipping),mat4.translate(u,u,[-.5,.5,0]),mat4.scale(u,u,[1/p[2],-1/p[3],1]),mat4.identity(l.matrix),d.disable(d.CULL_FACE),t.cacheState.useCullFace=!1):(mat4.perspective(u,l.fov*Math.PI/180,p[2]/p[3],l.nearClipping,l.farClipping),d.enable(d.CULL_FACE),t.cacheState.useCullFace=!0),!t.cacheState.useDepthMask&&d.depthMask(t.cacheState.useDepthMask=!0),f.shadowManager._directionalShadow&&(i.apply(t,[n,s,m]),d.enable(d.BLEND),d.blendFunc(d.ONE,d.ONE),t.cacheState.useBlendMode=!0,t.cacheState.blendSrc=d.ONE,t.cacheState.blendDst=d.ONE,f.shadowManager.render(n,t,m,s,c),d.enable(d.BLEND),d.blendFunc(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA),t.cacheState.useBlendMode=!0,t.cacheState.blendSrc=d.SRC_ALPHA,t.cacheState.blendDst=d.ONE_MINUS_SRC_ALPHA),m.postEffectManager.postEffectList.length&&(m.postEffectManager.bind(d),d.viewport(0,0,m.postEffectManager.frameBuffer.width,m.postEffectManager.frameBuffer.height),d.scissor(0,0,m.postEffectManager.frameBuffer.width,m.postEffectManager.frameBuffer.height)),i.apply(t,[n,s,m]),f.skyBox&&(f.skyBox.x=l.x,f.skyBox.y=l.y,f.skyBox.z=l.z,f.skyBox.scaleX=f.skyBox.scaleY=f.skyBox.scaleZ=.6*l.farClipping,t.sceneRender(n,f,l,l.orthographicYn,[f.skyBox],s,c),d.clear(d.DEPTH_BUFFER_BIT)),f.grid&&t.sceneRender(n,f,l,l.orthographicYn,[f.grid],s,c),t.sceneRender(n,f,l,l.orthographicYn,f.children,s,c),f.axis&&t.sceneRender(n,f,l,l.orthographicYn,f.axis.children,s,c),o.length&&t.sceneRender(n,f,l,l.orthographicYn,o,s,c),c.viewRenderTime=performance.now(),m.postEffectManager.postEffectList.length&&m.postEffectManager.render(n,d,t,m,s,c),c.postEffectRenderTime=performance.now()-c.viewRenderTime,c.viewRenderTime-=s;this.renderDebuger.visible&&this.renderDebuger.update(n,t.renderInfo)}}(),RedRenderer.prototype.sceneRender=(i=function(e,t,r,d,f,c,u,l,h,R,m){var p,_,P,g,E,y,M,T,v,b,L,w,x,U,I,D,B,A,S,G,F,C,O,k,N,X,Y,j,z,V,H,Z,q,W,J,Q,K,$,ee,te,re,ne,ie,ae,oe,se,de,fe,ce,ue,le,he,Re,me,pe,_e,Pe,ge,Ee,ye,Me,Te,ve,be,Le,we,xe,Ue,Ie,De,Be,Ae,Se,Ge,Fe,Ce,Oe,ke,Ne,Xe,Ye,je,ze,Ve,He,Ze,qe,We,Je,Qe,Ke,$e,et,tt,rt,nt,it,at,ot,st,dt,ft,ct,ut,lt,ht,Rt,mt,pt,_t,Pt,gt,Et,yt,Mt,Tt=e.gl,vt=l.cacheAttrInfo,bt=l.cacheUniformInfo,Lt=l.cacheSamplerIndex,wt=l.cacheTexture,xt=f?-1:1;for(P=Math.PI/180,ut=3.141592653589793,lt=6.283185307179586,ht=1.27323954,Rt=.405284735,mt=1.5707963267948966,p=r.length;p--;){if(u.call++,C=(g=r[p]).matrix,O=g.normalMatrix,E=g._geometry,X=g._sprite3DYn,g.useLOD)for(var Ut in pt=d.x-g.x,_t=d.y-g.y,Pt=d.z-g.z,gt=Math.abs(Math.sqrt(pt*pt+_t*_t+Pt*Pt)),M=g._lodLevels)(Y=M[Ut]).distance<gt&&(g._geometry=Y.geometry,g._material=Y.material);if(E){if(j=(y=m||g._material)._RedDirectionalShadowYn,y.__RedSheetMaterialYn){if(y._nextFrameTime||(y._nextFrameTime=y._perFrameTime+c),y._playYn&&y._nextFrameTime<c){var It=parseInt((c-y._nextFrameTime)/y._perFrameTime);It=It||1,y._nextFrameTime=y._perFrameTime+c,y.currentIndex+=It,y.currentIndex>=y.totalFrame&&(y._loop?(y._playYn=!0,y.currentIndex=0):(y._playYn=!1,y.currentIndex=y.totalFrame-1))}y._sheetRect[0]=1/y._segmentW,y._sheetRect[1]=1/y._segmentH,y._sheetRect[2]=y.currentIndex%y._segmentW/y._segmentW,y._sheetRect[3]=Math.floor(y.currentIndex/y._segmentH)/y._segmentH}for(Et=t.shadowManager._directionalShadow,V=null,H=null,Mt=(z=y.program).key,(yt=y._programList)&&(Et?V=t._useFog&&X?"directionalShadow_fog_sprite3D":X?"directionalShadow_sprite3D":t._useFog?"directionalShadow_fog":"directionalShadow":t._useFog&&X?V="fog_sprite3D":X?V="sprite3D":t._useFog&&(V="fog")),V&&((H=yt[V][Mt])._prepareProgramYn&&(H=yt[V][Mt]=H._makePrepareProgram()),z=H),n!=z._UUID&&Tt.useProgram(z.webglProgram),n=z._UUID,T=z.attributeLocation,w=z.uniformLocation,x=z.systemUniformLocation,B=E.interleaveBuffer,A=E.indexBuffer,k=B._UUID,_=T.length,b=B.interleaveDefineInfoList,o!=k&&Tt.bindBuffer(Tt.ARRAY_BUFFER,B.webglBuffer),o=k;_--;)L=b[(v=T[_]).name],D=v.location,L&&vt[D]!=L._UUID&&(!v.enabled&&Tt.enableVertexAttribArray(D),v.enabled=1,Tt.vertexAttribPointer(D,L.size,B.glArrayType,L.normalize,B.stride_BYTES_PER_ELEMENT,L.offset_BYTES_PER_ELEMENT),vt[D]=L._UUID);for(_=w.length;_--;)I=(U=w[_]).location,k=U._UUID,F=U.renderTypeIndex,G=U.renderType,S=y[U.materialPropertyName],"sampler2D"==G||"samplerCube"==G?(N=U.samplerIndex,S?wt[N]!=S._UUID&&(s!=N&&Tt.activeTexture(Tt.TEXTURE0+(s=N)),S._videoDom?(Tt.bindTexture(Tt.TEXTURE_2D,S.webglTexture),S._videoDom.loaded&&Tt.texImage2D(Tt.TEXTURE_2D,0,Tt.RGBA,Tt.RGBA,Tt.UNSIGNED_BYTE,S._videoDom)):Tt.bindTexture("sampler2D"==G?Tt.TEXTURE_2D:Tt.TEXTURE_CUBE_MAP,S.webglTexture),Lt[k]!=N&&Tt.uniform1i(I,Lt[k]=N),wt[N]=S._UUID):"sampler2D"==G?0!=wt[N]&&(0!=Lt[k]&&Tt.uniform1i(I,Lt[k]=0),wt[N]=0,s=0):1!=wt[N]&&(1!=Lt[k]&&Tt.uniform1i(I,Lt[k]=1),wt[N]=1,s=1)):(void 0==S&&RedGLUtil.throwFunc("RedRenderer : Material에 ",U.materialPropertyName,"이 정의 되지않았습니다."),F<13?bt[k]!=S&&Tt[U.renderMethod](I,(bt[k]=12==F?null:S,S)):13==F?Tt[U.renderMethod](I,!1,S):RedGLUtil.throwFunc("RedRenderer : 처리할수없는 타입입니다.","tRenderType -",G))}g.autoUpdateMatrix&&(C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,Z=C,Be=g.x,Ae=g.y,Se=g.z,Z[12]=Z[0]*Be+Z[4]*Ae+Z[8]*Se+Z[12],Z[13]=Z[1]*Be+Z[5]*Ae+Z[9]*Se+Z[13],Z[14]=Z[2]*Be+Z[6]*Ae+Z[10]*Se+Z[14],Z[15]=Z[3]*Be+Z[7]*Ae+Z[11]*Se+Z[15],X?ee=te=re=0:(ee=g.rotationX*P,te=g.rotationY*P,re=g.rotationZ*P),(ct=ee%lt)<-ut?ct+=lt:ct>ut&&(ct-=lt),q=(ct=ct<0?ht*ct+Rt*ct*ct:ht*ct-Rt*ct*ct)<0?.225*(ct*-ct-ct)+ct:.225*(ct*ct-ct)+ct,(ct=(ee+mt)%lt)<-ut?ct+=lt:ct>ut&&(ct-=lt),Q=(ct=ct<0?ht*ct+Rt*ct*ct:ht*ct-Rt*ct*ct)<0?.225*(ct*-ct-ct)+ct:.225*(ct*ct-ct)+ct,(ct=te%lt)<-ut?ct+=lt:ct>ut&&(ct-=lt),W=(ct=ct<0?ht*ct+Rt*ct*ct:ht*ct-Rt*ct*ct)<0?.225*(ct*-ct-ct)+ct:.225*(ct*ct-ct)+ct,(ct=(te+mt)%lt)<-ut?ct+=lt:ct>ut&&(ct-=lt),K=(ct=ct<0?ht*ct+Rt*ct*ct:ht*ct-Rt*ct*ct)<0?.225*(ct*-ct-ct)+ct:.225*(ct*ct-ct)+ct,(ct=re%lt)<-ut?ct+=lt:ct>ut&&(ct-=lt),J=(ct=ct<0?ht*ct+Rt*ct*ct:ht*ct-Rt*ct*ct)<0?.225*(ct*-ct-ct)+ct:.225*(ct*ct-ct)+ct,(ct=(re+mt)%lt)<-ut?ct+=lt:ct>ut&&(ct-=lt),$=(ct=ct<0?ht*ct+Rt*ct*ct:ht*ct-Rt*ct*ct)<0?.225*(ct*-ct-ct)+ct:.225*(ct*ct-ct)+ct,ne=Z[0],ie=Z[1],ae=Z[2],se=Z[4],de=Z[5],fe=Z[6],ue=Z[8],le=Z[9],he=Z[10],Te=K*$,ve=q*W*$-Q*J,be=Q*W*$+q*J,Le=K*J,we=q*W*J+Q*$,xe=Q*W*J-q*$,Ue=-W,Ie=q*K,De=Q*K,Z[0]=ne*Te+se*ve+ue*be,Z[1]=ie*Te+de*ve+le*be,Z[2]=ae*Te+fe*ve+he*be,Z[4]=ne*Le+se*we+ue*xe,Z[5]=ie*Le+de*we+le*xe,Z[6]=ae*Le+fe*we+he*xe,Z[8]=ne*Ue+se*Ie+ue*De,Z[9]=ie*Ue+de*Ie+le*De,Z[10]=ae*Ue+fe*Ie+he*De,Be=g.scaleX,Ae=g.scaleY*xt,Se=g.scaleZ,Z[0]=Z[0]*Be,Z[1]=Z[1]*Be,Z[2]=Z[2]*Be,Z[3]=Z[3]*Be,Z[4]=Z[4]*Ae,Z[5]=Z[5]*Ae,Z[6]=Z[6]*Ae,Z[7]=Z[7]*Ae,Z[8]=Z[8]*Se,Z[9]=Z[9]*Se,Z[10]=Z[10]*Se,Z[11]=Z[11]*Se,Z[12]=Z[12],Z[13]=Z[13],Z[14]=Z[14],Z[15]=Z[15],R&&(ne=R[0],ie=R[1],ae=R[2],oe=R[3],se=R[4],de=R[5],fe=R[6],ce=R[7],ue=R[8],le=R[9],he=R[10],Re=R[11],me=R[12],pe=R[13],_e=R[14],Pe=R[15],ge=C[0],Ee=C[1],ye=C[2],Me=C[3],C[0]=ge*ne+Ee*se+ye*ue+Me*me,C[1]=ge*ie+Ee*de+ye*le+Me*pe,C[2]=ge*ae+Ee*fe+ye*he+Me*_e,C[3]=ge*oe+Ee*ce+ye*Re+Me*Pe,ge=C[4],Ee=C[5],ye=C[6],Me=C[7],C[4]=ge*ne+Ee*se+ye*ue+Me*me,C[5]=ge*ie+Ee*de+ye*le+Me*pe,C[6]=ge*ae+Ee*fe+ye*he+Me*_e,C[7]=ge*oe+Ee*ce+ye*Re+Me*Pe,ge=C[8],Ee=C[9],ye=C[10],Me=C[11],C[8]=ge*ne+Ee*se+ye*ue+Me*me,C[9]=ge*ie+Ee*de+ye*le+Me*pe,C[10]=ge*ae+Ee*fe+ye*he+Me*_e,C[11]=ge*oe+Ee*ce+ye*Re+Me*Pe,ge=C[12],Ee=C[13],ye=C[14],Me=C[15],C[12]=ge*ne+Ee*se+ye*ue+Me*me,C[13]=ge*ie+Ee*de+ye*le+Me*pe,C[14]=ge*ae+Ee*fe+ye*he+Me*_e,C[15]=ge*oe+Ee*ce+ye*Re+Me*Pe)),E&&Tt.uniformMatrix4fv(x.uMMatrix.location,!1,C),E&&x&&x.uNMatrix.location&&(Ge=C[0],Fe=C[1],Ce=C[2],Oe=C[3],ke=C[4],Ne=C[5],Xe=C[6],Ye=C[7],je=C[8],ze=C[9],Ve=C[10],He=C[11],qe=C[12],We=C[13],Je=C[14],ft=1/(ft=(Ze=Ge*Ne-Fe*ke)*(dt=Ve*(Qe=C[15])-He*Je)-(Ke=Ge*Xe-Ce*ke)*(st=ze*Qe-He*We)+($e=Ge*Ye-Oe*ke)*(ot=ze*Je-Ve*We)+(et=Fe*Xe-Ce*Ne)*(at=je*Qe-He*qe)-(tt=Fe*Ye-Oe*Ne)*(it=je*Je-Ve*qe)+(rt=Ce*Ye-Oe*Xe)*(nt=je*We-ze*qe)),O[0]=(Ne*dt-Xe*st+Ye*ot)*ft,O[1]=(-Fe*dt+Ce*st-Oe*ot)*ft,O[2]=(We*rt-Je*tt+Qe*et)*ft,O[3]=(-ze*rt+Ve*tt-He*et)*ft,O[4]=(-ke*dt+Xe*at-Ye*it)*ft,O[5]=(Ge*dt-Ce*at+Oe*it)*ft,O[6]=(-qe*rt+Je*$e-Qe*Ke)*ft,O[7]=(je*rt-Ve*$e+He*Ke)*ft,O[8]=(ke*st-Ne*at+Ye*nt)*ft,O[9]=(-Ge*st+Fe*at-Oe*nt)*ft,O[10]=(qe*tt-We*$e+Qe*Ze)*ft,O[11]=(-je*tt+ze*$e-He*Ze)*ft,O[12]=(-ke*ot+Ne*it-Xe*nt)*ft,O[13]=(Ge*ot-Fe*it+Ce*nt)*ft,O[14]=(-qe*et+We*Ke-Je*Ze)*ft,O[15]=(je*et-ze*Ke+Ve*Ze)*ft,ie=O[1],ae=O[2],oe=O[3],fe=O[6],ce=O[7],Re=O[11],O[1]=O[4],O[2]=O[8],O[3]=O[12],O[4]=ie,O[6]=O[9],O[7]=O[13],O[8]=ae,O[9]=fe,O[11]=O[14],O[12]=oe,O[13]=ce,O[14]=Re,Tt.uniformMatrix4fv(x.uNMatrix.location,!1,O)),E&&(h.useCullFace!=g.useCullFace&&((h.useCullFace=g.useCullFace)?Tt.enable(Tt.CULL_FACE):Tt.disable(Tt.CULL_FACE)),h.useCullFace&&h.cullFace!=g.cullFace&&Tt.cullFace(h.cullFace=g.cullFace),h.useDepthMask!=g.useDepthMask&&Tt.depthMask(h.useDepthMask=g.useDepthMask),h.useDepthTest!=g.useDepthTest&&((h.useDepthTest=g.useDepthTest)?Tt.enable(Tt.DEPTH_TEST):Tt.disable(Tt.DEPTH_TEST)),h.useDepthTest&&h.depthTestFunc!=g.depthTestFunc&&Tt.depthFunc(h.depthTestFunc=g.depthTestFunc),x.uPointSize.use&&h.pointSize!=g.pointSize&&Tt.uniform1f(x.uPointSize.location,h.pointSize=g.pointSize),x.u_PerspectiveScale.location&&(k=x.u_PerspectiveScale._UUID,S=g._perspectiveScale,bt[k]!=S&&(Tt[x.u_PerspectiveScale.renderMethod](x.u_PerspectiveScale.location,S),bt[k]=S)),j||(h.useBlendMode!=g.useBlendMode&&((h.useBlendMode=g.useBlendMode)?Tt.enable(Tt.BLEND):Tt.disable(Tt.BLEND)),h.blendSrc==g.blendSrc&&h.blendDst==g.blendDst||(Tt.blendFunc(g.blendSrc,g.blendDst),h.blendSrc=g.blendSrc,h.blendDst=g.blendDst)),A?(a!=A._UUID&&Tt.bindBuffer(Tt.ELEMENT_ARRAY_BUFFER,A.webglBuffer),Tt.drawElements(g.drawMode,A.pointNum,A.glArrayType,0),a=A._UUID,u.triangleNum+=A.triangleNum):(Tt.drawArrays(g.drawMode,0,B.pointNum),u.triangleNum+=B.triangleNum)),g.children.length&&i(e,t,g.children,d,f,c,u,l,h,C,m)}},function(e,t,r,n,d,f,c,u){this.cacheInfo.cacheTexture.length=0,a=null,o=null,s=null,i(e,t,d,r,n,f,c,this.cacheInfo,this.cacheState,void 0,u)}),Object.freeze(RedRenderer)}(),(RedRenderDebuger=function(){if(!(this instanceof RedRenderDebuger))return new RedRenderDebuger;if(!this.renderResult){this.renderResult=document.createElement("div"),this._contentBox=document.createElement("div"),this._etcBox=document.createElement("div"),this.renderResult.appendChild(this._contentBox),this.renderResult.appendChild(this._etcBox),this.renderResult.style.cssText="position:absolute;bottom:0px;left:0px;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;background:rgba(0,0,0,0.75);padding:3px;width:300px",this._etcBox.style.cssText="position:relative;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;padding:3px;margin-top:10px;";var e=document.createElement("a");e.style.padding="5px",e.style.borderRadius="2px",e.style.background="rgba(91, 82, 170,0.8)",e.style.color="#fff",e.style.textDecoration="none",e.style.display="block",e.setAttribute("href","https://redcamel.github.io/RedGL2/redDoc/index.html"),e.innerHTML="API document",this._etcBox.appendChild(e),(e=document.createElement("a")).style.padding="5px",e.style.borderRadius="2px",e.style.background="rgba(91, 82, 170,0.8)",e.style.color="#fff",e.style.textDecoration="none",e.style.display="block",e.style.marginTop="2px",e.setAttribute("href","https://github.com/redcamel/RedGL2"),e.innerHTML="GITHUB",this._etcBox.appendChild(e)}this._visible=!1}).prototype={update:function(e,t){this._contentBox.innerHTML="";var r="",n=0,i=0;for(var a in t)r+='<div style="padding:5px"><div><b style="color:rgb(242, 169, 113)">RedView : key - '+t[a].key+'</b></div> orthographicYn - <b style="color:rgb(191, 82, 170)">'+t[a].orthographicYn+'</b> <br>call - <b style="color:rgb(191, 82, 170)">'+t[a].call+'</b> <br>triangleNum - <b style="color:rgb(191, 82, 170)">'+t[a].triangleNum+'</b> <br> width - <b style="color:rgb(191, 82, 170)">'+t[a].width+'</b> / height - <b style="color:rgb(191, 82, 170)">'+t[a].height+'</b> <br> viewRectWidth - <b style="color:rgb(191, 82, 170)">'+t[a].viewRectWidth+'</b> / viewRectHeight - <b style="color:rgb(191, 82, 170)">'+t[a].viewRectHeight+'</b> <br> x - <b style="color:rgb(191, 82, 170)">'+t[a].x+'</b> / y - <b style="color:rgb(191, 82, 170)">'+t[a].y+'</b><div>renderTime</div><div style="padding:5px 7px 7px 7px;background:rgba(0,0,0, 0.5);"><div>viewRenderTime - <b style="color:rgb(191, 82, 170)">'+t[a].viewRenderTime.toFixed(2)+'ms</b></div><div>baseRenderTime - <b style="color:rgb(191, 82, 170)">'+(t[a].viewRenderTime-t[a].postEffectRenderTime).toFixed(2)+'ms</b></div><div>postEffectRenderTime - <b style="color:rgb(191, 82, 170)">'+t[a].postEffectRenderTime.toFixed(2)+"ms</b></div></div></div>",n+=t[a].viewRenderTime,i+=t[a].postEffectRenderTime;r+='<div style="padding:0px 5px">',r+='<div>renderScale : <span style="padding:3px;background:#000">'+e.renderScale+"</span></div>",r+='<div>totalRenderTime : <span style="padding:3px;background:#000">'+n.toFixed(2)+"ms</span></div>",r+='<div>baseRenderTime : <span style="padding:3px;background:#000">'+(n-i).toFixed(2)+"ms</span></div>",r+='<div>postEffectRenderTime : <span style="padding:3px;background:#000">'+i.toFixed(2)+"ms</span></div>",r+="</div>",this._contentBox.innerHTML=r}},Object.defineProperty(RedRenderDebuger.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible=e,this._visible?document.body.appendChild(this.renderResult):this.renderResult.parentNode&&document.body.removeChild(this.renderResult)}}),Object.freeze(RedRenderDebuger),function(){var e,t,r,n,i,a,o,s,d,f,c,u,l,h,R,m,p,_,P,g,E,y,M,T,v,b,L,w,x,U,I,D,B,A,S,G,F;RedSystemUniformUpdater={update:(F=0,M={uTime:{cacheData:null,data:0},uResolution:{cacheData:null,data:new Float32Array([0,0])},u_FogDensity:{cacheData:null,data:0},uFogColor:{cacheData:null,data:new Float32Array([0,0,0,0])},u_FogDistance:{cacheData:null,data:0},uCameraMatrix:{cacheData:null,data:null},uPMatrix:{cacheData:null,data:null},uAmbientLightColor:{cacheData:null,data:new Float32Array([0,0,0,0])},uAmbientIntensity:{cacheData:null,data:1},uDirectionalLightPositionList:{cacheData:null,data:[]},uDirectionalLightColorList:{cacheData:null,data:[]},uDirectionalLightIntensityList:{cacheData:null,data:[]},uDirectionalLightNum:{cacheData:null,data:0},uPointLightPositionList:{cacheData:null,data:[]},uPointLightColorList:{cacheData:null,data:[]},uPointLightIntensityList:{cacheData:null,data:[]},uPointLightRadiusList:{cacheData:null,data:[]},uPointLightNum:{cacheData:null,data:0}},w=new Float32Array(3),v=new Float32Array(16),L=new Float32Array(16),d=new Float32Array(9),f=new Float32Array(12),c=new Float32Array(3),u=new Float32Array(15),l=new Float32Array(20),h=new Float32Array(5),R=new Float32Array(5),g=new Float32Array(3),function(C,O,k,N,X,Y){for(e=C.gl,D=N.scene,B=(B=N.camera)instanceof RedBaseController?B.camera:B,A=N._viewRect,I=O.cacheInfo.cacheSystemUniformInfo,U=null,T={},Y.length=0,S=F!=C._datas.RedProgramList.length,F=0,(G=M.uTime).cacheData!=k&&(T.uTime=G.data=k,G.cacheData=k),s=JSON.stringify(A),((G=M.uResolution).cacheData!=s||S)&&(G.data[0]=A[2],G.data[1]=A[3],T.uResolution=G.data,G.cacheData=s),s=D._fogDensity,((G=M.u_FogDensity).cacheData!=s||S)&&(T.u_FogDensity=G.data=s,G.cacheData=s),s=D._fogR+"_"+D._fogG+"_"+D._fogB+"_1",((G=M.uFogColor).cacheData!=s||S)&&(G.data[0]=D._fogR,G.data[1]=D._fogG,G.data[2]=D._fogB,G.data[3]=1,T.uFogColor=G.data,G.cacheData=s),s=D._fogDistance,((G=M.u_FogDistance).cacheData!=s||S)&&(T.u_FogDistance=G.data=s,G.cacheData=s),s=JSON.stringify(B.matrix),((G=M.uCameraMatrix).cacheData!=s||S)&&(T.uCameraMatrix=G.data=B.matrix,G.cacheData=s),s=JSON.stringify(B.perspectiveMTX),((G=M.uPMatrix).cacheData!=s||S)&&(T.uPMatrix=G.data=B.perspectiveMTX,G.cacheData=s),(_=D._lightInfo[RedAmbientLight.TYPE])&&(s=JSON.stringify(_._lightColor),((G=M.uAmbientLightColor).cacheData!=s||S)&&(T.uAmbientLightColor=G.data=_._lightColor,G.cacheData=s),s=_._intensity,((G=M.uAmbientIntensity).cacheData!=s||S)&&(T.uAmbientIntensity=G.data=_._intensity,G.cacheData=s)),m=D._lightInfo[RedDirectionalLight.TYPE],E=m.length;E--;)_=m[E],g[0]=_.x,g[1]=_.y,g[2]=_.z,_.debug&&((P=_._debugObject).x=g[0],P.y=g[1],P.z=g[2],P._material._color=_._lightColor,Y.push(P)),vec3.normalize(g,g),d[0+3*E]=g[0],d[1+3*E]=g[1],d[2+3*E]=g[2],f[0+4*E]=_._lightColor[0],f[1+4*E]=_._lightColor[1],f[2+4*E]=_._lightColor[2],f[3+4*E]=_._lightColor[3],c[E]=_._intensity;for(s=JSON.stringify(d),((G=M.uDirectionalLightPositionList).cacheData!=s||S)&&(T.uDirectionalLightPositionList=G.data=d,G.cacheData=s),s=JSON.stringify(f),((G=M.uDirectionalLightColorList).cacheData!=s||S)&&(T.uDirectionalLightColorList=G.data=f,G.cacheData=s),s=JSON.stringify(c),((G=M.uDirectionalLightIntensityList).cacheData!=s||S)&&(T.uDirectionalLightIntensityList=G.data=c,G.cacheData=s),s=m.length,((G=M.uDirectionalLightNum).cacheData!=s||S)&&(T.uDirectionalLightNum=G.data=s,G.cacheData=s),m=D._lightInfo[RedPointLight.TYPE],E=m.length;E--;)_=m[E],g[0]=_.x,g[1]=_.y,g[2]=_.z,_.debug&&((P=_._debugObject).x=g[0],P.y=g[1],P.z=g[2],P.scaleX=P.scaleY=P.scaleZ=_._radius,P._material._color=_._lightColor,Y.push(P)),u[0+3*E]=g[0],u[1+3*E]=g[1],u[2+3*E]=g[2],l[0+4*E]=_._lightColor[0],l[1+4*E]=_._lightColor[1],l[2+4*E]=_._lightColor[2],l[3+4*E]=_._lightColor[3],h[E]=_._intensity,R[E]=_._radius;for(s=JSON.stringify(u),((G=M.uPointLightPositionList).cacheData!=s||S)&&(T.uPointLightPositionList=G.data=u,G.cacheData=s),s=JSON.stringify(l),((G=M.uPointLightColorList).cacheData!=s||S)&&(T.uPointLightColorList=G.data=l,G.cacheData=s),s=JSON.stringify(h),((G=M.uPointLightIntensityList).cacheData!=s||S)&&(T.uPointLightIntensityList=G.data=h,G.cacheData=s),s=JSON.stringify(R),((G=M.uPointLightRadiusList).cacheData!=s||S)&&(T.uPointLightRadiusList=G.data=R,G.cacheData=s),s=m.length,((G=M.uPointLightNum).cacheData!=s||S)&&(T.uPointLightNum=G.data=s,G.cacheData=s),D.shadowManager._directionalShadow&&(v[1]=v[2]=v[3]=v[4]=v[6]=v[7]=v[8]=v[9]=v[11]=v[12]=v[13]=v[14]=0,v[0]=v[5]=v[10]=v[15]=1,b=D.shadowManager._directionalShadow.size,p=D.shadowManager._directionalShadow._light,mat4.ortho(L,-b,b,-b,b,-b,b),w[0]=0,w[1]=0,w[2]=0,p&&(w[0]=-p.x,w[1]=-p.y,w[2]=-p.z,vec3.normalize(w,w),mat4.lookAt(v,w,[0,0,0],[0,1,0]),mat4.multiply(v,L,v))),E=C._datas.RedProgramList.length;E--;)for(y in F++,t=C._datas.RedProgramList[E],e.useProgram(t.webglProgram),X=t._UUID,r=t.systemUniformLocation,n=r.uDirectionalShadowLightMatrix,i=n.location,a=n._UUID,i&&D.shadowManager._directionalShadow&&(p=D.shadowManager._directionalShadow._light)&&(s=JSON.stringify(v),I[a]!=s&&(e.uniformMatrix4fv(i,!1,v),I[a]=s)),(n=r.uDirectionalShadowTexture)&&(i=n.location)&&(a=n._UUID,o=D.shadowManager._directionalShadow?D.shadowManager.directionalShadow.frameBuffer.texture:C._datas.emptyTexture["2d"],(x=n.samplerIndex)!=U&&(e.activeTexture(e.TEXTURE0+x),e.bindTexture(e.TEXTURE_2D,o.webglTexture),e[n.renderMethod](i,x)),U=x),T)n=r[y],(i=n.location)&&(a=n._UUID,o=T[y],"mat"==n.renderType?e[n.renderMethod](i,!1,o):e[n.renderMethod](i,o),I[a]=null);return X})},Object.freeze(RedSystemUniformUpdater)}(),function(){var e;e={},(RedView=function(t,r,n,i){if(e[t]){if(!n&&!i)return e[t];RedGLUtil.throwFunc("RedView : "+t,"는 이미 생성된 RedView key입니다.","입력값 : "+t)}if(r instanceof RedGL||RedGLUtil.throwFunc("RedScene : RedGL Instance만 허용.",r),!(this instanceof RedView))return new RedView(t,r,n,i);"string"==typeof t||RedGLUtil.throwFunc("RedView : key : 문자열만 허용","입력값 : "+t),n||i||RedGLUtil.throwFunc("RedView : 존재하지 않는 key입니다.","입력값 : "+t),!n||n instanceof RedScene||RedGLUtil.throwFunc("RedView : RedScene Instance만 허용","입력값 : "+n),i?!i||i instanceof RedCamera||i instanceof RedBaseController||RedGLUtil.throwFunc("RedView : RedCamera or XXController Instance만 허용"):RedGLUtil.throwFunc("RedView : RedCamera or XXController Instance만 허용","입력값 : "+i),this.key=t,this.scene=n,this.postEffectManager=RedPostEffectManager(r),this.camera=i,this._width="100%",this._height="100%",this._x=0,this._y=0,this._viewRect=[0,0,0,0],e[t]=this}).prototype={setSize:function(e,t){void 0==e&&RedGLUtil.throwFunc("RedView setSize : width가 입력되지 않았습니다."),void 0==t&&RedGLUtil.throwFunc("RedView setSize : height가 입력되지 않았습니다."),"number"==typeof e?this._width=e<0?0:e:e.indexOf("%")>-1&&+e.replace("%","")>=0?this._width=e:RedGLUtil.throwFunc("RedView setSize : width는 0이상의 숫자나 %만 허용.",e),"number"==typeof t?this._height=t<0?0:t:t.indexOf("%")>-1&&+t.replace("%","")>=0?this._height=t:RedGLUtil.throwFunc("RedView setSize : height는 0이상의 숫자나 %만 허용.",t)},setLocation:function(e,t){void 0==e&&RedGLUtil.throwFunc("RedView setLocation : x가 입력되지 않았습니다."),void 0==t&&RedGLUtil.throwFunc("RedView setLocation : y가 입력되지 않았습니다."),"number"==typeof e?this._x=e<0?0:e:e.indexOf("%")>-1&&+e.replace("%","")>=0?this._x=e:RedGLUtil.throwFunc("RedView setLocation : x는 0이상의 숫자나 %만 허용.",e),"number"==typeof t?this._y=t<0?0:t:t.indexOf("%")>-1&&+t.replace("%","")>=0?this._y=t:RedGLUtil.throwFunc("RedView setLocation : y는 0이상의 숫자나 %만 허용.",t)}},Object.freeze(RedView)}(),function(){var e,t;(RedWorld=function(){if(!(this instanceof RedWorld))return new RedWorld;this._viewList=[],this._viewMap={},this._UUID=RedGL.makeUUID()}).prototype={addView:function(e){e instanceof RedView||RedGLUtil.throwFunc("RedWorld :addView Instance만 허용함.","입력값 : "+e),this._viewMap[e.key]=e,this._viewList.push(e)},getView:function(e){return"string"==typeof e||RedGLUtil.throwFunc("RedWorld :getView 문자열만 허용함.","입력값 : "+e),this._viewMap[e]},delView:function(r){"string"==typeof r||RedGLUtil.throwFunc("RedWorld :delView 문자열만 허용함.","입력값 : "+r),(e=this._viewMap[r])&&(t=this._viewList.indexOf(e),this._viewList.splice(t,1),delete this._viewMap[r])},hasView:function(e){return"string"==typeof e||RedGLUtil.throwFunc("RedWorld :hasView 문자열만 허용함.","입력값 : "+e),!!this._viewMap[e]},getViewList:function(){return this._viewList.concat()}},Object.freeze(RedWorld)}(),function(){RedScene=function(e,t){if(!(this instanceof RedScene))return new RedScene(e,t);e instanceof RedGL||RedGLUtil.throwFunc("RedScene : RedGL Instance만 허용.",e),this.backgroundColor=t||"#000000",this.useBackgroundColor=!0,this.useFog=!1,this.fogDensity=.5,this.fogDistance=25,this.fogColor="#ffffff",this.children=[],this.shadowManager=RedShadowManager(e),this._lightInfo={RedAmbientLight:null,RedDirectionalLight:[],RedPointLight:[]},this._UUID=RedGL.makeUUID()};var e,t,r={addLight:function(e){switch(e.TYPE){case RedAmbientLight.TYPE:this._lightInfo[e.TYPE]=e;break;case RedDirectionalLight.TYPE:this._lightInfo[e.TYPE].length==RedSystemShaderCode.MAX_DIRECTIONAL_LIGHT&&RedGLUtil.throwFunc("RedScene : RedDirectionalLight "+RedSystemShaderCode.MAX_DIRECTIONAL_LIGHT+"개 까지 허용."),this._lightInfo[e.TYPE].push(e);break;case RedPointLight.TYPE:this._lightInfo[e.TYPE].length==RedSystemShaderCode.MAX_POINT_LIGHT&&RedGLUtil.throwFunc("RedScene : RedPointLight "+RedSystemShaderCode.MAX_POINT_LIGHT+"개 까지 허용."),this._lightInfo[e.TYPE].push(e);break;default:RedGLUtil.throwFunc("RedScene : RedBaseLight 인스턴스만 가능")}},removeLight:function(t){switch(t.TYPE){case RedAmbientLight.TYPE:this._lightInfo[t.TYPE]==t&&(this._lightInfo[t.TYPE]=null);break;case RedDirectionalLight.TYPE:case RedPointLight.TYPE:(e=this._lightInfo[t.TYPE].indexOf(t))>-1&&this._lightInfo[t.TYPE].splice(e,1);break;default:RedGLUtil.throwFunc("RedScene : RedBaseLight 인스턴스만 가능")}}};for(var n in RedScene.prototype=new RedBaseContainer,r)RedScene.prototype[n]=r[n];RedDefinePropertyInfo.definePrototype("RedScene","backgroundColor","hex",{callback:function(){t=RedGLUtil.hexToRGB_ZeroToOne.call(this,this._backgroundColor),this._r=t[0],this._g=t[1],this._b=t[2]}}),RedDefinePropertyInfo.definePrototype("RedScene","useBackgroundColor","boolean",!0),RedDefinePropertyInfo.definePrototype("RedScene","useFog","boolean",!0),RedDefinePropertyInfo.definePrototype("RedScene","fogDensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedScene","fogDistance","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedScene","fogColor","hex",{callback:function(){var e;return function(){e=RedGLUtil.hexToRGB_ZeroToOne.call(this,this._fogColor),this._fogR=e[0],this._fogG=e[1],this._fogB=e[2]}}()}),Object.defineProperty(RedScene.prototype,"skyBox",{get:function(){return this._skyBoxMesh},set:function(e){return!e||e instanceof RedSkyBox||RedGLUtil.throwFunc("RedScene : RedSkyBox Instance만 허용."),this._skyBoxMesh=e,this._skyBoxMesh}}),Object.defineProperty(RedScene.prototype,"grid",{get:function(){return this._gridMesh},set:function(e){return!e||e instanceof RedGrid||RedGLUtil.throwFunc("RedScene : RedGrid Instance만 허용."),this._gridMesh=e,this._gridMesh}}),Object.defineProperty(RedScene.prototype,"axis",{get:function(){return this._axisMesh},set:function(e){return!e||e instanceof RedAxis||RedGLUtil.throwFunc("RedScene : RedAxis Instance만 허용."),this._axisMesh=e,this._axisMesh}}),Object.freeze(RedScene)}(),function(){var e,t;(RedCamera=function(){if(!(this instanceof RedCamera))return new RedCamera;this.x=this.y=this.z=0,this.targetX=this.targetY=this.targetZ=0,this.fov=60,this.nearClipping=.1,this.farClipping=1e5,this.orthographicYn=!1,this.matrix=mat4.create(),this.perspectiveMTX=mat4.create(),this.autoUpdateMatrix=!0,this._UUID=RedGL.makeUUID()}).prototype.update=function(){this.lookAt(this.targetX,this.targetY,this.targetZ)},RedCamera.prototype.lookAt=(e=new Float32Array([0,1,0]),t=[],function(r,n,i){t[0]=this.targetX=r,t[1]=this.targetY=n,t[2]=this.targetZ=i,mat4.identity(this.matrix),mat4.lookAt(this.matrix,[this.x,this.y,this.z],t,e)}),Object.freeze(RedCamera)}(),(RedBasicController=function(e){if(!(this instanceof RedBasicController))return new RedBasicController(e);this.keyBuffer={},this.keyNameMapper={moveForward:"w",moveBack:"s",moveLeft:"a",moveRight:"d",moveUp:"t",moveDown:"g",turnLeft:"q",turnRight:"e",turnUp:"r",turnDown:"f"},this.speed=1,this.delay=.1,this.speedRotation=1,this.delayRotation=.1,this.maxAcceleration=3,this.camera=RedCamera(),this._desirePosition=[0,0,0],this._desirePan=0,this._desireTilt=0,this._targetObject=RedMesh(e),function(t){var r,n,i,a,o,s,d,f,c;s=0,d=0,f=0,c=0,r=function(e){t.keyBuffer[e.key]=1},n=function(e){t.keyBuffer[e.key]=0},i=function(t){s=t.x,d=t.y,e._canvas.addEventListener("mousemove",a),window.addEventListener("mouseup",o)},a=function(e){f=e.x-s,c=e.y-d,s=e.x,d=e.y,t._desirePan-=f*t._speedRotation*.1,t._desireTilt-=c*t._speedRotation*.1},o=function(){e._canvas.removeEventListener("mousemove",a),window.removeEventListener("mouseup",o)},window.addEventListener("keydown",r),window.addEventListener("keyup",n),e._canvas.addEventListener("mousedown",i)}(this)}).prototype=new RedBaseController,RedDefinePropertyInfo.definePrototype("RedBasicController","speed","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedBasicController","delay","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedBasicController","speedRotation","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedBasicController","delayRotation","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedBasicController","maxAcceleration","number",{min:0}),Object.defineProperty(RedBasicController.prototype,"x",{get:function(){return this._targetObject.x},set:function(e){this._targetObject.x=e,this._desirePosition[0]=e}}),Object.defineProperty(RedBasicController.prototype,"y",{get:function(){return this._targetObject.y},set:function(e){this._targetObject.y=e,this._desirePosition[1]=e}}),Object.defineProperty(RedBasicController.prototype,"z",{get:function(){return this._targetObject.z},set:function(e){this._targetObject.z=e,this._desirePosition[2]=e}}),Object.defineProperty(RedBasicController.prototype,"tilt",{get:function(){return this._desireTilt},set:function(e){this._targetObject.rotationX=e,this._desireTilt=e}}),Object.defineProperty(RedBasicController.prototype,"pan",{get:function(){return this._desirePan},set:function(e){this._targetObject.rotationY=e,this._desirePan=e}}),RedBasicController.prototype.update=function(){var e,t,r,n,i,a,o,s,d,f,c,u,l,h,R,m,p,_;return new Float32Array([0,1,0]),u=mat4.create(),f=mat4.create(),c=mat4.create(),l=vec3.create(),R=0,function(){e=0,t=0,n=!1,i=!1,a=this._speed,o=this._speedRotation,s=this._delay,d=this._delayRotation,h=this.camera,_=this._desirePosition,m=this.keyBuffer,p=this.keyNameMapper,l[0]=0,l[1]=0,l[2]=0,m[p.turnLeft]&&(i=!0,e=o),m[p.turnRight]&&(i=!0,e=-o),m[p.turnUp]&&(i=!0,t=o),m[p.turnDown]&&(i=!0,t=-o),m[p.moveForward]&&(n=!0,l[2]=-R*a),m[p.moveBack]&&(n=!0,l[2]=R*a),m[p.moveLeft]&&(n=!0,l[0]=-R*a),m[p.moveRight]&&(n=!0,l[0]=R*a),m[p.moveUp]&&(n=!0,l[1]=R*a),m[p.moveDown]&&(n=!0,l[1]=-R*a),i||n?(R+=.1)>this._maxAcceleration&&(R=this._maxAcceleration):(R+=-.1)<0&&(R=0),r=this._targetObject,i&&(this._desirePan+=e,this._desireTilt+=t),r.rotationY+=(this._desirePan-r.rotationY)*d,r.rotationX+=(this._desireTilt-r.rotationX)*d,(n||i)&&(f=r.matrix,mat4.identity(u),mat4.rotateY(u,u,r.rotationY*Math.PI/180),mat4.rotateX(u,u,r.rotationX*Math.PI/180),mat4.translate(u,u,l),mat4.identity(f),mat4.translate(f,f,[r.x,r.y,r.z]),mat4.multiply(f,f,u),_[0]=f[12],_[1]=f[13],_[2]=f[14]),r.x+=(_[0]-r.x)*s,r.y+=(_[1]-r.y)*s,r.z+=(_[2]-r.z)*s,r.rotationY+=(this._desirePan-r.rotationY)*d,r.rotationX+=(this._desireTilt-r.rotationX)*d,f=r.matrix,mat4.identity(f),mat4.translate(f,f,[r.x,r.y,r.z]),mat4.rotateY(f,f,r.rotationY*Math.PI/180),mat4.rotateX(f,f,r.rotationX*Math.PI/180),c=mat4.clone(f),mat4.translate(c,c,[0,0,.01]),h.x=c[12],h.y=c[13],h.z=c[14],h.lookAt(r.x,r.y,r.z)}}(),Object.freeze(RedBasicController),function(){var e,t,r,n;(RedObitController=function(e){if(!(this instanceof RedObitController))return new RedObitController(e);this.centerX=0,this.centerY=0,this.centerZ=0,this.distance=15,this.speedDistance=2,this.delayDistance=.1,this.speedRotation=3,this.delayRotation=.1,this.tilt=0,this.minTilt=-90,this.maxTilt=90,this.pan=0,this.camera=RedCamera(),this._currentPan=0,this._currentTilt=0,this._currentDistance=0,function(t){var r,n,i,a,o,s,d,f;o=0,s=0,d=0,f=0,r=function(t){o=t.x,s=t.y,e._canvas.addEventListener("mousemove",n),window.addEventListener("mouseup",i)},n=function(e){d=e.x-o,f=e.y-s,o=e.x,s=e.y,t._pan-=d*t._speedRotation*.1,t._tilt-=f*t._speedRotation*.1},i=function(){e._canvas.removeEventListener("mousemove",n),window.removeEventListener("mouseup",i)},a=function(e){t.distance+=e.deltaY/100*t._speedDistance},e._canvas.addEventListener("mousedown",r),e._canvas.addEventListener("wheel",a)}(this)}).prototype=new RedBaseController,RedDefinePropertyInfo.definePrototype("RedObitController","centerX","number"),RedDefinePropertyInfo.definePrototype("RedObitController","centerY","number"),RedDefinePropertyInfo.definePrototype("RedObitController","centerZ","number"),RedDefinePropertyInfo.definePrototype("RedObitController","distance","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedObitController","speedDistance","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedObitController","delayDistance","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedObitController","speedRotation","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedObitController","delayRotation","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedObitController","pan","number"),RedDefinePropertyInfo.definePrototype("RedObitController","tilt","number"),RedDefinePropertyInfo.definePrototype("RedObitController","maxTilt","number",{max:90}),RedDefinePropertyInfo.definePrototype("RedObitController","minTilt","number",{max:-90}),RedObitController.prototype.update=(n=Math.PI/180,function(){this._tilt<this._minTilt&&(this._tilt=this._minTilt),this._tilt>this._maxTilt&&(this._tilt=this._maxTilt),e=this._delayRotation,t=this.camera,r=t.matrix,this._currentPan+=(this._pan-this._currentPan)*e,this._currentTilt+=(this._tilt-this._currentTilt)*e,this._currentDistance+=(this._distance-this._currentDistance)*this._delayDistance,mat4.identity(r),mat4.rotateY(r,r,this._currentPan*n),mat4.rotateX(r,r,this._currentTilt*n),mat4.translate(r,r,[0,0,this._currentDistance]),t.x=r[12],t.y=r[13],t.z=r[14],t.lookAt(this._centerX,this._centerY,this._centerZ)}),Object.freeze(RedObitController)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
vColor = aVertexColor;
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
varying vec4 vColor;
void main(void) {
vec4 finalColor = vColor;
finalColor.rgb *= vColor.a;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedGridMaterial=function(n){if(!(this instanceof RedGridMaterial))return new RedGridMaterial(n);this.makeProgramList(this,n,"RedGridMaterialProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,Object.freeze(RedGridMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec3 vReflectionCubeCoord;
void main(void) {
vReflectionCubeCoord = (uMMatrix *vec4(-aVertexPosition, 0.0)).xyz;
gl_Position = uPMatrix * uCameraMatrix * uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform samplerCube u_skyBoxTexture;
varying vec3 vReflectionCubeCoord;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = textureCube(u_skyBoxTexture, vReflectionCubeCoord);
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedSkyBoxMaterial=function(n,i){if(!(this instanceof RedSkyBoxMaterial))return new RedSkyBoxMaterial(n,i);n instanceof RedGL||RedGLUtil.throwFunc("RedSkyBoxMaterial : RedGL Instance만 허용.",n),this.makeProgramList(this,n,"RedSkyBoxMaterialProgram",e,t),this.skyBoxTexture=i,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedSkyBoxMaterial","skyBoxTexture","samplerCube",{essential:!0}),Object.freeze(RedSkyBoxMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
gl_Position =  uDirectionalShadowLightMatrix *  uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
vec4 encodeFloat (float depth) {
const vec4 cBitShift = vec4(
256 * 256 * 256,
256 * 256,
256,
1.0
);
const vec4 cBitMask = vec4(
0,
1.0 / 256.0,
1.0 / 256.0,
1.0 / 256.0
);
vec4 comp = fract(depth * cBitShift);
comp -= comp.xxyz * cBitMask;
return comp;
}
void main(void) {
gl_FragColor = encodeFloat(gl_FragCoord.z);
}
*/},(RedDirectionalShadowMaterial=function(n){if(!(this instanceof RedDirectionalShadowMaterial))return new RedDirectionalShadowMaterial(n);n instanceof RedGL||RedGLUtil.throwFunc("RedDirectionalShadowMaterial : RedGL Instance만 허용.",n),this._RedDirectionalShadowYn=!0,this.program=RedProgram.makeProgram(n,"RedDirectionalShadowMaterialProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,Object.freeze(RedDirectionalShadowMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
void main(void) {
gl_FragColor = texture2D(u_diffuseTexture, vTexcoord);
}
*/},(RedPostEffectMaterial=function(n,i){if(!(this instanceof RedPostEffectMaterial))return new RedPostEffectMaterial(n,i);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffectMaterial : RedGL Instance만 허용.",n),this.diffuseTexture=i,this.program=RedProgram.makeProgram(n,"RedPostEffectMaterialProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedPostEffectMaterial","diffuseTexture","sampler2D",{essential:!0}),Object.freeze(RedPostEffectMaterial)}(),function(){var e;(RedDirectionalShadow=function(e,t){if(!(this instanceof RedDirectionalShadow))return new RedDirectionalShadow(e,t);e instanceof RedGL||RedGLUtil.throwFunc("RedDirectionalShadow : RedGL Instance만 허용.",e),this._directionalShadowMaterial=RedDirectionalShadowMaterial(e),this.frameBuffer=RedFrameBuffer(e),this.light=t,this.width=2048,this.height=2048,this.size=20,this._UUID=RedGL.makeUUID(),this._castingList=[]}).prototype.addCasting=function(e){e instanceof RedBaseObject3D||RedGLUtil.throwFunc("addCasting","RedBaseObject3D Instance만 가능","입력값 : "+e),this._castingList.push(e)},RedDirectionalShadow.prototype.removeCasting=function(t){-1==(e=this._castingList.indexOf(t))?RedGLUtil.throwFunc("removeCasting","존재하지 않는 대상을 삭제하려고 함"):this._castingList.splice(e,1)},Object.defineProperty(RedDirectionalShadow.prototype,"light",{get:function(){return this._light},set:function(e){e&&e instanceof RedDirectionalLight||RedGLUtil.throwFunc("RedDirectionalShadow - light : RedDirectionalLight Instance만 허용.",e),this._light=e}}),RedDefinePropertyInfo.definePrototype("RedDirectionalShadow","width","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedDirectionalShadow","height","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedDirectionalShadow","size","number",{min:1}),Object.freeze(RedDirectionalShadow)}(),function(){var e,t,r,n,i,a;(RedShadowManager=function(e){if(!(this instanceof RedShadowManager))return new RedShadowManager(e);e instanceof RedGL||RedGLUtil.throwFunc("RedShadowManager : RedGL Instance만 허용.",e),this._UUID=RedGL.makeUUID()}).prototype={render:function(o,s,d,f,c){(n=this._directionalShadow)&&(e=o.gl,r=s.worldRect,t=d._viewRect,i=n.width,a=n.height,n.frameBuffer.width=i,n.frameBuffer.height=a,n.frameBuffer.bind(o.gl),e.viewport(0,0,i,a),e.scissor(0,0,i,a),s.sceneRender(o,d.scene,d.camera,d.camera.orthographicYn,n._castingList,f,c,n._directionalShadowMaterial),n.frameBuffer.unbind(o.gl),e.viewport(t[0],r[3]-t[3]-t[1],t[2],t[3]),e.scissor(t[0],r[3]-t[3]-t[1],t[2],t[3]))}},Object.defineProperty(RedShadowManager.prototype,"directionalShadow",{get:function(){return this._directionalShadow},set:function(e){!e||e instanceof RedDirectionalShadow||RedGLUtil.throwFunc("RedShadowManager - directionalShadow : RedDirectionalShadow Instance만 허용.",e),this._directionalShadow=e}}),Object.freeze(RedShadowManager)}(),function(){var e,t,r,n;t=function(t,r,n){var i;i=t._svg.querySelector("td").style,t["_"+r]=n,Object.defineProperty(t,r,{get:function(){return t["_"+r]},set:function(n){t["_"+r]=n,i[r]="number"==typeof n?n+="px":n,e(t)}}),t[r]=n},e=function(e){e._height=+e._height,e._svg.setAttribute("width",e._svg.viewBox.baseVal.width=e._width),e._svg.setAttribute("height",e._svg.viewBox.baseVal.height=e._height),e._svg.querySelector("foreignObject").setAttribute("height",e._height),e._svg.querySelector("table").style.height=e._height+"px",e._img.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(e._svg.outerHTML)},(RedText=function(e,r,n){if(!(this instanceof RedText))return new RedText(e,r,n);e instanceof RedGL||RedGLUtil.throwFunc("RedText : RedGL Instance만 허용.",e),RedBaseObject3D.build.call(this,e.gl);var i=this;this._cvs=document.createElement("canvas"),this._ctx=this._cvs.getContext("2d"),this._cvs.width=2,this._cvs.height=2,this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.setAttribute("xmlns","http://www.w3.org/2000/svg"),this._svg.style="position:absolute;top:0px;left:0px;text-align:center;z-index:10",this._svg.innerHTML='<foreignObject  width="100%" style="position:absolute;top:0;left:0">   <table xmlns="http://www.w3.org/1999/xhtml" style="position:table;top:0;left:0;width:100%;table-layout:fixed">       <tr xmlns="http://www.w3.org/1999/xhtml">       <td xmlns="http://www.w3.org/1999/xhtml"  > </td>       </tr>   </table></foreignObject>',this._img=new Image,r=r||256,n=n||256,r>e.detect.texture.MAX_TEXTURE_SIZE&&(r=e.detect.texture.MAX_TEXTURE_SIZE),n>e.detect.texture.MAX_TEXTURE_SIZE&&(n=e.detect.texture.MAX_TEXTURE_SIZE),this.width=r,this.height=n,t(this,"padding",0),t(this,"background",""),t(this,"color","#000"),t(this,"fontFamily","Arial"),t(this,"fontSize",16),t(this,"fontWeight","normal"),t(this,"fontStyle","normal"),t(this,"lineHeight",24),t(this,"letterSpacing",0),t(this,"wordBreak","break-all"),t(this,"verticalAlign","middle"),t(this,"textAlign","center"),this.geometry=RedPlane(e,1,1,0),this.material=RedBitmapMaterial(e,RedBitmapTexture(e,this._cvs)),this.blendSrc=e.gl.ONE,this.blendDst=e.gl.ONE_MINUS_SRC_ALPHA,this.useDepthMask=!1,this.useCullFace=!1,this.perspectiveScale=!1,this.sprite3DYn=!1,this._img.onload=function(){var t,r;t=i._width,r=i._height,i._cvs.width=t,i._cvs.height=r,i._ctx.clearRect(0,0,t,r),i.scaleX=i._width/e.gl.drawingBufferWidth,i.scaleY=i._height/e.gl.drawingBufferWidth,i._ctx.drawImage(i._img,0,0,t,r),i.material.diffuseTexture.src=i._cvs},this._UUID=RedGL.makeUUID()}).prototype=new RedBaseObject3D,RedDefinePropertyInfo.definePrototype("RedText","perspectiveScale","boolean",!0),RedDefinePropertyInfo.definePrototype("RedText","sprite3DYn","boolean",!0),RedDefinePropertyInfo.definePrototype("RedText","width","number",{min:2,callback:function(t){this._width=t,e(this)}}),RedDefinePropertyInfo.definePrototype("RedText","height","number",{min:2,callback:function(t){this._height=t,e(this)}}),Object.defineProperty(RedText.prototype,"text",{get:function(){return this._text},set:function(t){r=this._svg,n=r.querySelector("foreignObject td"),this._text=t.replace(/\<br\>/gi,"<div/>"),n.innerHTML=this._text,e(this)}}),Object.freeze(RedText)}(),function(){var e,t,r,n,i,a,o,s,d,f,c,u,l,h,R,m,p,_,P,g,E,y,M,T,v,b,L,w;(RedPostEffectManager=function(e){if(!(this instanceof RedPostEffectManager))return new RedPostEffectManager(e);e instanceof RedGL||RedGLUtil.throwFunc("RedPostEffectManager : RedGL Instance만 허용.",e),Object.defineProperty(this,"frameBuffer",{value:RedFrameBuffer(e)}),Object.defineProperty(this,"finalMaterial",{value:RedPostEffectMaterial(e,this.frameBuffer.texture)}),Object.defineProperty(this,"postEffectList",{value:[]}),Object.defineProperty(this,"children",{value:[RedMesh(e,RedPlane(e),this.finalMaterial)]}),this._UUID=RedGL.makeUUID()}).prototype={addEffect:function(e){e instanceof RedBasePostEffect||RedGLUtil.throwFunc("RedPostEffectManager : addEffect - RedBasePostEffect Instance만 허용.","입력값 : "+e),this.postEffectList.push(e)},removeEffect:function(e){-1!=(w=this.postEffectList.indexOf(e))&&this.postEffectList.splice(w,1)},removeAllEffect:function(){this.postEffectList.length=0},bind:function(e){this.frameBuffer.bind(e)},unbind:function(e){this.frameBuffer.unbind(e)},render:(p=mat4.create(),m=new Float32Array(2),d=function(t,r,n,i,a){e._material=n,c=e._material.program,t.useProgram(c.webglProgram),l=c.systemUniformLocation,(u=l.uPMatrix)&&(h=u.location,R=u._UUID,h&&(mat4.ortho(p,-.5,.5,-.5,.5,-r.farClipping,r.farClipping),mat4.scale(p,p,[1,-1,1]),_=JSON.stringify(p),f[R]!=_&&(t.uniformMatrix4fv(h,!1,p),f[R]=_))),(u=l.uResolution)&&(h=u.location,R=u._UUID,h&&(m[0]=i,m[1]=a,_=JSON.stringify(m),f[R]!=_&&(t.uniform2fv(h,m),f[R]=_)))},n=function(e,t,r,n){P=r.frameBuffer.width=n[2],g=r.frameBuffer.height=n[3],i==P&&a==g||(e.viewport(0,0,P,g),e.scissor(0,0,P,g)),d(e,t,r,P,g),i=P,a=g},s=function(e,t,d,f,c,u,l){var h,R,m,p,_,P,g,E,y,M;if(m=e.gl,y=f.scene,M=f._viewRect,t._process&&t._process.length)for(h=r,p=0,_=t._process.length;p<_;p++)s(e,t._process[p],d,f,c,u,l);if((R=t._subFrameBufferList)&&R.length)for(P=0,g=R.length;P<g;P++)if((E=R[P]).frameBuffer.width=M[2],E.frameBuffer.height=M[3],E.frameBuffer.bind(m),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT),c.sceneRender(e,y,o,o.orthographicYn,y.children,u,l,E.renderMaterial),E.frameBuffer.unbind(m),i=E.frameBuffer.width,a=E.frameBuffer.height,E._process&&E._process.length)for(p=0,_=E._process.length;p<_;p++)s(e,E._process[p],d,y,c,u,l);t.frameBuffer&&(n(m,o,t,M),t.bind(m),t.updateTexture(r,h),c.sceneRender(e,y,o,!0,d,u,l),t.unbind(m),r=t.frameBuffer.texture)},y=[],function(n,c,u,l,h,R){for(E=this,i=null,a=null,v=l.scene,o=l.camera instanceof RedBaseController?l.camera.camera:l.camera,b=l._viewRect,L=u.worldRect,f=u.cacheInfo.cacheSystemUniformInfo,E.unbind(c),e=E.children[0],r=t=E.frameBuffer.texture,E.frameBuffer.width=b[2],E.frameBuffer.height=b[3],y.length=0,M=0,T=E.postEffectList.length;M<T;M++)y[M]=E.postEffectList[M];for(E.antialiasing&&y.push(E.antialiasing),M=0,T=y.length;M<T;M++)s(n,y[M],E.children,l,u,h,R);r!=t&&(E.finalMaterial.diffuseTexture=r,c.viewport(b[0],L[3]-b[3]-b[1],b[2],b[3]),c.scissor(b[0],L[3]-b[3]-b[1],b[2],b[3]),d(c,o,E.finalMaterial,b[2],b[3],!0),u.sceneRender(n,v,o,!0,E.children,h,R)),E.finalMaterial.diffuseTexture=E.frameBuffer.texture})},Object.defineProperty(RedPostEffectManager.prototype,"antialiasing",{get:function(){return this._antialiasing},set:function(e){e&&(e instanceof RedPostEffect_FXAA||RedGLUtil.throwFunc("RedPostEffectManager : antialiasing - RedPostEffect_FXAA Instance만 허용.","입력값 : "+e)),this._antialiasing=e}}),Object.freeze(RedPostEffectManager)}(),(RedBasePostEffect=function(){}).prototype=new RedBaseMaterial,RedBasePostEffect.prototype.bind=RedPostEffectManager.prototype.bind,RedBasePostEffect.prototype.unbind=RedPostEffectManager.prototype.unbind,RedBasePostEffect.prototype.updateTexture=function(){RedGLUtil.throwFunc("RedBasePostEffect - updateTexture : 반드시 재정의해야함")},RedBasePostEffect.prototype._process=[],RedBasePostEffect.prototype._subFrameBufferList=[],Object.freeze(RedBasePostEffect),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform sampler2D u_blurTexture;
uniform float u_exposure;
uniform float u_bloomStrength;
void main() {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
vec4 thresholdColor = finalColor;
vec4 blurColor = texture2D(u_blurTexture, vTexcoord);
gl_FragColor = (finalColor  + blurColor * u_bloomStrength) * u_exposure ;
}
*/},(RedPostEffect_Bloom=function(n){if(!(this instanceof RedPostEffect_Bloom))return new RedPostEffect_Bloom(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Bloom : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.blurTexture=null,this.exposure=1,this.bloomStrength=1.2,this._process=[RedPostEffect_BloomThreshold(n),RedPostEffect_BlurX(n),RedPostEffect_BlurY(n)],this.blur=20,this.threshold=75,this.program=RedProgram.makeProgram(n,"RedPostEffectBloomProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Bloom.prototype.updateTexture=function(e,t){this.diffuseTexture=t,this.blurTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","blurTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","exposure","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","bloomStrength","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","threshold","number",{min:0,callback:function(e){this._process[0].threshold=e,this._threshold=this._process[0].threshold}}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","blur","number",{min:0,callback:function(e){this._process[1].size=e,this._process[2].size=e}}),Object.freeze(RedPostEffect_Bloom)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision highp float;
uniform sampler2D u_diffuseTexture;
uniform float u_threshold_value;
void main() {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
if(0.2126 * finalColor.r + 0.7152 * finalColor.g + 0.0722 * finalColor.b < u_threshold_value)  finalColor.r = finalColor.g = finalColor.b = 0.0;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_BloomThreshold=function(n){if(!(this instanceof RedPostEffect_BloomThreshold))return new RedPostEffect_BloomThreshold(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BloomThreshold : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.threshold=128,this.program=RedProgram.makeProgram(n,"RedPostEffectBloomThresholdProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_BloomThreshold.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_BloomThreshold","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_BloomThreshold","threshold","number",{min:0,max:255,callback:function(e){this._threshold_value=e/255}}),Object.freeze(RedPostEffect_BloomThreshold)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
void main(void) {
vec2 px = vec2(1.0/vResolution.x, 1.0/vResolution.y);
vec4 finalColor = vec4(0.0);
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-7.0*px.x, -7.0*px.y))*0.0044299121055113265;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-6.0*px.x, -6.0*px.y))*0.00895781211794;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-5.0*px.x, -5.0*px.y))*0.0215963866053;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-4.0*px.x, -4.0*px.y))*0.0443683338718;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-3.0*px.x, -3.0*px.y))*0.0776744219933;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-2.0*px.x, -2.0*px.y))*0.115876621105;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-1.0*px.x, -1.0*px.y))*0.147308056121;
finalColor += texture2D(u_diffuseTexture, vTexcoord                             )*0.159576912161;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 1.0*px.x,  1.0*px.y))*0.147308056121;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 2.0*px.x,  2.0*px.y))*0.115876621105;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 3.0*px.x,  3.0*px.y))*0.0776744219933;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 4.0*px.x,  4.0*px.y))*0.0443683338718;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 5.0*px.x,  5.0*px.y))*0.0215963866053;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 6.0*px.x,  6.0*px.y))*0.00895781211794;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 7.0*px.x,  7.0*px.y))*0.0044299121055113265;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Blur=function(n){if(!(this instanceof RedPostEffect_Blur))return new RedPostEffect_Blur(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Blur : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.program=RedProgram.makeProgram(n,"RedPostEffectBlurProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Blur.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Blur","diffuseTexture","sampler2D"),Object.freeze(RedPostEffect_Blur)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_size;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main() {
vec4 finalColor = vec4(0.0);
vec2 delta;
float total = 0.0;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
delta = vec2(u_size/vResolution.x,0.0);
for (float t = -10.0; t <= 10.0; t++) {
float percent = (t + offset - 0.5) / 10.0;
float weight = 1.0 - abs(percent);
vec4 sample = texture2D(u_diffuseTexture, vTexcoord + delta * percent);
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
finalColor = finalColor / total;
finalColor.rgb /= finalColor.a + 0.00001;
gl_FragColor =  finalColor ;
}
*/},(RedPostEffect_BlurX=function(n){if(!(this instanceof RedPostEffect_BlurX))return new RedPostEffect_BlurX(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BlurX : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.size=50,this.program=RedProgram.makeProgram(n,"RedPostEffectBlurXProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_BlurX.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_BlurX","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_BlurX","size","number",{min:0}),Object.freeze(RedPostEffect_BlurX)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_size;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main() {
vec4 finalColor = vec4(0.0);
vec2 delta;
float total = 0.0;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
delta = vec2(0.0, u_size/vResolution.y);
for (float t = -10.0; t <= 10.0; t++) {
float percent = (t + offset - 0.5) / 10.0;
float weight = 1.0 - abs(percent);
vec4 sample = texture2D(u_diffuseTexture, vTexcoord + delta * percent);
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
finalColor = finalColor / total;
finalColor.rgb /= finalColor.a + 0.00001;
gl_FragColor =   finalColor ;
}
*/},(RedPostEffect_BlurY=function(n){if(!(this instanceof RedPostEffect_BlurY))return new RedPostEffect_BlurY(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BlurY : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.size=50,this.program=RedProgram.makeProgram(n,"RedPostEffectBlurYProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_BlurY.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_BlurY","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_BlurY","size","number",{min:0}),Object.freeze(RedPostEffect_BlurY)}(),(RedPostEffect_GaussianBlur=function(e){if(!(this instanceof RedPostEffect_GaussianBlur))return new RedPostEffect_GaussianBlur(e);e instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_GaussianBlur : RedGL Instance만 허용.",e),this._UUID=RedGL.makeUUID(),this._process=[RedPostEffect_BlurX(e),RedPostEffect_BlurY(e)],this.radius=1}).prototype=new RedBasePostEffect,RedPostEffect_GaussianBlur.prototype.updateTexture=function(){},RedDefinePropertyInfo.definePrototype("RedPostEffect_GaussianBlur","radius","number",{min:.1,max:255,callback:function(e){this._process[0].size=e,this._process[1].size=e}}),Object.freeze(RedPostEffect_GaussianBlur),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_centerX;
uniform float u_centerY;
uniform float u_amount_value;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main(void) {
vec4 finalColor = vec4(0.0);
vec2 center = vec2(u_centerX+0.5,-u_centerY+0.5);
vec2 toCenter = center - vTexcoord ;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
float total = 0.0;
for (float t = 0.0; t <= 30.0; t++) {
float percent = (t + offset) / 30.0;
float weight = 3.0 * (percent - percent * percent);
vec4 sample = texture2D(u_diffuseTexture, vTexcoord + toCenter * percent * u_amount_value );
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
gl_FragColor = finalColor / total;
gl_FragColor.rgb /= gl_FragColor.a + 0.00001;
}
*/},(RedPostEffect_ZoomBlur=function(n){if(!(this instanceof RedPostEffect_ZoomBlur))return new RedPostEffect_ZoomBlur(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_ZoomBlur : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.centerX=0,this.centerY=0,this.amount=38,this.program=RedProgram.makeProgram(n,"RedPostEffectZoomBlurProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_ZoomBlur.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_ZoomBlur","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_ZoomBlur","centerX","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_ZoomBlur","centerY","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_ZoomBlur","amount","number",{min:1,max:100,callback:function(e){this._amount_value=e/100}}),Object.freeze(RedPostEffect_ZoomBlur)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_brightness_value;
uniform float u_contrast_value;
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord );
if (u_contrast_value > 0.0) finalColor.rgb = (finalColor.rgb - 0.5) / (1.0 - u_contrast_value) + 0.5;
else finalColor.rgb = (finalColor.rgb - 0.5) * (1.0 + u_contrast_value) + 0.5;
finalColor.rgb += u_brightness_value;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_BrightnessContrast=function(n){if(!(this instanceof RedPostEffect_BrightnessContrast))return new RedPostEffect_BrightnessContrast(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BrightnessContrast : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.brightness=0,this.contrast=0,this.program=RedProgram.makeProgram(n,"RedPostEffectBrightnessContrastProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_BrightnessContrast.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_BrightnessContrast","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_BrightnessContrast","brightness","number",{min:-150,max:150,callback:function(e){this._brightness_value=e/255}}),RedDefinePropertyInfo.definePrototype("RedPostEffect_BrightnessContrast","contrast","number",{min:-50,max:100,callback:function(e){this._contrast_value=e/255}}),Object.freeze(RedPostEffect_BrightnessContrast)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision highp float;
uniform sampler2D u_diffuseTexture;
uniform float u_threshold_value;
void main() {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
float v;
if(0.2126 * finalColor.r + 0.7152 * finalColor.g + 0.0722 * finalColor.b >= u_threshold_value) v = 1.0;
else v = 0.0;
finalColor.r = finalColor.g = finalColor.b = v;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Threshold=function(n){if(!(this instanceof RedPostEffect_Threshold))return new RedPostEffect_Threshold(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Threshold : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.threshold=128,this.program=RedProgram.makeProgram(n,"RedPostEffectThresholdProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Threshold.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Threshold","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Threshold","threshold","number",{min:1,max:255,callback:function(e){this._threshold_value=e/255}}),Object.freeze(RedPostEffect_Threshold)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
finalColor.r = 1.0 - finalColor.r;
finalColor.g = 1.0 - finalColor.g;
finalColor.b = 1.0 - finalColor.b;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Invert=function(n){if(!(this instanceof RedPostEffect_Invert))return new RedPostEffect_Invert(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Invert : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.program=RedProgram.makeProgram(n,"RedPostEffectInvertProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Invert.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Invert","diffuseTexture","sampler2D"),Object.freeze(RedPostEffect_Invert)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
highp float gray = (finalColor.r  + finalColor.g + finalColor.b)/3.0;
gl_FragColor = vec4( gray, gray, gray, 1.0);
}
*/},(RedPostEffect_Gray=function(n){if(!(this instanceof RedPostEffect_Gray))return new RedPostEffect_Gray(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Gray : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.program=RedProgram.makeProgram(n,"RedPostEffectGrayProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Gray.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Gray","diffuseTexture","sampler2D"),Object.freeze(RedPostEffect_Gray)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_hue_value;
uniform float u_saturation_value;
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord );
float angle = u_hue_value * 3.1415926535897932384626433832795;
float s = sin(angle), c = cos(angle);
vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;
float len = length(finalColor.rgb);
finalColor.rgb = vec3(
dot(finalColor.rgb, weights.xyz),
dot(finalColor.rgb, weights.zxy),
dot(finalColor.rgb, weights.yzx)
);
float average = (finalColor.r + finalColor.g + finalColor.b) / 3.0;
if (u_saturation_value > 0.0) finalColor.rgb += (average - finalColor.rgb) * (1.0 - 1.0 / (1.001 - u_saturation_value));
else finalColor.rgb += (average - finalColor.rgb) * (-u_saturation_value);
gl_FragColor = finalColor;
}
*/},(RedPostEffect_HueSaturation=function(n){if(!(this instanceof RedPostEffect_HueSaturation))return new RedPostEffect_HueSaturation(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_HueSaturation : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.hue=0,this.saturation=0,this.program=RedProgram.makeProgram(n,"RedPostEffectHueSaturationProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_HueSaturation.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_HueSaturation","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HueSaturation","hue","number",{min:-180,max:180,callback:function(e){this._hue_value=e/180}}),RedDefinePropertyInfo.definePrototype("RedPostEffect_HueSaturation","saturation","number",{min:-100,max:100,callback:function(e){this._saturation_value=e/100}}),Object.freeze(RedPostEffect_HueSaturation)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_centerX;
uniform float u_centerY;
uniform float u_angle;
uniform float u_radius;
uniform bool u_grayMode;
float pattern(float angle) {
angle = angle * 3.141592653589793/180.0;
float s = sin(angle), c = cos(angle);
vec2 tex = vTexcoord;
tex.x -= u_centerX + 0.5;
tex.y -= u_centerY + 0.5;
vec2 point = vec2(
c * tex.x - s * tex.y,
s * tex.x + c * tex.y
) * vResolution / u_radius;
return (sin(point.x) * sin(point.y)) * 4.0;
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
if(u_grayMode) {
float average = (finalColor.r + finalColor.g + finalColor.b) / 3.0;
gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern(u_angle)), finalColor.a);
}else{
vec3 cmy = 1.0 - finalColor.rgb;
float k = min(cmy.x, min(cmy.y, cmy.z));
cmy = (cmy - k) / (1.0 - k);
cmy = clamp(cmy * 10.0 - 3.0 + vec3(pattern(u_angle + 0.26179), pattern(u_angle + 1.30899), pattern(u_angle)), 0.0, 1.0);
k = clamp(k * 10.0 - 5.0 + pattern(u_angle + 0.78539), 0.0, 1.0);
gl_FragColor = vec4(1.0 - cmy - k, finalColor.a);
}
}
*/},(RedPostEffect_HalfTone=function(n){if(!(this instanceof RedPostEffect_HalfTone))return new RedPostEffect_HalfTone(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_HalfTone : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.centerX=0,this.centerY=0,this.angle=0,this.radius=2,this.grayMode=!1,this.program=RedProgram.makeProgram(n,"RedPostEffectHalfToneProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_HalfTone.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","centerX","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","centerY","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","angle","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","grayMode","boolean"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","radius","number",{min:0}),Object.freeze(RedPostEffect_HalfTone)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_width;
uniform float u_height;
void main(void) {
vec4 finalColor;
float dx = 1.0/vResolution.x * u_width;
float dy = 1.0/vResolution.y * u_height;
vec2 coord = vec2(
dx * (floor(vTexcoord.x / dx) + 0.5),
dy * (floor(vTexcoord.y / dy) + 0.5)
);
finalColor = texture2D(u_diffuseTexture, coord);
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Pixelize=function(n){if(!(this instanceof RedPostEffect_Pixelize))return new RedPostEffect_Pixelize(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Pixelize : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.width=5,this.height=5,this.program=RedProgram.makeProgram(n,"RedPostEffectPixelizeProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Pixelize.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Pixelize","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Pixelize","width","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Pixelize","height","number",{min:0}),Object.freeze(RedPostEffect_Pixelize)}(),function(){var e,t,r,n,i;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform mat3 u_kernel;
uniform float uKernelWeight;
void main(void) {
vec2 perPX = vec2(1.0/vResolution.x, 1.0/vResolution.y);
vec4 finalColor = vec4(0.0);
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2(-1.0, -1.0)) * u_kernel[0][0] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 0.0, -1.0)) * u_kernel[0][1] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 1.0, -1.0)) * u_kernel[0][2] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2(-1.0,  0.0)) * u_kernel[1][0] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 0.0,  0.0)) * u_kernel[1][1] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 1.0,  0.0)) * u_kernel[1][2] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2(-1.0,  1.0)) * u_kernel[2][0] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 0.0,  1.0)) * u_kernel[2][1] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 1.0,  1.0)) * u_kernel[2][2] ;
highp float weight;
weight = uKernelWeight;
if (0.01 > weight) {
weight = 1.0;
}
gl_FragColor = vec4((finalColor / uKernelWeight).rgb, 1.0);
}
*/},(RedPostEffect_Convolution=function(n,i){if(!(this instanceof RedPostEffect_Convolution))return new RedPostEffect_Convolution(n,i);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Convolution : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.kernel=i,this.program=RedProgram.makeProgram(n,"RedPostEffectConvolutionProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Convolution.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Convolution","diffuseTexture","sampler2D"),Object.defineProperty(RedPostEffect_Convolution.prototype,"kernel",{get:function(){return this._kernel||(this._kernel=RedPostEffect_Convolution.NORMAL),this._kernel},set:function(e){this._kernel=e}}),Object.defineProperty(RedPostEffect_Convolution.prototype,"kernelWeight",{get:function(){for(i in n=0,this.kernel)n+=this.kernel[i];return n}}),RedPostEffect_Convolution.NORMAL=[0,0,0,0,1,0,0,0,0],RedPostEffect_Convolution.SHARPEN=[0,-1,0,-1,5,-1,0,-1,0],RedPostEffect_Convolution.BLUR=[1,1,1,1,1,1,1,1,1],RedPostEffect_Convolution.EDGE=[0,1,0,1,-4,1,0,1,0],RedPostEffect_Convolution.EMBOSS=[-2,-1,0,-1,1,1,0,1,2],Object.freeze(RedPostEffect_Convolution)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform sampler2D u_blurTexture;
uniform sampler2D u_depthTexture;
void main() {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
vec4 blurColor = texture2D(u_blurTexture, vTexcoord);
vec4 depthColor = texture2D(u_depthTexture, vTexcoord);
finalColor.rgb *= (depthColor.r);
blurColor.rgb *= (1.0-depthColor.r);
gl_FragColor =  (finalColor + blurColor) ;
}
*/},(RedPostEffect_DoF=function(n){if(!(this instanceof RedPostEffect_DoF))return new RedPostEffect_DoF(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_DoF : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.blurTexture=null,this.depthTexture=null,this._subFrameBufferList=[{frameBuffer:RedFrameBuffer(n),renderMaterial:RedPostEffect_DoF_DepthMaterial(n),process:[]}],this._process=[RedPostEffect_BlurX(n),RedPostEffect_BlurY(n)],this.focusLength=15,this.blur=10,this.program=RedProgram.makeProgram(n,"RedPostEffectDoFProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_DoF.prototype.updateTexture=function(e,t){this.diffuseTexture=t,this.blurTexture=e,this.depthTexture=this._subFrameBufferList[0].frameBuffer.texture},RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF","blurTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF","depthTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF","blur","number",{min:0,callback:function(e){this._process[0].size=e,this._process[1].size=e}}),Object.defineProperty(RedPostEffect_DoF.prototype,"focusLength",{get:function(){return this._subFrameBufferList[0].renderMaterial.focusLength},set:function(e){this._subFrameBufferList[0].renderMaterial.focusLength=e}}),Object.freeze(RedPostEffect_DoF)}(),function(){var e,t,r;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
gl_PointSize = uPointSize;
//#define#sprite3D#true# gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
//#define#sprite3D#true# if(!u_PerspectiveScale){
//#define#sprite3D#true#   gl_Position /= gl_Position.w;
//#define#sprite3D#true#   gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1] * uResolution.x/uResolution.y);
//#define#sprite3D#true# }
//#define#sprite3D#false# gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform float u_focusLength;
void main(void) {
float depth = 1.0 - gl_FragCoord.z / gl_FragCoord.w / u_focusLength;
gl_FragColor = vec4(depth, depth, depth, 1.0);
}
*/},(RedPostEffect_DoF_DepthMaterial=function(n){if(!(this instanceof RedPostEffect_DoF_DepthMaterial))return new RedPostEffect_DoF_DepthMaterial(n);this.focusLength=15,this.program=RedProgram.makeProgram(n,"RedPostEffectDoFdepthProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF_DepthMaterial","focusLength","number",{min:0}),Object.freeze(RedPostEffect_DoF_DepthMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vTime = uTime;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform bool u_grayMode;
uniform sampler2D u_diffuseTexture;
uniform float u_noiseIntensity; // noise effect intensity value (0 = no effect, 1 = full effect)
uniform float u_scanlineIntensity; // scanlines effect intensity value (0 = no effect, 1 = full effect)
uniform float u_scanlineCount; // scanlines effect count value (0 = no effect, 4096 = full effect)
void main() {
// sample the source
vec4 diffuseColor = texture2D( u_diffuseTexture, vTexcoord );
// make some noise
float x = vTexcoord.x * vTexcoord.y * vTime;
x = mod( x, 13.0 ) * mod( x, 123.0 );
float dx = mod( x, 0.01 );
// add noise
vec3 finalColor = diffuseColor.rgb + diffuseColor.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );
// get us a sine and cosine
vec2 sc = vec2( sin( vTexcoord.y * u_scanlineCount ), cos( vTexcoord.y * u_scanlineCount ) );
// add scanlines
finalColor += diffuseColor.rgb * vec3( sc.x, sc.y, sc.x ) * u_scanlineIntensity;
// interpolate between source and result by intensity
finalColor = diffuseColor.rgb + clamp( u_noiseIntensity, 0.0, 1.0 ) * ( finalColor - diffuseColor.rgb );
// convert to grayscale if desired
if( u_grayMode ) finalColor = vec3( finalColor.r * 0.3 + finalColor.g * 0.59 + finalColor.b * 0.11 );
gl_FragColor =  vec4( finalColor, diffuseColor.a );
}
*/},(RedPostEffect_Film=function(n){if(!(this instanceof RedPostEffect_Film))return new RedPostEffect_Film(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Film : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.grayMode=!1,this.scanlineIntensity=.5,this.noiseIntensity=.5,this.scanlineCount=2048,this.program=RedProgram.makeProgram(n,"RedPostEffectFilmProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Film.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","grayMode","boolean"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","scanlineIntensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","noiseIntensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","scanlineCount","number",{min:0}),Object.freeze(RedPostEffect_Film)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_size;
uniform float u_intensity;
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord );
float dist = distance(vTexcoord, vec2(0.5, 0.5));
finalColor.rgb *= smoothstep(0.8, u_size * 0.799, dist * (u_intensity + u_size));
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Vignetting=function(n){if(!(this instanceof RedPostEffect_Vignetting))return new RedPostEffect_Vignetting(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Vignetting : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.size=.1,this.intensity=.85,this.program=RedProgram.makeProgram(n,"RedPostEffectVignettingProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Vignetting.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Vignetting","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Vignetting","intensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Vignetting","size","number",{min:0}),Object.freeze(RedPostEffect_Vignetting)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
const float cFXAA_REDUCE_MIN = 1.0/ 128.0;
const float cFXAA_REDUCE_MUL = 1.0 / 8.0;
const float cFXAA_SPAN_MAX = 8.0;
void main() {
vec4 finalColor;
vec2 inverseVP = vec2(1.0 / vResolution.x, 1.0 / vResolution.y);
vec2 fragCoord = gl_FragCoord.xy;
vec3 rgbNW = texture2D(u_diffuseTexture, (fragCoord + vec2(-1.0, -1.0)) * inverseVP).xyz;
vec3 rgbNE = texture2D(u_diffuseTexture, (fragCoord + vec2(1.0, -1.0)) * inverseVP).xyz;
vec3 rgbSW = texture2D(u_diffuseTexture, (fragCoord + vec2(-1.0, 1.0)) * inverseVP).xyz;
vec3 rgbSE = texture2D(u_diffuseTexture, (fragCoord + vec2(1.0, 1.0)) * inverseVP).xyz;
vec3 rgbM  = texture2D(u_diffuseTexture, fragCoord  * inverseVP).xyz;
vec3 luma = vec3(0.299, 0.587, 0.114);
float lumaNW = dot(rgbNW, luma);
float lumaNE = dot(rgbNE, luma);
float lumaSW = dot(rgbSW, luma);
float lumaSE = dot(rgbSE, luma);
float lumaM  = dot(rgbM,  luma);
float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));
vec2 dir;
dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));
float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * cFXAA_REDUCE_MUL), cFXAA_REDUCE_MIN);
float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
dir = min(
vec2(cFXAA_SPAN_MAX, cFXAA_SPAN_MAX),
max( vec2(-cFXAA_SPAN_MAX, -cFXAA_SPAN_MAX), dir * rcpDirMin)
) * inverseVP;
vec3 rgbA = 0.5 * (
texture2D(u_diffuseTexture, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
texture2D(u_diffuseTexture, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz
);
vec3 rgbB = rgbA * 0.5 + 0.25 * (
texture2D(u_diffuseTexture, fragCoord * inverseVP + dir * -0.5).xyz +
texture2D(u_diffuseTexture, fragCoord * inverseVP + dir * 0.5).xyz
);
float lumaB = dot(rgbB, luma);
if ((lumaB < lumaMin) || (lumaB > lumaMax)) finalColor = vec4(rgbA, 1.0);
else finalColor = vec4(rgbB, 1.0);
gl_FragColor = finalColor;
}
*/},(RedPostEffect_FXAA=function(n){if(!(this instanceof RedPostEffect_FXAA))return new RedPostEffect_FXAA(n);n instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_FXAA : RedGL Instance만 허용.",n),this.frameBuffer=RedFrameBuffer(n),this.diffuseTexture=null,this.program=RedProgram.makeProgram(n,"RedPostEffectFXAAProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_FXAA.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_FXAA","diffuseTexture","sampler2D"),Object.freeze(RedPostEffect_FXAA)}();console.log('RedGL Release. last update(2018-08-07 18:14:40)');