var RedGLUtil,RedGL,RedBaseContainer,RedBaseLight,RedBaseMaterial,RedBaseObject3D,RedBuffer,RedGeometry,RedInterleaveInfo,RedAmbientLight,RedDirectionalLight,RedPointLight,JsonModelLoader,RedAxis,RedGrid,RedMesh,RedLine,RedSkyBox,RedSprite3D,RedPointUnit,RedBox,RedPlane,RedSphere,RedProgram,RedSystemShaderCode,RedShader,RedRenderer,RedRenderDebuger,RedAtlas,RedAtlasUV,RedBitmapTexture,RedAtlasTexture,RedBitmapCubeTexture,RedView,RedWorld,RedScene,RedCamera,RedBasicController,RedObitController;!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=function(e){t.ARRAY_TYPE=e},t.toRadian=function(e){return e*i},t.equals=function(e,t){return Math.abs(e-t)<=n*Math.max(1,Math.abs(e),Math.abs(t))};var n=t.EPSILON=1e-6,i=(t.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,t.RANDOM=Math.random,Math.PI/180)},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=t[6],d=t[7],h=t[8],f=r[0],l=r[1],R=r[2],m=r[3],M=r[4],v=r[5],p=r[6],E=r[7],b=r[8];return e[0]=f*n+l*o+R*u,e[1]=f*i+l*s+R*d,e[2]=f*a+l*c+R*h,e[3]=m*n+M*o+v*u,e[4]=m*i+M*s+v*d,e[5]=m*a+M*c+v*h,e[6]=p*n+E*o+b*u,e[7]=p*i+E*s+b*d,e[8]=p*a+E*c+b*h,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},t.clone=function(e){var t=new a.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromValues=function(e,t,r,n,i,o,s,c,u){var d=new a.ARRAY_TYPE(9);return d[0]=e,d[1]=t,d[2]=r,d[3]=n,d[4]=i,d[5]=o,d[6]=s,d[7]=c,d[8]=u,d},t.set=function(e,t,r,n,i,a,o,s,c,u){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=c,e[8]=u,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7],d=t[8],h=d*o-s*u,f=-d*a+s*c,l=u*a-o*c,R=r*h+n*f+i*l;return R?(R=1/R,e[0]=h*R,e[1]=(-d*n+i*u)*R,e[2]=(s*n-i*o)*R,e[3]=f*R,e[4]=(d*r-i*c)*R,e[5]=(-s*r+i*a)*R,e[6]=l*R,e[7]=(-u*r+n*c)*R,e[8]=(o*r-n*a)*R,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7],d=t[8];return e[0]=o*d-s*u,e[1]=i*u-n*d,e[2]=n*s-i*o,e[3]=s*c-a*d,e[4]=r*d-i*c,e[5]=i*a-r*s,e[6]=a*u-o*c,e[7]=n*c-r*u,e[8]=r*o-n*a,e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],u=e[8];return t*(u*a-o*c)+r*(-u*i+o*s)+n*(c*i-a*s)},t.multiply=n,t.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=t[6],d=t[7],h=t[8],f=r[0],l=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=c,e[6]=f*n+l*o+u,e[7]=f*i+l*s+d,e[8]=f*a+l*c+h,e},t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=t[6],d=t[7],h=t[8],f=Math.sin(r),l=Math.cos(r);return e[0]=l*n+f*o,e[1]=l*i+f*s,e[2]=l*a+f*c,e[3]=l*o-f*n,e[4]=l*s-f*i,e[5]=l*c-f*a,e[6]=u,e[7]=d,e[8]=h,e},t.scale=function(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,c=i+i,u=r*o,d=n*o,h=n*s,f=i*o,l=i*s,R=i*c,m=a*o,M=a*s,v=a*c;return e[0]=1-h-R,e[3]=d-v,e[6]=f+M,e[1]=d+v,e[4]=1-u-R,e[7]=l-m,e[2]=f-M,e[5]=l+m,e[8]=1-u-h,e},t.normalFromMat4=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7],d=t[8],h=t[9],f=t[10],l=t[11],R=t[12],m=t[13],M=t[14],v=t[15],p=r*s-n*o,E=r*c-i*o,b=r*u-a*o,y=n*c-i*s,A=n*u-a*s,g=i*u-a*c,L=d*m-h*R,U=d*M-f*R,w=d*v-l*R,I=h*M-f*m,_=h*v-l*m,T=f*v-l*M,x=p*T-E*_+b*I+y*w-A*U+g*L;return x?(x=1/x,e[0]=(s*T-c*_+u*I)*x,e[1]=(c*w-o*T-u*U)*x,e[2]=(o*_-s*w+u*L)*x,e[3]=(i*_-n*T-a*I)*x,e[4]=(r*T-i*w+a*U)*x,e[5]=(n*w-r*_-a*L)*x,e[6]=(m*g-M*A+v*y)*x,e[7]=(M*b-R*g-v*E)*x,e[8]=(R*A-m*b+v*p)*x,e):null},t.projection=function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},t.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],c=e[5],u=e[6],d=e[7],h=e[8],f=t[0],l=t[1],R=t[2],m=t[3],M=t[4],v=t[5],p=t[6],E=t[7],b=t[8];return Math.abs(r-f)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-l)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-R)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(R))&&Math.abs(o-m)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-M)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(c-v)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(u-p)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(d-E)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(h-b)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(){var e=new R.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e}function i(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function a(e,t,r){var n=new R.ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=r,n}function o(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function s(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function c(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function u(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function d(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function h(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function f(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function l(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=function(e){var t=new R.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.length=i,t.fromValues=a,t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},t.subtract=o,t.multiply=s,t.divide=c,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},t.distance=u,t.squaredDistance=d,t.squaredLength=h,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=f,t.dot=l,t.cross=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],c=r[2];return e[0]=i*c-a*s,e[1]=a*o-n*c,e[2]=n*s-i*o,e},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e},t.hermite=function(e,t,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,c=o*(a-2)+a,u=o*(a-1),d=o*(3-2*a);return e[0]=t[0]*s+r[0]*c+n[0]*u+i[0]*d,e[1]=t[1]*s+r[1]*c+n[1]*u+i[1]*d,e[2]=t[2]*s+r[2]*c+n[2]*u+i[2]*d,e},t.bezier=function(e,t,r,n,i,a){var o=1-a,s=o*o,c=a*a,u=s*o,d=3*a*s,h=3*c*o,f=c*a;return e[0]=t[0]*u+r[0]*d+n[0]*h+i[0]*f,e[1]=t[1]*u+r[1]*d+n[1]*h+i[1]*f,e[2]=t[2]*u+r[2]*d+n[2]*h+i[2]*f,e},t.random=function(e,t){t=t||1;var r=2*R.RANDOM()*Math.PI,n=2*R.RANDOM()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e},t.transformMat3=function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],c=r[2],u=r[3],d=u*n+s*a-c*i,h=u*i+c*n-o*a,f=u*a+o*i-s*n,l=-o*n-s*i-c*a;return e[0]=d*u+l*-o+h*-c-f*-s,e[1]=h*u+l*-s+f*-o-d*-c,e[2]=f*u+l*-c+d*-s-h*-o,e},t.rotateX=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateY=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateZ=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.angle=function(e,t){var r=a(e[0],e[1],e[2]),n=a(t[0],t[1],t[2]);f(r,r),f(n,n);var i=l(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(r-a)<=R.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=R.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=R.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))};var R=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=o,t.mul=s,t.div=c,t.dist=u,t.sqrDist=d,t.len=i,t.sqrLen=h,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,c=void 0;for(r||(r=3),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,c=n;c<s;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],a(e,e,o),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}}()},function(e,t,r){"use strict";function n(){var e=new l.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function s(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function c(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+a*a)}function u(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a}function d(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function h(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function f(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o),e}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=function(e){var t=new l.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,r,n){var i=new l.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=i,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=s,t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},t.distance=c,t.squaredDistance=u,t.length=d,t.squaredLength=h,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=f,t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e},t.random=function(e,t){return t=t||1,e[0]=l.RANDOM(),e[1]=l.RANDOM(),e[2]=l.RANDOM(),e[3]=l.RANDOM(),f(e,e),s(e,e,t),e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],c=r[2],u=r[3],d=u*n+s*a-c*i,h=u*i+c*n-o*a,f=u*a+o*i-s*n,l=-o*n-s*i-c*a;return e[0]=d*u+l*-o+h*-c-f*-s,e[1]=h*u+l*-s+f*-o-d*-c,e[2]=f*u+l*-c+d*-s-h*-o,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=t[0],s=t[1],c=t[2],u=t[3];return Math.abs(r-o)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-c)<=l.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-u)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))};var l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=i,t.mul=a,t.div=o,t.dist=c,t.sqrDist=u,t.len=d,t.sqrLen=h,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,c=void 0;for(r||(r=4),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,c=n;c<s;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],e[3]=t[c+3],a(e,e,o),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2],t[c+3]=e[3];return t}}()},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=t.vec3=t.vec2=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.glMatrix=void 0;var i=n(r(0)),a=n(r(5)),o=n(r(6)),s=n(r(1)),c=n(r(7)),u=n(r(8)),d=n(r(9)),h=n(r(2)),f=n(r(3));t.glMatrix=i,t.mat2=a,t.mat2d=o,t.mat3=s,t.mat4=c,t.quat=u,t.vec2=d,t.vec3=h,t.vec4=f},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],c=r[1],u=r[2],d=r[3];return e[0]=n*s+a*c,e[1]=i*s+o*c,e[2]=n*u+a*d,e[3]=i*u+o*d,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.fromValues=function(e,t,r,n){var i=new a.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},t.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},t.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*a-i*n;return o?(o=1/o,e[0]=a*o,e[1]=-n*o,e[2]=-i*o,e[3]=r*o,e):null},t.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},t.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},t.multiply=n,t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),c=Math.cos(r);return e[0]=n*c+a*s,e[1]=i*c+o*s,e[2]=n*-s+a*c,e[3]=i*-s+o*c,e},t.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],c=r[1];return e[0]=n*s,e[1]=i*s,e[2]=a*c,e[3]=o*c,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},t.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},t.LDU=function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=i,t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=t[0],c=t[1],u=t[2],d=t[3];return Math.abs(r-s)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-c)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-u)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-d)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))},t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=r[0],d=r[1],h=r[2],f=r[3],l=r[4],R=r[5];return e[0]=n*u+a*d,e[1]=i*u+o*d,e[2]=n*h+a*f,e[3]=i*h+o*f,e[4]=n*l+a*R+s,e[5]=i*l+o*R+c,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.clone=function(e){var t=new a.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.fromValues=function(e,t,r,n,i,o){var s=new a.ARRAY_TYPE(6);return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s},t.set=function(e,t,r,n,i,a,o){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=r*a-n*i;return c?(c=1/c,e[0]=a*c,e[1]=-n*c,e[2]=-i*c,e[3]=r*c,e[4]=(i*s-a*o)*c,e[5]=(n*o-r*s)*c,e):null},t.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},t.multiply=n,t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=Math.sin(r),d=Math.cos(r);return e[0]=n*d+a*u,e[1]=i*d+o*u,e[2]=n*-u+a*d,e[3]=i*-u+o*d,e[4]=s,e[5]=c,e},t.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=r[0],d=r[1];return e[0]=n*u,e[1]=i*u,e[2]=a*d,e[3]=o*d,e[4]=s,e[5]=c,e},t.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=r[0],d=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=n*u+a*d+s,e[5]=i*u+o*d+c,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},t.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],c=e[5],u=t[0],d=t[1],h=t[2],f=t[3],l=t[4],R=t[5];return Math.abs(r-u)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-d)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(i-h)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-f)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-l)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(c-R)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(R))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=t[6],d=t[7],h=t[8],f=t[9],l=t[10],R=t[11],m=t[12],M=t[13],v=t[14],p=t[15],E=r[0],b=r[1],y=r[2],A=r[3];return e[0]=E*n+b*s+y*h+A*m,e[1]=E*i+b*c+y*f+A*M,e[2]=E*a+b*u+y*l+A*v,e[3]=E*o+b*d+y*R+A*p,E=r[4],b=r[5],y=r[6],A=r[7],e[4]=E*n+b*s+y*h+A*m,e[5]=E*i+b*c+y*f+A*M,e[6]=E*a+b*u+y*l+A*v,e[7]=E*o+b*d+y*R+A*p,E=r[8],b=r[9],y=r[10],A=r[11],e[8]=E*n+b*s+y*h+A*m,e[9]=E*i+b*c+y*f+A*M,e[10]=E*a+b*u+y*l+A*v,e[11]=E*o+b*d+y*R+A*p,E=r[12],b=r[13],y=r[14],A=r[15],e[12]=E*n+b*s+y*h+A*m,e[13]=E*i+b*c+y*f+A*M,e[14]=E*a+b*u+y*l+A*v,e[15]=E*o+b*d+y*R+A*p,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.fromValues=function(e,t,r,n,i,o,s,c,u,d,h,f,l,R,m,M){var v=new a.ARRAY_TYPE(16);return v[0]=e,v[1]=t,v[2]=r,v[3]=n,v[4]=i,v[5]=o,v[6]=s,v[7]=c,v[8]=u,v[9]=d,v[10]=h,v[11]=f,v[12]=l,v[13]=R,v[14]=m,v[15]=M,v},t.set=function(e,t,r,n,i,a,o,s,c,u,d,h,f,l,R,m,M){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=c,e[8]=u,e[9]=d,e[10]=h,e[11]=f,e[12]=l,e[13]=R,e[14]=m,e[15]=M,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7],d=t[8],h=t[9],f=t[10],l=t[11],R=t[12],m=t[13],M=t[14],v=t[15],p=r*s-n*o,E=r*c-i*o,b=r*u-a*o,y=n*c-i*s,A=n*u-a*s,g=i*u-a*c,L=d*m-h*R,U=d*M-f*R,w=d*v-l*R,I=h*M-f*m,_=h*v-l*m,T=f*v-l*M,x=p*T-E*_+b*I+y*w-A*U+g*L;return x?(x=1/x,e[0]=(s*T-c*_+u*I)*x,e[1]=(i*_-n*T-a*I)*x,e[2]=(m*g-M*A+v*y)*x,e[3]=(f*A-h*g-l*y)*x,e[4]=(c*w-o*T-u*U)*x,e[5]=(r*T-i*w+a*U)*x,e[6]=(M*b-R*g-v*E)*x,e[7]=(d*g-f*b+l*E)*x,e[8]=(o*_-s*w+u*L)*x,e[9]=(n*w-r*_-a*L)*x,e[10]=(R*A-m*b+v*p)*x,e[11]=(h*b-d*A-l*p)*x,e[12]=(s*U-o*I-c*L)*x,e[13]=(r*I-n*U+i*L)*x,e[14]=(m*E-R*y-M*p)*x,e[15]=(d*y-h*E+f*p)*x,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7],d=t[8],h=t[9],f=t[10],l=t[11],R=t[12],m=t[13],M=t[14],v=t[15];return e[0]=s*(f*v-l*M)-h*(c*v-u*M)+m*(c*l-u*f),e[1]=-(n*(f*v-l*M)-h*(i*v-a*M)+m*(i*l-a*f)),e[2]=n*(c*v-u*M)-s*(i*v-a*M)+m*(i*u-a*c),e[3]=-(n*(c*l-u*f)-s*(i*l-a*f)+h*(i*u-a*c)),e[4]=-(o*(f*v-l*M)-d*(c*v-u*M)+R*(c*l-u*f)),e[5]=r*(f*v-l*M)-d*(i*v-a*M)+R*(i*l-a*f),e[6]=-(r*(c*v-u*M)-o*(i*v-a*M)+R*(i*u-a*c)),e[7]=r*(c*l-u*f)-o*(i*l-a*f)+d*(i*u-a*c),e[8]=o*(h*v-l*m)-d*(s*v-u*m)+R*(s*l-u*h),e[9]=-(r*(h*v-l*m)-d*(n*v-a*m)+R*(n*l-a*h)),e[10]=r*(s*v-u*m)-o*(n*v-a*m)+R*(n*u-a*s),e[11]=-(r*(s*l-u*h)-o*(n*l-a*h)+d*(n*u-a*s)),e[12]=-(o*(h*M-f*m)-d*(s*M-c*m)+R*(s*f-c*h)),e[13]=r*(h*M-f*m)-d*(n*M-i*m)+R*(n*f-i*h),e[14]=-(r*(s*M-c*m)-o*(n*M-i*m)+R*(n*c-i*s)),e[15]=r*(s*f-c*h)-o*(n*f-i*h)+d*(n*c-i*s),e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],l=e[12],R=e[13],m=e[14],M=e[15];return(t*o-r*a)*(h*M-f*m)-(t*s-n*a)*(d*M-f*R)+(t*c-i*a)*(d*m-h*R)+(r*s-n*o)*(u*M-f*l)-(r*c-i*o)*(u*m-h*l)+(n*c-i*s)*(u*R-d*l)},t.multiply=n,t.translate=function(e,t,r){var n=r[0],i=r[1],a=r[2],o=void 0,s=void 0,c=void 0,u=void 0,d=void 0,h=void 0,f=void 0,l=void 0,R=void 0,m=void 0,M=void 0,v=void 0;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],c=t[2],u=t[3],d=t[4],h=t[5],f=t[6],l=t[7],R=t[8],m=t[9],M=t[10],v=t[11],e[0]=o,e[1]=s,e[2]=c,e[3]=u,e[4]=d,e[5]=h,e[6]=f,e[7]=l,e[8]=R,e[9]=m,e[10]=M,e[11]=v,e[12]=o*n+d*i+R*a+t[12],e[13]=s*n+h*i+m*a+t[13],e[14]=c*n+f*i+M*a+t[14],e[15]=u*n+l*i+v*a+t[15]),e},t.scale=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,r,n){var i=n[0],o=n[1],s=n[2],c=Math.sqrt(i*i+o*o+s*s),u=void 0,d=void 0,h=void 0,f=void 0,l=void 0,R=void 0,m=void 0,M=void 0,v=void 0,p=void 0,E=void 0,b=void 0,y=void 0,A=void 0,g=void 0,L=void 0,U=void 0,w=void 0,I=void 0,_=void 0,T=void 0,x=void 0,S=void 0,P=void 0;return Math.abs(c)<a.EPSILON?null:(i*=c=1/c,o*=c,s*=c,u=Math.sin(r),h=1-(d=Math.cos(r)),f=t[0],l=t[1],R=t[2],m=t[3],M=t[4],v=t[5],p=t[6],E=t[7],b=t[8],y=t[9],A=t[10],g=t[11],L=i*i*h+d,U=o*i*h+s*u,w=s*i*h-o*u,I=i*o*h-s*u,_=o*o*h+d,T=s*o*h+i*u,x=i*s*h+o*u,S=o*s*h-i*u,P=s*s*h+d,e[0]=f*L+M*U+b*w,e[1]=l*L+v*U+y*w,e[2]=R*L+p*U+A*w,e[3]=m*L+E*U+g*w,e[4]=f*I+M*_+b*T,e[5]=l*I+v*_+y*T,e[6]=R*I+p*_+A*T,e[7]=m*I+E*_+g*T,e[8]=f*x+M*S+b*P,e[9]=l*x+v*S+y*P,e[10]=R*x+p*S+A*P,e[11]=m*x+E*S+g*P,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],c=t[7],u=t[8],d=t[9],h=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+u*n,e[5]=o*i+d*n,e[6]=s*i+h*n,e[7]=c*i+f*n,e[8]=u*i-a*n,e[9]=d*i-o*n,e[10]=h*i-s*n,e[11]=f*i-c*n,e},t.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],c=t[3],u=t[8],d=t[9],h=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-u*n,e[1]=o*i-d*n,e[2]=s*i-h*n,e[3]=c*i-f*n,e[8]=a*n+u*i,e[9]=o*n+d*i,e[10]=s*n+h*i,e[11]=c*n+f*i,e},t.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],c=t[3],u=t[4],d=t[5],h=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+u*n,e[1]=o*i+d*n,e[2]=s*i+h*n,e[3]=c*i+f*n,e[4]=u*i-a*n,e[5]=d*i-o*n,e[6]=h*i-s*n,e[7]=f*i-c*n,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,r){var n=r[0],i=r[1],o=r[2],s=Math.sqrt(n*n+i*i+o*o),c=void 0,u=void 0,d=void 0;return Math.abs(s)<a.EPSILON?null:(n*=s=1/s,i*=s,o*=s,c=Math.sin(t),d=1-(u=Math.cos(t)),e[0]=n*n*d+u,e[1]=i*n*d+o*c,e[2]=o*n*d-i*c,e[3]=0,e[4]=n*i*d-o*c,e[5]=i*i*d+u,e[6]=o*i*d+n*c,e[7]=0,e[8]=n*o*d+i*c,e[9]=i*o*d-n*c,e[10]=o*o*d+u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,c=i+i,u=a+a,d=n*s,h=n*c,f=n*u,l=i*c,R=i*u,m=a*u,M=o*s,v=o*c,p=o*u;return e[0]=1-(l+m),e[1]=h+p,e[2]=f-v,e[3]=0,e[4]=h-p,e[5]=1-(d+m),e[6]=R+M,e[7]=0,e[8]=f+v,e[9]=R-M,e[10]=1-(d+l),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],c=t[8],u=t[9],d=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(c*c+u*u+d*d),e},t.getRotation=function(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},t.fromRotationTranslationScale=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],c=i+i,u=a+a,d=o+o,h=i*c,f=i*u,l=i*d,R=a*u,m=a*d,M=o*d,v=s*c,p=s*u,E=s*d,b=n[0],y=n[1],A=n[2];return e[0]=(1-(R+M))*b,e[1]=(f+E)*b,e[2]=(l-p)*b,e[3]=0,e[4]=(f-E)*y,e[5]=(1-(h+M))*y,e[6]=(m+v)*y,e[7]=0,e[8]=(l+p)*A,e[9]=(m-v)*A,e[10]=(1-(h+R))*A,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,r,n,i){var a=t[0],o=t[1],s=t[2],c=t[3],u=a+a,d=o+o,h=s+s,f=a*u,l=a*d,R=a*h,m=o*d,M=o*h,v=s*h,p=c*u,E=c*d,b=c*h,y=n[0],A=n[1],g=n[2],L=i[0],U=i[1],w=i[2];return e[0]=(1-(m+v))*y,e[1]=(l+b)*y,e[2]=(R-E)*y,e[3]=0,e[4]=(l-b)*A,e[5]=(1-(f+v))*A,e[6]=(M+p)*A,e[7]=0,e[8]=(R+E)*g,e[9]=(M-p)*g,e[10]=(1-(f+m))*g,e[11]=0,e[12]=r[0]+L-(e[0]*L+e[4]*U+e[8]*w),e[13]=r[1]+U-(e[1]*L+e[5]*U+e[9]*w),e[14]=r[2]+w-(e[2]*L+e[6]*U+e[10]*w),e[15]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,c=i+i,u=r*o,d=n*o,h=n*s,f=i*o,l=i*s,R=i*c,m=a*o,M=a*s,v=a*c;return e[0]=1-h-R,e[1]=d+v,e[2]=f-M,e[3]=0,e[4]=d-v,e[5]=1-u-R,e[6]=l+m,e[7]=0,e[8]=f+M,e[9]=l-m,e[10]=1-u-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,r,n,i,a,o){var s=1/(r-t),c=1/(i-n),u=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*c,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*c,e[10]=(o+a)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*u,e[15]=0,e},t.perspective=function(e,t,r,n,i){var a=1/Math.tan(t/2),o=1/(n-i);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*o,e[15]=0,e},t.perspectiveFromFieldOfView=function(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),c=2/(o+s),u=2/(i+a);return e[0]=c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(o-s)*c*.5,e[9]=(i-a)*u*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},t.ortho=function(e,t,r,n,i,a,o){var s=1/(t-r),c=1/(n-i),u=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*c,e[14]=(o+a)*u,e[15]=1,e},t.lookAt=function(e,t,r,n){var i=void 0,o=void 0,s=void 0,c=void 0,u=void 0,d=void 0,h=void 0,f=void 0,l=void 0,R=void 0,m=t[0],M=t[1],v=t[2],p=n[0],E=n[1],b=n[2],y=r[0],A=r[1],g=r[2];return Math.abs(m-y)<a.EPSILON&&Math.abs(M-A)<a.EPSILON&&Math.abs(v-g)<a.EPSILON?mat4.identity(e):(h=m-y,f=M-A,l=v-g,i=E*(l*=R=1/Math.sqrt(h*h+f*f+l*l))-b*(f*=R),o=b*(h*=R)-p*l,s=p*f-E*h,(R=Math.sqrt(i*i+o*o+s*s))?(i*=R=1/R,o*=R,s*=R):(i=0,o=0,s=0),c=f*s-l*o,u=l*i-h*s,d=h*o-f*i,(R=Math.sqrt(c*c+u*u+d*d))?(c*=R=1/R,u*=R,d*=R):(c=0,u=0,d=0),e[0]=i,e[1]=c,e[2]=h,e[3]=0,e[4]=o,e[5]=u,e[6]=f,e[7]=0,e[8]=s,e[9]=d,e[10]=l,e[11]=0,e[12]=-(i*m+o*M+s*v),e[13]=-(c*m+u*M+d*v),e[14]=-(h*m+f*M+l*v),e[15]=1,e)},t.targetTo=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=n[0],c=n[1],u=n[2],d=i-r[0],h=a-r[1],f=o-r[2],l=d*d+h*h+f*f;l>0&&(d*=l=1/Math.sqrt(l),h*=l,f*=l);var R=c*f-u*h,m=u*d-s*f,M=s*h-c*d;return e[0]=R,e[1]=m,e[2]=M,e[3]=0,e[4]=h*M-f*m,e[5]=f*R-d*M,e[6]=d*m-h*R,e[7]=0,e[8]=d,e[9]=h,e[10]=f,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},t.subtract=i,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],c=e[5],u=e[6],d=e[7],h=e[8],f=e[9],l=e[10],R=e[11],m=e[12],M=e[13],v=e[14],p=e[15],E=t[0],b=t[1],y=t[2],A=t[3],g=t[4],L=t[5],U=t[6],w=t[7],I=t[8],_=t[9],T=t[10],x=t[11],S=t[12],P=t[13],B=t[14],G=t[15];return Math.abs(r-E)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(E))&&Math.abs(n-b)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(i-y)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(o-A)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(s-g)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-L)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(L))&&Math.abs(u-U)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(U))&&Math.abs(d-w)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(w))&&Math.abs(h-I)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(f-_)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(_))&&Math.abs(l-T)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(R-x)<=a.EPSILON*Math.max(1,Math.abs(R),Math.abs(x))&&Math.abs(m-S)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(S))&&Math.abs(M-P)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(v-B)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs(B))&&Math.abs(p-G)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(G))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=n,t.sub=i},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(){var e=new u.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function a(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function o(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],c=r[1],u=r[2],d=r[3];return e[0]=n*d+o*s+i*u-a*c,e[1]=i*d+o*c+a*s-n*u,e[2]=a*d+o*u+n*c-i*s,e[3]=o*d-n*s-i*c-a*u,e}function s(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],c=r[0],u=r[1],d=r[2],h=r[3],f=void 0,l=void 0,R=void 0,m=void 0,M=void 0;return(l=i*c+a*u+o*d+s*h)<0&&(l=-l,c=-c,u=-u,d=-d,h=-h),1-l>1e-6?(f=Math.acos(l),R=Math.sin(f),m=Math.sin((1-n)*f)/R,M=Math.sin(n*f)/R):(m=1-n,M=n),e[0]=m*i+M*c,e[1]=m*a+M*u,e[2]=m*o+M*d,e[3]=m*s+M*h,e}function c(e,t){var r=t[0]+t[4]+t[8],n=void 0;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=i,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},t.setAxisAngle=a,t.getAxisAngle=function(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return 0!=n?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r},t.multiply=o,t.rotateX=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),c=Math.cos(r);return e[0]=n*c+o*s,e[1]=i*c+a*s,e[2]=a*c-i*s,e[3]=o*c-n*s,e},t.rotateY=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),c=Math.cos(r);return e[0]=n*c-a*s,e[1]=i*c+o*s,e[2]=a*c+n*s,e[3]=o*c-i*s,e},t.rotateZ=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),c=Math.cos(r);return e[0]=n*c+i*s,e[1]=i*c-n*s,e[2]=a*c+o*s,e[3]=o*c-a*s,e},t.calculateW=function(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e},t.slerp=s,t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=a*s,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},t.fromMat3=c,t.fromEuler=function(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(r),c=Math.cos(r),u=Math.sin(n),d=Math.cos(n);return e[0]=a*c*d-o*s*u,e[1]=o*s*d+a*c*u,e[2]=o*c*u-a*s*d,e[3]=o*c*d+a*s*u,e},t.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"};var u=n(r(0)),d=n(r(1)),h=n(r(2)),f=n(r(3)),l=(t.clone=f.clone,t.fromValues=f.fromValues,t.copy=f.copy,t.set=f.set,t.add=f.add,t.mul=o,t.scale=f.scale,t.dot=f.dot,t.lerp=f.lerp,t.length=f.length),R=(t.len=l,t.squaredLength=f.squaredLength),m=(t.sqrLen=R,t.normalize=f.normalize);t.exactEquals=f.exactEquals,t.equals=f.equals,t.rotationTo=function(){var e=h.create(),t=h.fromValues(1,0,0),r=h.fromValues(0,1,0);return function(n,i,o){var s=h.dot(i,o);return s<-.999999?(h.cross(e,t,i),h.len(e)<1e-6&&h.cross(e,r,i),h.normalize(e,e),a(n,e,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(h.cross(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+s,m(n,n))}}(),t.sqlerp=function(){var e=i(),t=i();return function(r,n,i,a,o,c){return s(e,n,o,c),s(t,i,a,c),s(r,e,t,2*c*(1-c)),r}}(),t.setAxes=function(){var e=d.create();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],m(t,c(t,e))}}()},function(e,t,r){"use strict";function n(){var e=new h.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e}function i(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function s(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function c(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function u(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function d(e){var t=e[0],r=e[1];return t*t+r*r}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.sqrDist=t.dist=t.div=t.mul=t.sub=t.len=void 0,t.create=n,t.clone=function(e){var t=new h.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},t.fromValues=function(e,t){var r=new h.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},t.set=function(e,t,r){return e[0]=t,e[1]=r,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},t.subtract=i,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e},t.distance=s,t.squaredDistance=c,t.length=u,t.squaredLength=d,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},t.normalize=function(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},t.cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e},t.lerp=function(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e},t.random=function(e,t){t=t||1;var r=2*h.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},t.transformMat2=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e},t.transformMat2d=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e},t.transformMat3=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},t.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},t.equals=function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return Math.abs(r-i)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))};var h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.len=u,t.sub=i,t.mul=a,t.div=o,t.dist=s,t.sqrDist=c,t.sqrLen=d,t.forEach=function(){var e=n();return function(t,r,n,i,a,o){var s,c=void 0;for(r||(r=2),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,c=n;c<s;c+=r)e[0]=t[c],e[1]=t[c+1],a(e,e,o),t[c]=e[0],t[c+1]=e[1];return t}}()}])}),function(){var e;RedGLUtil={throwFunc:function(){throw Array.prototype.slice.call(arguments).join(" ")},copyProto:function(e,t){for(var r in t.prototype)e.prototype[r]=t.prototype[r]},hexToRGB:function(e){var t,r;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return r=[],3==(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),t="0x"+t.join(""),r[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,r;RedGLUtil.throwFunc("RedGLUtil.hexToRGB : 잘못된 hex값입니다.",e)},rgb2hex:(e,t,r)=>"#"+(16777216+(r|t<<8|e<<16)).toString(16).slice(1),getStrFromComment:function(t){if("string"!=typeof t&&RedGLUtil.throwFunc("getStrFromComment : 해석할 값은 문자열만 가능",t),e=t.toString().trim().match(/(\/\*)[\s\S]+(\*\/)/g))return e[0].replace(/\/\*|\*\//g,"").trim();RedGLUtil.throwFunc("getStrFromComment : 해석할 불가능한 값",t)}},Object.freeze(RedGLUtil)}(),function(){var e,t,r,n,i,a,o,s,c,u,d,h;t=function(e){if(!(this instanceof t))return new t(e);for(r="VENDOR,VERSION,SHADING_LANGUAGE_VERSION,RENDERER,MAX_VERTEX_ATTRIBS,MAX_VARYING_VECTORS,MAX_VERTEX_UNIFORM_VECTORS,MAX_VERTEX_TEXTURE_IMAGE_UNITS,MAX_FRAGMENT_UNIFORM_VECTORS,MAX_TEXTURE_SIZE,MAX_CUBE_MAP_TEXTURE_SIZE,MAX_COMBINED_TEXTURE_IMAGE_UNITS,MAX_TEXTURE_IMAGE_UNITS,MAX_RENDERBUFFER_SIZE,MAX_VIEWPORT_DIMS,RED_BITS,GREEN_BITS,BLUE_BITS,ALPHA_BITS,DEPTH_BITS,STENCIL_BITS".split(","),n=r.length;n--;)this[i=r[n]]=e.getParameter(e[i])},e=function(){var e,t,r,n,i,a;return t={alpha:!1,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!1,powerPreference:"default",failIfMajorPerformanceCaveat:!1},e="webkit-3d,moz-webgl,3d,experimental-webgl,webgl".split(","),function(o,s){if(a=JSON.parse(JSON.stringify(t)),i=e.length,s)for(i in s)a[i]=s[i];for(;i--;)if(r=o.getContext(n=e[i],a)){return r.OES_element_index_uint=r.getExtension("OES_element_index_uint"),r.EXT_texture_filter_anisotropic=r.getExtension("EXT_texture_filter_anisotropic"),r.version=n,r}return null}}(),(RedGL=function(r,n,i){var a,o,s,c;if(!(this instanceof RedGL))return new RedGL(r,n);r instanceof Element&&"CANVAS"==r.tagName||RedGLUtil.throwFunc("RedGL : Canvas Element만 허용"),o=this,s=!0,c=1,Object.defineProperty(this,"renderScale",{get:function(){return c},set:function(e){c=e,this.setSize(this._width,this._height,!0)}}),Object.defineProperty(this,"fullMode",{get:function(){return s},set:function(e){"boolean"!=typeof e&&RedGLUtil.throwFunc("RedGL : Boolean만 가능."),s=e,this.setSize(this._width,this._height)}}),this._canvas=r,this._width=500,this._height=500,this.gl=a=e(r),a&&(this._detect=t(a,i)),this._datas={},this._UUID=RedGL.makeUUID(),requestAnimationFrame(function(e){var t,r;window.addEventListener("resize",function(){o.setSize(o._width,o._height)}),o.setSize(o._width,o._height),n&&n.call(o,!!a);var i=o._detect.MAX_COMBINED_TEXTURE_IMAGE_UNITS,s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC";for(t=RedBitmapTexture(o,s),r=RedBitmapCubeTexture(o,[s,s,s,s,s,s]),o._datas.emptyTexture={"2d":t,"3d":r};i--;)1!=i?(a.activeTexture(a.TEXTURE0+i),a.bindTexture(a.TEXTURE_2D,t.webglTexture)):(a.activeTexture(a.TEXTURE0+1),a.bindTexture(a.TEXTURE_CUBE_MAP,r.webglTexture))})}).makeUUID=(a=0,function(){return a++}),RedGL.prototype={setSize:(c=0,u=0,function(e,t,r){this.fullMode?(o=document.documentElement?document.documentElement.clientWidth:document.body.clientWidth,s=window.innerHeight):(void 0==e&&RedGLUtil.throwFunc("RedGL setSize : width가 입력되지 않았습니다."),void 0==t&&RedGLUtil.throwFunc("RedGL setSize : height가 입력되지 않았습니다."),"string"==typeof e&&-1!=e.indexOf("%")&&RedGLUtil.throwFunc("RedGL setSize : width는 %로 입력할수 없음."),"string"==typeof t&&-1!=t.indexOf("%")&&RedGLUtil.throwFunc("RedGL setSize: height는 %로 입력할수 없음."),this._width=o=e,this._height=s=t),d=window.devicePixelRatio||1,h=this._canvas,(c!=o||u!=s||r)&&(h.width=o*d*this.renderScale,h.height=s*d*this.renderScale,h.style.width=o,h.style.height=s,c=o,u=s)})},Object.freeze(RedGL)}(),function(){var e;(RedBaseContainer=function(){RedGLUtil.throwFunc("RedBaseContainer : 생성자/직접실행으로 사용 할 수 없습니다.")}).prototype={addChild:function(t){t instanceof RedMesh||t instanceof RedSprite3D||t instanceof RedLine||t instanceof RedPointUnit||RedGLUtil.throwFunc("addChild","RedMesh,RedSprite3D,RedLine,RedPointUnit Instance만 가능"),-1!=(e=this.children.indexOf(t))&&(t=this.children.splice(e,1)),this.children.push(t)},addChildAt:function(){var e;return function(t,r){t instanceof RedMesh||t instanceof RedSprite3D||t instanceof RedLine||t instanceof RedPointUnit||RedGLUtil.throwFunc("addChildAt","RedMesh,RedSprite3D,RedLine,RedPointUnit Instance만 가능"),e=this.children.indexOf(t),this.children.splice(e,0,t)}}(),removeChild:function(){var e;return function(t){-1==(e=this.children.indexOf(t))?RedGLUtil.throwFunc("removeChild","존재하지 않는 RedMesh를 삭제하려고 함"):this.children.splice(e,1)}}(),removeChildAt:function(){return function(e){"number"!=typeof e&&RedGLUtil.throwFunc("removeChildAt","index가 Number형이 아님 "),this.children[e]&&this.children.splice(void 0,1)}},removeChildAll:function(){this.children.length=0},getChildAt:function(e){return"number"!=typeof e&&RedGLUtil.throwFunc("getChildAt","index가 Number형이 아님 "),this.children[e]},getChildIndex:function(e){return this.children.indexOf(e)},numChildren:function(e){return this.children.length}},Object.freeze(RedBaseContainer)}(),function(){var e;(RedBaseLight=function(){RedGLUtil.throwFunc("RedBaseLight : 생성자/직접실행으로 사용 할 수 없습니다.")}).prototype={setColor:function(t,r){t=t||"#fff",void 0==r&&(r=this.alpha),r>1&&(r=1),this.alpha=r,e=RedGLUtil.hexToRGB.call(this,t),this.color[0]=e[0],this.color[1]=e[1],this.color[2]=e[2],this.color[3]=this.alpha}},Object.freeze(RedBaseLight)}(),(RedBaseMaterial=function(){RedGLUtil.throwFunc("RedBaseMaterial : 생성자/직접실행으로 사용 할 수 없습니다.")}).prototype={checkProperty:function(){var e,t,r;for(e=(t=this.program.uniformLocation).length;e--;)(r=t[e]).location&&!this.hasOwnProperty(r.materialPropertyName)&&RedGLUtil.throwFunc("Material에 ",r.materialPropertyName,"이 정의 되지않았습니다.")},checkProgram:function(e,t,r,n){return RedProgram.hasKey(e,t)?RedProgram(e,t):RedProgram(e,t,RedShader(e,t+"_VS",RedShader.VERTEX,r),RedShader(e,t+"_FS",RedShader.FRAGMENT,n))}},Object.freeze(RedBaseMaterial),function(){var e;(RedBaseObject3D=function(){RedGLUtil.throwFunc("RedBaseObject3D : 생성자/직접실행으로 사용 할 수 없습니다.")}).build=function(e){this.useCullFace=!0,this.cullFace=e.BACK,this.useDepthTest=!0,this.depthTestFunc=e.LEQUAL,this.useBlendMode=!0,this.blendSrc=e.ONE,this.blendDst=e.ONE_MINUS_SRC_ALPHA,this.drawMode=e.TRIANGLES,this.pointSize=1,this.x=this.y=this.z=0,this.rotationX=this.rotationY=this.rotationZ=0,this.scaleX=this.scaleY=this.scaleZ=1,this.matrix=mat4.create(),this.normalMatrix=mat4.create(),this.children=[]},RedBaseObject3D.prototype={localToWorld:(e=mat4.create(),function(t,r,n){return t=t||0,r=r||0,n=n||0,mat4.identity(e),mat4.translate(e,e,[t,r,n]),mat4.multiply(e,this.matrix,e),[e[12],e[13],e[14]]}),worldToLocal:function(){var e,t;return e=mat4.create(),t=mat4.create(),function(r,n,i){return r=r||0,n=n||0,i=i||0,mat4.translate(e,e,[r,n,i]),mat4.multiply(t,e,this.matrix),[t[0]*r+t[1]*n+t[2]*i+t[3],t[4]*r+t[5]*n+t[6]*i+t[7],t[8]*r+t[9]*n+t[10]*i+t[11]]}}()},Object.freeze(RedBaseObject3D)}(),function(){var e,t,r,n,i;e=function(e,t,r){switch(t){case RedBuffer.ARRAY_BUFFER:if(r instanceof Float32Array||r instanceof Float64Array){if(r instanceof Float32Array)return e.FLOAT;if(r instanceof Float64Array)return e.FLOAT}else RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ARRAY_BUFFER)형식을 사용해야합니다.");break;case RedBuffer.ELEMENT_ARRAY_BUFFER:if(r instanceof Uint8Array||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array){if(r instanceof Int8Array)return e.BYTE;if(r instanceof Uint8Array)return e.UNSIGNED_BYTE;if(r instanceof Uint16Array)return e.UNSIGNED_SHORT;if(r instanceof Uint32Array)return e.UNSIGNED_INT;if(r instanceof Int16Array)return e.SHORT;if(r instanceof Int32Array)return e.INT}else RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ELEMENT_ARRAY_BUFFER)형식을 사용해야합니다.");break;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ")}},t=function(e,t){switch(t){case RedBuffer.ARRAY_BUFFER:return e.ARRAY_BUFFER;case RedBuffer.ELEMENT_ARRAY_BUFFER:return e.ELEMENT_ARRAY_BUFFER;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ")}},r=function(e,t,r,a){switch(n=0,t){case RedBuffer.ARRAY_BUFFER:if(e.interleaveDefineInfo=a,a){for(i in a)a[i]instanceof RedInterleaveInfo||RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfo의 정보는 RedInterleaveInfo Instance로만 구성되어야합니다.",a),a[i].offset=a.length<2?0:n,n+=a[i].size,a[i]._UUID=RedGL.makeUUID();a.forEach(function(e){a[e.attributeKey]=e}),a.length<2?(e.stride=0,e.pointNum=r.length/3):(e.stride=n,e.pointNum=r.length/n)}else RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfo는 반드시 정의 되어야합니다.");break;case RedBuffer.ELEMENT_ARRAY_BUFFER:e.pointNum=r.length}},(RedBuffer=function(n,i,a,o,s,c){if(!(this instanceof RedBuffer))return new RedBuffer(n,i,a,o,s,c);n instanceof RedGL||RedGLUtil.throwFunc("RedBuffer : RedGL Instance만 허용됩니다.",n),"string"!=typeof o&&RedGLUtil.throwFunc("RedBuffer : bufferType - 문자열만 허용됩니다."),"string"!=typeof i&&RedGLUtil.throwFunc("RedBuffer : key - 문자열만 허용됩니다."),o!=RedBuffer.ARRAY_BUFFER||s||RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfo를 반드시 정의해야합니다.");var u=n.gl;if(n._datas[o]||(n._datas[o]={}),n._datas[o][i])return n._datas[o][i];n._datas[o][i]=this,this.key=i,this.data=a,this.bufferType=o,this.glArrayType=e(u,this.bufferType,this.data),this.glBufferType=t(u,this.bufferType),this.drawMode=c||u.STATIC_DRAW,r(this,this.bufferType,this.data,s),this.webglBuffer=u.createBuffer(),this._UUID=RedGL.makeUUID(),this.upload=function(t){this.glArrayType==e(u,o,t)?(this.data=t,u.bindBuffer(this.glBufferType,this.webglBuffer),u.bufferData(this.glBufferType,this.data,this.drawMode)):RedGLUtil.throwFunc("RedBuffer : upload - data형식이 기존 형식과 다름",t)},this.parseInterleaveDefineInfo=function(){r(this,this.bufferType,this.data,this.interleaveDefineInfo)},this.upload(this.data)}).ARRAY_BUFFER="arrayBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER="elementArrayBuffer",Object.freeze(RedBuffer)}(),RedGeometry=function(e,t){if(!(this instanceof RedGeometry))return new RedGeometry(e,t);e instanceof RedBuffer?e.bufferType!=RedBuffer.ARRAY_BUFFER&&RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer.ARRAY_BUFFER 타입만.",e):RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer Instance만 허용.",e),t&&(t instanceof RedBuffer?t.bufferType!=RedBuffer.ELEMENT_ARRAY_BUFFER&&RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer.ELEMENT_ARRAY_BUFFER 타입만.",t):RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer Instance만 허용.",t)),this.interleaveBuffer=e,this.indexBuffer=t,this._UUID=RedGL.makeUUID()},Object.freeze(RedGeometry),RedInterleaveInfo=function(e,t,r){if(!(this instanceof RedInterleaveInfo))return new RedInterleaveInfo(e,t,r);"string"!=typeof e&&RedGLUtil.throwFunc("RedInterleaveInfo : attributeKey - 문자열만 허용",e),"number"!=typeof t&&RedGLUtil.throwFunc("RedInterleaveInfo : size - 숫자만 허용",t),this.attributeKey=e,this.size=t,this.normalize=void 0!=r,this.offset=null},Object.freeze(RedInterleaveInfo),(RedAmbientLight=function(e,t,r){if(!(this instanceof RedAmbientLight))return new RedAmbientLight(e,t,r);this.color=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?.1:r,this.setColor(t||"#fff",this.alpha),this._UUID=RedGL.makeUUID(),Object.defineProperty(this,"type",{configurable:!1,writable:!1,value:RedAmbientLight.type})}).type="RedAmbientLight",RedGLUtil.copyProto(RedAmbientLight,RedBaseLight),Object.defineProperty(RedAmbientLight.prototype,"alpha",{get:function(){return this.color[3]},set:function(e){this.color[3]=e}}),Object.freeze(RedAmbientLight),(RedDirectionalLight=function(e,t,r){if(!(this instanceof RedDirectionalLight))return new RedDirectionalLight(e,t,r);this.color=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?1:r,this.setColor(t||"#fff",this.alpha),this.x=0,this.y=-1,this.z=0,this._UUID=RedGL.makeUUID(),Object.defineProperty(this,"type",{configurable:!1,writable:!1,value:RedDirectionalLight.type}),this.debug=!1,this.debugObject=RedSprite3D(e,RedBitmapMaterial(e,RedBitmapTexture(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEY3MkNCREQzRUMwMTFFODkxOUZBQUY2QzI1MUMxRkYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEY3MkNCREUzRUMwMTFFODkxOUZBQUY2QzI1MUMxRkYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4RjcyQ0JEQjNFQzAxMUU4OTE5RkFBRjZDMjUxQzFGRiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4RjcyQ0JEQzNFQzAxMUU4OTE5RkFBRjZDMjUxQzFGRiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnFzHU0AABcbSURBVHja5Ft7lCRV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")))}).type="RedDirectionalLight",RedGLUtil.copyProto(RedDirectionalLight,RedBaseLight),Object.defineProperty(RedDirectionalLight.prototype,"alpha",{get:function(){return this.color[3]},set:function(e){this.color[3]=e}}),Object.freeze(RedDirectionalLight),(RedPointLight=function(e,t,r){if(!(this instanceof RedPointLight))return new RedPointLight(e,t,r);this.color=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?1:r,this.setColor(t||"#fff",this.alpha),this.x=0,this.y=0,this.z=0,this.radius=1,this._UUID=RedGL.makeUUID(),Object.defineProperty(this,"type",{configurable:!1,writable:!1,value:RedPointLight.type}),this.debug=!1,this.debugObject=RedMesh(e,RedSphere(e,1,16,16,16),RedColorMaterial(e)),this.debugObject.drawMode=e.gl.LINE_STRIP}).type="RedPointLight",RedGLUtil.copyProto(RedPointLight,RedBaseLight),Object.defineProperty(RedPointLight.prototype,"alpha",{get:function(){return this.color[3]},set:function(e){this.color[3]=e}}),Object.freeze(RedPointLight),JsonModelLoader=function(e,t,r,n){if(!(this instanceof JsonModelLoader))return new JsonModelLoader(e,t,r,n);var i=new XMLHttpRequest;i.open("GET",r,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.onreadystatechange=function(){if(4==i.readyState){var r,a,o,s;for(a=[],o=0,s=(r=JSON.parse(i.responseText)).position.length/3;o<s;o++)a.push(r.position[3*o],r.position[3*o+1],r.position[3*o+2]),a.push(r.normal[3*o],r.normal[3*o+1],r.normal[3*o+2]),r.uvs?a.push(r.uvs[2*o],r.uvs[2*o+1]):a.push(0,0);n&&n(RedBuffer(e,t,new Float32Array(a),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),RedBuffer(e,t,new Uint16Array(r.index),RedBuffer.ELEMENT_ARRAY_BUFFER))}},i.send()},Object.freeze(JsonModelLoader),RedAxis=function(e){if(!(this instanceof RedAxis))return new RedAxis(e);var t,r,n,i;e instanceof RedGL||RedGLUtil.throwFunc("RedAxis : RedGL Instance만 허용됩니다.",e),RedBaseObject3D.build.call(this,e.gl),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#ff0000")),(r=RedMesh(e,RedBox(e),RedColorMaterial(e,"#ff0000"))).scaleX=r.scaleY=r.scaleZ=.5,r.scaleX=10,t.x=5,r.x=-5,t.children.push(r),this.children.push(t),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#00ff00")),(n=RedMesh(e,RedBox(e),RedColorMaterial(e,"#00ff00"))).scaleX=n.scaleY=n.scaleZ=.5,n.scaleY=10,t.y=5,n.y=-5,t.children.push(n),this.children.push(t),t=RedMesh(e,RedBox(e),RedColorMaterial(e,"#0000ff")),(i=RedMesh(e,RedBox(e),RedColorMaterial(e,"#0000ff"))).scaleX=i.scaleY=i.scaleZ=.5,i.scaleZ=10,t.z=5,i.z=-5,t.children.push(i),this.children.push(t),this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedAxis,RedBaseContainer),RedGLUtil.copyProto(RedAxis,RedBaseObject3D),Object.freeze(RedAxis),RedGrid=function(e,t,r,n,i){if(!(this instanceof RedGrid))return new RedGrid(e,t,r,n,i);var a;e instanceof RedGL||RedGLUtil.throwFunc("RedGrid : RedGL Instance만 허용됩니다.",e),a=e.gl,RedBaseObject3D.build.call(this,a);var o=[];t=t||100,n=[1,1,1,.7],i=[1,1,1,.5];for(var s,c=(r=r||100)/2,u=t/r,d=t/2,h=0,f=-d;h<=r;h++,f+=u){var l=h===c?n:i;o.push(-d,0,f),o.push(l[0],l[1],l[2],l[3]),o.push(d,0,f),o.push(l[0],l[1],l[2],l[3]),o.push(f,0,-d),o.push(l[0],l[1],l[2],l[3]),o.push(f,0,d),o.push(l[0],l[1],l[2],l[3])}s=RedBuffer(e,"gridInterleaveBuffer_"+r,new Float32Array(o),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexColor",4)]),this.geometry=RedGeometry(s),this.material=RedGridMaterial(e),this.drawMode=a.LINES,this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedGrid,RedBaseContainer),RedGLUtil.copyProto(RedGrid,RedBaseObject3D),Object.freeze(RedGrid),RedMesh=function(e,t,r){if(!(this instanceof RedMesh))return new RedMesh(e,t,r);var n;e instanceof RedGL||RedGLUtil.throwFunc("RedMesh : RedGL Instance만 허용됩니다.",e),!t||t instanceof RedGeometry||RedGLUtil.throwFunc("RedMesh : RedGeometry Instance만 허용됩니다."),!r||r instanceof RedBaseMaterial||RedGLUtil.throwFunc("RedMesh : RedBaseMaterial 확장 Instance만 허용됩니다."),n=e.gl,RedBaseObject3D.build.call(this,n),this.geometry=t,this.material=r,this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedMesh,RedBaseContainer),RedGLUtil.copyProto(RedMesh,RedBaseObject3D),Object.freeze(RedMesh),RedLine=function(e,t){if(!(this instanceof RedLine))return new RedLine(e,t);var r,n,i,a,o;e instanceof RedGL||RedGLUtil.throwFunc("RedLine : RedGL Instance만 허용됩니다.",e),t instanceof RedColorMaterial||RedGLUtil.throwFunc("RedLine : RedColorMaterial Instance만 허용됩니다."),n=[],i=[],this._UUID=RedGL.makeUUID(),a=RedBuffer(e,"RedLine_InterleaveBuffer_"+this._UUID,new Float32Array(n),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3)]),o=RedBuffer(e,"RedLine_indexBuffer_"+this._UUID,new Uint16Array(i),RedBuffer.ELEMENT_ARRAY_BUFFER),this.addPoint=function(e,t,r){var a=n.length/3;n.push(e,t,r),i.push(a)},this.upload=function(){a.upload(new Float32Array(n)),o.upload(new Uint16Array(i)),a.parseInterleaveDefineInfo(),o.parseInterleaveDefineInfo()},r=e.gl,RedBaseObject3D.build.call(this,r),this.geometry=RedGeometry(a,o),this.material=t,this.drawMode=r.LINE_STRIP},RedGLUtil.copyProto(RedLine,RedBaseContainer),RedGLUtil.copyProto(RedLine,RedBaseObject3D),Object.freeze(RedLine),RedSkyBox=function(e,t){if(!(this instanceof RedSkyBox))return new RedSkyBox(e,t);var r;e instanceof RedGL||RedGLUtil.throwFunc("RedSkyBox : RedGL Instance만 허용됩니다.",e),r=e.gl,RedBaseObject3D.build.call(this,r),this.geometry=RedBox(e),this.material=RedSkyBoxMaterial(e,RedBitmapCubeTexture(e,t)),this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedSkyBox,RedBaseObject3D),Object.freeze(RedSkyBox),RedSprite3D=function(e,t){if(!(this instanceof RedSprite3D))return new RedSprite3D(e,t);var r;e instanceof RedGL||RedGLUtil.throwFunc("RedSprite3D : RedGL Instance만 허용됩니다.",e),t instanceof RedBaseMaterial||RedGLUtil.throwFunc("RedSprite3D : RedBaseMaterial 확장 Instance만 허용됩니다."),r=e.gl,RedBaseObject3D.build.call(this,r),this.geometry=RedBox(e,1,1,0),this.material=t,this._UUID=RedGL.makeUUID()},RedGLUtil.copyProto(RedSprite3D,RedBaseContainer),RedGLUtil.copyProto(RedSprite3D,RedBaseObject3D),Object.freeze(RedSprite3D),RedPointUnit=function(e,t,r,n){if(!(this instanceof RedPointUnit))return new RedPointUnit(e,t,r,n);var i,a;n instanceof RedPointColorMaterial||n instanceof RedPointBitmapMaterial||RedGLUtil.throwFunc("RedPointUnit : material - RedPointColorMaterial Instance or RedPointBitmapMaterial Instance만 허용됩니다."),i=e.gl,RedBaseObject3D.build.call(this,i),this._UUID=RedGL.makeUUID(),a=RedBuffer(e,"RedPointUnit_"+this._UUID,t,RedBuffer.ARRAY_BUFFER,r),this.geometry=RedGeometry(a),this.material=n,this.drawMode=i.POINTS},RedGLUtil.copyProto(RedPointUnit,RedBaseContainer),RedGLUtil.copyProto(RedPointUnit,RedBaseObject3D),RedPointUnit.prototype.update=function(){},Object.freeze(RedPointUnit),function(){var e,t,r,n;r=function(e,r,n,i,a,o,s,c,u,d,h,f){var l,R,m=c/h,M=u/f,v=c/2,p=u/2,E=d/2,b=h+1,y=f+1,A=0,g=[];for(R=0;R<y;R++){var L=R*M-p;for(l=0;l<b;l++){var U=l*m-v;g[n]=U*o,g[i]=L*s,g[a]=E,e.push(g.x,g.y,g.z),g[n]=0,g[i]=0,g[a]=d>0?1:-1,e.push(g.x,g.y,g.z),e.push(l/h,1-R/f),A+=1}}for(R=0;R<f;R++)for(l=0;l<h;l++){var w=t+l+b*R,I=t+l+b*(R+1),_=t+(l+1)+b*(R+1),T=t+(l+1)+b*R;r.push(w,I,T,I,_,T),6}t+=A},e=function(e,i,a,o,s,c,u){n="RedBox_"+(i=i||1)+"_"+(a=a||1)+"_"+(o=o||1)+"_"+(s=s||1)+"_"+(c=c||1)+"_"+(u=u||1);var d=[],h=[];return t=0,r(d,h,"z","y","x",-1,-1,o,a,i,u,c),r(d,h,"z","y","x",1,-1,o,a,-i,u,c),r(d,h,"x","z","y",1,1,i,o,a,s,u),r(d,h,"x","z","y",1,-1,i,o,-a,s,u),r(d,h,"x","y","z",1,-1,i,a,o,s,c),r(d,h,"x","y","z",-1,-1,i,a,-o,s,c),{interleaveData:d,indexData:h,type:n,interleaveBuffer:RedBuffer(e,n+"_interleaveBuffer",new Float32Array(d),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,n+"_indexBuffer",new Uint16Array(h),RedBuffer.ELEMENT_ARRAY_BUFFER)}},(RedBox=function(t,r,n,i,a,o,s){if(!(this instanceof RedBox))return new RedBox(t,r,n,i,a,o,s);if(!(t instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";var c;if(c=e(t,r,n,i,a,o,s),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[c.type])return t._datas.Primitives[c.type];t._datas.Primitives[c.type]=this,this.interleaveBuffer=c.interleaveBuffer,this.indexBuffer=c.indexBuffer,this._UUID=RedGL.makeUUID()}).prototype=RedGeometry.prototype,Object.freeze(RedBox)}(),function(){var e,t,r,n,i,a,o,s,c,u,d,h,f,l,R,m,M,v;e=function(e,p,E,b,y){p=p||1,E=E||1,b=b||1,y=y||1,t=p/2,r=E/2,n=Math.floor(b)||1,i=Math.floor(y)||1,a=n+1,o=i+1,s=p/n,c=E/i,v="RedPlane_"+p+"_"+E+"_"+b+"_"+y;var A=[],g=[];for(d=0;d<o;d++)for(f=d*c-r,u=0;u<a;u++)h=u*s-t,A.push(h,-f,0),A.push(0,0,1),A.push(u/n,1-d/i);for(d=0;d<i;d++)for(u=0;u<n;u++)l=u+a*d,R=u+a*(d+1),m=u+1+a*(d+1),M=u+1+a*d,g.push(l,R,M,R,m,M);return{interleaveData:A,indexData:g,type:v,interleaveBuffer:RedBuffer(e,v+"_interleaveBuffer",new Float32Array(A),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,v+"_indexBuffer",new Uint16Array(g),RedBuffer.ELEMENT_ARRAY_BUFFER)}},(RedPlane=function(t,r,n,i,a){if(!(this instanceof RedPlane))return new RedPlane(t,r,n,i,a);if(!(t instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";var o;if(o=e(t,r,n,i,a),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[o.type])return t._datas.Primitives[o.type];t._datas.Primitives[o.type]=this,this.interleaveBuffer=o.interleaveBuffer,this.indexBuffer=o.indexBuffer,this._UUID=RedGL.makeUUID()}).prototype=RedGeometry.prototype,Object.freeze(RedPlane)}(),function(){var e,t,r,n,i,a,o,s,c,u,d,h,f;d=[],h=new Float32Array([0,0,0]),f=new Float32Array([0,0,0]),e=function(e,l,R,m,M,v,p,E){l=l||1,R=Math.max(3,Math.floor(R)||8),m=Math.max(2,Math.floor(m)||6),M=void 0!==M?M:0,v=void 0!==v?v:2*Math.PI,p=void 0!==p?p:0,E=void 0!==E?E:Math.PI,t=p+E,i=0,d.length=0,h[0]=0,h[1]=0,h[2]=0,f[0]=0,f[1]=0,f[2]=0,u="RedSphere_"+l+"_"+R+"_"+m+"_"+M+"_"+v+"_"+p+"_"+E;var b=[],y=[];for(n=0;n<=m;n++){var A=[],g=n/m;for(r=0;r<=R;r++){var L=r/R;h.x=-l*Math.cos(M+L*v)*Math.sin(p+g*E),h.y=l*Math.cos(p+g*E),h.z=l*Math.sin(M+L*v)*Math.sin(p+g*E),b.push(h.x,h.y,h.z),f[0]=h.x,f[1]=h.y,f[2]=h.z,vec3.normalize(f,f),b.push(f[0],f[1],f[2]),b.push(L,1-g),A.push(i++)}d.push(A)}for(n=0;n<m;n++)for(r=0;r<R;r++)a=d[n][r+1],o=d[n][r],s=d[n+1][r],c=d[n+1][r+1],(0!==n||p>0)&&y.push(a,o,c),(n!==m-1||t<Math.PI)&&y.push(o,s,c);return{interleaveData:b,indexData:y,type:u,interleaveBuffer:RedBuffer(e,u+"_interleaveBuffer",new Float32Array(b),RedBuffer.ARRAY_BUFFER,[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,u+"_indexBuffer",new Uint16Array(y),RedBuffer.ELEMENT_ARRAY_BUFFER)}},(RedSphere=function(t,r,n,i,a,o,s,c){if(!(this instanceof RedSphere))return new RedSphere(t,r,n,i,a,o,s,c);if(!(t instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";var u;if(u=e(t,r,n,i,a,o,s,c),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[u.type])return t._datas.Primitives[u.type];t._datas.Primitives[u.type]=this,this.interleaveBuffer=u.interleaveBuffer,this.indexBuffer=u.indexBuffer,this._UUID=RedGL.makeUUID()}).prototype=RedGeometry.prototype,Object.freeze(RedSphere)}(),function(){var e,t,r,n,i,a;e=function(e,t,r,i){return n=e.createProgram(),e.attachShader(n,r.webglShader),e.attachShader(n,i.webglShader),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||RedGLUtil.throwFunc("프로그램을 초기화 할 수 없습니다."),n.key=t,n.vShaderKey=r.key,n.fShaderKey=r.key,e.useProgram(n),n},i=function(){},a=function(){},t=function(e,t,n){n.parseData.attribute&&n.parseData.attribute.list.forEach(function(r){var n=new i;n._UUID=RedGL.makeUUID(),n.location=t.getAttribLocation(e.webglProgram,r.name),-1==n.location?n.msg="쉐이더 main 함수에서 사용되고 있지 않음":(n.attributeType=r.attributeType,n.name=r.name,n.enabled=!1,e.attributeLocation.push(n),e.attributeLocation[r.name]=n)}),n.parseData.uniform&&n.parseData.uniform.list.forEach(function(n){var i,o,s=new a;switch(s._UUID=RedGL.makeUUID(),s.location=t.getUniformLocation(e.webglProgram,n.name),s.location||(s.msg="쉐이더 main 함수에서 사용되고 있지 않음"),s.uniformType=n.uniformType,n.arrayNum,n.uniformType){case"sampler2D":i="sampler2D",o="uniform1f",s.samplerIndex=r,8==++r&&(r=2);break;case"samplerCube":i="samplerCube",o="uniform1f",s.samplerIndex=r,8==++r&&(r=2);break;case"float":i="float",o="uniform1f";break;case"int":i="int",o="uniform1i";break;case"mat4":i="mat",o="uniformMatrix4fv";break;case"mat3":i="mat",o="uniformMatrix3fv";break;case"mat2":i="mat",o="uniformMatrix2fv";break;case"vec4":i="vec",o="uniform4fv";break;case"vec3":i="vec",o="uniform3fv";break;case"vec2":i="vec",o="uniform2fv"}s.renderType=i,s.renderMethod=o,s.name=n.name,s.materialPropertyName=n.name.charAt(1).toLowerCase()+n.name.substr(2),s.arrayNum=n.arrayNum,n.systemUniformYn?(e.systemUniformLocation.push(s),e.systemUniformLocation[n.name]=s):(e.uniformLocation.push(s),e.uniformLocation[n.name]=s)})},(RedProgram=function(n,i,a,o){var s;if(!(this instanceof RedProgram))return new RedProgram(n,i,a,o);if(n instanceof RedGL||RedGLUtil.throwFunc("RedProgram : RedGL Instance만 허용됩니다.",n),"string"!=typeof i&&RedGLUtil.throwFunc("RedProgram : key - 문자열만 허용됩니다."),!a instanceof RedShader&&RedGLUtil.throwFunc("RedProgram : vShaderInfo - RedShader만 허용됩니다."),!o instanceof RedShader&&RedGLUtil.throwFunc("RedProgram : fShaderInfo - RedShader만 허용됩니다."),a&&a.type!=RedShader.VERTEX&&RedGLUtil.throwFunc("RedProgram : vShaderInfo - VERTEX 타입만 허용됩니다."),o&&o.type!=RedShader.FRAGMENT&&RedGLUtil.throwFunc("RedProgram : fShaderInfo - FRAGMENT 타입만 허용됩니다."),s=n.gl,n._datas.RedProgram||(n._datas.RedProgram={}),a||o)a&&o||RedGLUtil.throwFunc("RedProgram : 신규 생성시 vertexShader, fragmentShader 모두 입력해야함."),RedProgram.hasKey(n,i)?RedGLUtil.throwFunc("RedProgram : key - 이미 정의된 키로 생성을 시도.","\n키 :",i):n._datas.RedProgram[i]=this;else{if(n._datas.RedProgram[i])return n._datas.RedProgram[i];RedGLUtil.throwFunc("RedShader : 존재하지않는 key를 검색하려고합니다.",i)}this.key=i,this.webglProgram=e(s,i,a,o),this.attributeLocation=[],this.uniformLocation=[],this.systemUniformLocation=[],s.useProgram(this.webglProgram),r=2,t(this,s,a),t(this,s,o),this._UUID=RedGL.makeUUID()}).prototype={},RedProgram.hasKey=function(e,t){return e._datas.RedProgram||(e._datas.RedProgram={}),!!e._datas.RedProgram[t]},Object.freeze(RedProgram)}(),[(RedSystemShaderCode={vShareSource:["attribute vec3 aVertexPosition","attribute vec3 aVertexNormal","attribute vec4 aVertexColor","varying vec3 vVertexNormal","attribute float aPointSize","uniform float uPointSize","attribute vec2 aTexcoord","varying vec2 vTexcoord","uniform vec4 uAtlascoord","uniform float uTime","varying float vTime","uniform vec2 uResolution","varying vec2 vResolution","uniform mat4 uMVMatrix","uniform mat4 uNMatrix","uniform mat4 uPMatrix","uniform mat4 uCameraMatrix"],fShareSource:["varying vec3 vVertexNormal","varying vec2 vTexcoord","varying float vTime","varying vec2 vResolution","const int DIRETIONAL_MAX = 3","uniform vec3 uDirectionalLightPosition[3]","uniform vec4 uDirectionalLightColor[3]","uniform float uDirectionalLightIntensity[3]","uniform int uDirectionalLightNum","const int POINT_MAX = 5","uniform vec3 uPointLightPosition[5]","uniform vec4 uPointLightColor[5]","uniform float uPointLightRadius[5]","uniform float uPointLightIntensity[5]","uniform int uPointLightNum","uniform vec4 uAmbientLightColor","uniform float uAmbientIntensity"],systemUniform:{}}).vShareSource,RedSystemShaderCode.fShareSource].forEach(function(e){e.forEach(function(e){"uniform"==(e=e.split(" "))[0]&&(RedSystemShaderCode.systemUniform[e[2]]=1)})}),Object.freeze(RedSystemShaderCode),function(){var e,t,r,n,i,a,o,s;e=function(e,t,r){switch(r){case RedShader.VERTEX:return(i=e.createShader(e.VERTEX_SHADER)).key=t,i.type=r,i;case RedShader.FRAGMENT:return(i=e.createShader(e.FRAGMENT_SHADER)).key=t,i.type=r,i;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요!")}},t=function(e,t,r,n){e.shaderSource(r,n.lastSource),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)||RedGLUtil.throwFunc(e.getShaderInfoLog(r),"쉐이더 컴파일에 실패하였습니다.")},n=function(){var e;return function(t,r){switch(t){case RedShader.VERTEX:e=RedSystemShaderCode.vShareSource.concat();break;case RedShader.FRAGMENT:e=RedSystemShaderCode.fShareSource.concat();break;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요!")}return r.forEach(function(t){t=t.replace(";",""),-1==e.indexOf(t)?e.push(t):RedGLUtil.throwFunc("RedShader : ","\n1. 중복된 소스이거나","\n2. RedSystemShaderCode에 정의된 소스\n",t)}),e}}(),r=function(e,t){return t=(t=t.replace(/\s+$/,"")).replace(/  /g,"").trim(),a={etc:{list:[],map:{},source:""}},o=t.match(/attribute[\s\S]+?\;|uniform[\s\S]+?\;|varying[\s\S]+?\;|precision[\s\S]+?\;/g),(o=n(e,o=o||[])).sort(),o.forEach(function(e){var r,n,i,o,s,c,u;if(e=e.trim(),t=t.replace(e+";",""),(r=e.split(" "))[2])switch(n=r[0],o=r[1],i=r[2].replace(";","").split("["),c=(c=e.split("="))[1]?c[1].trim().replace(";",""):null,s=i.length>1?+i[1].split("]")[0]:0,i=i[0],n){case"attribute":"a"!=i.charAt(0)&&RedGLUtil.throwFunc("attribute의 첫글자는 a로 시작해야합니다.",i);break;case"uniform":"u"!=i.charAt(0)&&RedGLUtil.throwFunc("uniform의 첫글자는 u로 시작해야합니다.",i);break;case"varying":"v"!=i.charAt(0)&&RedGLUtil.throwFunc("varying의 첫글자는 v로 시작해야합니다.",i)}else n="var",o=r[0],s=(i=r[1].replace(";","").split("[")).length>1?+i[1].split("]")[0]:0,i=i[0];a[n]||(a[n]={},a[n].list=[],a[n].map={},a[n].source=""),u={name:i,arrayNum:s,value:c,systemUniformYn:!!RedSystemShaderCode.systemUniform[s?i+"["+s+"]":i]},"uniform"==n&&(u.uniformType=o),"attribute"==n&&(u.attributeType=o),a[n].list.push(u),a[n].map[i]=e,a[n].source+=e+";\n"}),[t+="\n"].forEach(function(e){var t=e.split(" "),r=t[1].replace(/\([\s\S]+/g,"").trim();a.etc.list.push({uniformType:t[0],name:r}),a.etc.map[r]=e,a.etc.source+=e+"\n"}),s="",a.precision&&(s+=a.precision.source+"\n//attribute\n"),a.const&&(s+=a.const.source+"\n//const\n"),a.attribute&&(s+=a.attribute.source+"\n//uniform\n"),a.uniform&&(s+=a.uniform.source+"\n//varying\n"),a.varying&&(s+=a.varying.source+"\n//var\n"),a.var&&(s+=a.var.source+"\n//etc\n"),a.etc&&(s+=a.etc.source),a.lastSource=s,a},(RedShader=function(n,i,a,o){var s;if(!(this instanceof RedShader))return new RedShader(n,i,a,o);if(n instanceof RedGL||RedGLUtil.throwFunc("RedShader : RedGL Instance만 허용됩니다.",n),"string"!=typeof i&&RedGLUtil.throwFunc("RedShader : key - 문자열만 허용됩니다.",i),a!=RedShader.VERTEX&&a!=RedShader.FRAGMENT&&RedGLUtil.throwFunc("RedShader : type - RedShader.VERTEX or RedShader.FRAGMENT 만 허용됩니다.",a),n._datas.RedShader||(n._datas.RedShader={},n._datas.RedShader[RedShader.VERTEX]={},n._datas.RedShader[RedShader.FRAGMENT]={}),o)"string"!=typeof o&&RedGLUtil.throwFunc("RedShader : source - 문자열만 허용됩니다."),RedShader.hasKey(n,i,a)?RedGLUtil.throwFunc("RedShader : key - 이미 정의된 키로 생성을 시도.","\n키 :",i,"\n타입 :",a):n._datas.RedShader[a][i]=this;else{if(RedShader.hasKey(n,i,a))return n._datas.RedShader[a][i];RedGLUtil.throwFunc("RedShader : 존재하지않는 key를 검색하려고합니다.",i)}s=n.gl,this.webglShader=e(s,i,a),this.parseData=r(a,o),t(s,0,this.webglShader,this.parseData),this.key=i,this.type=a,this._UUID=RedGL.makeUUID(),Object.freeze(this)}).hasKey=function(e,t,r){return e._datas.RedShader||(e._datas.RedShader={},e._datas.RedShader[RedShader.VERTEX]={},e._datas.RedShader[RedShader.FRAGMENT]={}),!!e._datas.RedShader[r][t]},RedShader.FRAGMENT="fragmentShader",RedShader.VERTEX="vertexShader",Object.freeze(RedShader)}(),function(){var e,t,r,n,i,a,o,s,c,u;(RedRenderer=function(){if(!(this instanceof RedRenderer))return new RedRenderer;this.world=null,this._tickKey=null,this._callback=null,this._UUID=RedGL.makeUUID(),this.renderInfo={},this.cacheUniformInfo=[],this.cacheAttrInfo=[],this.cacheBySamplerIndex=[],this.cacheState=[],this.renderDebuger=RedRenderDebuger()}).prototype={start:(e=function(n){t.worldRender(r,n),t._callback&&t._callback(n),t._tickKey=requestAnimationFrame(e)},function(n,i){n instanceof RedGL||RedGLUtil.throwFunc("RedGL Instance만 허용"),n.world instanceof RedWorld||RedGLUtil.throwFunc("RedWorld Instance만 허용"),(t=this).world=n.world,r=n,t._tickKey=requestAnimationFrame(e),t._callback=i}),stop:function(){cancelAnimationFrame(this._tickKey)}},RedRenderer.prototype.worldRender=function(){var e,t,r,o,s,c,u,d,h,f,l,R,m,M,v;return u=[],o=function(t){return t.forEach(function(r,n){"number"==typeof t[n]?t[n]=r:t[n]=n<2?e[n+2]*parseFloat(t[n])/100:e[n]*parseFloat(t[n])/100}),t},v=[],s=function(e,t,r,i,a,o){for(var s in f=e.gl,u.length=0,e._datas.RedProgram){var c,p,E,b,y,A,g,L,U,w,I;for(d=e._datas.RedProgram[s],n!=d._UUID&&f.useProgram(d.webglProgram),n=d._UUID,h=d.systemUniformLocation,l=h.uTime,R=l.location,m=l._UUID,R&&v[m]!=t&&(f.uniform1f(R,t),v[m]=t),l=h.uResolution,R=l.location,m=l._UUID,M=[o[2],o[3]],R&&v[m]!=M.toString()&&(f.uniform2fv(R,M),v[m]=M.toString()),l=h.uCameraMatrix,R=l.location,m=l._UUID,R&&v[m]!=a.toString()&&(f.uniformMatrix4fv(R,!1,a),v[m]=a.toString()),l=h.uPMatrix,R=l.location,m=l._UUID,R&&v[m]!=i.toString()&&(f.uniformMatrix4fv(R,!1,i),v[m]=i.toString()),(E=r._lightInfo[RedAmbientLight.type])&&(l=h.uAmbientLightColor,R=l.location,m=l._UUID,y=E.color,R&&v[m]!=y.toString()&&(f.uniform4fv(R,y),v[m]=y.toString()),l=h.uAmbientIntensity,R=l.location,m=l._UUID,y=E.intensity,R&&v[m]!=y&&(f.uniform1f(R,y),v[m]=y)),I=vec3.create(),A=new Float32Array(9),L=new Float32Array(12),U=new Float32Array(3),c=(p=r._lightInfo[RedDirectionalLight.type]).length;c--;)E=p[c],vec3.set(I,E.x,E.y,E.z),E.debug&&((b=E.debugObject).x=I[0],b.y=I[1],b.z=I[2],b.material.color=E.color,u.push(b)),l=h.uDirectionalLightPosition,(R=l.location)&&(vec3.normalize(I,I),A[0+3*c]=I[0],A[1+3*c]=I[1],A[2+3*c]=I[2]),l=h.uDirectionalLightColor,(R=l.location)&&(L[0+4*c]=E.color[0],L[1+4*c]=E.color[1],L[2+4*c]=E.color[2],L[3+4*c]=E.color[3]),l=h.uDirectionalLightIntensity,(R=l.location)&&(U[c]=E.intensity);for(l=h.uDirectionalLightPosition,R=l.location,m=l._UUID,y=A,R&&v[m]!=y.toString()&&(f.uniform3fv(R,y),v[m]=y.toString()),l=h.uDirectionalLightColor,R=l.location,m=l._UUID,y=L,R&&v[m]!=y.toString()&&(f.uniform4fv(R,y),v[m]=y.toString()),l=h.uDirectionalLightIntensity,R=l.location,m=l._UUID,y=U,R&&v[m]!=y.toString()&&(f.uniform1fv(R,y),v[m]=y.toString()),l=h.uDirectionalLightNum,R=l.location,m=l._UUID,y=p.length,R&&v[m]!=y&&(f.uniform1i(R,y),v[m]=y),I=vec3.create(),g=new Float32Array(15),L=new Float32Array(20),U=new Float32Array(5),w=new Float32Array(5),c=(p=r._lightInfo[RedPointLight.type]).length;c--;)E=p[c],vec3.set(I,E.x,E.y,E.z),E.debug&&((b=E.debugObject).x=I[0],b.y=I[1],b.z=I[2],b.scaleX=b.scaleY=b.scaleZ=E.radius,b.material.color=E.color,u.push(b)),l=h.uPointLightPosition,(R=l.location)&&(g[0+3*c]=I[0],g[1+3*c]=I[1],g[2+3*c]=I[2]),l=h.uPointLightColor,(R=l.location)&&(L[0+4*c]=E.color[0],L[1+4*c]=E.color[1],L[2+4*c]=E.color[2],L[3+4*c]=E.color[3]),l=h.uPointLightIntensity,(R=l.location)&&(U[c]=E.intensity),l=h.uPointLightRadius,(R=l.location)&&(w[c]=E.radius);l=h.uPointLightPosition,R=l.location,m=l._UUID,y=g,R&&v[m]!=y.toString()&&(f.uniform3fv(R,y),v[m]=y.toString()),l=h.uPointLightColor,R=l.location,m=l._UUID,y=L,R&&v[m]!=y.toString()&&(f.uniform4fv(R,y),v[m]=y.toString()),l=h.uPointLightIntensity,R=l.location,m=l._UUID,y=U,R&&v[m]!=y.toString()&&(f.uniform1fv(R,y),v[m]=y.toString()),l=h.uPointLightRadius,R=l.location,m=l._UUID,y=w,R&&v[m]!=y.toString()&&(f.uniform1fv(R,y),v[m]=y.toString()),l=h.uPointLightNum,R=l.location,m=l._UUID,y=p.length,R&&v[m]!=y&&(f.uniform1i(R,y),v[m]=y)}return u},c=function(e){e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.frontFace(e.CCW),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.enable(e.SCISSOR_TEST),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0)},function(n,d){var h,f;h=n.gl,r=this,e=[0,0,h.drawingBufferWidth,h.drawingBufferHeight],h.viewport(0,0,h.drawingBufferWidth,h.drawingBufferHeight),h.scissor(0,0,h.drawingBufferWidth,h.drawingBufferHeight),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),c(h),r.renderInfo={},this.cacheAttrInfo.length=0,r.world._viewList.forEach(function(c){(f=c._viewRect)[0]=c._x,f[1]=c._y,f[2]=c._width,f[3]=c._height,i=c.camera,a=c.scene,o(f),r.renderInfo[c.key]={orthographic:i.orthographic,x:c._x,y:c._y,width:c._width,height:c._height,viewRectX:f[0],viewRectY:f[1],viewRectWidth:f[2],viewRectHeight:f[3],key:c.key,call:0},h.viewport(f[0],e[3]-f[3]-f[1],f[2],f[3]),h.scissor(f[0],e[3]-f[3]-f[1],f[2],f[3]),a.useBackgroundColor?(h.clearColor(a.r,a.g,a.b,1),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT)):(h.clearColor(0,0,0,0),h.clear(h.DEPTH_BUFFER_BIT)),i instanceof RedCamera||(i.update(),i=i.camera),i.update(),t=i.perspectiveMTX,mat4.identity(t),i.orthographic?(mat4.ortho(t,-.5,.5,-.5,.5,-i.farClipping,i.farClipping),mat4.translate(t,t,[-.5,.5,0]),mat4.scale(t,t,[1/f[2],-1/f[3],1]),mat4.identity(i.matrix),h.disable(h.CULL_FACE)):(mat4.perspective(t,i.fov*Math.PI/180,f[2]/f[3],i.nearClipping,i.farClipping),h.enable(h.CULL_FACE)),s(n,d,a,t,i.matrix,f),a.skyBox&&(h.cullFace(h.FRONT),a.skyBox.scaleX=a.skyBox.scaleY=a.skyBox.scaleZ=i.farClipping,r.sceneRender(n,h,i.orthographic,[a.skyBox],d,r.renderInfo[c.key]),h.cullFace(h.BACK),h.clear(h.DEPTH_BUFFER_BIT)),r.sceneRender(n,h,i.orthographic,a.children,d,r.renderInfo[c.key]),a.grid&&r.sceneRender(n,h,i.orthographic,[a.grid],d,r.renderInfo[c.key]),a.axis&&r.sceneRender(n,h,i.orthographic,a.axis.children,d,r.renderInfo[c.key]),u.length&&r.sceneRender(n,h,i.orthographic,u,d,r.renderInfo[c.key])}),this.renderDebuger.visible&&this.renderDebuger.update(n,r.renderInfo)}}(),RedRenderer.prototype.sceneRender=(o=function(e,t,r,a,d,h,f,l,R,m,M){var v,p,E,b,y,A,g,L,U,w,I,_,T,x,S,P,B,G,D,F,O,C,N,j,Y,k,z,X,Z,V,W,H,Q,q,J,K,$,ee,te,re,ne,ie,ae,oe,se,ce,ue,de,he,fe,le,Re,me,Me,ve,pe,Ee,be,ye,Ae,ge,Le,Ue,we,Ie,_e,Te,xe,Se,Pe,Be,Ge,De,Fe,Oe,Ce,Ne,je,Ye,ke,ze,Xe,Ze,Ve,We,He,Qe,qe,Je,Ke,$e,et,tt,rt,nt,it,at,ot,st,ct,ut,dt,ht,ft,lt,Rt,mt,Mt,vt,pt,Et,bt,yt,At,gt,Lt=a?-1:1;for(E=Float32Array.BYTES_PER_ELEMENT,b=Math.PI/180,Et=3.141592653589793,bt=6.283185307179586,yt=1.27323954,At=.405284735,gt=1.5707963267948966,u=null,v=r.length;v--;){if(h.call++,O=(y=r[v]).matrix,C=y.normalMatrix,A=y.geometry){for(g=y.material,n!=g.program._UUID&&t.useProgram(g.program.webglProgram),n=g.program._UUID,U=g.program.attributeLocation,w=g.program.uniformLocation,I=g.program.systemUniformLocation,B=A.interleaveBuffer,G=A.indexBuffer,L=B.interleaveDefineInfo,N=B._UUID,p=U.length;p--;)_=L[(x=U[p]).name],c!=N&&t.bindBuffer(t.ARRAY_BUFFER,B.webglBuffer),c=N,x&&_&&f[P=x.location]!=_._UUID&&(!x.enabled&&(t.enableVertexAttribArray(P),x.enabled=!0),t.vertexAttribPointer(P,_.size,B.glArrayType,_.normalize,B.stride*E,_.offset*E),f[P]=_._UUID);for(p=w.length;p--;)S=(T=w[p]).location,N=T._UUID,S&&(F=T.renderType,D=g[T.materialPropertyName],j=l[N]==D,"sampler2D"==F||"samplerCube"==F?(Y=T.samplerIndex,D?(R[Y]==D._UUID||(u!=Y&&t.activeTexture(t.TEXTURE0+(u=Y)),t.bindTexture("sampler2D"==F?t.TEXTURE_2D:t.TEXTURE_CUBE_MAP,D.webglTexture),R[N]!=Y&&t.uniform1i(S,R[N]=Y),R[Y]=D._UUID),I.uAtlascoord.location&&l[N=I.uAtlascoord._UUID]!=D.atlascoord.data._UUID&&(t.uniform4fv(I.uAtlascoord.location,D.atlascoord.data),l[N]=D.atlascoord.data._UUID)):"sampler2D"==F?0==R[Y]||(0!=u&&t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e._datas.emptyTexture["2d"].webglTexture),0!=R[N]&&t.uniform1i(S,R[N]=0),R[Y]=0,u=0):1==R[Y]||(1!=u&&t.activeTexture(t.TEXTURE0+1),t.bindTexture(t.TEXTURE_CUBE_MAP,e._datas.emptyTexture["3d"].webglTexture),1!=R[N]&&t.uniform1i(S,R[N]=1),R[Y]=1,u=1)):(void 0==D&&RedGLUtil.throwFunc("RedRenderer : Material에 ",T.materialPropertyName,"이 정의 되지않았습니다."),"float"==F?!j&&t[T.renderMethod](S,l[N]=D):"int"==F?!j&&t[T.renderMethod](S,l[N]=D):"vec"==F?t[T.renderMethod](S,l[N]=D):"mat"==F?t[T.renderMethod](S,!1,D):RedGLUtil.throwFunc("RedRenderer : 처리할수없는 타입입니다.","tRenderType -",F)))}O[0]=1,O[1]=0,O[2]=0,O[3]=0,O[4]=0,O[5]=1,O[6]=0,O[7]=0,O[8]=0,O[9]=0,O[10]=1,O[11]=0,O[12]=0,O[13]=0,O[14]=0,O[15]=1,k=O,Ie=y.x,_e=y.y,Te=y.z,k[12]=k[0]*Ie+k[4]*_e+k[8]*Te+k[12],k[13]=k[1]*Ie+k[5]*_e+k[9]*Te+k[13],k[14]=k[2]*Ie+k[6]*_e+k[10]*Te+k[14],k[15]=k[3]*Ie+k[7]*_e+k[11]*Te+k[15],Q=y.rotationX*b,q=y.rotationY*b,J=y.rotationZ*b,(pt=Q%bt)<-Et?pt+=bt:pt>Et&&(pt-=bt),z=(pt=pt<0?yt*pt+At*pt*pt:yt*pt-At*pt*pt)<0?.225*(pt*-pt-pt)+pt:.225*(pt*pt-pt)+pt,(pt=(Q+gt)%bt)<-Et?pt+=bt:pt>Et&&(pt-=bt),V=(pt=pt<0?yt*pt+At*pt*pt:yt*pt-At*pt*pt)<0?.225*(pt*-pt-pt)+pt:.225*(pt*pt-pt)+pt,(pt=q%bt)<-Et?pt+=bt:pt>Et&&(pt-=bt),X=(pt=pt<0?yt*pt+At*pt*pt:yt*pt-At*pt*pt)<0?.225*(pt*-pt-pt)+pt:.225*(pt*pt-pt)+pt,(pt=(q+gt)%bt)<-Et?pt+=bt:pt>Et&&(pt-=bt),W=(pt=pt<0?yt*pt+At*pt*pt:yt*pt-At*pt*pt)<0?.225*(pt*-pt-pt)+pt:.225*(pt*pt-pt)+pt,(pt=J%bt)<-Et?pt+=bt:pt>Et&&(pt-=bt),Z=(pt=pt<0?yt*pt+At*pt*pt:yt*pt-At*pt*pt)<0?.225*(pt*-pt-pt)+pt:.225*(pt*pt-pt)+pt,(pt=(J+gt)%bt)<-Et?pt+=bt:pt>Et&&(pt-=bt),H=(pt=pt<0?yt*pt+At*pt*pt:yt*pt-At*pt*pt)<0?.225*(pt*-pt-pt)+pt:.225*(pt*pt-pt)+pt,K=k[0],$=k[1],ee=k[2],re=k[4],ne=k[5],ie=k[6],oe=k[8],se=k[9],ce=k[10],pe=W*H,Ee=z*X*H-V*Z,be=V*X*H+z*Z,ye=W*Z,Ae=z*X*Z+V*H,ge=V*X*Z-z*H,Le=-X,Ue=z*W,we=V*W,k[0]=K*pe+re*Ee+oe*be,k[1]=$*pe+ne*Ee+se*be,k[2]=ee*pe+ie*Ee+ce*be,k[4]=K*ye+re*Ae+oe*ge,k[5]=$*ye+ne*Ae+se*ge,k[6]=ee*ye+ie*Ae+ce*ge,k[8]=K*Le+re*Ue+oe*we,k[9]=$*Le+ne*Ue+se*we,k[10]=ee*Le+ie*Ue+ce*we,Ie=y.scaleX,_e=y.scaleY*Lt,Te=y.scaleZ,k[0]=k[0]*Ie,k[1]=k[1]*Ie,k[2]=k[2]*Ie,k[3]=k[3]*Ie,k[4]=k[4]*_e,k[5]=k[5]*_e,k[6]=k[6]*_e,k[7]=k[7]*_e,k[8]=k[8]*Te,k[9]=k[9]*Te,k[10]=k[10]*Te,k[11]=k[11]*Te,k[12]=k[12],k[13]=k[13],k[14]=k[14],k[15]=k[15],M&&(K=M[0],$=M[1],ee=M[2],te=M[3],re=M[4],ne=M[5],ie=M[6],ae=M[7],oe=M[8],se=M[9],ce=M[10],ue=M[11],de=M[12],he=M[13],fe=M[14],le=M[15],Re=O[0],me=O[1],Me=O[2],ve=O[3],O[0]=Re*K+me*re+Me*oe+ve*de,O[1]=Re*$+me*ne+Me*se+ve*he,O[2]=Re*ee+me*ie+Me*ce+ve*fe,O[3]=Re*te+me*ae+Me*ue+ve*le,Re=O[4],me=O[5],Me=O[6],ve=O[7],O[4]=Re*K+me*re+Me*oe+ve*de,O[5]=Re*$+me*ne+Me*se+ve*he,O[6]=Re*ee+me*ie+Me*ce+ve*fe,O[7]=Re*te+me*ae+Me*ue+ve*le,Re=O[8],me=O[9],Me=O[10],ve=O[11],O[8]=Re*K+me*re+Me*oe+ve*de,O[9]=Re*$+me*ne+Me*se+ve*he,O[10]=Re*ee+me*ie+Me*ce+ve*fe,O[11]=Re*te+me*ae+Me*ue+ve*le,Re=O[12],me=O[13],Me=O[14],ve=O[15],O[12]=Re*K+me*re+Me*oe+ve*de,O[13]=Re*$+me*ne+Me*se+ve*he,O[14]=Re*ee+me*ie+Me*ce+ve*fe,O[15]=Re*te+me*ae+Me*ue+ve*le),y instanceof RedSprite3D&&(at=O[12],ot=O[13],st=O[14],ct=0,ut=1,dt=0,(Rt=(ht=at-i.x)*ht+(ft=ot-i.y)*ft+(lt=st-i.z)*lt)>0&&(ht*=Rt=1/Math.sqrt(Rt),ft*=Rt,lt*=Rt),mt=ut*lt-dt*ft,Mt=dt*ht-ct*lt,vt=ct*ft-ut*ht,Ie=Math.sqrt(k[0]*k[0]+k[1]*k[1]+k[2]*k[2]),_e=Math.sqrt(k[4]*k[4]+k[5]*k[5]+k[6]*k[6]),Te=Math.sqrt(k[8]*k[8]+k[9]*k[9]+k[10]*k[10]),O[0]=mt,O[1]=Mt,O[2]=vt,O[3]=0,O[4]=ft*vt-lt*Mt,O[5]=lt*mt-ht*vt,O[6]=ht*Mt-ft*mt,O[7]=0,O[8]=ht,O[9]=ft,O[10]=lt,O[11]=0,O[12]=at,O[13]=ot,O[14]=st,O[15]=1,k[0]=k[0]*Ie,k[1]=k[1]*Ie,k[2]=k[2]*Ie,k[3]=k[3]*Ie,k[4]=k[4]*_e,k[5]=k[5]*_e,k[6]=k[6]*_e,k[7]=k[7]*_e,k[8]=k[8]*Te,k[9]=k[9]*Te,k[10]=k[10]*Te,k[11]=k[11]*Te,k[12]=k[12],k[13]=k[13],k[14]=k[14],k[15]=k[15]),A&&t.uniformMatrix4fv(I.uMVMatrix.location,!1,O),A&&I.uNMatrix.location&&(xe=O[0],Se=O[1],Pe=O[2],Be=O[3],Ge=O[4],De=O[5],Fe=O[6],Oe=O[7],Ce=O[8],Ne=O[9],je=O[10],Ye=O[11],ze=O[12],Xe=O[13],Ze=O[14],it=1/(it=(ke=xe*De-Se*Ge)*(nt=je*(Ve=O[15])-Ye*Ze)-(We=xe*Fe-Pe*Ge)*(rt=Ne*Ve-Ye*Xe)+(He=xe*Oe-Be*Ge)*(tt=Ne*Ze-je*Xe)+(Qe=Se*Fe-Pe*De)*(et=Ce*Ve-Ye*ze)-(qe=Se*Oe-Be*De)*($e=Ce*Ze-je*ze)+(Je=Pe*Oe-Be*Fe)*(Ke=Ce*Xe-Ne*ze)),C[0]=(De*nt-Fe*rt+Oe*tt)*it,C[1]=(-Se*nt+Pe*rt-Be*tt)*it,C[2]=(Xe*Je-Ze*qe+Ve*Qe)*it,C[3]=(-Ne*Je+je*qe-Ye*Qe)*it,C[4]=(-Ge*nt+Fe*et-Oe*$e)*it,C[5]=(xe*nt-Pe*et+Be*$e)*it,C[6]=(-ze*Je+Ze*He-Ve*We)*it,C[7]=(Ce*Je-je*He+Ye*We)*it,C[8]=(Ge*rt-De*et+Oe*Ke)*it,C[9]=(-xe*rt+Se*et-Be*Ke)*it,C[10]=(ze*qe-Xe*He+Ve*ke)*it,C[11]=(-Ce*qe+Ne*He-Ye*ke)*it,C[12]=(-Ge*tt+De*$e-Fe*Ke)*it,C[13]=(xe*tt-Se*$e+Pe*Ke)*it,C[14]=(-ze*Qe+Xe*We-Ze*ke)*it,C[15]=(Ce*Qe-Ne*We+je*ke)*it,$=C[1],ee=C[2],te=C[3],ie=C[6],ae=C[7],ue=C[11],C[1]=C[4],C[2]=C[8],C[3]=C[12],C[4]=$,C[6]=C[9],C[7]=C[13],C[8]=ee,C[9]=ie,C[11]=C[14],C[12]=te,C[13]=ae,C[14]=ue,t.uniformMatrix4fv(I.uNMatrix.location,!1,C)),A&&(I.uPointSize.location&&m.pointSize!=y.pointSize&&t.uniform1f(I.uPointSize.location,m.pointSize=y.pointSize),m.useCullFace!=y.useCullFace&&((m.useCullFace=y.useCullFace)?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE)),m.cullFace!=y.cullFace&&t.cullFace(m.cullFace=y.cullFace),m.useDepthTest!=y.useDepthTest&&((m.useDepthTest=y.useDepthTest)?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)),m.depthTestFunc!=y.depthTestFunc&&t.depthFunc(y.depthTestFunc),m.useBlendMode!=y.useBlendMode&&((m.useBlendMode=y.useBlendMode)?t.enable(t.BLEND):t.disable(t.BLEND)),m.blendSrc==y.blendSrc&&m.blendDst==y.blendDst||(t.blendFunc(y.blendSrc,y.blendDst),m.blendSrc=y.blendSrc,m.blendDst=y.blendDst),G?(s!=G._UUID&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,G.webglBuffer),t.drawElements(y.drawMode,G.pointNum,G.glArrayType,0),s=G._UUID):t.drawArrays(y.drawMode,0,B.pointNum)),y.children.length&&o(e,t,y.children,a,d,h,f,l,R,m,O)}},function(e,t,r,n,i,a){void 0==this.cacheState.pointSize&&(this.cacheState.pointSize=1),this.cacheState.useCullFace||(this.cacheState.useCullFace=t.getParameter(t.CULL_FACE)),this.cacheState.cullFace||(this.cacheState.cullFace=t.getParameter(t.CULL_FACE_MODE)),this.cacheState.useDepthTest||(this.cacheState.useDepthTest=t.getParameter(t.DEPTH_TEST)),this.cacheState.depthTestFunc||(this.cacheState.depthTestFunc=t.getParameter(t.DEPTH_FUNC)),this.cacheState.useBlendMode||(this.cacheState.useBlendMode=t.getParameter(t.BLEND)),this.cacheState.blendSrc||(this.cacheState.blendSrc=t.getParameter(t.BLEND_SRC_RGB)),this.cacheState.blendDst||(this.cacheState.blendDst=t.getParameter(t.BLEND_DST_RGB)),this.cacheBySamplerIndex.length=0,o(e,t,n,r,i,a,this.cacheAttrInfo,this.cacheUniformInfo,this.cacheBySamplerIndex,this.cacheState)}),Object.freeze(RedRenderer)}(),(RedRenderDebuger=function(){if(!(this instanceof RedRenderDebuger))return new RedRenderDebuger;this.renderResult||(this.renderResult=document.createElement("div"),this._contentBox=document.createElement("div"),this._etcBox=document.createElement("div"),this.renderResult.appendChild(this._contentBox),this.renderResult.appendChild(this._etcBox),this.renderResult.style.cssText="position:absolute;bottom:0px;left:0px;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;background:rgba(0,0,0,0.6);padding:3px;width:300px",this._etcBox.style.cssText="position:relative;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;background:rgba(0,0,0,0.6);padding:3px",this._etcBox.innerHTML='<a href="https://redcamel.github.io/RedGL2/redDoc/index.html" stlye="color:#fff;text-decoration:none">API document</a>'),this._visible=!1}).prototype={update:function(e,t){for(var r in this._contentBox.innerHTML="",t)this._contentBox.innerHTML+='<div style="padding:3px"><div><b>RedView : key - '+t[r].key+"</b></div> orthographic - "+t[r].orthographic+" <br>call - "+t[r].call+" <br> width - "+t[r].width+" / height - "+t[r].height+" <br> viewRectWidth - "+t[r].viewRectWidth+" / viewRectHeight - "+t[r].viewRectHeight+" <br> x - "+t[r].x+" / y - "+t[r].y+"</div><br>";this._contentBox.innerHTML+='<div style="padding:3px;background:#000">renderScale : '+e.renderScale+"</div>"}},Object.defineProperty(RedRenderDebuger.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible=e,this._visible?document.body.appendChild(this.renderResult):this.renderResult.parentNode&&document.body.removeChild(this.renderResult)}}),Object.freeze(RedRenderDebuger),function(){var e,t;function r(e,t,r,n){this.x=e,this.y=t,this.w=r,this.h=n}(RedAtlas=function(r,n,i){if(!(this instanceof RedAtlas))return new RedAtlas(r,n,i);r instanceof RedGL||RedGLUtil.throwFunc("RedBitmapMaterial : RedGL Instance만 허용됩니다.",r),r._datas.RedAtlas||(r._datas.RedAtlas={atlasInfoList:[new e],atlasMap:{}}),(t=r._detect.MAX_TEXTURE_SIZE)>2048&&(t=2048),this.redGL=r,this.loadList(n,i)}).prototype={getAtlasMap:function(){return this.redGL._datas.RedAtlas.atlasMap},getAtlasInfoList:function(){return this.redGL._datas.RedAtlas.atlasInfoList},loadList:function(e,t){var r,n,i,a;for(a=0,i=this,r=0,n=e.length,r=0;r<n;r++){var o=new Image;o.id=o.src=e[r],o.onload=function(){(i.atlasPack(i.redGL,this),++a==e.length)&&(i.redGL._datas.RedAtlas.atlasInfoList.forEach(function(e){e.texture=RedBitmapTexture(i.redGL,e.canvas)}),t&&t.call(i,i.redGL._datas.RedAtlas))}}},atlasPack:function(t,r){var n,i;if(n=t._datas.RedAtlas.atlasInfoList,!(i=t._datas.RedAtlas.atlasMap)[r.id]){var a,o,s,c;if(!1===(c=(s=n[0]).pack(r))){for(a=0,o=n.length;a<o&&!(c=(s=n[a]).pack(r));a++);!1===c&&(n.push(s=new e),c=s.pack(r))}i[r.id]={atlas:s,rect:s.uv()[r.id]},s.texture||(s.texture=RedBitmapTexture(t,s.canvas))}}},r.prototype.fitsIn=function(e){return e.w>=this.w&&e.h>=this.h},r.prototype.sameSizeAs=function(e){return this.w===e.w&&this.h===e.h},(e=function(e,n,i,a){if(void 0==e){var o=document.createElement("canvas");document.body.appendChild(o),o.style.display="none",o.width=t,o.height=t,this.canvas=o,e=n=0,i=this.canvas.width,a=this.canvas.height}2===arguments.length&&(i=e,a=n,e=n=0),this._UUID=RedGL.makeUUID(),this.left=this.right=null,this.rect=new r(e,n,i,a),this.filled=!1,this.tilepad=!1,this._cache=[],this._uvcache=Object.create(null)}).prototype.pack=function(t){return this._cache=[],this._uvcache=Object.create(null),t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),null!==this.left?this._ontoCanvas(this.left.pack(t)||this.right.pack(t)):!(this.filled||!t.fitsIn(this.rect))&&(t.sameSizeAs(this.rect)?(this.filled=!0,this._ontoCanvas(this)):(this.rect.w-t.w>this.rect.h-t.h?(this.left=new e(this.rect.x,this.rect.y,t.w,this.rect.h),this.right=new e(this.rect.x+t.w,this.rect.y,this.rect.w-t.w,this.rect.h)):(this.left=new e(this.rect.x,this.rect.y,this.rect.w,t.h),this.right=new e(this.rect.x,this.rect.y+t.h,this.rect.w,this.rect.h-t.h)),this._ontoCanvas(this.left.pack(t))))},e.prototype.expand=function(t){var r,n=this;if(t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),this.rect.w<this.rect.h?((r=new e(0,0,this.rect.w+t.w,this.rect.h)).right=new e(this.rect.w,0,t.w,this.rect.h),r.left=this):((r=new e(0,0,this.rect.w,this.rect.h+t.h)).right=new e(0,this.rect.h,this.rect.w,t.h),r.left=this),["canvas","context","img"].forEach(function(e){n[e]&&(r[e]=n[e],n[e]=null)}),r.canvas){r.context||(r.context=r.canvas.getContext("2d"));var i=r.context.getImageData(0,0,r.canvas.width,r.canvas.height);r.canvas.width=r.rect.w,r.canvas.height=r.rect.h,r.context.putImageData(i,0,0)}return!1===r.pack(t)?r.expand(t):r},e.prototype.index=function(){var e=this;return e._cache.length>0?e._cache:(function t(r){null!==r.left?(t(r.left),t(r.right)):r.rect.name&&e._cache.push(r.rect)}(e),e._cache)},e.prototype.uv=function(e,t){var r=this;e=e||r.rect.w,t=t||r.rect.h;var n=this.tilepad;return function i(a){if(null!==a.left)i(a.left),i(a.right);else if(void 0!==a.rect.name){var o=n?a.rect.w/4:0;r._uvcache[a.rect.name]=[[a.rect.x+o,a.rect.y+o],[a.rect.x+o+(a.rect.w-2*o),a.rect.y+o],[a.rect.x+o+(a.rect.w-2*o),a.rect.y+o+(a.rect.h-2*o)],[a.rect.x+o,a.rect.y+o+(a.rect.h-2*o)]].map(function(r){return 0!==r[0]&&(r[0]=r[0]/e),0!==r[1]&&(r[1]=r[1]/t),r})}}(r),r._uvcache},e.prototype.json=function(t){return t?("string"==typeof t&&(t=JSON.parse(t)),function t(r){if(r&&r.rect){var n=new e(r.rect.x,r.rect.y,r.rect.w,r.rect.h);return r.left&&(n.left=t(r.left)),r.right&&(n.right=t(r.right)),n}}(t)):JSON.stringify(function e(t){var r={left:null,right:null,rect:t.rect,filled:t.filled};return null!==t.left&&(r.left=e(t.left),r.right=e(t.right)),r}(this),null,2)},e.prototype._tilepad=function(e){var t=this.img;if(!t)return e;var n=t.width/2,i=document.createElement("canvas");i.name=t.name||t.src,i.id=t.id||"",i.width=t.width+t.width,i.height=t.height+t.height;var a=i.getContext("2d"),o=a.createPattern(t,"repeat");return a.fillStyle=o,a.translate(n,n),a.fillRect(-n,-n,i.width+n,i.height+n),a.translate(-n,-n),this.img=i,new r(e.x,e.y,this.img.width,this.img.height)},e.prototype._ontoCanvas=function(e){return e&&this.img&&this.canvas&&(this.context||(this.context=this.canvas.getContext("2d")),this.context.clearRect(e.rect.x,e.rect.y,e.rect.w,e.rect.h),this.context.drawImage(this.img,e.rect.x,e.rect.y,e.rect.w,e.rect.h),e.rect.name=this.img.id||this.img.name||this.img.src||null),e},e.prototype._toRect=function(e){return!e.nodeName||"IMG"!==e.nodeName&&"CANVAS"!==e.nodeName||(this.img=e,e=new r(e.x,e.y,e.width,e.height)),e instanceof r||(e=new r(e.x||0,e.y||0,e.w||e.width,e.h||e.height)),e},e.prototype._debug=function(){if(this.canvas){var e=this.canvas.getContext("2d");this.index().forEach(function(t){e.lineWidth=1,e.strokeStyle="red",e.strokeRect(t.x,t.y,t.w,t.h)})}}}(),function(){var e,t,r=new Float32Array([0,0,1,1]),n={};r._UUID=RedGL.makeUUID(),(RedAtlasUV=function(i,a){if(!(this instanceof RedAtlasUV))return new RedAtlasUV(i,a);i instanceof RedGL||RedGLUtil.throwFunc("RedAtlasUV : RedGL Instance만 허용됩니다.",i),a?(t=[a[0][0],1-a[2][1],a[1][0]-a[0][0],a[2][1]-a[0][1]],e=t.toString(),n[e]?this.data=n[e]:(this.data=n[e]=t,this.data._UUID=RedGL.makeUUID())):this.data=r}).prototype={},Object.freeze(RedAtlasUV)}(),function(){var e,t,r;e=function(e,t){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,2,2,0,e.LUMINANCE,e.UNSIGNED_BYTE,new Uint8Array([128,64,0,192])),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.generateMipmap(e.TEXTURE_2D),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.bindTexture(e.TEXTURE_2D,null),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0)},r=function(e,t,r,n){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n.min?n.min:e.LINEAR_MIPMAP_NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n.max?n.max:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,n.wrap_s?n.wrap_s:e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,n.wrap_t?n.wrap_t:e.REPEAT),e.EXT_texture_filter_anisotropic&&n.anisotropic&&e.texParameterf(e.TEXTURE_2D,e.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.anisotropic);try{e.generateMipmap(e.TEXTURE_2D)}catch(e){}e.bindTexture(e.TEXTURE_2D,null)},t=function(t,n,i,a){var o,s,c,u;a||(a={}),c=function(e){e.removeEventListener("error",o),e.removeEventListener("load",s)},o=function(){var e="couldn't load image: "+i;RedGLUtil.throwFunc(e),c(this)},s=function(){c(this),r(t,n,this,a)},e(t,n),i instanceof HTMLCanvasElement?r(t,n,i,a):((u=new Image).crossOrigin="anonymous",u.src=i,u.addEventListener("error",o),u.addEventListener("load",s))},(RedBitmapTexture=function(e,r,n){var i;if(!(this instanceof RedBitmapTexture))return new RedBitmapTexture(e,r,n);e instanceof RedGL||RedGLUtil.throwFunc("RedBitmapTexture : RedGL Instance만 허용됩니다.",e),i=e.gl,this.webglTexture=i.createTexture(),this.atlascoord=RedAtlasUV(e),this._UUID=RedGL.makeUUID(),r&&t(i,this.webglTexture,r,n)}).prototype={},Object.freeze(RedBitmapTexture)}(),function(){var e;(RedAtlasTexture=function(t,r){if(!(this instanceof RedAtlasTexture))return new RedAtlasTexture(t,r);t instanceof RedGL||RedGLUtil.throwFunc("RedAtlasTexture : RedGL Instance만 허용됩니다.",t),e=t._datas.RedAtlas.atlasMap[r],this.webglTexture=e.atlas.texture.webglTexture,this.atlascoord=RedAtlasUV(t,e.rect),this._UUID=e.atlas._UUID}).prototype=RedBitmapTexture.prototype,Object.freeze(RedAtlasTexture)}(),function(){var e,t,r;(r=new Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC",e=function(e,t){e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,t),[r,r,r,r,r,r].forEach(function(t,n){e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},t=function(t,r,n,i){var a,o,s,c,u,d=[];for(i||(i={}),s=function(e){e.removeEventListener("error",a),e.removeEventListener("load",o)},a=function(){var e="couldn't load image: "+src;RedGLUtil.throwFunc(e),s(this)},o=function(){if(6==++u){s(this),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_CUBE_MAP,r);for(var e=d.length;e--;)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,d[e]);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,i.min?i.min:t.LINEAR_MIPMAP_NEAREST),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,i.max?i.max:t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,i.wrap_s?i.wrap_s:t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,i.wrap_t?i.wrap_t:t.CLAMP_TO_EDGE);try{t.generateMipmap(t.TEXTURE_CUBE_MAP)}catch(e){}t.bindTexture(t.TEXTURE_CUBE_MAP,null)}else s(this)},c=6,u=0;c--;){var h;e(t,r),(h=new Image).crossOrigin="anonymous",h.src=n[c],h.addEventListener("error",a),h.addEventListener("load",o),d[c]=h}},(RedBitmapCubeTexture=function(e,r,n){var i;if(!(this instanceof RedBitmapCubeTexture))return new RedBitmapCubeTexture(e,r,n);e instanceof RedGL||RedGLUtil.throwFunc("RedBitmapCubeTexture : RedGL Instance만 허용됩니다.",e),i=e.gl,this.webglTexture=i.createTexture(),this.atlascoord=RedAtlasUV(e),this._UUID=RedGL.makeUUID(),t(i,this.webglTexture,r,n)}).prototype={},Object.freeze(RedBitmapCubeTexture)}(),function(){var e;e={},(RedView=function(t,r,n){if(e[t]){if(!r&&!n)return e[t];RedGLUtil.throwFunc(t,"는 이미 생성된 RedView key입니다.")}if(!(this instanceof RedView))return new RedView(t,r,n);"string"!=typeof t&&RedGLUtil.throwFunc("RedView : key : 문자열만 허용"),r||n||RedGLUtil.throwFunc("RedView : 존재하지 않는 key입니다."),!r||r instanceof RedScene||RedGLUtil.throwFunc("RedView : RedScene Instance만 허용"),n&&(n instanceof RedCamera||n instanceof RedBasicController||n instanceof RedObitController)||RedGLUtil.throwFunc("RedView : RedCamera or XXController Instance만 허용"),this.key=t,this.scene=r,this.camera=n,this._width="100%",this._height="100%",this._x=0,this._y=0,this._viewRect=[0,0,0,0],e[t]=this,Object.seal(this)}).prototype={setSize:function(e,t){this._width=void 0!=e?e:"100%",this._height=void 0!=t?t:"100%"},setLocation:function(e,t){this._x=void 0!=e?e:0,this._y=void 0!=t?t:0}},Object.freeze(RedView)}(),(RedWorld=function(){if(!(this instanceof RedWorld))return new RedWorld;this._viewList=[],this._viewMap={},this._UUID=RedGL.makeUUID(),Object.seal(this)}).prototype={addView:function(e){e instanceof RedView||RedGLUtil.throwFunc("RedView Instance만 허용함."),this._viewMap[e.key]=e,this._viewList.push(e)},getView:function(e){return this._viewMap[e]},delView:function(e){var t,r;(t=this._viewMap[e])&&(r=this._viewList.indexOf(t),this._viewList.splice(r,1),delete this._viewMap[e])},hasView:function(e){return!!this._viewMap[e]},getViewList:function(){return this._viewList.concat()}},Object.freeze(RedWorld),function(){var e;(RedScene=function(e){if(!(this instanceof RedScene))return new RedScene(e);var t,r,n;this.r=0,this.g=0,this.b=0,this.setBackgroundColor(e||"#000"),this.useBackgroundColor=!0,this.children=[],Object.defineProperty(this,"skyBox",{get:function(){return t},set:function(e){return e instanceof RedSkyBox||!e||RedGLUtil.throwFunc("RedScene : RedSkyBox Instance만 허용됩니다."),t=e}}),Object.defineProperty(this,"grid",{get:function(){return r},set:function(e){return e instanceof RedGrid||!e||RedGLUtil.throwFunc("RedScene : RedGrid Instance만 허용됩니다."),r=e}}),Object.defineProperty(this,"axis",{get:function(){return n},set:function(e){return e instanceof RedAxis||!e||RedGLUtil.throwFunc("RedScene : RedAxis Instance만 허용됩니다."),n=e}}),this._lightInfo={RedAmbientLight:null,RedDirectionalLight:[],RedPointLight:[]},this._UUID=RedGL.makeUUID()}).prototype={addLight:function(e){switch(e.type){case RedAmbientLight.type:this._lightInfo[e.type]=e;break;case RedDirectionalLight.type:case RedPointLight.type:this._lightInfo[e.type].push(e);break;default:RedGLUtil.throwFunc("RedBaseLight 확장객체만 가능")}},removeLight:function(){}},RedScene.prototype.setBackgroundColor=function(t){t=t||"#000",e=RedGLUtil.hexToRGB.call(this,t),this.r=e[0],this.g=e[1],this.b=e[2]},RedGLUtil.copyProto(RedScene,RedBaseContainer),Object.freeze(RedScene)}(),function(){var e,t;(RedCamera=function(){if(!(this instanceof RedCamera))return new RedCamera;this.x=this.y=this.z=0,this.targetX=this.targetY=this.targetZ=0,this.fov=45,this.nearClipping=.01,this.farClipping=1e4,this.orthographic=!1,this.matrix=mat4.create(),this.perspectiveMTX=mat4.create(),this._UUID=RedGL.makeUUID()}).prototype.update=function(){new Float32Array([0,1,0]);return function(){this.lookAt(this.targetX,this.targetY,this.targetZ)}}(),RedCamera.prototype.lookAt=(e=new Float32Array([0,1,0]),t=[],function(r,n,i){t[0]=this.targetX=r,t[1]=this.targetY=n,t[2]=this.targetZ=i,mat4.identity(this.matrix),mat4.lookAt(this.matrix,[this.x,this.y,this.z],t,e)}),Object.freeze(RedCamera)}(),(RedBasicController=function(e){if(!(this instanceof RedBasicController))return new RedBasicController(e);this.keyBuffer={},this.speed=1,this.delay=.1,this.speedRotation=1,this.delayRotation=.1,this.maxAcceleration=3,Object.defineProperty(this,"x",{get:function(){return this._targetObject.x},set:function(e){this._targetObject.x=e,this._desirePosition[0]=e}}),Object.defineProperty(this,"y",{get:function(){return this._targetObject.y},set:function(e){this._targetObject.y=e,this._desirePosition[1]=e}}),Object.defineProperty(this,"z",{get:function(){return this._targetObject.z},set:function(e){this._targetObject.z=e,this._desirePosition[2]=e}}),Object.defineProperty(this,"tilt",{get:function(){return this._desireTilt},set:function(e){this._targetObject.rotationX=e,this._desireTilt=e}}),Object.defineProperty(this,"pan",{get:function(){return this._desirePan},set:function(e){this._targetObject.rotationY=e,this._desirePan=e}}),this.camera=RedCamera(),this.keyNameMapper={moveForward:"w",moveBack:"s",moveLeft:"a",moveRight:"d",moveUp:"t",moveDown:"g",turnLeft:"q",turnRight:"e",turnUp:"r",turnDown:"f"},this._desirePosition=[0,0,0],this._targetObject=RedMesh(e),this._desirePan=0,this._desireTilt=0,function(t){var r,n,i,a,o,s,c,u,d;s=0,c=0,u=0,d=0,r=function(e){t.keyBuffer[e.key]=1},n=function(e){t.keyBuffer[e.key]=0},i=function(t){s=t.x,c=t.y,e._canvas.addEventListener("mousemove",a),window.addEventListener("mouseup",o)},a=function(e){u=e.x-s,d=e.y-c,s=e.x,c=e.y,t._desirePan-=u*t.speedRotation*.1,t._desireTilt-=d*t.speedRotation*.1},o=function(){e._canvas.removeEventListener("mousemove",a),window.removeEventListener("mouseup",o)},window.addEventListener("keydown",r),window.addEventListener("keyup",n),e._canvas.addEventListener("mousedown",i)}(this)}).prototype.update=function(){var e,t,r,n,i,a,o,s,c,u,d,h,f,l,R,m,M,v;return new Float32Array([0,1,0]),h=mat4.create(),u=mat4.create(),d=mat4.create(),f=vec3.create(),R=0,function(p){e=0,t=0,n=!1,i=!1,a=this.speed,o=this.speedRotation,s=this.delay,c=this.delayRotation,l=this.camera,v=this._desirePosition,m=this.keyBuffer,M=this.keyNameMapper,f[0]=0,f[1]=0,f[2]=0,m[M.turnLeft]&&(i=!0,e=o),m[M.turnRight]&&(i=!0,e=-o),m[M.turnUp]&&(i=!0,t=o),m[M.turnDown]&&(i=!0,t=-o),m[M.moveForward]&&(n=!0,f[2]=-R*a),m[M.moveBack]&&(n=!0,f[2]=R*a),m[M.moveLeft]&&(n=!0,f[0]=-R*a),m[M.moveRight]&&(n=!0,f[0]=R*a),m[M.moveUp]&&(n=!0,f[1]=R*a),m[M.moveDown]&&(n=!0,f[1]=-R*a),i||n?(R+=.1)>this.maxAcceleration&&(R=this.maxAcceleration):(R+=-.1)<0&&(R=0),r=this._targetObject,i&&(this._desirePan+=e,this._desireTilt+=t),r.rotationY+=(this._desirePan-r.rotationY)*c,r.rotationX+=(this._desireTilt-r.rotationX)*c,(n||i)&&(u=r.matrix,mat4.identity(h),mat4.rotateY(h,h,r.rotationY*Math.PI/180),mat4.rotateX(h,h,r.rotationX*Math.PI/180),mat4.translate(h,h,f),mat4.identity(u),mat4.translate(u,u,[r.x,r.y,r.z]),mat4.multiply(u,u,h),v[0]=u[12],v[1]=u[13],v[2]=u[14]),r.x+=(v[0]-r.x)*s,r.y+=(v[1]-r.y)*s,r.z+=(v[2]-r.z)*s,r.rotationY+=(this._desirePan-r.rotationY)*c,r.rotationX+=(this._desireTilt-r.rotationX)*c,u=r.matrix,mat4.identity(u),mat4.translate(u,u,[r.x,r.y,r.z]),mat4.rotateY(u,u,r.rotationY*Math.PI/180),mat4.rotateX(u,u,r.rotationX*Math.PI/180),d=mat4.clone(u),mat4.translate(d,d,[0,0,.1]),l.x=d[12],l.y=d[13],l.z=d[14],l.lookAt(r.x,r.y,r.z)}}(),Object.freeze(RedBasicController),(RedObitController=function(e){var t;if(!(this instanceof RedObitController))return new RedObitController(e);this.speedDistance=2,this.delayDistance=.1,this.speedRotation=3,this.delayRotation=.1,this.centerX=0,this.centerY=0,this.centerZ=0,this.distance=15,this.tilt=0,Object.defineProperty(this,"minTilt",(t=-90,{get:function(){return t},set:function(e){e<-90&&(e=-90),t=e}})),Object.defineProperty(this,"maxTilt",function(){var e=90;return{get:function(){return e},set:function(t){t>90&&(t=90),e=t}}}()),this.pan=0,this.camera=RedCamera(),this._currentPan=0,this._currentTilt=0,this._currentDistance=0,function(t){var r,n,i,a,o,s,c,u;o=0,s=0,c=0,u=0,r=function(t){o=t.x,s=t.y,e._canvas.addEventListener("mousemove",n),window.addEventListener("mouseup",i)},n=function(e){c=e.x-o,u=e.y-s,o=e.x,s=e.y,t.pan-=c*t.speedRotation*.1,t.tilt-=u*t.speedRotation*.1},i=function(){e._canvas.removeEventListener("mousemove",n),window.removeEventListener("mouseup",i)},a=function(e){t.distance+=e.deltaY/100*t.speedDistance},e._canvas.addEventListener("mousedown",r),e._canvas.addEventListener("wheel",a)}(this)}).prototype.update=function(){var e,t,r;return new Float32Array([0,1,0]),function(n){this.tilt<this.minTilt&&(this.tilt=this.minTilt+.01),this.tilt>this.maxTilt&&(this.tilt=this.maxTilt-.01),this.speedRotation,e=this.delayRotation,t=this.camera,r=t.matrix,this._currentPan+=(this.pan-this._currentPan)*e,this._currentTilt+=(this.tilt-this._currentTilt)*e,this._currentDistance+=(this.distance-this._currentDistance)*this.delayDistance,mat4.identity(r),mat4.rotateY(r,r,this._currentPan*Math.PI/180),mat4.rotateX(r,r,this._currentTilt*Math.PI/180),mat4.translate(r,r,[0,0,this._currentDistance]),t.x=r[12],t.y=r[13],t.z=r[14],t.lookAt(this.centerX,this.centerY,this.centerZ)}}(),Object.freeze(RedObitController);
"use strict";
var RedMaterial;
(function () {
    var makeProgram;
    RedMaterial = function (redGL) {
        if (!(this instanceof RedMaterial)) return new RedMaterial(redGL);
        this['program'] = makeProgram(this, redGL)
        // 유니폼 프로퍼티
        this['floatTest'] = 1
        this['floatTest2'] = [1, 2, 3, 4, 5]
        this['intTest'] = 1
        this['intTest2'] = [1, 2, 3, 4, 5]
        this['vec4Test'] = [0, 0, 0, 0]
        this['mat4Test'] = mat4.create()
        // 일반 프로퍼티
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        Object.seal(this)
        console.log(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*      
            varying vec4 vColor;
            uniform float uFloatTest;
            uniform float uFloatTest2[10];
            uniform int uIntTest;
            uniform int uIntTest2[10];
            uniform vec4 uVec4Test;
            uniform mat4 uMat4Test;
            void main(void) {
                vColor = aVertexColor;
                vColor.r= sin(uTime*0.01);
                uFloatTest;
                uFloatTest2;
                uIntTest;
                uIntTest2;
                uVec4Test;
                uMat4Test;
                uResolution;
                gl_PointSize = aPointSize;
                gl_Position = uPMatrix * uCameraMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            varying vec4 vColor;
            void main(void) {
                gl_FragColor = vColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'testrProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })()

    RedMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedMaterial)
})();
"use strict";
var RedColorMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedColorMaterial`,
            description : `
                RedColorMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                hex : [
                    {type:'hex'}
                ],
                alpha : [
                    {type:'number'},
                    '알파값'
                ]
            },
            example : `
                RedColorMaterial(RedGL Instance, hex)
            `,
            return : 'RedColorMaterial Instance'
        }
    :DOC*/
    RedColorMaterial = function (redGL, hex, alpha) {
        if (!(this instanceof RedColorMaterial)) return new RedColorMaterial(redGL, hex, alpha);
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`color`,
                description : `
                    RedProgram Instance
                    직접설정하지 않도록 유의해야함!
                `,
                return : 'Float32Array'
            }
        :DOC*/
        this['color'] = new Float32Array(4);
        this.setColor(hex ? hex : '#ff0000', alpha == undefined ? 1 : alpha);
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this);
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            uniform vec4 uColor;
            varying vec4 vColor;
            void main(void) {
                vColor = uColor; 
                gl_PointSize = uPointSize;
                gl_Position = uPMatrix * uCameraMatrix* uMVMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            varying vec4 vColor;
            void main(void) {
                vec4 finalColor = vColor * vColor.a;
                gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'colorProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })()
    RedColorMaterial.prototype = RedBaseMaterial.prototype
    /**DOC:
        {
            code : 'METHOD',
            title :`setColor`,
            description : `
                컬러설정
            `,
            params : {
                hex : [
                    {type: 'hex'},
                    'ex) #fff, #ffffff'
                ]
            },
            example : `// TODO:`,
            return : 'RedProgram Instance'
        }
    :DOC*/
    RedColorMaterial.prototype['setColor'] = (function () {
        var t0;
        return function (hex, alpha) {
            hex = hex ? hex : '#ff2211';
            if (alpha == undefined) alpha = 1;
            if (alpha > 1) alpha = 1
            t0 = RedGLUtil.hexToRGB.call(this, hex);
            this['color'][0] = t0[0];
            this['color'][1] = t0[1];
            this['color'][2] = t0[2];
            this['color'][3] = alpha;
        }
    })();
    Object.freeze(RedColorMaterial)
})();
"use strict";
var RedColorPhongMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedColorPhongMaterial`,
            description : `
                RedColorPhongMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                color : [
                    {type:'hex'}
                ],
                alpha : [
                    {type:'number'},
                    '알파값'
                ]
            },
            example: `
            RedColorPhongMaterial(RedGL Instance, hex, alpha)
            `,
            return : 'RedColorPhongMaterial Instance'
        }
    :DOC*/
    RedColorPhongMaterial = function (redGL, hex, alpha) {
        if (!(this instanceof RedColorPhongMaterial)) return new RedColorPhongMaterial(redGL, hex, alpha);
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`color`,
                description : `
                    RedProgram Instance
                    직접설정하지 않도록 유의해야함!
                `,
                return : 'RedProgram Instance'
            }
        :DOC*/
        this['color'] = new Float32Array(4);
        this['shininess'] = 16
        /**DOC:
            {
                title :`specularPower`,
                description : `기본값 : 1`,
                return : 'uint'
            }
        :DOC*/
        this['specularPower'] = 1
        this.setColor(hex ? hex : '#ff0000', alpha == undefined ? 1 : alpha);
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this);
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            
            uniform vec4 uColor;
            varying vec4 vColor;

            varying vec4 vVertexPositionEye4;
            void main(void) {
                vColor = uColor; 
                vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0)); 
                vVertexPositionEye4 = uMVMatrix * vec4(aVertexPosition, 1.0);
                gl_PointSize = uPointSize;
                gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            
            uniform float uShininess;
            uniform float uSpecularPower;
            
            varying vec4 vVertexPositionEye4;
            varying vec4 vColor;
            void main(void) {
                vec4 la = uAmbientLightColor * uAmbientLightColor.a;
                vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
                vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);

                vec4 texelColor = vColor;
                // texelColor.rgb *= texelColor.a;

                vec3 N = normalize(vVertexNormal);

                vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
                float specularTextureValue = 1.0;
                float specular;             

                vec3 L;
                vec3 R;
                highp float lambertTerm;
                for(int i=0; i<DIRETIONAL_MAX; i++){
                    if(i == uDirectionalLightNum) break;
                    L = normalize(-uDirectionalLightPosition[i]);
                    lambertTerm = dot(N,-L);
                    if(lambertTerm > 0.0){
                        ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
                        R = reflect(L, N);
                        specular = pow( max(dot(R, -L), 0.0), uShininess);
                        ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
                    }
                }         
                vec3 pointDirection;  
                highp float distanceLength;
                highp float attenuation;
                for(int i=0;i<POINT_MAX;i++){
                    if(i== uPointLightNum) break;
                    pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
                    distanceLength = length(pointDirection);
                    if(uPointLightRadius[i]> distanceLength){
                        attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength); 
                        L = normalize(pointDirection);
                        lambertTerm = dot(N,-L);
                        if(lambertTerm > 0.0){
                            ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
                            R = reflect(L, N);
                            specular = pow( max(dot(R, -L), 0.0), uShininess);
                            ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
                        }
                    }                          
                }            
                
                vec4 finalColor = la * uAmbientIntensity + ld + ls; 
                finalColor.rgb *= texelColor.a;
                finalColor.a = texelColor.a;
                gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'colorPhongProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedColorPhongMaterial.prototype = RedBaseMaterial.prototype
    /**DOC:
        {
            code : 'METHOD',
            title :`setColor`,
            description : `
                컬러설정
            `,
            params : {
                hex : [
                    {type: 'hex'},
                    'ex) #fff, #ffffff'
                ]
            },
            example : `// TODO:`,
            return : 'RedProgram Instance'
        }
    :DOC*/
    RedColorPhongMaterial.prototype['setColor'] = RedColorMaterial.prototype['setColor'];
    Object.freeze(RedColorPhongMaterial)
})();
"use strict";
var RedColorPhongTextureMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedColorPhongTextureMaterial`,
            description : `
                RedColorPhongTextureMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                color : [
                    {type:'hex'}
                ],
                alpha : [
                    {type:'number'},
                    '알파값'
                ],
                normalTexture : [
                    {type: 'RedBitmapTexture'}
                ],
                specularTexture : [
                    {type: 'RedBitmapTexture'}
                ],
                specularTexture : [
                    {type: 'RedBitmapTexture'}
                ],
                displacementTexture : [
                    {type: 'RedBitmapTexture'}
                ]
            },
            example: `
            RedColorPhongTextureMaterial(RedGL Instance, hex, alpha, normalTexture, specularTexture)
            `,
            return : 'RedColorPhongTextureMaterial Instance'
        }
    :DOC*/
    RedColorPhongTextureMaterial = function (redGL, hex, alpha, normalTexture, specularTexture, displacementTexture) {
        if (!(this instanceof RedColorPhongTextureMaterial)) return new RedColorPhongTextureMaterial(redGL, hex, alpha, normalTexture, specularTexture, displacementTexture);
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`color`,
                description : `
                    RedProgram Instance
                    직접설정하지 않도록 유의해야함!
                `,
                return : 'RedProgram Instance'
            }
        :DOC*/
        this['color'] = new Float32Array(4);
        /**DOC:
             {
                 title :`normalTexture`,
                 return : 'RedBitmapTexture'
             }
         :DOC*/
        this['normalTexture'] = normalTexture;
        /**DOC:
            {
                title :`specularTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['specularTexture'] = specularTexture;
        /**DOC:
            {
                title :`displacementTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['displacementTexture'] = displacementTexture;
        /**DOC:
            {
                title :`shininess`,
                description : `기본값 : 16`,
                return : 'uint'
            }
        :DOC*/
        this['shininess'] = 16
        /**DOC:
            {
                title :`specularPower`,
                description : `기본값 : 1`,
                return : 'uint'
            }
        :DOC*/
        this['specularPower'] = 1
        /**DOC:
           {
               title :`displacementPower`,
               description : `기본값 : 0`,                
               return : 'Number'
           }
       :DOC*/
        this['displacementPower'] = 0
        this.setColor(hex ? hex : '#ff0000', alpha == undefined ? 1 : alpha);
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this);
        console.log(this);
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            
            uniform vec4 uColor;
            varying vec4 vColor;
            uniform sampler2D uDisplacementTexture;
            uniform float uDisplacementPower;

            varying vec4 vVertexPositionEye4;
            void main(void) {
                vColor = uColor; 
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0)); 
                vVertexPositionEye4 = uMVMatrix * vec4(aVertexPosition, 1.0);
                vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(uDisplacementTexture, vTexcoord).x * uDisplacementPower ;
                gl_PointSize = uPointSize;
                gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uNormalTexture;
            uniform sampler2D uSpecularTexture;

            uniform float uShininess;
            uniform float uSpecularPower;
            
            varying vec4 vVertexPositionEye4;
            varying vec4 vColor;
            void main(void) {
                vec4 la = uAmbientLightColor * uAmbientLightColor.a;
                vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
                vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);

                vec4 texelColor = vColor;
                // texelColor.rgb *= texelColor.a;

                vec3 N = normalize(vVertexNormal);
                N = normalize(2.0 * (N + texture2D(uNormalTexture, vTexcoord).rgb  - 0.5));

                vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
                float specularTextureValue = 1.0;
                specularTextureValue = texture2D(uSpecularTexture, vTexcoord).r;
                float specular;             

                vec3 L;
                vec3 R;
                highp float lambertTerm;
                for(int i=0; i<DIRETIONAL_MAX; i++){
                    if(i == uDirectionalLightNum) break;
                    L = normalize(-uDirectionalLightPosition[i]);
                    lambertTerm = dot(N,-L);
                    if(lambertTerm > 0.0){
                        ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
                        R = reflect(L, N);
                        specular = pow( max(dot(R, -L), 0.0), uShininess);
                        ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
                    }
                }         
                vec3 pointDirection;  
                highp float distanceLength;
                highp float attenuation;
                for(int i=0;i<POINT_MAX;i++){
                    if(i== uPointLightNum) break;
                    pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
                    distanceLength = length(pointDirection);
                    if(uPointLightRadius[i]> distanceLength){
                        attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength); 
                        L = normalize(pointDirection);
                        lambertTerm = dot(N,-L);
                        if(lambertTerm > 0.0){
                            ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
                            R = reflect(L, N);
                            specular = pow( max(dot(R, -L), 0.0), uShininess);
                            ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
                        }
                    }                          
                }            
                
                vec4 finalColor = la * uAmbientIntensity + ld + ls; 
                finalColor.rgb *= texelColor.a;
                finalColor.a = texelColor.a;
                gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'colorPhongTextureProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedColorPhongTextureMaterial.prototype = RedBaseMaterial.prototype
    /**DOC:
        {
            code : 'METHOD',
            title :`setColor`,
            description : `
                컬러설정
            `,
            params : {
                hex : [
                    {type: 'hex'},
                    'ex) #fff, #ffffff'
                ]
            },
            example : `// TODO:`,
            return : 'RedProgram Instance'
        }
    :DOC*/
    RedColorPhongTextureMaterial.prototype['setColor'] = RedColorMaterial.prototype['setColor'];
    Object.freeze(RedColorPhongTextureMaterial)
})();
"use strict";
var RedEnvironmentMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedEnvironmentMaterial`,
            description : `
                RedEnvironmentMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                diffuseTexture : [
                    {type:'RedBitmapTexture'}
                ],
                environmentTexture : [
                    {type:'RedBitmapCubeTexture'}
                ],
                normalTexture : [
                    {type:'RedBitmapTexture'}
                ],
                specularTexture : [
                    {type:'RedBitmapTexture'}
                ],
                displacementTexture : [
                    {type:'RedBitmapTexture'}
                ]
            },
            example : `
                RedEnvironmentMaterial(
                    RedGL Instance, 
                    RedBitmapTexture(RedGL Instance, src), // diffuseTexture
                    RedBitmapCubeTexture(RedGL Instance, srcList),
                    RedBitmapTexture(RedGL Instance, src), // normalTexture
                    RedBitmapTexture(RedGL Instance, src), // specularTexture
                    RedBitmapTexture(RedGL Instance, src)  // displacementTexture
                )
            `,
            return : 'RedEnvironmentMaterial Instance'
        }
    :DOC*/
    RedEnvironmentMaterial = function (
        redGL,
        diffuseTexture,
        environmentTexture,
        normalTexture,
        specularTexture,
        displacementTexture
    ) {
        if (!(this instanceof RedEnvironmentMaterial)) return new RedEnvironmentMaterial(
            redGL,
            diffuseTexture,
            environmentTexture,
            normalTexture,
            specularTexture,
            displacementTexture
        );
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedEnvironmentMaterial : RedGL Instance만 허용됩니다.', redGL)
        if (!(diffuseTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedEnvironmentMaterial : diffuseTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (environmentTexture && !(environmentTexture instanceof RedBitmapCubeTexture)) RedGLUtil.throwFunc('RedEnvironmentMaterial : environmentTexture - RedBitmapCubeTexture Instance만 허용됩니다.')
        if (normalTexture && !(normalTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedEnvironmentMaterial : normalTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (specularTexture && !(specularTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedEnvironmentMaterial : specularTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (displacementTexture && !(displacementTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedEnvironmentMaterial : displacementTexture - RedBitmapTexture Instance만 허용됩니다.')
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`diffuseTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['diffuseTexture'] = diffuseTexture;
        /**DOC:
            {
                title :`environmentTexture`,
                return : 'RedBitmapCubeTexture'
            }
        :DOC*/
        this['environmentTexture'] = environmentTexture;
        /**DOC:
            {
                title :`normalTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['normalTexture'] = normalTexture;
        /**DOC:
            {
                title :`specularTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['specularTexture'] = specularTexture;
        /**DOC:
            {
                title :`shininess`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['displacementTexture'] = displacementTexture;
        /**DOC:
            {
                title :`shininess`,
                description : `기본값 : 16`,                
                return : 'Number'
            }
        :DOC*/
        this['shininess'] = 16
        /**DOC:
            {
                title :`specularPower`,
                description : `기본값 : 1`,                
                return : 'Number'
            }
        :DOC*/
        this['specularPower'] = 1
        /**DOC:
            {
                title :`reflectionPower`,
                description : `기본값 : 1`,                
                return : 'Number'
            }
        :DOC*/
        this['reflectionPower'] = 1
        /**DOC:
            {
                title :`displacementPower`,
                description : `기본값 : 0`,                
                return : 'Number'
            }
        :DOC*/
        this['displacementPower'] = 0
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        console.log(this)
        // Object.seal(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            varying vec4 vVertexPositionEye4;
            varying vec3 vReflectionCubeCoord;
            uniform sampler2D uDisplacementTexture;
            uniform float uDisplacementPower;
 
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0)); 
                vVertexPositionEye4 = uMVMatrix * vec4(aVertexPosition, 1.0);     
                vReflectionCubeCoord = -(uMVMatrix *vec4(aVertexPosition, 0.0)).xyz;
                vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(uDisplacementTexture, vTexcoord).x * uDisplacementPower ;
                
                gl_PointSize = uPointSize;
                gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;                
                vVertexPositionEye4 = uMVMatrix * vVertexPositionEye4;
                
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;
            uniform sampler2D uNormalTexture;
            uniform sampler2D uSpecularTexture;
            uniform samplerCube uEnvironmentTexture;
            
            uniform float uShininess;
            uniform float uSpecularPower;
            uniform float uReflectionPower;            
            
            varying vec4 vVertexPositionEye4;
            varying vec3 vReflectionCubeCoord;
 
            void main(void) {
                
                vec4 la = uAmbientLightColor * uAmbientLightColor.a;
                vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
                vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
 
                vec4 texelColor = texture2D(uDiffuseTexture, vTexcoord);
                texelColor.rgb *= texelColor.a;
                if(texelColor.a ==0.0) discard;
 
                vec3 N = normalize(vVertexNormal);
                vec4 normalColor = texture2D(uNormalTexture, vTexcoord);
                N = normalize(2.0 * (N + normalColor.rgb - 0.5));
 
                vec4 reflectionColor = textureCube(uEnvironmentTexture, 2.0 * dot(vReflectionCubeCoord,vVertexNormal) * vVertexNormal - vReflectionCubeCoord);
                texelColor = texelColor * (1.0 - uReflectionPower) + reflectionColor * uReflectionPower;
 
                vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
                float specularTextureValue = 1.0;
                specularTextureValue = texture2D(uSpecularTexture, vTexcoord).r;
                float specular;             
 
                vec3 L;
                vec3 R;
                highp float lambertTerm;
                for(int i=0; i<DIRETIONAL_MAX; i++){
                    if(i == uDirectionalLightNum) break;
                    L = normalize(-uDirectionalLightPosition[i]);
                    lambertTerm = dot(N,-L);
                    if(lambertTerm > 0.0){
                        ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
                        R = reflect(L, N);
                        specular = pow( max(dot(R, -L), 0.0), uShininess);
                        ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
                    }
                }         
                vec3 pointDirection;  
                highp float distanceLength;
                highp float attenuation;
                for(int i=0;i<POINT_MAX;i++){
                    if(i== uPointLightNum) break;
                    pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
                    distanceLength = length(pointDirection);
                    if(uPointLightRadius[i]> distanceLength){
                        attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength); 
                        L = normalize(pointDirection);
                        lambertTerm = dot(N,-L);
                        if(lambertTerm > 0.0){
                            ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
                            R = reflect(L, N);
                            specular = pow( max(dot(R, -L), 0.0), uShininess);
                            ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
                        }
                    }                          
                }         
                    
                vec4 finalColor = la * uAmbientIntensity + ld + ls; 
                finalColor.rgb *= texelColor.a;
                finalColor.a = texelColor.a;
                gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'environmentProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedEnvironmentMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedEnvironmentMaterial)
})();
"use strict";
var RedBitmapMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedBitmapMaterial`,
            description : `
                RedBitmapMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                diffuseTexture : [
                    {type:'RedBitmapTexture'},
                    'RedBitmapTexture Instance'
                ]
            },
            example : `
                RedBitmapMaterial(RedGL Instance, RedBitmapTexture(RedGL Instance, src))
            `,
            return : 'RedBitmapMaterial Instance'
        }
    :DOC*/
    RedBitmapMaterial = function (redGL, diffuseTexture) {
        if (!(this instanceof RedBitmapMaterial)) return new RedBitmapMaterial(redGL, diffuseTexture);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedBitmapMaterial : RedGL Instance만 허용됩니다.', redGL)
        if (!(diffuseTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedBitmapMaterial : RedBitmapTexture Instance만 허용됩니다.')
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`diffuseTexture`,
                return : 'RedBitmapMaterial'
            }
        :DOC*/
        this['diffuseTexture'] = diffuseTexture;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this)
        console.log(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                gl_PointSize = uPointSize;
                gl_Position = uPMatrix * uCameraMatrix* uMVMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;
            void main(void) {
                vec4 texelColor = texture2D(uDiffuseTexture, vTexcoord);
                texelColor.rgb *= texelColor.a;
                if(texelColor.a ==0.0) discard;
                gl_FragColor = texelColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'bitmapProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedBitmapMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedBitmapMaterial)
})();
"use strict";
var RedPointBitmapMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedPointBitmapMaterial`,
            description : `
                RedPointBitmapMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                diffuseTexture : [
                    {type:'RedBitmapTexture'}
                ]
            },
            return : 'RedPointBitmapMaterial Instance'
        }
    :DOC*/
    RedPointBitmapMaterial = function (redGL, diffuseTexture) {
        if (!(this instanceof RedPointBitmapMaterial)) return new RedPointBitmapMaterial(redGL, diffuseTexture);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPointBitmapMaterial : RedGL Instance만 허용됩니다.', redGL)
        if (!(diffuseTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedPointBitmapMaterial : RedBitmapTexture Instance만 허용됩니다.')
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`diffuseTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['diffuseTexture'] = diffuseTexture;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this,redGL);
        /**DOC:
            {
                title :`alphaTest`,
                description : `
                기본값 : 0.0001
                해당값보다 알파값이 작을경우 discard 처리됨.
                `,
                return : 'Number'
            }
        :DOC*/
        this['alphaTest'] = 0.00001
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this)
        console.log(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            void main(void) {
                gl_PointSize = aPointSize;
                gl_Position = uPMatrix * uCameraMatrix* uMVMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;
            uniform float uAlphaTest;
            void main(void) {
                vec4 texelColor = texture2D(uDiffuseTexture, vec2(gl_PointCoord.x, - gl_PointCoord.y));
                texelColor.rgb *= texelColor.a;
                if(texelColor.a < uAlphaTest) discard;
                gl_FragColor = texelColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'pointBitmapProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedPointBitmapMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedPointBitmapMaterial)
})();
"use strict";
var RedStandardMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedStandardMaterial`,
            description : `
                RedStandardMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                diffuseTexture : [
                    {type:'RedBitmapTexture'}
                ],
                normalTexture : [
                    {type:'RedBitmapTexture'}
                ],
                specularTexture : [
                    {type:'RedBitmapTexture'}
                ],
                displacementTexture : [
                    {type:'RedBitmapTexture'}
                ]
            },
            example : `
                RedStandardMaterial(
                    RedGL Instance, 
                    RedBitmapTexture(RedGL Instance, src), // diffuseTexture
                    RedBitmapTexture(RedGL Instance, src), // normalTexture
                    RedBitmapTexture(RedGL Instance, src), // specularTexture
                    RedBitmapTexture(RedGL Instance, src)  // displacementTexture
                )
            `,
            return : 'RedStandardMaterial Instance'
        }
    :DOC*/
    RedStandardMaterial = function (redGL, diffuseTexture, normalTexture, specularTexture, displacementTexture) {
        if (!(this instanceof RedStandardMaterial)) return new RedStandardMaterial(redGL, diffuseTexture, normalTexture, specularTexture, displacementTexture);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedStandardMaterial : RedGL Instance만 허용됩니다.', redGL)
        if (!(diffuseTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedStandardMaterial : diffuseTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (normalTexture && !(normalTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedStandardMaterial : normalTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (specularTexture && !(specularTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedStandardMaterial : specularTexture - RedBitmapTexture Instance만 허용됩니다.')
        if (displacementTexture && !(displacementTexture instanceof RedBitmapTexture)) RedGLUtil.throwFunc('RedStandardMaterial : displacementTexture - RedBitmapTexture Instance만 허용됩니다.')

        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`diffuseTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['diffuseTexture'] = diffuseTexture;
        /**DOC:
            {
                title :`normalTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['normalTexture'] = normalTexture;
        /**DOC:
            {
                title :`specularTexture`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['specularTexture'] = specularTexture;
        /**DOC:
            {
                title :`shininess`,
                return : 'RedBitmapTexture'
            }
        :DOC*/
        this['displacementTexture'] = displacementTexture;
        /**DOC:
            {
                title :`shininess`,
                description : `기본값 : 16`,
                return : 'number'
            }
        :DOC*/
        this['shininess'] = 16
        /**DOC:
            {
                title :`specularPower`,
                description : `기본값 : 1`,                
                return : 'number'
            }
        :DOC*/
        this['specularPower'] = 1
        /**DOC:
            {
                title :`displacementPower`,
                description : `기본값 : 0`,                
                return : 'Number'
            }
        :DOC*/
        this['displacementPower'] = 0
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        console.log(this)
        // Object.seal(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            uniform sampler2D uDisplacementTexture;
            uniform float uDisplacementPower;
            
            varying vec4 vVertexPositionEye4;
            void main(void) {
                vTexcoord = uAtlascoord.xy + aTexcoord * uAtlascoord.zw;
                vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0)); 
                vVertexPositionEye4 = uMVMatrix * vec4(aVertexPosition, 1.0);         
                vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(uDisplacementTexture, vTexcoord).x * uDisplacementPower ;
 
                gl_PointSize = uPointSize;
                gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform sampler2D uDiffuseTexture;
            uniform sampler2D uNormalTexture;
            uniform sampler2D uSpecularTexture;
 
            uniform float uShininess;
            uniform float uSpecularPower;
            
            varying vec4 vVertexPositionEye4;
       
            void main(void) {
                vec4 la = uAmbientLightColor * uAmbientLightColor.a;
                vec4 ld = vec4(0.0, 0.0, 0.0, 1.0);
                vec4 ls = vec4(0.0, 0.0, 0.0, 1.0);
 
                vec4 texelColor = texture2D(uDiffuseTexture, vTexcoord);
                texelColor.rgb *= texelColor.a;
                if(texelColor.a ==0.0) discard;
 
                vec3 N = normalize(vVertexNormal);
                N = normalize(2.0 * (N + texture2D(uNormalTexture, vTexcoord).rgb  - 0.5));
 
                vec4 specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
                float specularTextureValue = 1.0;
                specularTextureValue = texture2D(uSpecularTexture, vTexcoord).r;
                float specular;             
 
                vec3 L;
                vec3 R;
                highp float lambertTerm;
                for(int i=0; i<DIRETIONAL_MAX; i++){
                    if(i == uDirectionalLightNum) break;
                    L = normalize(-uDirectionalLightPosition[i]);
                    lambertTerm = dot(N,-L);
                    if(lambertTerm > 0.0){
                        ld += (uDirectionalLightColor[i] * texelColor * lambertTerm * uDirectionalLightIntensity[i]) * uDirectionalLightColor[i].a;
                        R = reflect(L, N);
                        specular = pow( max(dot(R, -L), 0.0), uShininess);
                        ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uDirectionalLightIntensity[i];
                    }
                }         
                vec3 pointDirection;  
                highp float distanceLength;
                highp float attenuation;
                for(int i=0;i<POINT_MAX;i++){
                    if(i== uPointLightNum) break;
                    pointDirection =  -uPointLightPosition[i] + vVertexPositionEye4.xyz;
                    distanceLength = length(pointDirection);
                    if(uPointLightRadius[i]> distanceLength){
                        attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength); 
                        L = normalize(pointDirection);
                        lambertTerm = dot(N,-L);
                        if(lambertTerm > 0.0){
                            ld += (uPointLightColor[i] * texelColor * lambertTerm * attenuation * uPointLightIntensity[i]) * uPointLightColor[i].a;
                            R = reflect(L, N);
                            specular = pow( max(dot(R, -L), 0.0), uShininess);
                            ls +=  specularLightColor * specular * uSpecularPower * specularTextureValue * uPointLightIntensity[i] ;
                        }
                    }                          
                }            
                
                vec4 finalColor = la * uAmbientIntensity + ld + ls; 
                finalColor.rgb *= texelColor.a;
                finalColor.a = texelColor.a;
                gl_FragColor = finalColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'standardProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedStandardMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedStandardMaterial)
})();
"use strict";
var RedGridMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedGridMaterial`,
            description : `
                RedGridMaterial Instance 생성.
                RedGrid Instance 새성시 내부적으로 자동으로 생성됨.
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ]
            },
            example : `
                RedGridMaterial(RedGL Instance)
            `,
            return : 'RedGridMaterial Instance'
        }
    :DOC*/
    RedGridMaterial = function (redGL) {
        if (!(this instanceof RedGridMaterial)) return new RedGridMaterial(redGL);
        // 유니폼 프로퍼티
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL)
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        Object.seal(this)
        console.log(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            varying vec4 vColor;
            void main(void) {
                vColor = aVertexColor;
                gl_Position = uPMatrix * uCameraMatrix* uMVMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            varying vec4 vColor;
            void main(void) {
                gl_FragColor = vColor;
                gl_FragColor.rgb *= vColor.a;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        PROGRAM_NAME = 'gridMaterialProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();

    RedGridMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedGridMaterial)
})();
"use strict";
var RedPointColorMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedPointColorMaterial`,
            description : `
                RedPointColorMaterial Instance 생성
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ]
            },
            return : 'RedPointColorMaterial Instance'
        }
    :DOC*/
    RedPointColorMaterial = function (redGL) {
        if (!(this instanceof RedPointColorMaterial)) return new RedPointColorMaterial(redGL);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedPointColorMaterial : RedGL Instance만 허용됩니다.', redGL)
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        // Object.seal(this)
        console.log(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            varying vec4 vColor;
            void main(void) {
                gl_PointSize = aPointSize;
                vColor = aVertexColor;
                gl_Position = uPMatrix * uCameraMatrix* uMVMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            varying vec4 vColor;
            void main(void) {
                gl_FragColor = vColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'pointColorProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedPointColorMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedPointColorMaterial)
})();
"use strict";
var RedSkyBoxMaterial;
(function () {
    var makeProgram;
    /**DOC:
        {
            constructorYn : true,
            title :`RedSkyBoxMaterial`,
            description : `
                RedSkyBoxMaterial Instance 생성.
                RedSkyBox Instance 생성시 내부적으로 자동으로 생성됨.
            `,
            params : {
                redGL : [
                    {type:'RedGL'}
                ],
                skyboxTexture : [
                    {type:'RedBitmapCubeTexture'}
                ]
            },
            example : `
                RedSkyBoxMaterial(
                    RedGL Instance,
                    RedBitmapCubeTexture Instance
                )
            `,
            return : 'RedSkyBoxMaterial Instance'
        }
    :DOC*/
    RedSkyBoxMaterial = function (redGL, skyboxTexture) {
        if (!(this instanceof RedSkyBoxMaterial)) return new RedSkyBoxMaterial(redGL, skyboxTexture);
        if (!(redGL instanceof RedGL)) RedGLUtil.throwFunc('RedSkyBoxMaterial : RedGL Instance만 허용됩니다.', redGL)
        if (skyboxTexture && !(skyboxTexture instanceof RedBitmapCubeTexture)) RedGLUtil.throwFunc('RedSkyBoxMaterial : skyboxTexture - RedBitmapCubeTexture Instance만 허용됩니다.')
        /////////////////////////////////////////
        // 유니폼 프로퍼티
        /**DOC:
            {
                title :`skyboxTexture`,
                return : 'RedBitmapCubeTexture'
            }
        :DOC*/
        this['skyboxTexture'] = skyboxTexture;
        /////////////////////////////////////////
        // 일반 프로퍼티
        this['program'] = makeProgram(this, redGL);
        this['_UUID'] = RedGL['makeUUID']();
        this.checkProperty()
        console.log(this)
        // Object.seal(this)
    }
    makeProgram = (function () {
        var vSource, fSource;
        var PROGRAM_NAME;
        vSource = function () {
            /*
            varying vec3 vReflectionCubeCoord;
            void main(void) {
                vReflectionCubeCoord = (uMVMatrix *vec4(-aVertexPosition, 0.0)).xyz;
                gl_Position = uPMatrix * uCameraMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
            }
            */
        }
        fSource = function () {
            /*
            precision mediump float;
            uniform samplerCube uSkyboxTexture;
            
            varying vec3 vReflectionCubeCoord;
            void main(void) {
                vec4 texelColor = textureCube(uSkyboxTexture, vReflectionCubeCoord);
                gl_FragColor = texelColor;
            }
            */
        }
        vSource = RedGLUtil.getStrFromComment(vSource.toString());
        fSource = RedGLUtil.getStrFromComment(fSource.toString());
        // console.log(vSource, fSource)
        PROGRAM_NAME = 'skyboxProgram';
        return function (target, redGL) {
            return target['checkProgram'](redGL, PROGRAM_NAME, vSource, fSource)

        }
    })();
    RedSkyBoxMaterial.prototype = RedBaseMaterial.prototype
    Object.freeze(RedSkyBoxMaterial)
})();console.log('RedGL Release. last update(2018-04-22 20:21:43)');