<html>

<head>
    <meta charset="UTF-8">
    <title>LOD</title>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, target-densitydpi=device-dpi"
    />
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>

    <script src="dat.gui.min.js"></script>
    <script src="baseTestUI.js"></script>
    <script src="../release/RedGL.min.js"></script>
</head>

<body>
<script id='testSource'>
	var testUI;
	var canvas;
	var assetPath = '../../asset/'
	canvas = document.createElement('canvas');
	document.body.appendChild(canvas);
	RedGL(canvas, function (v) {
		if ( v ) {
			console.log('초기화 성공!')
			var tWorld, tScene, tController, tRenderer;
			var self;
			self = this;
			// 월드 생성
			this['world'] = tWorld = RedWorld();
			// 씬 생성
			tScene = RedScene(this);
			// 카메라 생성
			tController = RedObitController(this);
			tController.distance = 15
			tController.tilt = -30
			tController.pan = 0
			// 렌더러 생성
			tRenderer = RedRenderer();
			// 뷰생성 및 적용
			tWorld.addView(RedView('test', this, tScene, tController));
			// 라이트 설정
			var testDLight;
			testDLight = RedDirectionalLight(this, '#fff', 1)
			testDLight.x = 3
			testDLight.y = 2
			testDLight.z = 3
			testDLight.debug = true
			tScene.addLight(testDLight)
			tScene.skyBox =
				RedSkyBox(this, [
					'../asset/cubemap/SwedishRoyalCastle/px.jpg',
					'../asset/cubemap/SwedishRoyalCastle/nx.jpg',
					'../asset/cubemap/SwedishRoyalCastle/py.jpg',
					'../asset/cubemap/SwedishRoyalCastle/ny.jpg',
					'../asset/cubemap/SwedishRoyalCastle/pz.jpg',
					'../asset/cubemap/SwedishRoyalCastle/nz.jpg'
				]);
			var i = 15
			var max = 10
			var j
			var k
			var tMesh;
			var tGeo = RedSphere(self, 0.5, 16, 16, 16)
			var tMat = RedStandardMaterial(
				self,
				RedBitmapTexture(self, '../asset/crate.png'),
				RedBitmapTexture(self, '../asset/normalTest.jpg'),
				RedBitmapTexture(self, '../asset/brick_roughness.jpg')
			)
			tMat.shininess = 32
			while ( i-- ) {
				j = 15
				while ( j-- ) {
					k = 15
					while ( k-- ) {
						tMesh = RedMesh(self, tGeo, tMat)
						tMesh.x = (i - 7.5) * 2
						tMesh.y = (j - 7.5) * 2
						tMesh.z = (k - 7.5) * 2
						tMesh.useLOD = true
						tMesh.drawMode = self.gl.LINES
						tMesh.addLOD(0, 5, RedSphere(self, 0.5, 32, 32, 32), tMat)
						tMesh.addLOD(1, 10, RedSphere(self, 0.5, 16, 16, 16), RedColorMaterial(self, '#00ff00'))
						tMesh.addLOD(2, 15, RedSphere(self, 0.5, 8, 8, 8), RedColorMaterial(self, '#0000ff'))
						tMesh.addLOD(3, 20, RedSphere(self, 0.5, 4, 4, 4), RedColorMaterial(self, '#ffff00'))
						tMesh.addLOD(4, 25, RedSphere(self, 0.5, 3, 3, 3), RedColorMaterial(self, '#00ffff'))
						tScene.addChild(tMesh)
					}
				}
			}
			// 렌더시작
			tRenderer.start(this, function (time) {})
			// 렌더 디버거 활성화
			tRenderer['renderDebuger']['visible'] = true
			testUI()
		} else {
			console.log('초기화 실패!')
		}
	})
	testUI = function (redGL, tScene, effect) {
		var gui = new baseTestUI(redGL)
	}
</script>
</body>

</html>