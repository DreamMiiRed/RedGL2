<html>

<head>
    <meta charset="UTF-8">
    <title>RedLine</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, target-densitydpi=device-dpi"
    />
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>
    <script src="dat.gui.min.js"></script>
    <script src="baseTestUI.js"></script>
    <script src="../release/RedGL.min.js"></script>
</head>

<body>
    <canvas id="test" style="border: none;background:red"></canvas>
    <script>
        var testUI;
        document.getElementById('test')
        RedGL(document.getElementById('test'), function (v) {
            if (v) {
                console.log('초기화 성공!')
                var tWorld, tRenderer;
                var tScene;
                var tCamera;

                // 월드 생성
                this['world'] = tWorld = RedWorld();

                // 씬 생성
                tScene = RedScene(this);

                // 카메라 생성
                tCamera = RedCamera();

                // 렌더러 생성
                tRenderer = RedRenderer();

                // 뷰생성 및 적용
                tWorld.addView(RedView('testView', tScene, tCamera));

                // 그리드 설정
                tScene['grid'] = RedGrid(this)


                // tLine 설정
                var addLine, addLine2;
                addLine = function (redGL) {
                    var tLine;
                    var tX, tY, tZ
                    var i = 3 * 20
                    tLine = RedLine(redGL, RedColorMaterial(redGL))
                    tScene.addChild(tLine)
                    tX = tY = tZ = 0
                    while (i--) {
                        tX += Math.random() * 0.5
                        tY += Math.random() * 0.5
                        tZ += Math.random() * 0.5
                        tLine.addPoint(tX, tY, tZ)
                    }
                }
                addLine2 = function (redGL) {
                    var tLine;
                    var tX, tY, tZ
                    var i = 3 * 20
                    tLine = RedLine(redGL, RedColorMaterial(redGL, '#00ff00'))
                    tScene.addChild(tLine)
                    tX = tY = tZ = 0
                    while (i--) {
                        tX += Math.sin(i / 60 * Math.PI * 2)
                        tY += Math.cos(i / 60 * Math.PI * 2)
                        tZ += Math.sin(i / 60 * Math.PI * 2)
                        tLine.addPoint(tX, tY, tZ)
                    }
                    tLine.rotationX = tLine.rotationY = tLine.rotationZ = Math.random() * 360
                    tLine.drawMode = redGL.gl.LINES
                }
                addLine(this)
                addLine2(this)

                tCamera.x = 30
                tCamera.y = 30
                tCamera.z = 30
                tCamera.lookAt(0, 0, 0)

                // 렌더시작
                tRenderer.start(this, function (time) {
                    var i = tScene.children.length
                    var t0
                    while (i--) {
                        t0 = tScene.children[i]
                        t0.rotationX += 1
                        t0.rotationY += 1
                        t0.rotationZ += 1
                    }
                })

                // 렌더 디버거 활성화
                tRenderer['renderDebuger']['visible'] = true

                // 
                testUI(this, RedView('testView'), addLine, addLine2)
            } else {
                console.log('초기화 실패!')
            }
        })
        testUI = function (redGL, view1, addLine,addLine2) {
            console.log('test')
            var gui = new baseTestUI(redGL)
            gui.initCamera(view1['camera'])
            gui.initScene(view1['scene'])

            var t0 = gui['gui'].addFolder('Line Test')
            var test = {
                addLineTest: function () {
                    addLine(redGL)
                },
                addLine2Test: function () {
                    addLine2(redGL)
                }
            }
            t0.open()
            t0.add(test, 'addLineTest').name('add Line Test')
            t0.add(test, 'addLine2Test').name('add Line Test2')



        }
    </script>
</body>

</html>